{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///node_modules/moment/locale sync ^\\.\\/.*$","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/app.service.ts","webpack:///src/app/chart/chart.component.ts","webpack:///src/app/chart/chart.component.html","webpack:///src/app/chart/chart.module.ts","webpack:///src/app/chart/chart.service.ts","webpack:///src/app/common/aliceblue-parser.service.ts","webpack:///src/app/common/aliceblue.service.ts","webpack:///src/app/common/angel.service.ts","webpack:///src/app/common/angelwebsocket.service.ts","webpack:///src/app/common/application.constant.ts","webpack:///src/app/common/fyers.service.ts","webpack:///src/app/common/holdings.service.ts","webpack:///src/app/common/map.service.ts","webpack:///src/app/common/models.ts","webpack:///src/app/common/websocket.service.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","map","webpackContext","webpackContextResolve","__webpack_require__","o","webpackContextKeys","Object","routes","AppRoutingModule","forRoot","imports","AppComponent","route","appService","mapService","websocketService","chartService","angelService","angelWS","holdingsService","title","access_token","user_id","auth_code","lastRequestStatus","positions","orders","hide_positions","hide_orders","disable_order_buttons","lastPositionsUpdateTime","lastOrdersUpdateTime","positionsPnL","stranglePositions","debitSpreadPositions","newexpiry","newstrike","newoption","newqty","newblock","newlimit","newstop","newProductType","newOrderType","nifty_oc_check","usdinr_oc_check","oc_instru","oc_year","oc_month","oc_date","is_monthly_expiry","checked_instrument","oc_range_higher","oc_range_lower","oc_range_multiple","oc_strikes","oc_product_type","ws_vendor","mean","variance","ws_access_token","strategyPnL","strategyPointsProfit","suggestions","adjust_sugg","portfolio_return","holdings","total_inv","current_val","combined_SL","combined_premium","qty_default","historical_append","zerodha_auth","zerodha_marketwatch","zerodha_from_date","zerodha_to_date","zerodha_expiry_date","queryParams","subscribe","params","console","log","requestStatusEvent$","res","websocketEvent$","subscribePositionsFeed","setLtp","window","location","href","includes","isProduction","refresh_interval","setInterval","updateSpotStrike","autoSuggest_interval","strategyPnLEvent$","optionChainEvent$","instru","expiryDate","processOCRequest","setTimeout","fetchCandles","exportToCSV","expiry","Date","getFullYear","getMonth","getDate","spot","getLtp","spotStrike","Math","round","updateOCRange","symbol","strike","type","date_expiry","setHours","underlying","mkt_price","typet0","CE","PE","iv","calculateIV","INTEREST_RATE","ltp","delta","getDelta","USDINR_FUT_MONTH","auth","next","authorization_code","generateAccessToken","error","message","tokenUrl","getTokenUrl","fyersAppId","wnd","open","getFunds","totalBalance","fund_limit","equityAmount","toLocaleString","availableBalance","utilizedBalance","getPositions","toLocaleTimeString","mapPositions","pos","includeInSum1","includeInSum2","includeInSum3","includeInSum4","num","sum","forEach","pnl","RestMode","netPositions","Array","p","scrip","netQty","buyAvg","sellAvg","productType","realizedProfit","pl","push","sub","replace","startsWith","slice","substring","isNaN","parseInt","monthlyExpiryDates","toDateString","monthlyExpiryDatesUSDINR","year","Number","month","date","e1","sendSubscriptions","abMastersContract","size","SocketMode","getMastersContract","isSocketConnected","getOrders","mapOrders","orderBook","order","qty","status","limit","limitPrice","stop","stopPrice","tradedPrice","side","orderDateTime","placeOrder","refreshAll","confirm","exitPosition","isExitSelected","document","getElementById","value","abs","buysell","orderType","user_confirm","playAudio","oc","payOffEvent$","chartEvent$","curr_positions_trades","i","length","element","ocDate","strikeExpiry","exit","entry","optionType","findInitialPositions","checkAdjustments","isAnyOpenPosition","index","getExpiry","index1","symbol1","delta1","ltp1","strikeCE","deltaCE","ltpCE","strikePE","deltaPE","ltpPE","ceDelta","cePremium","ceQty","peDelta","pePremium","peQty","roll","action","colName","sort","a","b","fetchStocksData","r","loadHoldings","backtestStocks","exportBacktest","avgp","enteredDate","tempmonthlyExpiryDates","key","hasOwnProperty","getTime","isSimulatedStrategy","e2","ocSpotStrike","position","cmp","monthsMapping","expiryMonth","oc_strike","getAtp","volume","getVolume","getOI","getChgOI","connectWebsocket","filter","lotsize","credit","profit","loss","spread","s1","s2","debit","establishWSVendor","exitSelected","fetchHistorical","exportHistorical","sortTableColumn","fetchStocks","clearOC","selector","templateUrl","styleUrls","AppModule","declarations","providers","bootstrap","AppService","http","fyersService","aliceblueService","simulate_strategy","simulateCurrDateObj","date_now","seconds","floor","minutes","hours","delta_t","volt","int_rate","d1","pow","sqrt","getCDF","dDate1","dDate2","count","curDate","dayOfWeek","getDay","setDate","expiry_date","high","low","calculateT0AtPoint","volatility","add_days","t0","days_diff","calcWorkingDays","d2","fv_strike","exp","x","standardDeviation","erfc","z","t","relativePath","audio","Audio","src","load","play","urlToFetch","httpOptions","url","get","exchange","formData","FormData","append","pos_strike","trade","exch","qtyMultiple","post","strikes","angelLogin","appId","place_order","providedIn","ChartComponent","s1Trades","s2Trades","s3Trades","s4Trades","s5Trades","currLoadNum","payOffData","margin","breakevens","ceWeight","peWeight","ceLots","peLots","rest_res","labels","zeroline","stepValue","simulate_instru","simulateExpiryDate","simulateStartDate","simulateTimeAdv","simulateTimeMins","simulateCurrHour","simulateCurrMins","simulateCurrDateTimeString","payoff_overlay","hide_payoff","use_hypo_future","hypo_future_strike","payoff_range","alerts","ordersTextarea","orders_parsed","orders_broker","ce_side_overlay","pe_side_overlay","num_overlays","lineChartData","finLineChartData1","finLineChartData2","finLineChartDataInstru","lineChartLabels","finLineChartLabels1","finLineChartLabels2","finLineChartLabelsInstru","lineChartOptions","finLineChartOptions","lineChartColors","borderColor","borderWidth","pointRadius","borderDash","finLineChartColors","lineChartLegend","lineChartType","lineChartPlugins","straddle1instru","straddle1expiryDate","straddle1scrip","straddle2instru","straddle2expiryDate","straddle2scrip","straddle3instru","straddle3expiryDate","straddle3scrip","i1ChartData","i1ChartLabels","i1ChartOptions","responsive","scales","xAxes","yAxes","tooltips","mode","intersect","animation","duration","elements","line","fill","i1ChartColors","i1ChartLegend","i1ChartType","i1ChartPlugins","intradayWatch","parseSymbol","addPosition","addScripToChart","doStrategiesSubscriptions","numAlerts","selected","scrip1","scrip2","compare","price","alert_interval","alert","getLTP_strike","ltp2","updateChartData","getCEPEWeightage","refresh_intervalP","getPayoff","refresh_intervalI","curr_positions","JSON","parse","localStorage","getItem","trades","event","parseUpstoxOrders","parseZerodhaOrders","split","details","strategy","getMapKeyString","export_file_name","getDateInFormat","str","row","downloadFile","Blob","navigator","msSaveOrOpenBlob","fileURL","URL","createObjectURL","link","createElement","target","body","appendChild","download","click","parentNode","removeChild","d","m","y","h","getHours","mins","getMinutes","s","getSeconds","format","fileInput","fileReaded","files","reader","FileReader","readAsText","onload","csv","String","result","loadExpiryFile","importData","allTextLines_all_data","allTextLines","elem","firstLine","simulateData","instru_name","timeDict","setMinutes","curr_date_string","loadSimulatedOCForTime","loadOptionChain","eod","diff","newday","setMilliseconds","getMilliseconds","sod","dateTimeString","curr_date_time","entries","endsWith","ltpMap","loadPayoffData","subscribeStrategiesPositionsFeed","subscribeAlerts","getSubscriptionObject","isImported","loadImportedPositions","selectedActual","compareForSorting","a_symbol","b_symbol","constructUrlToFetch","ascrip","bscrip","monthNames","day","monthIndex","monthName","dateString","arr","found_index","splice","getMargin","combinedItems","reduce","acc","obj","notconsider","found","qtydiff","copy","assign","stringify","setItem","reloadPayoffData","straddle_strike","currentTarget","checked","overlay_strike","new_strike1","unselectStraddlePositions","new_premium1_ce","new_premium1_pe","calculatePayoff","myPayoff","chart","ce_premium","pe_premium","parseFloat","getInstruLTP","range","increment","multiple","lower_range","upper_range","pnlForBreakeven","pnlExitedPos","actualPos","overlayPos1","overlayPos2","overlayPos3","hedge_strike","whatIsStraddleHedge","addPositionCustom","new_strike2","new_premium2_ce","new_premium2_pe","new_strike3","new_premium3_ce","new_premium3_pe","pospnl","getPnL","point","t1","t2","overlayPnL","overlayT0","overlayPnL2","overlayPnL3","calculatePnLAtPoint","Final","StockPrice","Today","T1","T2","Overlay","OverlayT0","Overlay2","Overlay3","prev_element","overlay","CEsell","PEsell","CEbuy","PEbuy","calculatePnLAtPointForStrike","d3","t0_","calculateT0AtPointForStrike","t1_","t2_","getZerodhaMargin","total","roi","getStrategyPnL","suggest_string","charges","pointsProfit","posPnl","chartData","curr_date","k","v","label","close","updateFinChartData","isArray","data","overlay2","overlay3","annotation","events","annotations","getChartAnnotations","drawTime","scaleID","yAdjust","enabled","fontColor","content","prices","ce_intraday","getIntradayData","pe_intraday","spot_intraday","ce_elem","ce_time","time","pe_elem","yAxisID","ordersTextareaUpdated","addOrdersToStrategy","payoffCheckboxChange","doSingleStrategySubscription","savePositions","importCSV","ChartModule","ChartService","intradayData","Map","set","sec","cutOffTime","openTime","currTime","dformat","join","val","AliceblueParserService","binaryData","parseSocketMessage","dataByteArry","Uint8Array","MARKETDATA","parseMarketData","COMPACT_MARKETDATA","SNAPQUOTE","FULL_SNAPQUOTE","DPR","OI","MARKET_STATUS","EXCHANGE_MESSAGES","payload","exchange_code","multiplier","token","byteArrayToNumber","subarray","ltt_unix","last_traded_qty","best_bid","best_bid_qty","best_ask","best_ask_qty","total_buy_qty","total_sell_qty","atp","exchange_timestamp","year_high","year_low","updateMaps","payloadstr","fromCharCode","apply","bufferedArray","shiftMax","accum","shiftBy","startIndex","instru_masters","setAtp","setVolume","AliceblueService","webSocketService","baseUrl","responseType","clear","lotSize","company","connect","instruments","instrument","findStrikeInMasters","MARKET_DATA","sendMessage","return_instru","AngelService","angelFeedToken","feedToken","angelJWTToken","jwtToken","angelRefreshToken","refreshToken","exch_seg","name","strwatchlistscrips","subs","angelUserId","headers","angelAPIKey","angelPassword","Authorization","AngelWebsocketService","aliceblueParserService","socket_endpoint","url2","websocket","OPEN","WebSocket","binaryType","onopen","handleOnOpen","onmessage","messageEvent","handleOnMessage","onerror","handleOnError","onclose","handleOnClose","_req","sendHeartbeat","heartbeatInterval","usdinr_fut_code","USDINRFUTCodes","strData","atob","charData","charCodeAt","binData","_atos","json","msg","array","newarray","clearInterval","send","AppConstants","fyersSecretId","toUpperCase","dummyResPos","dummyResOrd","FyersService","dataUrl","testUrl","HoldingsService","holdingsMap","backtestMap","shortlistedStocks","marketwatch","from_date","to_date","delay","niftyReturn","items","item","tradingsymbol","instrument_token","candles","j","expiry_string","key1","total_investment","current_value","supp_str","res_str","avgp_adj","ltp_adj","supp_perc","supp","supp_perc_t","res_perc","res_perc_t","oned","onew","onem","threem","fiftytwow","support","resistance","nifty50stocksURL","resArr","lastPrice","totalTradedVolume","pChange","perChange30d","yearHigh","fetchIndicesData","fetchHistoricalData","indicesURL","last","percentChange","date_prev","stockHistoricalURL","stockUrl","closeArr","indicators","adjclose","meta","regularMarketPrice","currdate","regularMarketTime","index_oned","timestamps","timestamp","one","thirty","highArr","quote","max_high","max","seven","ninety","finalStocks","cum_percent","stocksRetStr","ret","avg_percent","returnsStr","backtest52W1M","monthsToTest","test_date_end","test_date_start","toLocaleDateString","MapService","atpMap","volumeMap","oiMap","chgoiMap","period","IntradayData","Position","OrderPasted","Order","PlaceOrder","AliceblueInstrument","Instrument","AliceMarketData","AliceBlueLiveFeedType","AliceBlueWsFrameMode","PositionTypeForPayOff","WebsocketService","sendInitialSubscription","handleSocketMessage","environment","production","bootstrapModule","err"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,aAASA,wBAAT,CAAkCC,GAAlC,EAAuC;AACtC;AACA;AACA,aAAOC,OAAO,CAACC,OAAR,GAAkBC,IAAlB,CAAuB,YAAW;AACxC,YAAIC,CAAC,GAAG,IAAIC,KAAJ,CAAU,yBAAyBL,GAAzB,GAA+B,GAAzC,CAAR;AACAI,SAAC,CAACE,IAAF,GAAS,kBAAT;AACA,cAAMF,CAAN;AACA,OAJM,CAAP;AAKA;;AACDL,4BAAwB,CAACQ,IAAzB,GAAgC,YAAW;AAAE,aAAO,EAAP;AAAY,KAAzD;;AACAR,4BAAwB,CAACG,OAAzB,GAAmCH,wBAAnC;AACAS,UAAM,CAACC,OAAP,GAAiBV,wBAAjB;AACAA,4BAAwB,CAACW,EAAzB,GAA8B,yCAA9B;;;;;;;;;;;;;;ACZA,QAAIC,GAAG,GAAG;AACT,cAAQ,oCADC;AAET,iBAAW,oCAFF;AAGT,cAAQ,oCAHC;AAIT,iBAAW,uCAJF;AAKT,oBAAc,uCALL;AAMT,iBAAW,uCANF;AAOT,oBAAc,uCAPL;AAQT,iBAAW,uCARF;AAST,oBAAc,uCATL;AAUT,iBAAW,uCAVF;AAWT,oBAAc,uCAXL;AAYT,iBAAW,uCAZF;AAaT,oBAAc,uCAbL;AAcT,iBAAW,uCAdF;AAeT,oBAAc,uCAfL;AAgBT,iBAAW,oCAhBF;AAiBT,cAAQ,oCAjBC;AAkBT,iBAAW,oCAlBF;AAmBT,cAAQ,oCAnBC;AAoBT,iBAAW,oCApBF;AAqBT,cAAQ,oCArBC;AAsBT,iBAAW,oCAtBF;AAuBT,cAAQ,oCAvBC;AAwBT,iBAAW,oCAxBF;AAyBT,cAAQ,oCAzBC;AA0BT,iBAAW,uCA1BF;AA2BT,oBAAc,uCA3BL;AA4BT,iBAAW,oCA5BF;AA6BT,cAAQ,oCA7BC;AA8BT,iBAAW,oCA9BF;AA+BT,cAAQ,oCA/BC;AAgCT,iBAAW,oCAhCF;AAiCT,cAAQ,oCAjCC;AAkCT,iBAAW,oCAlCF;AAmCT,cAAQ,oCAnCC;AAoCT,iBAAW,oCApCF;AAqCT,cAAQ,oCArCC;AAsCT,iBAAW,oCAtCF;AAuCT,cAAQ,oCAvCC;AAwCT,iBAAW,oCAxCF;AAyCT,cAAQ,oCAzCC;AA0CT,iBAAW,oCA1CF;AA2CT,cAAQ,oCA3CC;AA4CT,iBAAW,oCA5CF;AA6CT,cAAQ,oCA7CC;AA8CT,iBAAW,uCA9CF;AA+CT,oBAAc,uCA/CL;AAgDT,iBAAW,uCAhDF;AAiDT,oBAAc,uCAjDL;AAkDT,iBAAW,oCAlDF;AAmDT,cAAQ,oCAnDC;AAoDT,iBAAW,oCApDF;AAqDT,cAAQ,oCArDC;AAsDT,iBAAW,oCAtDF;AAuDT,iBAAW,uCAvDF;AAwDT,oBAAc,uCAxDL;AAyDT,iBAAW,uCAzDF;AA0DT,oBAAc,uCA1DL;AA2DT,iBAAW,uCA3DF;AA4DT,oBAAc,uCA5DL;AA6DT,iBAAW,uCA7DF;AA8DT,oBAAc,uCA9DL;AA+DT,iBAAW,uCA/DF;AAgET,oBAAc,uCAhEL;AAiET,iBAAW,uCAjEF;AAkET,oBAAc,uCAlEL;AAmET,iBAAW,uCAnEF;AAoET,oBAAc,uCApEL;AAqET,iBAAW,uCArEF;AAsET,oBAAc,uCAtEL;AAuET,cAAQ,oCAvEC;AAwET,iBAAW,oCAxEF;AAyET,cAAQ,oCAzEC;AA0ET,iBAAW,uCA1EF;AA2ET,oBAAc,uCA3EL;AA4ET,iBAAW,uCA5EF;AA6ET,oBAAc,uCA7EL;AA8ET,iBAAW,uCA9EF;AA+ET,oBAAc,uCA/EL;AAgFT,iBAAW,oCAhFF;AAiFT,cAAQ,oCAjFC;AAkFT,iBAAW,oCAlFF;AAmFT,cAAQ,oCAnFC;AAoFT,iBAAW,oCApFF;AAqFT,cAAQ,oCArFC;AAsFT,iBAAW,oCAtFF;AAuFT,cAAQ,oCAvFC;AAwFT,iBAAW,oCAxFF;AAyFT,eAAS,qCAzFA;AA0FT,kBAAY,qCA1FH;AA2FT,cAAQ,oCA3FC;AA4FT,iBAAW,oCA5FF;AA6FT,cAAQ,oCA7FC;AA8FT,iBAAW,uCA9FF;AA+FT,oBAAc,uCA/FL;AAgGT,iBAAW,uCAhGF;AAiGT,oBAAc,uCAjGL;AAkGT,iBAAW,oCAlGF;AAmGT,cAAQ,oCAnGC;AAoGT,iBAAW,oCApGF;AAqGT,cAAQ,oCArGC;AAsGT,iBAAW,oCAtGF;AAuGT,cAAQ,oCAvGC;AAwGT,iBAAW,oCAxGF;AAyGT,cAAQ,oCAzGC;AA0GT,iBAAW,oCA1GF;AA2GT,oBAAc,0CA3GL;AA4GT,uBAAiB,0CA5GR;AA6GT,oBAAc,0CA7GL;AA8GT,uBAAiB,0CA9GR;AA+GT,cAAQ,oCA/GC;AAgHT,iBAAW,oCAhHF;AAiHT,cAAQ,oCAjHC;AAkHT,iBAAW,oCAlHF;AAmHT,cAAQ,oCAnHC;AAoHT,iBAAW,oCApHF;AAqHT,cAAQ,oCArHC;AAsHT,iBAAW,oCAtHF;AAuHT,cAAQ,oCAvHC;AAwHT,iBAAW,oCAxHF;AAyHT,iBAAW,uCAzHF;AA0HT,oBAAc,uCA1HL;AA2HT,cAAQ,oCA3HC;AA4HT,iBAAW,oCA5HF;AA6HT,cAAQ,oCA7HC;AA8HT,iBAAW,oCA9HF;AA+HT,cAAQ,oCA/HC;AAgIT,iBAAW,uCAhIF;AAiIT,oBAAc,uCAjIL;AAkIT,iBAAW,oCAlIF;AAmIT,cAAQ,oCAnIC;AAoIT,iBAAW,oCApIF;AAqIT,cAAQ,oCArIC;AAsIT,iBAAW,oCAtIF;AAuIT,cAAQ,oCAvIC;AAwIT,iBAAW,oCAxIF;AAyIT,cAAQ,oCAzIC;AA0IT,iBAAW,oCA1IF;AA2IT,cAAQ,oCA3IC;AA4IT,iBAAW,oCA5IF;AA6IT,cAAQ,oCA7IC;AA8IT,iBAAW,oCA9IF;AA+IT,cAAQ,oCA/IC;AAgJT,iBAAW,oCAhJF;AAiJT,cAAQ,oCAjJC;AAkJT,iBAAW,oCAlJF;AAmJT,cAAQ,oCAnJC;AAoJT,iBAAW,oCApJF;AAqJT,cAAQ,oCArJC;AAsJT,iBAAW,oCAtJF;AAuJT,cAAQ,oCAvJC;AAwJT,iBAAW,oCAxJF;AAyJT,cAAQ,oCAzJC;AA0JT,iBAAW,oCA1JF;AA2JT,cAAQ,oCA3JC;AA4JT,iBAAW,oCA5JF;AA6JT,cAAQ,oCA7JC;AA8JT,iBAAW,oCA9JF;AA+JT,cAAQ,oCA/JC;AAgKT,iBAAW,oCAhKF;AAiKT,cAAQ,oCAjKC;AAkKT,iBAAW,oCAlKF;AAmKT,cAAQ,oCAnKC;AAoKT,iBAAW,oCApKF;AAqKT,cAAQ,oCArKC;AAsKT,iBAAW,oCAtKF;AAuKT,cAAQ,oCAvKC;AAwKT,iBAAW,oCAxKF;AAyKT,cAAQ,oCAzKC;AA0KT,iBAAW,uCA1KF;AA2KT,oBAAc,uCA3KL;AA4KT,iBAAW,oCA5KF;AA6KT,cAAQ,oCA7KC;AA8KT,iBAAW,oCA9KF;AA+KT,cAAQ,oCA/KC;AAgLT,iBAAW,oCAhLF;AAiLT,cAAQ,oCAjLC;AAkLT,iBAAW,oCAlLF;AAmLT,cAAQ,oCAnLC;AAoLT,iBAAW,oCApLF;AAqLT,cAAQ,oCArLC;AAsLT,iBAAW,uCAtLF;AAuLT,oBAAc,uCAvLL;AAwLT,iBAAW,oCAxLF;AAyLT,cAAQ,oCAzLC;AA0LT,iBAAW,oCA1LF;AA2LT,kBAAY,wCA3LH;AA4LT,qBAAe,wCA5LN;AA6LT,iBAAW,uCA7LF;AA8LT,oBAAc,uCA9LL;AA+LT,cAAQ,oCA/LC;AAgMT,iBAAW,oCAhMF;AAiMT,cAAQ,oCAjMC;AAkMT,iBAAW,uCAlMF;AAmMT,oBAAc,uCAnML;AAoMT,iBAAW,oCApMF;AAqMT,cAAQ,oCArMC;AAsMT,iBAAW,oCAtMF;AAuMT,cAAQ,oCAvMC;AAwMT,iBAAW,oCAxMF;AAyMT,cAAQ,oCAzMC;AA0MT,iBAAW,oCA1MF;AA2MT,cAAQ,oCA3MC;AA4MT,iBAAW,oCA5MF;AA6MT,cAAQ,oCA7MC;AA8MT,iBAAW,oCA9MF;AA+MT,cAAQ,oCA/MC;AAgNT,iBAAW,oCAhNF;AAiNT,cAAQ,oCAjNC;AAkNT,iBAAW,oCAlNF;AAmNT,cAAQ,oCAnNC;AAoNT,iBAAW,oCApNF;AAqNT,cAAQ,oCArNC;AAsNT,mBAAa,yCAtNJ;AAuNT,sBAAgB,yCAvNP;AAwNT,iBAAW,oCAxNF;AAyNT,cAAQ,oCAzNC;AA0NT,iBAAW,oCA1NF;AA2NT,cAAQ,oCA3NC;AA4NT,iBAAW,oCA5NF;AA6NT,cAAQ,oCA7NC;AA8NT,iBAAW,oCA9NF;AA+NT,cAAQ,oCA/NC;AAgOT,iBAAW,oCAhOF;AAiOT,cAAQ,oCAjOC;AAkOT,iBAAW,oCAlOF;AAmOT,eAAS,qCAnOA;AAoOT,kBAAY,qCApOH;AAqOT,cAAQ,oCArOC;AAsOT,iBAAW,oCAtOF;AAuOT,cAAQ,oCAvOC;AAwOT,iBAAW,oCAxOF;AAyOT,cAAQ,oCAzOC;AA0OT,iBAAW,oCA1OF;AA2OT,iBAAW,uCA3OF;AA4OT,oBAAc,uCA5OL;AA6OT,eAAS,qCA7OA;AA8OT,kBAAY,qCA9OH;AA+OT,cAAQ,oCA/OC;AAgPT,iBAAW,oCAhPF;AAiPT,eAAS,qCAjPA;AAkPT,kBAAY,qCAlPH;AAmPT,eAAS,qCAnPA;AAoPT,oBAAc,0CApPL;AAqPT,uBAAiB,0CArPR;AAsPT,kBAAY,qCAtPH;AAuPT,iBAAW,uCAvPF;AAwPT,oBAAc,uCAxPL;AAyPT,cAAQ,oCAzPC;AA0PT,iBAAW,oCA1PF;AA2PT,cAAQ,oCA3PC;AA4PT,iBAAW,oCA5PF;AA6PT,cAAQ,oCA7PC;AA8PT,mBAAa,yCA9PJ;AA+PT,sBAAgB,yCA/PP;AAgQT,iBAAW,oCAhQF;AAiQT,cAAQ,oCAjQC;AAkQT,iBAAW,oCAlQF;AAmQT,oBAAc,0CAnQL;AAoQT,uBAAiB,0CApQR;AAqQT,cAAQ,oCArQC;AAsQT,iBAAW,oCAtQF;AAuQT,iBAAW,uCAvQF;AAwQT,oBAAc,uCAxQL;AAyQT,iBAAW,uCAzQF;AA0QT,oBAAc,uCA1QL;AA2QT,iBAAW,uCA3QF;AA4QT,oBAAc,uCA5QL;AA6QT,iBAAW,uCA7QF;AA8QT,oBAAc;AA9QL,KAAV;;AAkRA,aAASC,cAAT,CAAwBZ,GAAxB,EAA6B;AAC5B,UAAIU,EAAE,GAAGG,qBAAqB,CAACb,GAAD,CAA9B;AACA,aAAOc,mBAAmB,CAACJ,EAAD,CAA1B;AACA;;AACD,aAASG,qBAAT,CAA+Bb,GAA/B,EAAoC;AACnC,UAAG,CAACc,mBAAmB,CAACC,CAApB,CAAsBJ,GAAtB,EAA2BX,GAA3B,CAAJ,EAAqC;AACpC,YAAII,CAAC,GAAG,IAAIC,KAAJ,CAAU,yBAAyBL,GAAzB,GAA+B,GAAzC,CAAR;AACAI,SAAC,CAACE,IAAF,GAAS,kBAAT;AACA,cAAMF,CAAN;AACA;;AACD,aAAOO,GAAG,CAACX,GAAD,CAAV;AACA;;AACDY,kBAAc,CAACL,IAAf,GAAsB,SAASS,kBAAT,GAA8B;AACnD,aAAOC,MAAM,CAACV,IAAP,CAAYI,GAAZ,CAAP;AACA,KAFD;;AAGAC,kBAAc,CAACV,OAAf,GAAyBW,qBAAzB;AACAL,UAAM,CAACC,OAAP,GAAiBG,cAAjB;AACAA,kBAAc,CAACF,EAAf,GAAoB,wDAApB;;;;;;;;;;;;;;;;ACnSA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAIA,QAAMQ,MAAM,GAAW,EAAvB;;QAMaC,gB;;;;;YAAAA;;;;yBAAAA,gB;AAAgB,O;AAAA,gBAHlB,CAAC,6DAAaC,OAAb,CAAqBF,MAArB,CAAD,CAGkB,EAFjB,4DAEiB;;;;0HAAhBC,gB,EAAgB;AAAA;AAAA,kBAFjB,4DAEiB;AAAA,O;AAFL,K;;;;;sEAEXA,gB,EAAgB;cAJ5B,sDAI4B;eAJnB;AACRE,iBAAO,EAAE,CAAC,6DAAaD,OAAb,CAAqBF,MAArB,CAAD,CADD;AAERT,iBAAO,EAAE,CAAC,4DAAD;AAFD,S;AAImB,Q;;;;;;;;;;;;;;;;;;ACV7B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;ACwBgB;;AAAiE;AAAA;;AAAA;;AAAA;AAAA;;AAAkB;;AAAK;;;;;;AAIxF;;AAAkC;;AAAsB;;;;;;AACxD;;AAAmC;;AAA0B;;;;;;;;;;;;;;;AAsIzD;;AAEI;;AACI;;AACI;;AAAgC;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAAhC;;AACJ;;AACA;;AACI;;AAAgC;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAAhC;;AACJ;;AACA;;AACI;;AAAgC;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAAhC;;AACJ;;AACA;;AACI;;AAAgC;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAAhC;;AACJ;;AACJ;;AACA;;AAA6B;;AAAe;;AAC5C;;AAAI;;AAAa;;AACjB;;AAAI;;AAAe;;AACnB;;AAAI;;AAAe;;AACnB;;AAAI;;AAAgB;;AACpB;;AAAI;;AAAoB;;AACxB;;AAGK;;AAAoB;;AACzB;;AACI;;AACI;;AAGA;;AAA0F;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAA4B;;AAAI;;AAC9H;;AACJ;;AACJ;;;;;;;;AAlBiC;;AAAA;;AACzB;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACyB;;AAAA;;AAGxB;;AAAA;;AAG0C;;AAAA,uGAAAC,EAAA;;AAG/B;;AAAA;;;;;;AAhCxB;;AACI;;AAmCJ;;;;;;AAnCQ;;AAAA;;;;;;AA2IJ;;AACI;;AAAI;;AAAe;;AACnB;;AAAI;;AAAgC;;AACpC;;AAAI;;AAA8B;;AAClC;;AAAI;;AAAa;;AACjB;;AAAI;;AAA4B;;AAChC;;AAAI;;AAAe;;AACnB;;AAAI;;AAAc;;AAClB;;AAAI;;AAAqB;;AACzB;;AAAI;;AAAuB;;AAC3B;;AAAI;;AAAiB;;AACzB;;;;;;;;AAVQ;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;;;;;AAXZ;;AACI;;AAYJ;;;;;;AAZQ;;AAAA;;;;;;;;;;;;;;;;;;;;AAoGA;;AACI;;AAA4D;;AAAa;;AACzE;;AAAI;;AAAW;;AAEf;;AAAqG;;AAAY;;AACjH;;AAAqG;;AAAY;;AACjH;;AAAqG;;AAAY;;AACjH;;AAA+G;;AAAc;;AAC7H;;AAA2H;;AAAiB;;AAC5I;;AAAqG;;AAAY;;AACjH;;AAAiH;;AAAe;;AAChI;;AAA6H;;AAAkB;;AACnJ;;;;;;;;AAXQ;;AAAA;;AAAwD;;AAAA;;AACxD;;AAAA;;AAEA;;AAAA;;AAAiG;;AAAA;;AACjG;;AAAA;;AAAiG;;AAAA;;AACjG;;AAAA;;AAAiG;;AAAA;;AACjG;;AAAA;;AAA2G;;AAAA;;AAC3G;;AAAA;;AAAuH;;AAAA;;AACvH;;AAAA;;AAAiG;;AAAA;;AACjG;;AAAA;;AAA6G;;AAAA;;AAC7G;;AAAA;;AAAyH;;AAAA;;;;;;AAsBjJ;;AACI;;AACJ;;;;;;AADI;;AAAA;;;;;;AAGJ;;AACI;;AACJ;;;;;;AADI;;AAAA;;;;;;;;AAZR;;AACI;;AACI;;AAAc;;AAA0H;;AAAmD;;AAC/L;;AAIA;;AAIA;;AAIA;;AAAwB;;AAAuC;;AAE/D;;AACI;;AACA;;AAAqF;AAAA;;AAAA;;AAAA;AAAA;;AAArF;;AACJ;;AAEJ;;;;;;AApBqD;;AAAA;;AAA2F;;AAAA;;AAK5G;;AAAA;;AAIA;;AAAA;;AAIR;;AAAA;;AAIiE;;AAAA;;;;;;AA4HzE;;AACI;;AACJ;;;;;;;;AADI;;AAAA;;;;;;AAKJ;;AACI;;AACJ;;;;;;AADI;;AAAA;;;;;;AAKJ;;AACI;;AACJ;;;;;;;;AADI;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAzCZ;;AACI;;AACI;;AACI;;AACI;;AAAgC;AAAA;;AAAA;;AAAA;;AAAA,6DAA0C,IAA1C;AAA8C,SAA9C;;AAAhC;;AACJ;;AACA;;AACI;;AAAgC;AAAA;;AAAA;;AAAA;;AAAA,gEAA6C,IAA7C;AAAiD,SAAjD;;AAAhC;;AACJ;;AAMA;;AAA4D;AAAA;;AAAA;;AAAA;;AAAA,sDAAkC,IAAlC;AAAsC,SAAtC;;AAAyC;;AAAE;;AACvG;;AAAuD;AAAA;;AAAA;;AAAA;;AAAA,4CAAwB,IAAxB;AAA4B,SAA5B;;AAA+B;;AAAC;;AAI3F;;AACJ;;AAGA;;AAAmF;;AAAiC;;AAEpH;;AAAmF;;AAA0C;;AAC7H;;AACI;;AACA;;AAGJ;;AACA;;AACI;;AACA;;AAGJ;;AACA;;AACI;;AACA;;AAGJ;;AACA;;AAAmF;;AAA0C;;AAE7H;;AAAmF;;AAAiC;;AAGpH;;AACI;;AACI;;AACI;;AAAgC;AAAA;;AAAA;;AAAA;;AAAA,6DAA0C,IAA1C;AAA8C,SAA9C;;AAAhC;;AACJ;;AACA;;AACI;;AAAgC;AAAA;;AAAA;;AAAA;;AAAA,gEAA6C,IAA7C;AAAiD,SAAjD;;AAAhC;;AACJ;;AAMA;;AAA4D;AAAA;;AAAA;;AAAA;;AAAA,sDAAkC,IAAlC;AAAsC,SAAtC;;AAAyC;;AAAE;;AACvG;;AAAuD;AAAA;;AAAA;;AAAA;;AAAA,4CAAwB,IAAxB;AAA4B,SAA5B;;AAA+B;;AAAC;;AAC3F;;AACJ;;AACJ;;;;;;;;AAjEQ;;AAAA;;AAsBA;;AAAA;;AAA+E;;AAAA;;AAE/E;;AAAA;;AAA+E;;AAAA;;AAC/E;;AAAA;;AACA;;AAAA;;AACiC;;AAAA;;AAIjC;;AAAA;;AACA;;AAAA;;AACgD;;AAAA;;AAIhD;;AAAA;;AACA;;AAAA;;AACiC;;AAAA;;AAIjC;;AAAA;;AAA+E;;AAAA;;AAE/E;;AAAA;;AAA+E;;AAAA;;AAG/E;;AAAA;;;ADpkBxB;;;;;;;;;;;;;;;;;;;;;;;;QA4BaY,Y;AAiEX;;;;;;;;;;;;;;AAeA,4BACUC,KADV,EAEUC,UAFV,EAGUC,UAHV,EAIUC,gBAJV,EAKUC,YALV,EAMUC,YANV,EAOUC,OAPV,EAQUC;AACR;AATF,QASsC;AAAA;;AAAA;;AAR5B,aAAAP,KAAA,GAAAA,KAAA;AACA,aAAAC,UAAA,GAAAA,UAAA;AACA,aAAAC,UAAA,GAAAA,UAAA;AACA,aAAAC,gBAAA,GAAAA,gBAAA;AACA,aAAAC,YAAA,GAAAA,YAAA;AACA,aAAAC,YAAA,GAAAA,YAAA;AACA,aAAAC,OAAA,GAAAA,OAAA;AACA,aAAAC,eAAA,GAAAA,eAAA;AAvFV,aAAAC,KAAA,GAAQ,QAAR;AACA,aAAAC,YAAA,GAAe,IAAf;AACA,aAAAC,OAAA,GAAU,IAAV;AACA,aAAAC,SAAA,GAAY,IAAZ;AACA,aAAAC,iBAAA,GAAoB,IAApB;AACA,aAAAC,SAAA,GAAwB,EAAxB;AACA,aAAAC,MAAA,GAAkB,EAAlB;AACA,aAAAC,cAAA,GAAiB,IAAjB;AACA,aAAAC,WAAA,GAAc,IAAd;AACA,aAAAC,qBAAA,GAAwB,IAAxB;AACA,aAAAC,uBAAA,GAA+B,EAA/B;AACA,aAAAC,oBAAA,GAA4B,EAA5B;AACA,aAAAC,YAAA,GAAe,CAAf;AACA,aAAAC,iBAAA,GAAoB,EAApB;AACA,aAAAC,oBAAA,GAAuB,EAAvB;AACA,aAAAC,SAAA,GAAY,YAAZ;AACA,aAAAC,SAAA,GAAY,KAAZ;AACA,aAAAC,SAAA,GAAY,IAAZ;AACA,aAAAC,MAAA,GAAS,EAAT;AACA,aAAAC,QAAA,GAAW,CAAX;AACA,aAAAC,QAAA,GAAW,CAAX;AACA,aAAAC,OAAA,GAAU,CAAV;AACA,aAAAC,cAAA,GAAiB,UAAjB;AACA,aAAAC,YAAA,GAAe,CAAf;AACA,aAAAC,cAAA,GAAiB,IAAjB;AACA,aAAAC,eAAA,GAAkB,KAAlB;AACA,aAAAC,SAAA,GAAY,OAAZ;AACA,aAAAC,OAAA,GAAU,IAAV;AACA,aAAAC,QAAA,GAAW,CAAX;AACA,aAAAC,OAAA,GAAU,CAAV;AACA,aAAAC,iBAAA,GAAoB,KAApB;AACA,aAAAC,kBAAA,GAAqB,QAArB;AACA,aAAAC,eAAA,GAAkB,KAAlB,CAwDsC,CAxDb;;AACzB,aAAAC,cAAA,GAAiB,KAAjB,CAuDsC,CAvDd;;AACxB,aAAAC,iBAAA,GAAoB,EAApB;AACA,aAAAC,UAAA,GAAa,EAAb;AACA,aAAAC,eAAA,GAAkB,QAAlB;AACA,aAAAC,SAAA,GAAY,WAAZ;AAIA,aAAAC,IAAA,GAAO,CAAP;AACA,aAAAC,QAAA,GAAW,CAAX;AACA,aAAAC,eAAA,GAAkB,yFAAlB;AAEA,aAAAC,WAAA,GAAc,CAAd;AACA,aAAAC,oBAAA,GAAuB,CAAvB;AACA,aAAAC,WAAA,GAAc,EAAd;AACA,aAAAC,WAAA,GAAc,EAAd;AACA,aAAAC,gBAAA,GAAmB,CAAnB;AACA,aAAAC,QAAA,GAAW,EAAX;AACA,aAAAC,SAAA,GAAY,CAAZ;AACA,aAAAC,WAAA,GAAc,CAAd;AACA,aAAAC,WAAA,GAAc,CAAd;AACA,aAAAC,gBAAA,GAAmB,CAAnB;AACA,aAAAC,WAAA,GAAc,GAAd;AAEA,aAAAC,iBAAA,GAAoB,IAApB;AACA,aAAAC,YAAA,GAAe,mIAAf;AACA,aAAAC,mBAAA,GAAsB,svbAAtB;AACA,aAAAC,iBAAA,GAAoB,YAApB;AACA,aAAAC,eAAA,GAAkB,YAAlB;AACA,aAAAC,mBAAA,GAAsB,aAAtB;AA2BE,aAAKjE,KAAL,CAAWkE,WAAX,CAAuBC,SAAvB,CAAiC,UAAAC,MAAM,EAAI;AACzCC,iBAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBF,MAAtB;;AACA,cAAIA,MAAM,IAAIA,MAAM,CAAC3D,YAArB,EAAmC;AACjC,iBAAI,CAACA,YAAL,GAAoB2D,MAAM,CAAC3D,YAA3B,CADiC,CAEjC;;AAED;;;AAIC;AAEA;AAEA;AACD;;AACD,cAAI2D,MAAM,IAAIA,MAAM,CAAC1D,OAArB,EAA8B;AAC5B,iBAAI,CAACA,OAAL,GAAe0D,MAAM,CAAC1D,OAAtB;AACD;AACF,SAnBD;AAqBA,aAAKT,UAAL,CAAgBsE,mBAAhB,CAAoCJ,SAApC,CAA8C,UAAAK,GAAG,EAAI;AACnDH,iBAAO,CAACC,GAAR,CAAY,0BAAZ,EAAwCE,GAAxC;AACA,eAAI,CAAC5D,iBAAL,GAAyB4D,GAAzB;AACD,SAHD;AAKA,aAAKrE,gBAAL,CAAsBsE,eAAtB,CAAsCN,SAAtC,CAAgD,UAAAK,GAAG,EAAI;AACrDH,iBAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCE,GAApC;;AACA,cAAIA,GAAG,KAAK,WAAZ,EAAyB;AACvB,iBAAI,CAACE,sBAAL;AACD;AACF,SALD;AAOD;;;;mCAEU;AAAA;;AAET;AACA,eAAKxE,UAAL,CAAgByE,MAAhB,CAAuB,SAAvB,EAAkC,KAAlC;AACA,eAAKzE,UAAL,CAAgByE,MAAhB,CAAuB,WAAvB,EAAoC,KAApC;;AAEA,cAAIC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,QAArB,CAA8B,WAA9B,CAAJ,EAAgD;AAC9C,sFAAaC,YAAb,GAA4B,KAA5B;AACD;;AACDX,iBAAO,CAACC,GAAR,CAAYM,MAAM,CAACC,QAAP,CAAgBC,IAA5B,EAAkC,0EAAaE,YAA/C;AAEA,cAAIC,gBAAgB,GAAGC,WAAW,CAAC,YAAM;AACvC,kBAAI,CAACC,gBAAL;AACD,WAFiC,EAE/B,IAF+B,CAAlC;AAIA,cAAIC,oBAAoB,GAAGF,WAAW,CAAC,YAAM,CAC3C;AACD,WAFqC,EAEnC,IAFmC,CAAtC;AAGA,eAAK9E,YAAL,CAAkBiF,iBAAlB,CAAoClB,SAApC,CAA8C,UAAAK,GAAG,EAAI;AACnD;AACA,kBAAI,CAACvB,WAAL,GAAmBuB,GAAG,CAAC,CAAD,CAAtB;AACA,kBAAI,CAACtB,oBAAL,GAA4BsB,GAAG,CAAC,CAAD,CAA/B;AACD,WAJD;AAMA,eAAKpE,YAAL,CAAkBkF,iBAAlB,CAAoCnB,SAApC,CAA8C,UAAAK,GAAG,EAAI;AACnDH,mBAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BE,GAA5B;AACA,gBAAIe,MAAM,GAAGf,GAAG,CAAC,CAAD,CAAhB;AACA,gBAAIgB,UAAU,GAAGhB,GAAG,CAAC,CAAD,CAApB;;AACA,kBAAI,CAACiB,gBAAL,CAAsBF,MAAtB,EAA8BC,UAA9B;AACD,WALD;AAOD;;;0CAEiB;AAChBE,oBAAU,CAAC,YAAM,CAEhB,CAFS,CAAV;AAGA;AAED;;;0CAEiB;AAChB,eAAKnF,eAAL,CAAqBoF,YAArB,CAAkC,KAAK/B,iBAAvC,EAA0D,KAAKC,YAA/D,EAA6E,KAAKC,mBAAlF,EAAuG,KAAKC,iBAA5G,EAA+H,KAAKC,eAApI,EAAqJ,KAAKC,mBAA1J;AACD;;;2CAEkB;AACjB,eAAK1D,eAAL,CAAqBqF,WAArB;AACD;;;yCAEgBL,M,EAAQC,U,EAAY;AAEnC,eAAKtD,SAAL,GAAiBqD,MAAjB;AAEA,cAAIM,MAAM,GAAG,IAAIC,IAAJ,CAASN,UAAT,CAAb;AACA,eAAKrD,OAAL,GAAe0D,MAAM,CAACE,WAAP,EAAf;AACA,eAAK3D,QAAL,GAAgByD,MAAM,CAACG,QAAP,KAAoB,CAApC;AACA,eAAK3D,OAAL,GAAewD,MAAM,CAACI,OAAP,EAAf;;AAEA,cAAI,KAAK/D,SAAL,KAAmB,OAAvB,EAAgC;AAC9B,iBAAKQ,iBAAL,GAAyB,EAAzB;AACA,gBAAIwD,IAAI,GAAG,KAAKC,MAAL,CAAY,SAAZ,CAAX;AACA,gBAAIC,UAAU,GAAIC,IAAI,CAACC,KAAL,CAAWJ,IAAI,GAAG,KAAKxD,iBAAvB,IAA4C,KAAKA,iBAAnE;AACA,iBAAKF,eAAL,GAAuB4D,UAAU,GAAG,GAApC;AACA,iBAAK3D,cAAL,GAAsB2D,UAAU,GAAG,GAAnC;AACD,WAND,MAMO,IAAI,KAAKlE,SAAL,KAAmB,WAAvB,EAAoC;AACzC,iBAAKQ,iBAAL,GAAyB,GAAzB;;AACA,gBAAIwD,KAAI,GAAG,KAAKC,MAAL,CAAY,WAAZ,CAAX;;AACA,gBAAIC,WAAU,GAAIC,IAAI,CAACC,KAAL,CAAWJ,KAAI,GAAG,KAAKxD,iBAAvB,IAA4C,KAAKA,iBAAnE;;AACA,iBAAKF,eAAL,GAAuB4D,WAAU,GAAG,IAApC;AACA,iBAAK3D,cAAL,GAAsB2D,WAAU,GAAG,IAAnC;AACD,WANM,MAMA,IAAI,KAAKlE,SAAL,KAAmB,QAAvB,EAAiC;AACtC,iBAAKQ,iBAAL,GAAyB,IAAzB;;AACA,gBAAIwD,MAAI,GAAG,KAAKC,MAAL,CAAY,YAAZ,CAAX;;AACA,gBAAIC,YAAU,GAAIC,IAAI,CAACC,KAAL,CAAWJ,MAAI,GAAG,KAAKxD,iBAAvB,IAA4C,KAAKA,iBAAnE;;AACA,iBAAKF,eAAL,GAAuB4D,YAAU,GAAG,CAApC;AACA,iBAAK3D,cAAL,GAAsB2D,YAAU,GAAG,CAAnC;AACD;;AAED,eAAKG,aAAL;AACD;;;yCAEgB;AACf,iBAAO,KAAKtD,WAAZ;AACD;;;8BAEKuD,M,EAAQC,M,EAAQC,I,EAAM;AAC1B,cAAIC,WAAW,GAAG,IAAIb,IAAJ,CAAS,KAAK3D,OAAd,EAAuB,KAAKC,QAAL,GAAgB,CAAvC,EAA0C,KAAKC,OAA/C,CAAlB;;AACA,cAAI,KAAKH,SAAL,KAAmB,QAAvB,EAAiC;AAC/ByE,uBAAW,CAACC,QAAZ,CAAqB,EAArB,EAAyB,EAAzB,EAA6B,CAA7B;AACD,WAFD,MAEO;AACLD,uBAAW,CAACC,QAAZ,CAAqB,EAArB,EAAyB,EAAzB,EAA6B,CAA7B;AACD;;AAED,cAAIC,UAAU,GAAG,SAAjB;;AACA,cAAI,KAAK3E,SAAL,KAAmB,WAAvB,EAAoC;AAClC2E,sBAAU,GAAG,WAAb;AACD,WAFD,MAEO,IAAI,KAAK3E,SAAL,KAAmB,QAAvB,EAAiC;AACtC2E,sBAAU,GAAG,YAAb;AACD;;AACD,cAAIX,IAAI,GAAG,KAAKC,MAAL,CAAYU,UAAZ,CAAX;AAEA,cAAIC,SAAS,GAAG,KAAKX,MAAL,CAAYK,MAAM,GAAGE,IAArB,CAAhB;AAEA,cAAIK,MAAM,GAAG,IAAb;;AACA,cAAIL,IAAI,KAAK,IAAb,EAAmB;AACjBK,kBAAM,GAAG,qEAAsBC,EAA/B;AACD;;AACD,cAAIN,IAAI,KAAK,IAAb,EAAmB;AACjBK,kBAAM,GAAG,qEAAsBE,EAA/B;AACD;;AAED,cAAIC,EAAE,GAAG,KAAKjH,UAAL,CAAgBkH,WAAhB,CAA4B,KAAKjF,SAAjC,EAA4CgE,IAA5C,EAAkDO,MAAlD,EAA0D,0EAAaW,aAAvE,EAAsFT,WAAtF,EAAmGI,MAAnG,EAA2GD,SAA3G,CAAT;AAEA,iBAAOI,EAAP;AACD;;;iCAEQV,M,EAAQC,M,EAAQC,I,EAAM;AAE7B,cAAIW,GAAG,GAAG,KAAKlB,MAAL,CAAYK,MAAM,GAAGE,IAArB,CAAV;AACA,cAAIb,MAAM,GAAG,IAAIC,IAAJ,CAAS,KAAK3D,OAAd,EAAuB,KAAKC,QAAL,GAAgB,CAAvC,EAA0C,KAAKC,OAA/C,CAAb;AACA,cAAIiF,KAAK,GAAG,KAAKrH,UAAL,CAAgBsH,QAAhB,CAAyB,KAAKrF,SAA9B,EAAyCuE,MAAzC,EAAiDC,IAAjD,EAAuDb,MAAvD,EAA+DwB,GAA/D,CAAZ;AACA,iBAAOC,KAAP;AACD;;;yCAEgB;AACf,iBAAO,0EAAaE,gBAApB;AACD;;;qCAEY;AACX,cAAI,KAAKxF,cAAT,EAAyB;AACvB,iBAAKC,eAAL,GAAuB,KAAvB;AACA,iBAAKM,kBAAL,GAA0B,OAA1B;AACD,WAHD,MAGO;AACL,iBAAKN,eAAL,GAAuB,IAAvB;AACA,iBAAKM,kBAAL,GAA0B,QAA1B;AACD;AACF;;;sCAEa;AACZ,cAAI,KAAKN,eAAT,EAA0B;AACxB,iBAAKD,cAAL,GAAsB,KAAtB;AACA,iBAAKO,kBAAL,GAA0B,QAA1B;AACD,WAHD,MAGO;AACL,iBAAKP,cAAL,GAAsB,IAAtB;AACA,iBAAKO,kBAAL,GAA0B,OAA1B;AACD;AACF;;;gCAEO;AACN,eAAKkF,IAAL;AACD;;;+BAEM;AAAA;;AACL,eAAKxH,UAAL,CAAgBwH,IAAhB,GAAuBtD,SAAvB,CAAiC,UAACK,GAAD,EAAc;AAC7CH,mBAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBE,GAAxB;;AACA,gBAAIA,GAAJ,EAAS;AACP,oBAAI,CAACvE,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyClD,GAAzC;;AACA,kBAAIA,GAAG,CAACmD,kBAAR,EAA4B;AAC1B,sBAAI,CAAChH,SAAL,GAAiB6D,GAAG,CAACmD,kBAArB;;AACA,sBAAI,CAACC,mBAAL;AACD;AACF;AACF,WATD,EAUA,UAAAC,KAAK,EAAI;AACPxD,mBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BuD,KAA9B;;AACA,kBAAI,CAAC5H,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyCG,KAAK,CAACA,KAAN,CAAYC,OAAZ,GAAuB,IAAvB,GAA8BD,KAAK,CAACC,OAA7E;AACD,WAbD;AAcD;;;8CAEqB;AACpB,cAAI,KAAKnH,SAAT,EAAoB;AAClB,gBAAIoH,QAAQ,GAAG,KAAK9H,UAAL,CAAgB+H,WAAhB,CAA4B,KAAKrH,SAAjC,EAA4C,0EAAasH,UAAzD,CAAf;AACA5D,mBAAO,CAACC,GAAR,CAAY,UAAZ,EAAwByD,QAAxB,EAFkB,CAGlB;;AACA,gBAAIG,GAAG,GAAGtD,MAAM,CAACuD,IAAP,CAAYJ;AAAQ;AAApB,aAAV;AACD;AACF;;;mCAEU;AAAA;;AACT1D,iBAAO,CAACC,GAAR,CAAY,mBAAZ;AACA,eAAKrE,UAAL,CAAgBmI,QAAhB,CAAyB,KAAK3H,YAA9B,EAA4C0D,SAA5C,CAAsD,UAACK,GAAD,EAAc;AAClEH,mBAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BE,GAA5B;;AACA,gBAAIA,GAAJ,EAAS;AACP,oBAAI,CAAC6D,YAAL,GAAoB7D,GAAG,CAAC8D,UAAJ,CAAe,CAAf,EAAkBC,YAAlB,CAA+BC,cAA/B,EAApB;AACA,oBAAI,CAACC,gBAAL,GAAwBjE,GAAG,CAAC8D,UAAJ,CAAe,CAAf,EAAkBC,YAAlB,CAA+BC,cAA/B,EAAxB;AACA,oBAAI,CAACE,eAAL,GAAuBlE,GAAG,CAAC8D,UAAJ,CAAe,CAAf,EAAkBC,YAAlB,CAA+BC,cAA/B,EAAvB;AACD;AACF,WAPD,EAQA,UAAAX,KAAK,EAAI;AACPxD,mBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCuD,KAAtC;;AACA,kBAAI,CAAC5H,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyCG,KAAK,CAACA,KAAN,CAAYC,OAAZ,GAAuB,IAAvB,GAA8BD,KAAK,CAACC,OAA7E;AACD,WAXD;AAYD;;;uCAEc;AAAA;;AACbzD,iBAAO,CAACC,GAAR,CAAY,uBAAZ;AACA,eAAKrE,UAAL,CAAgB0I,YAAhB,CAA6B,KAAKlI,YAAlC,EAAgD0D,SAAhD,CAA0D,UAACK,GAAD,EAAc;AACtEH,mBAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCE,GAAhC;;AACA,gBAAIA,GAAJ,EAAS;AACP,oBAAI,CAACtD,uBAAL,GAA+B,IAAI4E,IAAJ,GAAW8C,kBAAX,EAA/B;;AACA,oBAAI,CAAC3I,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyClD,GAAzC;;AACA,oBAAI,CAACqE,YAAL,CAAkBrE,GAAlB;AACD;AACF,WAPD,EAQA,UAAAqD,KAAK,EAAI;AACPxD,mBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCuD,KAAtC;;AACA,kBAAI,CAAC5H,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyCG,KAAK,CAACA,KAAN,CAAYC,OAAZ,GAAuB,IAAvB,GAA8BD,KAAK,CAACC,OAA7E;AACD,WAXD;AAYD;;;4CAEmBgB,G,EAAe;AACjCA,aAAG,CAACC,aAAJ,GAAoB,CAACD,GAAG,CAACC,aAAzB;AACD;;;4CACmBD,G,EAAe;AACjCA,aAAG,CAACE,aAAJ,GAAoB,CAACF,GAAG,CAACE,aAAzB;AACD;;;4CACmBF,G,EAAe;AACjCA,aAAG,CAACG,aAAJ,GAAoB,CAACH,GAAG,CAACG,aAAzB;AACD;;;4CACmBH,G,EAAe;AACjCA,aAAG,CAACI,aAAJ,GAAoB,CAACJ,GAAG,CAACI,aAAzB;AACD;;;2CAEkBC,G,EAAa;AAC9B,cAAIC,GAAG,GAAG,CAAV;;AACA,cAAI,KAAKvI,SAAT,EAAoB;AAClB,iBAAKA,SAAL,CAAewI,OAAf,CAAuB,UAAAP,GAAG,EAAI;AAC5B,kBAAIK,GAAG,KAAK,CAAR,IAAaL,GAAG,CAACC,aAArB,EAAoC;AAClCK,mBAAG,IAAIN,GAAG,CAACQ,GAAX;AACD;;AACD,kBAAIH,GAAG,KAAK,CAAR,IAAaL,GAAG,CAACE,aAArB,EAAoC;AAClCI,mBAAG,IAAIN,GAAG,CAACQ,GAAX;AACD;;AACD,kBAAIH,GAAG,KAAK,CAAR,IAAaL,GAAG,CAACG,aAArB,EAAoC;AAClCG,mBAAG,IAAIN,GAAG,CAACQ,GAAX;AACD;;AACD,kBAAIH,GAAG,KAAK,CAAR,IAAaL,GAAG,CAACI,aAArB,EAAoC;AAClCE,mBAAG,IAAIN,GAAG,CAACQ,GAAX;AACD;AACF,aAbD;AAcAF,eAAG,GAAG/C,IAAI,CAACC,KAAL,CAAW,CAAC8C,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA1C,CAfkB,CAe6B;;AAC/C,iBAAKhI,YAAL,GAAoBgI,GAApB;AACD;;AACD,iBAAOA,GAAP;AACD;;;qCAEY5E,G,EAAK;AAAA;;AAChB,eAAK3D,SAAL,GAAiB,EAAjB;;AACA,cAAI,0EAAa0I,QAAb,KAA0B,OAA9B,EAAuC;AACrC,gBAAI/E,GAAG,CAACgF,YAAJ,YAA4BC,KAAhC,EAAuC;AACrCjF,iBAAG,CAACgF,YAAJ,CAAiBH,OAAjB,CAAyB,UAAAP,GAAG,EAAI;AAC9B,oBAAIY,CAAC,GAAG,IAAI,uDAAJ,EAAR;AACAA,iBAAC,CAACvK,EAAF,GAAO2J,GAAG,CAAC3J,EAAX;AACAuK,iBAAC,CAACC,KAAF,GAAUb,GAAG,CAACtC,MAAd;AACAkD,iBAAC,CAACE,MAAF,GAAWd,GAAG,CAACc,MAAf;AACAF,iBAAC,CAACG,MAAF,GAAWf,GAAG,CAACe,MAAf;AACAH,iBAAC,CAACI,OAAF,GAAYhB,GAAG,CAACgB,OAAhB;AACAJ,iBAAC,CAAChD,IAAF,GAASoC,GAAG,CAACiB,WAAb;AACAL,iBAAC,CAACM,cAAF,GAAmBlB,GAAG,CAACkB,cAAvB;AACAN,iBAAC,CAACJ,GAAF,GAAQR,GAAG,CAACmB,EAAZ;;AACA,sBAAI,CAACpJ,SAAL,CAAeqJ,IAAf,CAAoBR,CAApB;AACD,eAXD;AAYA,mBAAKhF,sBAAL;AACD;AACF;AACF;;;iDAEwB;AACvB,cAAIyF,GAAG,GAAG,EAAV;AACA,eAAKtJ,SAAL,CAAewI,OAAf,CAAuB,UAAAP,GAAG,EAAI;AAC5B,gBAAItC,MAAM,GAAGsC,GAAG,CAACa,KAAjB;AACAnD,kBAAM,GAAGA,MAAM,CAAC4D,OAAP,CAAe,MAAf,EAAuB,EAAvB,CAAT;AACA,gBAAI7E,MAAM,GAAG,EAAb;;AACA,gBAAIiB,MAAM,CAAC6D,UAAP,CAAkB,OAAlB,CAAJ,EAAgC;AAC9B9E,oBAAM,GAAG,OAAT;AACAiB,oBAAM,GAAGA,MAAM,CAAC4D,OAAP,CAAe,OAAf,EAAwB,EAAxB,CAAT;AACD;;AACD,gBAAI5D,MAAM,CAAC6D,UAAP,CAAkB,WAAlB,CAAJ,EAAoC;AAClC9E,oBAAM,GAAG,WAAT;AACAiB,oBAAM,GAAGA,MAAM,CAAC4D,OAAP,CAAe,WAAf,EAA4B,EAA5B,CAAT;AACD;;AACD,gBAAI5D,MAAM,CAAC6D,UAAP,CAAkB,QAAlB,CAAJ,EAAiC;AAC/B9E,oBAAM,GAAG,QAAT;AACAiB,oBAAM,GAAGA,MAAM,CAAC4D,OAAP,CAAe,QAAf,EAAyB,EAAzB,CAAT;AACD;;AACD,gBAAI1D,IAAI,GAAG,EAAX;;AACA,gBAAIF,MAAM,CAACzB,QAAP,CAAgB,IAAhB,CAAJ,EAA2B;AACzB2B,kBAAI,GAAG,IAAP;AACD;;AACD,gBAAIF,MAAM,CAACzB,QAAP,CAAgB,IAAhB,CAAJ,EAA2B;AACzB2B,kBAAI,GAAG,IAAP;AACD;;AACDrC,mBAAO,CAACC,GAAR,CAAY,oCAAoCkC,MAAhD;AACAA,kBAAM,GAAGA,MAAM,CAAC8D,KAAP,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAAT,CAxB4B,CAwBE;;AAC9B,gBAAI7D,MAAM,GAAGD,MAAM,CAAC+D,SAAP,CAAiB,CAAjB,CAAb;AACA,gBAAI1E,MAAM,GAAGW,MAAM,CAAC+D,SAAP,CAAiB,CAAjB,EAAoB,CAApB,CAAb,CA1B4B,CA0BS;AACrC;;AACA,gBAAI/E,UAAU,GAAG,EAAjB;;AACA,gBAAIgF,KAAK,CAAC3E,MAAD,CAAT,EAA0B;AAAE;AAE1B,kBAAI2E,KAAK,CAACC,QAAQ,CAAC5E,MAAM,CAAC,CAAD,CAAP,CAAT,CAAT,EAAgC;AAAE;AAChC,oBAAIN,MAAM,KAAK,OAAX,IAAsBA,MAAM,KAAK,WAArC,EAAkD;AAChDC,4BAAU,GAAG,0EAAakF,kBAAb,CAAgC7E,MAAhC,EAAwC8E,YAAxC,EAAb;AACD;;AACD,oBAAIpF,MAAM,KAAK,QAAf,EAAyB;AACvBC,4BAAU,GAAG,0EAAaoF,wBAAb,CAAsC/E,MAAtC,EAA8C8E,YAA9C,EAAb;AACD;AACF,eAPD,MAOO;AAAE;AACP,oBAAIE,IAAI,GAAGC,MAAM,CAACjF,MAAM,CAAC0E,SAAP,CAAiB,CAAjB,EAAoB,CAApB,CAAD,CAAN,GAAiC,IAA5C;AACA,oBAAIQ,KAAK,GAAG,IAAZ;;AACA,oBAAIlF,MAAM,CAAC,CAAD,CAAN,KAAc,GAAlB,EAAuB;AACrBkF,uBAAK,GAAG,CAAR;AACD,iBAFD,MAEO,IAAIlF,MAAM,CAAC,CAAD,CAAN,KAAc,GAAlB,EAAuB;AAC5BkF,uBAAK,GAAG,EAAR;AACD,iBAFM,MAEA,IAAIlF,MAAM,CAAC,CAAD,CAAN,KAAc,GAAlB,EAAuB;AAC5BkF,uBAAK,GAAG,EAAR;AACD;;AACD,oBAAIC,IAAI,GAAGF,MAAM,CAACjF,MAAM,CAAC0E,SAAP,CAAiB,CAAjB,EAAoB,CAApB,CAAD,CAAjB;AACAlG,uBAAO,CAACC,GAAR,CAAY,sCAAZ,EAAoDuG,IAApD,EAA0DE,KAA1D,EAAiEC,IAAjE;AACAxF,0BAAU,GAAG,IAAIM,IAAJ,CAAS+E,IAAT,EAAeE,KAAf,EAAsBC,IAAtB,EAA4BL,YAA5B,EAAb;AACD,eAtBuB,CAuBxB;;AACD,aAxBD,MAwBO;AAAE;AACP,kBAAIE,KAAI,GAAGC,MAAM,CAACjF,MAAM,CAAC0E,SAAP,CAAiB,CAAjB,EAAoB,CAApB,CAAD,CAAN,GAAiC,IAA5C;;AACA,kBAAIQ,MAAK,GAAGD,MAAM,CAACjF,MAAM,CAAC0E,SAAP,CAAiB,CAAjB,EAAoB,CAApB,CAAD,CAAN,GAAiC,CAA7C;;AACA,kBAAIS,KAAI,GAAGF,MAAM,CAACjF,MAAM,CAAC0E,SAAP,CAAiB,CAAjB,EAAoB,CAApB,CAAD,CAAjB;;AACAlG,qBAAO,CAACC,GAAR,CAAY,0BAAZ,EAAwCuG,KAAxC,EAA8CE,MAA9C,EAAqDC,KAArD;AACAxF,wBAAU,GAAG,IAAIM,IAAJ,CAAS+E,KAAT,EAAeE,MAAf,EAAsBC,KAAtB,EAA4BL,YAA5B,EAAb;AACD;;AAED,gBAAIM,EAAE,GAAG,IAAI,yDAAJ,EAAT;AACAA,cAAE,CAACpF,MAAH,GAAYL,UAAZ;AACAyF,cAAE,CAAC1F,MAAH,GAAYA,MAAZ;AACA0F,cAAE,CAACxE,MAAH,GAAYqE,MAAM,CAACrE,MAAD,CAAlB;AACAwE,cAAE,CAACvE,IAAH,GAAUA,IAAV;AACAyD,eAAG,CAACD,IAAJ,CAASe,EAAT;AACA;;;;;;;AAOD,WA1ED;AA2EA5G,iBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8B6F,GAA9B;AACA,eAAKlK,UAAL,CAAgBiL,iBAAhB,CAAkCf,GAAlC;AAGA;;;;;;;;;;;;;;;;;;;;;AAqBA;AACD;;;2CAEkB;AACjB,cAAI,0EAAagB,iBAAb,CAA+BC,IAAnC,EAAyC;AACvC,mBAAO,+BAAP;AACD;;AACD,iBAAO,oCAAP;AACD;;;4CAEmB;AAClB,oFAAaC,UAAb,GAA0B,KAAKxI,SAA/B;AACA,eAAK5C,UAAL,CAAgBqL,kBAAhB,CAAmC,KAAKtI,eAAxC;AACD;;;4CAEmB;AAClB,iBAAO,KAAK/C,UAAL,CAAgBsL,iBAAhB,EAAP;AACD;;;oCAEW;AAAA;;AACVlH,iBAAO,CAACC,GAAR,CAAY,oBAAZ;AACA,eAAKrE,UAAL,CAAgBuL,SAAhB,CAA0B,KAAK/K,YAA/B,EAA6C0D,SAA7C,CAAuD,UAACK,GAAD,EAAc;AACnEH,mBAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BE,GAA7B;;AACA,gBAAIA,GAAJ,EAAS;AACP,oBAAI,CAACrD,oBAAL,GAA4B,IAAI2E,IAAJ,GAAW8C,kBAAX,EAA5B;;AACA,oBAAI,CAAC3I,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyClD,GAAzC;;AACA,oBAAI,CAACiH,SAAL,CAAejH,GAAf;AACD;AACF,WAPD,EAQA,UAAAqD,KAAK,EAAI;AACPxD,mBAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCuD,KAAnC;;AACA,kBAAI,CAAC5H,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyCG,KAAK,CAACA,KAAN,CAAYC,OAAZ,GAAuB,IAAvB,GAA8BD,KAAK,CAACC,OAA7E;AACD,WAXD;AAYD;;;kCAEStD,G,EAAK;AAAA;;AACb,eAAK1D,MAAL,GAAc,EAAd;;AACA,cAAI,0EAAayI,QAAb,KAA0B,OAA9B,EAAuC;AACrC,gBAAI/E,GAAG,CAACkH,SAAJ,YAAyBjC,KAA7B,EAAoC;AAClCjF,iBAAG,CAACkH,SAAJ,CAAcrC,OAAd,CAAsB,UAAAsC,KAAK,EAAI;AAC7B,oBAAInM,CAAC,GAAG,IAAI,oDAAJ,EAAR;AACAA,iBAAC,CAACL,EAAF,GAAOwM,KAAK,CAACxM,EAAb;AACAK,iBAAC,CAACmK,KAAF,GAAUgC,KAAK,CAACnF,MAAhB;AACAhH,iBAAC,CAACoM,GAAF,GAAQD,KAAK,CAACC,GAAd;AACApM,iBAAC,CAACqM,MAAF,GAAWF,KAAK,CAACE,MAAjB;AACArM,iBAAC,CAACsI,OAAF,GAAY6D,KAAK,CAAC7D,OAAlB;AACAtI,iBAAC,CAACkH,IAAF,GAASiF,KAAK,CAACjF,IAAf;AACAlH,iBAAC,CAACsM,KAAF,GAAUH,KAAK,CAACI,UAAhB;AACAvM,iBAAC,CAACwM,IAAF,GAASL,KAAK,CAACM,SAAf;AACAzM,iBAAC,CAAC0M,WAAF,GAAgBP,KAAK,CAACO,WAAtB;AACA1M,iBAAC,CAAC2M,IAAF,GAASR,KAAK,CAACQ,IAAf;AACA3M,iBAAC,CAAC4M,aAAF,GAAkBT,KAAK,CAACS,aAAxB;;AACA,sBAAI,CAACtL,MAAL,CAAYoJ,IAAZ,CAAiB1K,CAAjB;AACD,eAdD;AAeD;AACF;AACF;;;iCAEQ;AACP,iBAAO,GAAP;AACD;;;uCAEcqM,M,EAAgB;AAC7B,cAAIA,MAAM,KAAK,CAAf,EAAkB;AAChB,mBAAO,WAAP;AACD,WAFD,MAEO,IAAIA,MAAM,KAAK,CAAf,EAAkB;AACvB,mBAAO,QAAP;AACD,WAFM,MAEA,IAAIA,MAAM,KAAK,CAAf,EAAkB;AACvB,mBAAO,SAAP;AACD,WAFM,MAEA,IAAIA,MAAM,KAAK,CAAf,EAAkB;AACvB,mBAAO,SAAP;AACD,WAFM,MAEA,IAAIA,MAAM,KAAK,CAAf,EAAkB;AACvB,mBAAO,UAAP;AACD,WAFM,MAEA,IAAIA,MAAM,KAAK,CAAf,EAAkB;AACvB,mBAAO,SAAP;AACD;AACF;;;qCAEYnF,I,EAAc;AACzB,cAAIA,IAAI,KAAK,CAAb,EAAgB;AACd,mBAAO,OAAP;AACD,WAFD,MAEO,IAAIA,IAAI,KAAK,CAAb,EAAgB;AACrB,mBAAO,QAAP;AACD,WAFM,MAEA,IAAIA,IAAI,KAAK,CAAb,EAAgB;AACrB,mBAAO,MAAP;AACD,WAFM,MAEA,IAAIA,IAAI,KAAK,CAAb,EAAgB;AACrB,mBAAO,IAAP;AACD;AACF;;;iCAEQyF,I,EAAc;AAAA;;AACrB,cAAI3F,MAAM,GAAG,SAAS,KAAKjF,SAAd,GAA0B,KAAKC,SAA/B,GAA2C,KAAKC,SAA7D;AACA,eAAKxB,UAAL,CAAgBoM,UAAhB,CAA2B,KAAK5L,YAAhC,EAA8C+F,MAA9C,EAAsD,KAAK9E,MAA3D,EAAmE,KAAKK,YAAxE,EAAsFoK,IAAtF,EAC4B,KAAKrK,cADjC,EACiD,KAAKF,QADtD,EACgE,KAAKC,OADrE,EAEGsC,SAFH,CAEa,UAACK,GAAD,EAAc;AACvBH,mBAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BE,GAA5B;;AACA,kBAAI,CAAC8H,UAAL;;AACA,gBAAI9H,GAAJ,EAAS;AACP,oBAAI,CAACvE,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyClD,GAAzC;AACD;AACF,WARH,EASE,UAAAqD,KAAK,EAAI;AACPxD,mBAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkCuD,KAAlC;;AACA,kBAAI,CAAC5H,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyCG,KAAK,CAACA,KAAN,CAAYC,OAAZ,GAAuB,IAAvB,GAA8BD,KAAK,CAACC,OAA7E;;AACA,kBAAI,CAACwE,UAAL;AACD,WAbH;AAcD;;;wCAEe;AACd,eAAK/K,SAAL,GAAiB,YAAjB;AACA,eAAKC,SAAL,GAAiB,KAAjB;AACA,eAAKC,SAAL,GAAiB,IAAjB;AACA,eAAKC,MAAL,GAAc,EAAd;AACA,eAAKC,QAAL,GAAgB,CAAhB;AACA,eAAKI,YAAL,GAAoB,CAApB;AACA,eAAKD,cAAL,GAAsB,UAAtB;AACA,eAAKF,QAAL,GAAgB,CAAhB;AACA,eAAKC,OAAL,GAAe,CAAf;AACD;;;uCAEc;AAAA;;AACb,cAAI,KAAKhB,SAAT,EAAoB;AAClB,gBAAI0L,OAAO,CAAC,gBAAD,CAAX,EAA+B;AAC7B,mBAAK1L,SAAL,CAAewI,OAAf,CAAuB,UAAAP,GAAG,EAAI;AAC5B,oBAAIA,GAAG,CAACC,aAAJ,IAAqBD,GAAG,CAACE,aAAzB,IAA0CF,GAAG,CAACG,aAA9C,IAA+DH,GAAG,CAACI,aAAvE,EAAsF;AACpF,yBAAI,CAACsD,YAAL,CAAkB1D,GAAlB,EAAuB,IAAvB;AACD;AACF,eAJD;AAKD;AACF;AACF;;;qCAEYA,G,EAAuC;AAAA;;AAAA,cAAxB2D,cAAwB,uEAAP,KAAO;AAClD,cAAIb,GAAG,GAAGd,MAAM,CAAG4B,QAAQ,CAACC,cAAT,CAAwB,aAAa7D,GAAG,CAAC3J,EAAzC,CAAD,CAAoEyN,KAAtE,CAAhB;AACA;;AAEA,cAAI,CAAChB,GAAL,EAAU;AACRA,eAAG,GAAGvF,IAAI,CAACwG,GAAL,CAAS/D,GAAG,CAACc,MAAb,CAAN;AACD;;AAED,cAAIkD,OAAO,GAAG,CAAd;;AACA,cAAIhE,GAAG,CAACc,MAAJ,GAAa,CAAjB,EAAoB;AAClBkD,mBAAO,GAAG,CAAC,CAAX;AACD,WAFD,MAEO,IAAIhE,GAAG,CAACc,MAAJ,GAAa,CAAjB,EAAoB;AACzBkD,mBAAO,GAAG,CAAV;AACD;;AAED,cAAIC,SAAS,GAAG,CAAhB,CAfkD,CAe/B;;AACnB1I,iBAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BwE,GAAG,CAACa,KAAnC,EAA0CiC,GAA1C,EAA+CmB,SAA/C,EAA0DD,OAA1D,EAAmEhE,GAAG,CAACpC,IAAvE,EAA6E,CAA7E;AACA,cAAIsG,YAAY,GAAGP,cAAnB;;AAEA,cAAIA,cAAc,KAAK,KAAvB,EAA8B;AAC5BO,wBAAY,GAAGT,OAAO,CAAC,UAAUX,GAAV,GAAgB,YAAhB,IAAgCkB,OAAO,KAAK,CAAC,CAAb,GAAiB,YAAjB,GAAgC,WAAhE,IAA+E,QAAhF,CAAtB;AACD;;AAED,cAAIE,YAAJ,EAAkB;AAChB,iBAAK/M,UAAL,CAAgBoM,UAAhB,CAA2B,KAAK5L,YAAhC,EAA8CqI,GAAG,CAACa,KAAlD,EAAyDiC,GAAzD,EAA8DmB,SAA9D,EAAyED,OAAzE,EAC4BhE,GAAG,CAACpC,IADhC,EACsC,CADtC,EACyC,CADzC,EAEGvC,SAFH,CAEa,UAACK,GAAD,EAAc;AACvBH,qBAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCE,GAAhC;;AACA,qBAAI,CAAC8H,UAAL;;AACA,kBAAI9H,GAAJ,EAAS;AACP,uBAAI,CAACvE,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyClD,GAAzC;;AACA,uBAAI,CAACvE,UAAL,CAAgBgN,SAAhB,CAA0B,SAA1B;AACD;AACF,aATH,EAUE,UAAApF,KAAK,EAAI;AACPxD,qBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCuD,KAAtC;;AACA,qBAAI,CAAC5H,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyCG,KAAK,CAACA,KAAN,CAAYC,OAAZ,GAAuB,IAAvB,GAA8BD,KAAK,CAACC,OAA7E;;AACA,qBAAI,CAACwE,UAAL;;AACA,qBAAI,CAACrM,UAAL,CAAgBgN,SAAhB,CAA0B,OAA1B;AACD,aAfH;AAgBD;AACF;;;qCAEY;AACX,eAAK7E,QAAL;AACA,eAAKO,YAAL;AACA,eAAK6C,SAAL;AACD;;;6CAEoB0B,E,EAAIxG,I,EAAM;AAC7B,eAAKzG,UAAL,CAAgBkN,YAAhB,CAA6BzF,IAA7B,CAAmC;AAAElB,kBAAM,EAAE0G,EAAE,CAAC1G,MAAH,GAAYE,IAAtB;AAA4BW,eAAG,EAAE,KAAKlB,MAAL,CAAY+G,EAAE,CAAC1G,MAAH,GAAYE,IAAxB,CAAjC;AAAgEkF,eAAG,EAAE,KAAKjI;AAA1E,WAAnC;AACD;;;mCAEUuJ,E,EAAIxG,I,EAAM;AACnB,eAAKzG,UAAL,CAAgBmN,WAAhB,CAA4B1F,IAA5B,CAAkC;AAAElB,kBAAM,EAAE0G,EAAE,CAAC1G,MAAH,GAAYE,IAAtB;AAA4BA,gBAAI,EAAEA;AAAlC,WAAlC;AACD;;;iDAEwBD,M,EAAQ;AAC/B,cAAI4G,qBAAqB,GAAG,0EAAaA,qBAAzC;;AACA,cAAIA,qBAAJ,EAA2B;AACzB,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,qBAAqB,CAACE,MAA1C,EAAkDD,CAAC,EAAnD,EAAuD;AACrD,kBAAIE,OAAO,GAAGH,qBAAqB,CAACC,CAAD,CAAnC;AACA;;;;;;;;AAOA,kBAAIG,MAAM,GAAG,IAAI3H,IAAJ,CAAS,KAAK3D,OAAd,EAAuB,KAAKC,QAAL,GAAgB,CAAvC,EAA0C,KAAKC,OAA/C,CAAb;AACA,kBAAIqL,YAAY,GAAG,IAAI5H,IAAJ,CAAS0H,OAAO,CAAC3H,MAAjB,CAAnB;;AACA,kBAAI4H,MAAM,CAACxH,OAAP,OAAqByH,YAAY,CAACzH,OAAb,EAArB,IAA+CuH,OAAO,CAAC7D,KAAR,KAAkBlD,MAAjE,IAA2E+G,OAAO,CAACG,IAAR,KAAiB,CAAhG,EAAmG;AACjG,uBAAOH,OAAO,CAAC5B,GAAf;AACD;AACF;;AACD,mBAAO,IAAP;AACD;AACF;;;kDAEyBnF,M,EAAQ;AAChC,cAAI4G,qBAAqB,GAAG,0EAAaA,qBAAzC;;AACA,cAAIA,qBAAJ,EAA2B;AACzB,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,qBAAqB,CAACE,MAA1C,EAAkDD,CAAC,EAAnD,EAAuD;AACrD,kBAAIE,OAAO,GAAGH,qBAAqB,CAACC,CAAD,CAAnC;AACA;;;;;;;;AAOA,kBAAIG,MAAM,GAAG,IAAI3H,IAAJ,CAAS,KAAK3D,OAAd,EAAuB,KAAKC,QAAL,GAAgB,CAAvC,EAA0C,KAAKC,OAA/C,CAAb;AACA,kBAAIqL,YAAY,GAAG,IAAI5H,IAAJ,CAAS0H,OAAO,CAAC3H,MAAjB,CAAnB;;AACA,kBAAI4H,MAAM,CAACxH,OAAP,OAAqByH,YAAY,CAACzH,OAAb,EAArB,IAA+CuH,OAAO,CAAC7D,KAAR,KAAkBlD,MAAjE,IAA2E+G,OAAO,CAACG,IAAR,KAAiB,CAAhG,EAAmG;AACjG,uBAAOH,OAAO,CAACI,KAAf;AACD;AACF;;AACD,mBAAO,IAAP;AACD;AACF;;;+CAEsBnH,M,EAAQ;AAC7B,cAAI4G,qBAAqB,GAAG,0EAAaA,qBAAzC;;AACA,cAAIA,qBAAJ,EAA2B;AACzB,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,qBAAqB,CAACE,MAA1C,EAAkDD,CAAC,EAAnD,EAAuD;AACrD,kBAAIE,OAAO,GAAGH,qBAAqB,CAACC,CAAD,CAAnC;AACA;;;;;;;;AAQA,kBAAIG,MAAM,GAAG,IAAI3H,IAAJ,CAAS,KAAK3D,OAAd,EAAuB,KAAKC,QAAL,GAAgB,CAAvC,EAA0C,KAAKC,OAA/C,CAAb;AACA,kBAAIqL,YAAY,GAAG,IAAI5H,IAAJ,CAAS0H,OAAO,CAAC3H,MAAjB,CAAnB;;AACA,kBAAI2H,OAAO,CAACG,IAAR,KAAiB,CAAjB,IAAsBF,MAAM,CAACxH,OAAP,OAAqByH,YAAY,CAACzH,OAAb,EAA3C,IAAqEuH,OAAO,CAAC7D,KAAR,KAAkBlD,MAA3F,EAAmG;AACjG,uBAAO,IAAP;AACD;AACF;;AACD,mBAAO,KAAP;AACD;AACF;;;gCAEOqG,O,EAAiBe,U,EAAoBX,E,EAAI;AAAA;;AAC/C,cAAI1G,MAAM,GAAG,SAAS0G,EAAE,CAAC1G,MAAZ,GAAqBqH,UAAlC;AACA,cAAIpH,MAAM,GAAGyG,EAAE,CAACzG,MAAhB;AACA,cAAIsD,WAAW,GAAG,KAAKnH,eAAvB;AAEA,cAAIkJ,KAAJ;AACAzH,iBAAO,CAACC,GAAR,CAAY,kBAAkB,SAAlB,GAA8BuJ,UAA9B,GAA2C,GAA3C,GAAiDX,EAAE,CAAC1G,MAAhE;AACA,cAAIoF,GAAG,GAAGd,MAAM,CAAE4B,QAAQ,CAACC,cAAT,CAAwB,YAAYkB,UAAZ,GAAyB,GAAzB,GAA+BX,EAAE,CAAC1G,MAA1D,EAAuFoG,KAAzF,CAAhB;AACAd,eAAK,GAAIY,QAAQ,CAACC,cAAT,CAAwB,cAAckB,UAAd,GAA2B,GAA3B,GAAiCX,EAAE,CAAC1G,MAA5D,EAAyFoG,KAAlG;AACA;;AAEA,cAAIG,SAAS,GAAG,CAAhB,CAX+C,CAW5B;;AACnB,cAAIjB,KAAJ,EAAW;AACTiB,qBAAS,GAAG,CAAZ,CADS,CACM;AAChB,WAFD,MAEO;AACLjB,iBAAK,GAAG,CAAR;AACD;;AACDzH,iBAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BkC,MAA/B,EAAuCoF,GAAvC,EAA6CmB,SAAS,KAAK,CAAd,GAAkB,QAAlB,GAA6B,OAA1E,EAAoFD,OAApF,EAA6F/C,WAA7F,EAA0G+B,KAA1G;;AACA,cAAI;AAAK;AAAT,YAA4H;AAC1H,mBAAK7L,UAAL,CAAgBoM,UAAhB,CAA2B,KAAK5L,YAAhC,EAA8C+F,MAA9C,EAAsDoF,GAAtD,EAA2DmB,SAA3D,EAAsED,OAAtE,EAC4B/C,WAD5B,EACyC+B,KADzC,EACgD,CADhD,EAEG3H,SAFH,CAEa,UAACK,GAAD,EAAc;AACvBH,uBAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BE,GAA3B;;AACA,uBAAI,CAAC8H,UAAL;;AACA,oBAAI9H,GAAJ,EAAS;AACP,yBAAI,CAACvE,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyClB,MAAM,GAAG,GAAT,GAAeoF,GAAf,GAAqB,GAArB,IAA4BmB,SAAS,KAAK,CAAd,GAAkB,QAAlB,GAA6B,OAAzD,IAAoE,GAApE,GAA0EvI,GAAnH,EADO,CAEP;;;AACA,yBAAI,CAACvE,UAAL,CAAgBgN,SAAhB,CAA0B,SAA1B;AACD;AACF,eAVH,EAWE,UAAApF,KAAK,EAAI;AACPxD,uBAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCuD,KAAjC;;AACA,uBAAI,CAAC5H,UAAL,CAAgBsE,mBAAhB,CAAoCmD,IAApC,CAAyCG,KAAK,CAACA,KAAN,CAAYC,OAAZ,GAAuB,IAAvB,GAA8BD,KAAK,CAACC,OAA7E;;AACA,uBAAI,CAACwE,UAAL;;AACA,uBAAI,CAACrM,UAAL,CAAgBgN,SAAhB,CAA0B,OAA1B;AACD,eAhBH;AAiBD;AACF;;;4CAEmB;AAClB,cAAII,qBAAqB,GAAG,0EAAaA,qBAAzC;;AACA,cAAIA,qBAAJ,EAA2B;AACzB,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,qBAAqB,CAACE,MAA1C,EAAkDD,CAAC,EAAnD,EAAuD;AACrD,kBAAIE,OAAO,GAAGH,qBAAqB,CAACC,CAAD,CAAnC;AACA;;;;;;;;AAQA,kBAAIE,OAAO,CAACG,IAAR,KAAiB,CAArB,EAAwB;AACtB,uBAAO,IAAP;AACD;AACF;AACF;;AACD,iBAAO,KAAP;AACD;;;sCAEa;AACZ,eAAKG,oBAAL;AACA,eAAKC,gBAAL;AACD;;;+CAEsB;AACrB,eAAK5K,WAAL,GAAmB,EAAnB;;AACA,cAAI,CAAC,KAAK6K,iBAAL,EAAL,EAA+B;AAC7B,iBAAK,IAAIC,KAAK,GAAG,KAAKxL,cAAtB,EAAsCwL,KAAK,IAAI,KAAKzL,eAApD,EAAqEyL,KAAK,IAAI,KAAKvL,iBAAnF,EAAsG;AACpG;AACA,kBAAI8D,MAAM,GAAG,KAAKtE,SAAL,GAAiB,KAAKgM,SAAL,EAAjB,GAAoCD,KAAjD;AACA,kBAAI5G,GAAG,GAAG,KAAKlB,MAAL,CAAYK,MAAM,GAAG,IAArB,CAAV;;AACA,kBAAIa,GAAG,IAAI,EAAP,IAAaA,GAAG,IAAI,EAAxB,EAA4B;AAC1B,oBAAIC,KAAK,GAAG,KAAKC,QAAL,CAAcf,MAAd,EAAsByH,KAAtB,EAA6B,IAA7B,CAAZ;;AACA,oBAAI3G,KAAK,GAAG,CAAR,IAAajB,IAAI,CAACwG,GAAL,CAASvF,KAAT,IAAkB,CAAnC,EAAsC;AAAE;AAEtC;AACA,uBAAK,IAAI6G,MAAM,GAAG,KAAK1L,cAAvB,EAAuC0L,MAAM,IAAI,KAAK3L,eAAtD,EAAuE2L,MAAM,IAAI,KAAKzL,iBAAtF,EAAyG;AACvG,wBAAI0L,OAAO,GAAG,KAAKlM,SAAL,GAAiB,KAAKgM,SAAL,EAAjB,GAAoCC,MAAlD;AACA,wBAAIE,MAAM,GAAG,KAAK9G,QAAL,CAAc6G,OAAd,EAAuBD,MAAvB,EAA+B,IAA/B,CAAb;;AAEA,wBAAI9H,IAAI,CAACwG,GAAL,CAASvF,KAAK,GAAG+G,MAAjB,KAA4B,KAAhC,EAAuC;AACrC,0BAAIC,IAAI,GAAG,KAAKnI,MAAL,CAAYiI,OAAO,GAAG,IAAtB,CAAX;;AACA,0BAAIE,IAAJ,EAAU;AACR,6BAAKnL,WAAL,CAAiB+G,IAAjB,CAAsB;AAAEqE,kCAAQ,EAAEN,KAAZ;AAAmBO,iCAAO,EAAElH,KAA5B;AAAmCmH,+BAAK,EAAEpH,GAA1C;AAA+CqH,kCAAQ,EAAEP,MAAzD;AAAiEQ,iCAAO,EAAEN,MAA1E;AAAkFO,+BAAK,EAAEN;AAAzF,yBAAtB;AACD;AACF;AACF;AACF;AACF;AACF,aAvB4B,CAwB7B;;AACD;AACF;;;2CAEkB;AACjB,cAAIjB,qBAAqB,GAAG,0EAAaA,qBAAzC;AACA,cAAIwB,OAAO,GAAG,CAAd;AACA,cAAIC,SAAS,GAAG,CAAhB;AACA,cAAIC,KAAK,GAAG,CAAZ;AACA,cAAIC,OAAO,GAAG,CAAd;AACA,cAAIC,SAAS,GAAG,CAAhB;AACA,cAAIC,KAAK,GAAG,CAAZ;AACA,eAAK9L,WAAL,GAAmB,EAAnB;AACA,eAAKM,gBAAL,GAAwB,CAAxB;;AACA,cAAI2J,qBAAJ,EAA2B;AACzB,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,qBAAqB,CAACE,MAA1C,EAAkDD,CAAC,EAAnD,EAAuD;AACrD,kBAAIE,OAAO,GAAGH,qBAAqB,CAACC,CAAD,CAAnC;AACA;;;;;;;;AAQA,kBAAIG,MAAM,GAAG,IAAI3H,IAAJ,CAAS,KAAK3D,OAAd,EAAuB,KAAKC,QAAL,GAAgB,CAAvC,EAA0C,KAAKC,OAA/C,CAAb;AACA,kBAAIqL,YAAY,GAAG,IAAI5H,IAAJ,CAAS0H,OAAO,CAAC3H,MAAjB,CAAnB;;AACA,kBAAI2H,OAAO,CAACG,IAAR,KAAiB,CAAjB,IAAsBH,OAAO,CAAC5B,GAAR,GAAc,CAAxC,EAA2C;AAAE;AAE3C,oBAAIlF,IAAI,GAAG,EAAX;;AACA,oBAAI8G,OAAO,CAAC7D,KAAR,CAAc5E,QAAd,CAAuB,IAAvB,CAAJ,EAAkC;AAChC2B,sBAAI,GAAG,IAAP;AACD;;AACD,oBAAI8G,OAAO,CAAC7D,KAAR,CAAc5E,QAAd,CAAuB,IAAvB,CAAJ,EAAkC;AAChC2B,sBAAI,GAAG,IAAP;AACD;;AACD,oBAAIuH,KAAK,GAAGT,OAAO,CAAC7D,KAAR,CAAcW,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB,CAAZ;AAEA,oBAAI9D,MAAM,GAAG,KAAKtE,SAAL,GAAiB,KAAKgM,SAAL,EAAjB,GAAoCD,KAAjD;AACA,oBAAI3G,KAAK,GAAG,KAAKC,QAAL,CAAcf,MAAd,EAAsByH,KAAtB,EAA6BvH,IAA7B,IAAqC8G,OAAO,CAAC5B,GAAzD;AACA,oBAAIvE,GAAG,GAAG,KAAKlB,MAAL,CAAYK,MAAM,GAAGE,IAArB,IAA6B8G,OAAO,CAAC5B,GAA/C;;AAEA,oBAAIlF,IAAI,KAAK,IAAb,EAAmB;AACjBoI,2BAAS,IAAIzH,GAAb;AACAwH,yBAAO,IAAIvH,KAAX;AACAyH,uBAAK,IAAIvB,OAAO,CAAC5B,GAAjB;AACD,iBAJD,MAIO,IAAIlF,IAAI,KAAK,IAAb,EAAmB;AACxBuI,2BAAS,IAAI5H,GAAb;AACA2H,yBAAO,IAAI1H,KAAX;AACA4H,uBAAK,IAAI1B,OAAO,CAAC5B,GAAjB;AACD;AACF;AACF;;AACD,gBAAIkD,SAAS,KAAK,CAAd,IAAmBG,SAAS,KAAK,CAArC,EAAwC;AACtCH,uBAAS,GAAGA,SAAS,GAAGC,KAAxB;AACAE,uBAAS,GAAGA,SAAS,GAAGC,KAAxB;AACA,mBAAKxL,gBAAL,GAAwBoL,SAAS,GAAGG,SAApC;AACA,mBAAKvL,gBAAL,GAAyB2C,IAAI,CAACC,KAAL,CAAW,CAAC,KAAK5C,gBAAL,GAAwB,OAAzB,IAAoC,GAA/C,IAAsD,GAA/E;;AACA,kBAAI,KAAKD,WAAL,IAAoB,KAAKC,gBAAL,IAAyB,KAAKD,WAAtD,EAAmE;AACjE,qBAAKxD,UAAL,CAAgBgN,SAAhB,CAA0B,MAA1B;AACD;AACF;;AACD,gBAAI4B,OAAO,KAAK,CAAZ,IAAiBG,OAAO,KAAK,CAA7B,IAAkCF,SAAlC,IAA+CG,SAAnD,EAA8D;AAC5DJ,qBAAO,GAAGA,OAAO,GAAGE,KAApB;AACAC,qBAAO,GAAGA,OAAO,GAAGE,KAApB;;AACA,kBAAI7I,IAAI,CAACwG,GAAL,CAASgC,OAAO,GAAGG,OAAnB,IAA8B,IAAlC,EAAwC;AACtC;AAEA,qBAAKG,IAAL,CAAU,IAAV,EAAgBH,OAAhB;AACA,qBAAKG,IAAL,CAAU,IAAV,EAAgBN,OAAhB;AAED,eAT2D,CAU5D;;AACD;AACF;AACF;;;6BAEInI,I,EAAMY,K,EAAO;AAChB,eAAK,IAAI6G,MAAM,GAAG,KAAK1L,cAAvB,EAAuC0L,MAAM,IAAI,KAAK3L,eAAtD,EAAuE2L,MAAM,IAAI,KAAKzL,iBAAtF,EAAyG;AACvG,gBAAI0L,OAAO,GAAG,KAAKlM,SAAL,GAAiB,KAAKgM,SAAL,EAAjB,GAAoCC,MAAlD;AACA,gBAAIE,MAAM,GAAG,KAAK9G,QAAL,CAAc6G,OAAd,EAAuBD,MAAvB,EAA+BzH,IAA/B,CAAb;;AAEA,gBAAIL,IAAI,CAACwG,GAAL,CAASvF,KAAK,GAAG+G,MAAjB,KAA4B,KAAhC,EAAuC;AACrC,kBAAIC,IAAI,GAAG,KAAKnI,MAAL,CAAYiI,OAAO,GAAG1H,IAAtB,CAAX;;AACA,kBAAI4H,IAAJ,EAAU;AACR,qBAAKlL,WAAL,CAAiB8G,IAAjB,CAAsB;AAAEkF,wBAAM,EAAE,YAAY1I,IAAtB;AAA4BD,wBAAM,EAAE0H,MAAM,GAAGzH,IAA7C;AAAmDW,qBAAG,EAAEiH;AAAxD,iBAAtB;AACD;AACF;AACF;AACF;;;wCAEee,O,EAAS;AACvBhL,iBAAO,CAACC,GAAR,CAAY,MAAZ;AACA,eAAKhB,QAAL,CAAcgM,IAAd,CAAmB,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAC3B;AACA,gBAAID,CAAC,CAAC,OAAD,CAAD,KAAe,UAAnB,EAA+B;AAC7B,qBAAO,CAAC,CAAR;AACD;;AACD,gBAAIC,CAAC,CAAC,OAAD,CAAD,KAAe,UAAnB,EAA+B;AAC7B,qBAAO,CAAP;AACD;;AACD,mBAAOD,CAAC,CAACF,OAAD,CAAD,GAAaG,CAAC,CAACH,OAAD,CAAd,GAA0B,CAAC,CAA3B,GAA+BE,CAAC,CAACF,OAAD,CAAD,GAAaG,CAAC,CAACH,OAAD,CAAd,GAA0B,CAA1B,GAA8B,CAApE,CAR2B,CAU3B;AACA;AACD,WAZD;AAaD;;;sCAEa;AACZ,eAAK9O,eAAL,CAAqBkP,eAArB;AACD;;;uCAEc;AACb,cAAIC,CAAC,GAAG,KAAKnP,eAAL,CAAqBoP,YAArB,EAAR;AACA,eAAKtM,gBAAL,GAAwBqM,CAAC,CAAC,kBAAD,CAAzB;AACA,eAAKpM,QAAL,GAAgBoM,CAAC,CAAC,UAAD,CAAjB;AACA,eAAKnM,SAAL,GAAiBmM,CAAC,CAAC,WAAD,CAAlB;AACA,eAAKlM,WAAL,GAAmBkM,CAAC,CAAC,aAAD,CAApB;AACArL,iBAAO,CAACC,GAAR,CAAY,SAAZ,EAAuB,KAAKhB,QAA5B;AACD;;;yCAEgB;AACf,eAAK/C,eAAL,CAAqBqP,cAArB;AACD;;;yCAEgB;AACf,eAAKrP,eAAL,CAAqBsP,cAArB;AACD;;;uCAEclG,K,EAAO;AACpB,cAAI,0EAAarG,QAAb,CAAsBqG,KAAtB,EAA6BmG,IAAjC,EAAuC;AACrC,mBAAO,IAAP;AACD,WAFD,MAEO;AACL,mBAAO,KAAP;AACD;AACF;;;wCAEe;AAAA;;AAEd,eAAKxN,iBAAL,GAAyB,KAAzB;AACA,cAAIyN,WAAW,GAAG,IAAIjK,IAAJ,CAAS,KAAK3D,OAAd,EAAuB,KAAKC,QAAL,GAAgB,CAAvC,EAA0C,KAAKC,OAA/C,CAAlB;AAEA,cAAI2N,sBAAsB,GAAG,0EAAatF,kBAA1C;;AACA,cAAI,KAAKxI,SAAL,KAAmB,QAAvB,EAAiC;AAC/B8N,kCAAsB,GAAG,0EAAapF,wBAAtC;AACD;;AACD,eAAK,IAAIqF,GAAT,IAAgBD,sBAAhB,EAAwC;AACtC,gBAAIA,sBAAsB,CAACE,cAAvB,CAAsCD,GAAtC,CAAJ,EAAgD;AAC5C;AACA,kBAAIF,WAAW,CAACI,OAAZ,OAA0BH,sBAAsB,CAACC,GAAD,CAAtB,CAA4BE,OAA5B,EAA9B,EAAqE;AACnE9L,uBAAO,CAACC,GAAR,CAAY,wBAAZ;AACA,qBAAKhC,iBAAL,GAAyB,IAAzB;AACA;AACD;AACJ;AACF;;AAED,eAAKK,UAAL,GAAkB,EAAlB;;AACA,eAAK,IAAIsL,KAAK,GAAG,KAAKxL,cAAtB,EAAsCwL,KAAK,IAAI,KAAKzL,eAApD,EAAqEyL,KAAK,IAAI,KAAKvL,iBAAnF,EAAsG;AACpG,iBAAKC,UAAL,CAAgBuH,IAAhB,CAAqB;AAAC1D,oBAAM,EAAE,KAAKtE,SAAL,GAAiB,KAAKgM,SAAL,EAAjB,GAAoCD,KAA7C;AAAoDxH,oBAAM,EAAEwH,KAA5D;AAAmE5G,iBAAG,EAAE,CAAxE;AAA2EC,mBAAK,EAAE;AAAlF,aAArB,EADoG,CACS;AAC9G;;AAED,cAAI,CAAC,0EAAa8I,mBAAlB,EAAuC;AACrC,gBAAIjG,GAAG,GAAG,EAAV;AACA,iBAAKxH,UAAL,CAAgB0G,OAAhB,CAAwB,UAAA6D,EAAE,EAAI;AAC5B,kBAAIjC,EAAE,GAAG,IAAI,yDAAJ,EAAT;AACAA,gBAAE,CAACpF,MAAH,GAAY,IAAIC,IAAJ,CAAS,OAAI,CAAC3D,OAAd,EAAuB,OAAI,CAACC,QAAL,GAAgB,CAAvC,EAA0C,OAAI,CAACC,OAA/C,EAAwDsI,YAAxD,EAAZ;AACAM,gBAAE,CAAC1F,MAAH,GAAY,OAAI,CAACrD,SAAjB;AACA+I,gBAAE,CAACxE,MAAH,GAAYqE,MAAM,CAACoC,EAAE,CAACzG,MAAJ,CAAlB;AACAwE,gBAAE,CAACvE,IAAH,GAAU,IAAV;AACAyD,iBAAG,CAACD,IAAJ,CAASe,EAAT;AACA,kBAAIoF,EAAE,GAAG,IAAI,yDAAJ,EAAT;AACAA,gBAAE,CAACxK,MAAH,GAAY,IAAIC,IAAJ,CAAS,OAAI,CAAC3D,OAAd,EAAuB,OAAI,CAACC,QAAL,GAAgB,CAAvC,EAA0C,OAAI,CAACC,OAA/C,EAAwDsI,YAAxD,EAAZ;AACA0F,gBAAE,CAAC9K,MAAH,GAAY,OAAI,CAACrD,SAAjB;AACAmO,gBAAE,CAAC5J,MAAH,GAAYqE,MAAM,CAACoC,EAAE,CAACzG,MAAJ,CAAlB;AACA4J,gBAAE,CAAC3J,IAAH,GAAU,IAAV;AACAyD,iBAAG,CAACD,IAAJ,CAASmG,EAAT;AACD,aAbD;AAcAhM,mBAAO,CAACC,GAAR,CAAY,kCAAkC6F,GAA9C;AACA,iBAAKlK,UAAL,CAAgBiL,iBAAhB,CAAkCf,GAAlC;AACD;AAEF;;;kCAES;AACR,eAAKxH,UAAL,GAAkB,EAAlB;AACD;;;uCAEc;AACb,cAAIkE,UAAU,GAAG,EAAjB;;AACA,cAAI,KAAK3E,SAAL,KAAmB,OAAvB,EAAgC;AAC9B2E,sBAAU,GAAG,SAAb;AACD,WAFD,MAEO,IAAI,KAAK3E,SAAL,KAAmB,WAAvB,EAAoC;AACzC2E,sBAAU,GAAG,WAAb;AACD,WAFM,MAEA,IAAI,KAAK3E,SAAL,KAAmB,QAAvB,EAAiC;AACtC2E,sBAAU,GAAG,YAAb;AACD;;AACD,cAAIhI,CAAC,GAAG,KAAKsH,MAAL,CAAYU,UAAZ,CAAR;AACA,iBAAOhI,CAAP;AACD;;;2CAEkB;AACjB,cAAIgI,UAAU,GAAG,EAAjB;;AACA,cAAI,KAAK3E,SAAL,KAAmB,OAAvB,EAAgC;AAC9B2E,sBAAU,GAAG,SAAb;AACD,WAFD,MAEO,IAAI,KAAK3E,SAAL,KAAmB,WAAvB,EAAoC;AACzC2E,sBAAU,GAAG,WAAb;AACD,WAFM,MAEA,IAAI,KAAK3E,SAAL,KAAmB,QAAvB,EAAiC;AACtC2E,sBAAU,GAAG,YAAb;AACD;;AACD,cAAIhI,CAAC,GAAG,KAAKsH,MAAL,CAAYU,UAAZ,CAAR;AAEA,cAAIT,UAAU,GAAIC,IAAI,CAACC,KAAL,CAAWzH,CAAC,GAAG,KAAK6D,iBAApB,IAAyC,KAAKA,iBAAhE;AAEA;;;;;AAOA;AACA;;AAEA,eAAK4N,YAAL,GAAoBlK,UAApB,CAvBiB,CAuBe;AACjC;;;qCAEYK,M,EAAQ;AACnB;;;;;;;;;;;;;AAcA,cAAIA,MAAM,KAAK,KAAK6J,YAApB,EAAkC;AAChC,mBAAO,IAAP;AACD;;AACD,iBAAO,KAAP;AACD;;;kCAESC,Q,EAAoB;AAC5B,cAAI/J,MAAM,GAAG+J,QAAQ,CAAC5G,KAAtB;AACAnD,gBAAM,GAAGA,MAAM,CAAC4D,OAAP,CAAe,MAAf,EAAuB,EAAvB,CAAT;AACA;;;;;;;;;;;;;;;;;;;;;AAoBAmG,kBAAQ,CAACC,GAAT,GAAe,KAAKrK,MAAL,CAAYK,MAAZ,CAAf;AACA,iBAAO+J,QAAQ,CAACC,GAAhB;AACD;;;kCAESD,Q,EAAoB;AAC5B;AACA,cAAIA,QAAQ,CAACC,GAAb,EAAkB;AAChB,gBAAIlH,GAAG,GAAG,IAAV;AACA,gBAAIU,cAAc,GAAG,CAArB;;AACA,gBAAIuG,QAAQ,CAACvG,cAAb,EAA6B;AAC3BA,4BAAc,GAAGuG,QAAQ,CAACvG,cAA1B;AACD;;AACD,gBAAIuG,QAAQ,CAAC3G,MAAT,KAAoB,CAAxB,EAA2B;AACzB,qBAAO2G,QAAQ,CAACjH,GAAhB;AACD;;AACD,gBAAIiH,QAAQ,CAAC3G,MAAT,GAAkB,CAAtB,EAAyB;AACvB,kBAAIF,CAAC,GAAG,CAAC6G,QAAQ,CAACC,GAAT,GAAeD,QAAQ,CAAC1G,MAAzB,IAAmC0G,QAAQ,CAAC3G,MAApD;AACAN,iBAAG,GAAGU,cAAc,GAAGN,CAAvB;AACD,aAHD,MAGO,IAAI6G,QAAQ,CAAC3G,MAAT,GAAkB,CAAtB,EAAyB;AAC9B,kBAAIF,EAAC,GAAG,CAAC6G,QAAQ,CAACzG,OAAT,GAAmByG,QAAQ,CAACC,GAA7B,IAAoC,CAACD,QAAQ,CAAC3G,MAAtD;;AACAN,iBAAG,GAAGU,cAAc,GAAGN,EAAvB;AACD;;AACD,gBAAI6G,QAAQ,CAAC5G,KAAT,CAAe5E,QAAf,CAAwB,QAAxB,CAAJ,EAAuC;AACrCuE,iBAAG,IAAI,IAAP;AACD;;AACDiH,oBAAQ,CAACjH,GAAT,GAAgBjD,IAAI,CAACC,KAAL,CAAW,CAACgD,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAApD;AACA,mBAAOiH,QAAQ,CAACjH,GAAhB;AACD,WArBD,MAqBO;AACL,mBAAOiH,QAAQ,CAACjH,GAAhB;AACD;AACF,S,CAED;;;;oCAEY;AACV,cAAI,KAAKhH,iBAAT,EAA4B;AAC1B,mBAAO,MAAM,KAAKH,OAAL,GAAe,IAArB,IAA6B,0EAAasO,aAAb,CAA2B,KAAKrO,QAAhC,CAApC;AACD;;AAED,cAAIsO,WAAW,GAAG,IAAlB;;AACA,cAAI,KAAKtO,QAAL,KAAkB,EAAtB,EAA0B;AACxBsO,uBAAW,GAAG,GAAd;AACD,WAFD,MAEO,IAAI,KAAKtO,QAAL,KAAkB,EAAtB,EAA0B;AAC/BsO,uBAAW,GAAG,GAAd;AACD,WAFM,MAEA,IAAI,KAAKtO,QAAL,KAAkB,EAAtB,EAA0B;AAC/BsO,uBAAW,GAAG,GAAd;AACD,WAFM,MAEA;AACLA,uBAAW,GAAG,KAAKtO,QAAnB;AACD;;AAED,iBAAO,MAAM,KAAKD,OAAL,GAAe,IAArB,IAA6BuO,WAA7B,GAA2C,CAAC,MAAM,KAAKrO,OAAZ,EAAqBiI,KAArB,CAA2B,CAAC,CAA5B,CAAlD,CAhBU,CAgBuE;AAClF;;;+BAEM7D,M,EAAkC;AAAA,cAAlBkK,SAAkB,uEAAN,IAAM;;AACvC;AAEA,cAAIlK,MAAM,KAAK,YAAf,EAA6B;AAC3B,gBAAIjB,UAAU,GAAS,0EAAaoF,wBAAb,CAAsC,0EAAaC,IAAb,GAAoB,0EAAarD,gBAAvE,CAAvB;AACA,gBAAIkJ,WAAW,GAAG,IAAlB;;AACA,gBAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AACpC0K,yBAAW,GAAG,GAAd;AACD,aAFD,MAEO,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA;AACLA,yBAAW,GAAGlL,UAAU,CAACQ,QAAX,KAAwB,CAAtC;AACD;;AACD,gBAAIH,MAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAA0C2K,WAA1C,GAAyD,CAAC,MAAMlL,UAAU,CAACS,OAAX,EAAP,EAA6BqE,KAA7B,CAAmC,CAAC,CAApC,CAAtE;AACA7D,kBAAM,GAAG,WAAWZ,MAAX,GAAoB,0EAAa2B,gBAAjC,GAAoD,KAA7D,CAb2B,CAc3B;AACD;;AAED,cAAIH,GAAG,GAAG,KAAKnH,UAAL,CAAgBiG,MAAhB,CAAuBM,MAAvB,CAAV;;AACA,cAAIkK,SAAJ,EAAe;AACbA,qBAAS,CAACtJ,GAAV,GAAgBA,GAAhB;AACD;;AAED,iBAAOA,GAAP;AACD;;;+BAEMZ,M,EAAgB;AACrB,iBAAO,KAAKvG,UAAL,CAAgB0Q,MAAhB,CAAuBnK,MAAvB,CAAP;AACD;;;kCAESA,M,EAAgB;AACxB,cAAIoK,MAAM,GAAG,KAAK3Q,UAAL,CAAgB4Q,SAAhB,CAA0BrK,MAA1B,CAAb;;AACA,cAAIoK,MAAJ,EAAY;AACV,mBAAOA,MAAM,CAACrI,cAAP,EAAP;AACD;;AACD,iBAAOqI,MAAP;AACD;;;8BAEKpK,M,EAAgB;AACpB,eAAKvG,UAAL,CAAgB6Q,KAAhB,CAAsBtK,MAAtB;AACD;;;iCAEQA,M,EAAgB;AACvB,eAAKvG,UAAL,CAAgB8Q,QAAhB,CAAyBvK,MAAzB;AACD;;;oCAEW;AACV,oFAAa4E,UAAb,GAA0B,KAAKxI,SAA/B;AACA,eAAK5C,UAAL,CAAgBgR,gBAAhB,CAAiC,KAAKjO,eAAtC;AACD;;;4CAEmBwD,M,EAAQ;AAC1B,cAAI,KAAKnF,iBAAL,CAAuB0D,QAAvB,CAAgCyB,MAAhC,CAAJ,EAA6C;AAC3C,iBAAKnF,iBAAL,GAAyB,KAAKA,iBAAL,CAAuB6P,MAAvB,CAA8B,UAAArS,CAAC;AAAA,qBAAIA,CAAC,KAAK2H,MAAV;AAAA,aAA/B,CAAzB;AACD,WAFD,MAEO;AACL,iBAAKnF,iBAAL,CAAuB6I,IAAvB,CAA4B1D,MAA5B;AACD;AACF;;;+CAEsBA,M,EAAQ;AAC7B,cAAI,KAAKlF,oBAAL,CAA0ByD,QAA1B,CAAmCyB,MAAnC,CAAJ,EAAgD;AAC9C,iBAAKlF,oBAAL,GAA4B,KAAKA,oBAAL,CAA0B4P,MAA1B,CAAiC,UAAArS,CAAC;AAAA,qBAAIA,CAAC,KAAK2H,MAAV;AAAA,aAAlC,CAA5B;AACD,WAFD,MAEO;AACL,iBAAKlF,oBAAL,CAA0B4I,IAA1B,CAA+B1D,MAA/B;AACD;AACF;;;+CAEsB;AAAA;;AACrB,cAAI8C,GAAG,GAAG,GAAV;AACA,cAAI6H,OAAO,GAAG,CAAd;;AACA,cAAI,KAAKjP,SAAL,KAAmB,OAAvB,EAAgC;AAC9BiP,mBAAO,GAAG,EAAV;AACD,WAFD,MAEO,IAAI,KAAKjP,SAAL,KAAmB,WAAvB,EAAoC;AACzCiP,mBAAO,GAAG,EAAV;AACD,WAFM,MAEA,IAAI,KAAKjP,SAAL,KAAmB,QAAvB,EAAiC;AACtCiP,mBAAO,GAAG,IAAV;AACD;;AAED,cAAIC,MAAM,GAAG,CAAb;AAEA,eAAK/P,iBAAL,CAAuBgI,OAAvB,CAA+B,UAAA7C,MAAM,EAAI;AACvC,gBAAIa,GAAG,GAAG,OAAI,CAAClB,MAAL,CAAYK,MAAZ,CAAV;;AACA4K,kBAAM,IAAI/J,GAAV,CAFuC,CAGvC;;AACAiC,eAAG,IAAKjC,GAAG,GAAG8J,OAAd;AACD,WALD;AAMAC,gBAAM,GAAG/K,IAAI,CAACC,KAAL,CAAW,CAAC8K,MAAM,GAAG,OAAV,IAAqB,GAAhC,IAAuC,GAAhD,CAnBqB,CAmBgC;;AACrD,iBAAOA,MAAM,GAAG,KAAT,GAAiB9H,GAAxB;AACD;;;+CAEsB;AAAA;;AACrB,cAAI+H,MAAM,GAAG,GAAb;AACA,cAAIC,IAAI,GAAG,GAAX;AACA,cAAIH,OAAO,GAAG,CAAd;AACA,cAAII,MAAM,GAAG,CAAb;;AACA,cAAI,KAAKrP,SAAL,KAAmB,OAAvB,EAAgC;AAC9BiP,mBAAO,GAAG,EAAV;AACAI,kBAAM,GAAG,EAAT;AACD,WAHD,MAGO,IAAI,KAAKrP,SAAL,KAAmB,WAAvB,EAAoC;AACzCiP,mBAAO,GAAG,EAAV;AACAI,kBAAM,GAAG,GAAT;AACD,WAHM,MAGA,IAAI,KAAKrP,SAAL,KAAmB,QAAvB,EAAiC;AACtCiP,mBAAO,GAAG,IAAV;AACAI,kBAAM,GAAG,IAAT;AACD;;AACD,cAAIzI,GAAG,GAAG,EAAV;AACA,eAAKxH,oBAAL,CAA0B+H,OAA1B,CAAkC,UAAA7C,MAAM,EAAI;AAC1C,gBAAIa,GAAG,GAAG,OAAI,CAAClB,MAAL,CAAYK,MAAZ,CAAV,CAD0C,CAE1C;;;AACAsC,eAAG,CAACoB,IAAJ,CAAS7C,GAAT;AACD,WAJD;;AAKA,cAAIyB,GAAG,CAACyE,MAAJ,KAAe,CAAnB,EAAsB;AACpB,gBAAIiE,EAAE,GAAG1I,GAAG,CAAC,CAAD,CAAZ;AACA,gBAAI2I,EAAE,GAAG3I,GAAG,CAAC,CAAD,CAAZ;AACA,gBAAI4I,KAAK,GAAGrL,IAAI,CAACwG,GAAL,CAAS2E,EAAE,GAAGC,EAAd,CAAZ;AACAH,gBAAI,GAAGI,KAAK,GAAGP,OAAf;AACAE,kBAAM,GAAG,CAACE,MAAM,GAAGG,KAAV,IAAmBP,OAA5B;AACA;;;;;AAKD;;AAED,iBAAO,CAACE,MAAD,EAASC,IAAT,CAAP;AACD;;;;;;;uBA5wCUvR,Y,EAAY,+H,EAAA,wH,EAAA,+H,EAAA,2I,EAAA,kI,EAAA,mI,EAAA,qJ,EAAA,0I;AAAA,K;;;YAAZA,Y;AAAY,+B;AAAA,gB;AAAA,c;AAAA,2yN;AAAA;AAAA;ACxCzB;;AAMI;;AACI;;AAEI;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAAmD;;AAAS;;AAChE;;AAQA;;AAA2C;AAAA,mBAAS,IAAA4R,iBAAA,EAAT;AAA4B,WAA5B;;AAA8B;;AAAU;;AAEnF;;AACI;;AAAM;;AAAwB;;AAC9B;;AACJ;;AAEA;;AACI;;AACA;;AAEJ;;AAEJ;;AAEA;;AACI;;AACJ;;AACA;;AACI;;AACI;;AACI;;AACI;;AAAuB;;AAAK;;AAC5B;;AAAI;;AAAuB;;AAC/B;;AACR;;AANA;;AAOJ;;AAEA;;AACI;;AACI;;AACI;;AACI;;AAAuB;;AAAG;;AAC1B;;AAAI;;AAAyB;;AACjC;;AACJ;;AACJ;;AACJ;;AAEA;;AACI;;AACI;;AACI;;AACI;;AAAuB;;AAAiC;;AACxD;;AAAI;;AAA0B;;AAClC;;AACJ;;AACJ;;AACJ;;AAgBJ;;AAKA;;AAEA;;AAAmE;AAAA,mBAAS,IAAArF,UAAA,EAAT;AAAqB,WAArB;;AAAuB;;AAAW;;AACrG;;AAAM;;AAAqG;;AAE3G;;AACI;;AACI;;AACI;;AAA+B;;AAAS;;AACxC;;AAAwB;;AAAC;;AACzB;;AACI;;AACA;;AAIE;;AACF;;AACJ;;AACA;;AAAwB;;AAAC;;AACzB;;AACI;;AACA;;AAIE;;AACF;;AACJ;;AACA;;AAAwB;;AAAC;;AACzB;;AACI;;AACA;;AAIE;;AACF;;AACJ;;AACA;;AAAwB;;AAAC;;AACzB;;AACI;;AACA;;AAIE;;AACF;;AACJ;;AACA;;AACI;;AACI;;AAA0D;;AAAI;;AAC9D;;AAAqC;AAAA;AAAA;;AAArC;;AACJ;;AACA;;AAAsG;AAAA,mBAAS,IAAAsF,YAAA,EAAT;AAAuB,WAAvB;;AAAyB;;AAAa;;AAChJ;;AAEJ;;AACA;;AACI;;AACI;;AAEI;;AACA;;AAAgB;;AAAM;;AACtB;;AAAgB;;AAAI;;AACpB;;AAAgB;;AAAM;;AACtB;;AAAgB;;AAAM;;AACtB;;AAAgB;;AAAO;;AACvB;;AAAgB;;AAAG;;AACnB;;AAAgB;;AAAG;;AACnB;;AACJ;;AACJ;;AACA;;AAqCJ;;AA2EJ;;AAEA;;AACI;;AACI;;AACI;;AAA+B;;AAAM;;AACrC;;AACI;;AAAuD;;AAAI;;AAC3D;;AAAgC;AAAA;AAAA;;AAAhC;;AACJ;;AACJ;;AACJ;;AACA;;AACI;;AACI;;AACI;;AAAgB;;AAAM;;AACtB;;AAAgB;;AAAM;;AACtB;;AAAgB;;AAAG;;AACnB;;AAAgB;;AAAG;;AACnB;;AAAgB;;AAAI;;AACpB;;AAAgB;;AAAK;;AACrB;;AAAgB;;AAAI;;AACpB;;AAAgB;;AAAK;;AACrB;;AAAgB;;AAAI;;AACpB;;AAAgB;;AAAO;;AAC3B;;AACJ;;AACA;;AAcJ;;AACJ;;AACJ;;AAEA;;AAEA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAA4D;;AAAqB;;AACrF;;AAEA;;AAEA;;AACI;;AAEI;;AACI;;AACJ;;AAEA;;AAEI;;AACI;;AAAwD;;AAAM;;AAC9D;;AAAgE;AAAA;AAAA;;AAAhE;;AACJ;;AAEA;;AACI;;AAAmD;;AAAa;;AAChE;;AAAsD;AAAA;AAAA;;AAAtD;;AACJ;;AAEA;;AACI;;AAA0D;;AAAW;;AACrE;;AAAqC;AAAA;AAAA;;AAA+D;;AACxG;;AAEA;;AACI;;AAAwD;;AAAS;;AACjE;;AAAgE;AAAA;AAAA;;AAAhE;;AACJ;;AAEA;;AACI;;AAAsD;;AAAO;;AAC7D;;AAA4D;AAAA;AAAA;;AAA5D;;AACJ;;AAEA;;AACI;;AAA0D;;AAAW;;AACrE;;AAAoE;AAAA;AAAA;;AAApE;;AACJ;;AAEA;;AAA2C;AAAA,mBAAS,IAAAC,eAAA,EAAT;AAA0B,WAA1B;;AAA4B;;AAAgB;;AACvF;;AAA2C;AAAA,mBAAS,IAAAC,gBAAA,EAAT;AAA2B,WAA3B;;AAA6B;;AAAM;;AAElF;;AAEJ;;AACJ;;AAEA;;AACI;;AAEI;;AACI;;AACJ;;AAEA;;AAEI;;AAAK;;AAAqG;;AAC1G;;AACI;;AACI;;AACI;;AAA+B;;AAAK;;AACpC;;AAA+B;;AAAG;;AAElC;;AAAI;AAAA,mBAAS,IAAAC,eAAA,CAAgB,MAAhB,CAAT;AAAgC,WAAhC;;AAA6D;;AAAG;;AACpE;;AAAI;AAAA,mBAAS,IAAAA,eAAA,CAAgB,MAAhB,CAAT;AAAgC,WAAhC;;AAA6D;;AAAG;;AACpE;;AAAI;AAAA,mBAAS,IAAAA,eAAA,CAAgB,MAAhB,CAAT;AAAgC,WAAhC;;AAA6D;;AAAG;;AACpE;;AAAI;AAAA,mBAAS,IAAAA,eAAA,CAAgB,QAAhB,CAAT;AAAkC,WAAlC;;AAA+D;;AAAG;;AACtE;;AAAI;AAAA,mBAAS,IAAAA,eAAA,CAAgB,WAAhB,CAAT;AAAqC,WAArC;;AAAkE;;AAAM;;AAC5E;;AAAI;AAAA,mBAAS,IAAAA,eAAA,CAAgB,MAAhB,CAAT;AAAgC,WAAhC;;AAA6D;;AAAI;;AACrE;;AAAI;AAAA,mBAAS,IAAAA,eAAA,CAAgB,SAAhB,CAAT;AAAmC,WAAnC;;AAAgE;;AAAO;;AAC3E;;AAAI;AAAA,mBAAS,IAAAA,eAAA,CAAgB,YAAhB,CAAT;AAAsC,WAAtC;;AAAmE;;AAAU;;AACrF;;AACJ;;AACA;;AACI;;AAaJ;;AACJ;;AAEA;;AAA2C;AAAA,mBAAS,IAAAC,WAAA,EAAT;AAAsB,WAAtB;;AAAwB;;AAAiB;;AACpF;;AAA2C;AAAA,mBAAS,IAAArC,YAAA,EAAT;AAAuB,WAAvB;;AAAyB;;AAAI;;AACxE;;AAA2C;AAAA,mBAAS,IAAAC,cAAA,EAAT;AAAyB,WAAzB;;AAA2B;;AAAQ;;AAC9E;;AAA2C;AAAA,mBAAS,IAAAC,cAAA,EAAT;AAAyB,WAAzB;;AAA2B;;AAAe;;AAEzF;;AAEJ;;AACJ;;AAEA;;AAwBA;;AAEA;;AAEA;;AASI;;AAAuD;AAAA;AAAA;;AACnD;;AAAsB;;AAAK;;AAC3B;;AAA0B;;AAAS;;AACnC;;AAAuB;;AAAM;;AACjC;;AACA;;AAAuG;AAAA;AAAA;;AAAvG;;AAEA;;AAA2E;;AAAQ;;AACnF;;AACI;;AACE;;AAA8B;;AAAI;;AACpC;;AACA;;AAAO;AAAA;AAAA;;AAAP;;AACJ;;AACA;;AACI;;AACE;;AAA8B;;AAAK;;AACrC;;AACA;;AAAO;AAAA;AAAA;;AAAP;;AACJ;;AACA;;AACI;;AACE;;AAA8B;;AAAI;;AACpC;;AACA;;AAAO;AAAA;AAAA;;AAAP;;AACJ;;AACA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAAwD;;AAAU;;AACtE;;AACA;;AAAgG;;AAAc;;AAC9G;;AACI;;AACE;;AAA8B;;AAAM;;AACtC;;AACA;;AAAO;AAAA;AAAA;;AAAP;;AACJ;;AACA;;AACI;;AACE;;AAA8B;;AAAK;;AACrC;;AACA;;AAAO;AAAA;AAAA;;AAAP;;AACJ;;AACA;;AACI;;AACE;;AAA8B;;AAAQ;;AACxC;;AACA;;AAAO;AAAA;AAAA;;AAAP;;AACJ;;AACA;;AAAuD;AAAA,mBAAS,IAAAtJ,aAAA,EAAT;AAAwB,WAAxB;;AAA0B;;AAAM;;AACvF;;AAA4D;AAAA,mBAAS,IAAA0L,OAAA,EAAT;AAAkB,WAAlB;;AAAoB;;AAAK;;AAErF;;AACI;;AACI;;AACI;;AAA4B;;AAAK;;AACjC;;AACA;;AAA4B;;AAAI;;AACpC;;AACA;;AACI;;AAGA;;AAA+B;;AAAM;;AAErC;;AAA+B;;AAAK;;AACpC;;AAA+B;;AAAG;;AAClC;;AAAoC;;AAAM;;AAC1C;;AAA+B;;AAAG;;AAClC;;AAA+B;;AAAK;;AAEpC;;AAA+B;;AAAM;;AAGrC;;AACJ;;AACJ;;AACA;;AACI;;AAmEJ;;AACJ;;AAEA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAA6D;;AAAQ;;AACzE;;AACA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAA2D;;AAAM;;AACrE;;AAEA;;AACI;;AAAM;;AAAyD;;AACnE;;AAEA;;AACI;;AAAM;;AAAmG;;AAC7G;;AACJ;;AACJ;;AAEA;;;;AA9mBgD;;AAAA;;AAa1B;;AAAA;;AACE;;AAAA;;AAIF;;AAAA;;AACA;;AAAA;;AAOV;;AAAA;;AAOgB;;AAAA;;AAUA;;AAAA;;AAUmB;;AAAA;;AACnB;;AAAA;;AA4BlB;;AAAA;;AASgB;;AAAA;;AAIJ;;AAAA;;AAMI;;AAAA;;AAIJ;;AAAA;;AAMI;;AAAA;;AAIJ;;AAAA;;AAMI;;AAAA;;AAIJ;;AAAA;;AAMuC;;AAAA;;AAEjC;;AAAA;;AAmBL;;AAAA;;AAwHiC;;AAAA;;AAmBjC;;AAAA;;AAqBiB;;AAAA;;AAiB4C;;AAAA;;AAKV;;AAAA;;AAKjB;;AAAA;;AAK2B;;AAAA;;AAKJ;;AAAA;;AAKQ;;AAAA;;AAoBnE;;AAAA;;AAkBO;;AAAA;;AA0BuC;;AAAA;;AAqCJ;;AAAA;;AAKgD;;AAAA;;AAO5F;;AAAA;;AAMA;;AAAA;;AAMA;;AAAA;;AAGyB;;AAAA,qGAA+B,UAA/B,EAA+B,IAA/B;;AAQzB;;AAAA;;AAMA;;AAAA;;AAMA;;AAAA;;AA+BC;;AAAA;;AAuEwB;;AAAA;;AAIA;;AAAA;;AAK1B;;AAAA;;AAIA;;AAAA;;;;;;;;;sED3kBLlS,Y,EAAY;cALxB,uDAKwB;eALd;AACTmS,kBAAQ,EAAE,UADD;AAETC,qBAAW,EAAE,sBAFJ;AAGTC,mBAAS,EAAE,CAAC,sBAAD;AAHF,S;AAKc,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AExCzB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAiCaC,S;;;;;YAAAA,S;AAAS,kBAFR,2DAEQ;;;;yBAATA,S;AAAS,O;AAAA,iBAHT,CAAC,uDAAD,EAAa,kEAAb,C;AAA0B,gBAZ5B,CACP,4DADO,EAEP,uEAFO,EAGP,oEAHO,EAIP,qEAJO,EAKP,0DALO,EAMP,kEANO,EAOP,+DAPO,CAY4B;;;;0HAG1BA,S,EAAS;AAAA,uBAjBlB,2DAiBkB;AAjBN,kBAGZ,4DAHY,EAIZ,uEAJY,EAKZ,oEALY,EAMZ,qEANY,EAOZ,0DAPY,EAQZ,kEARY,EASZ,+DATY;AAiBM,O;AARP,K;;;;;sEAQFA,S,EAAS;cAnBrB,sDAmBqB;eAnBZ;AACRC,sBAAY,EAAE,CACZ,2DADY,CADN;AAIRxS,iBAAO,EAAE,CACP,4DADO,EAEP,uEAFO,EAGP,oEAHO,EAIP,qEAJO,EAKP,0DALO,EAMP,kEANO,EAOP,+DAPO,CAJD;;AAaR;;;AAGAyS,mBAAS,EAAE,CAAC,uDAAD,EAAa,kEAAb,CAhBH;AAiBRC,mBAAS,EAAE,CAAC,2DAAD;AAjBH,S;AAmBY,Q;;;;;;;;;;;;;;;;;;ACjCtB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAeaC,U;AAQX,0BACUC,IADV,EAEUC,YAFV,EAGUC,gBAHV,EAIUvS,YAJV,EAKUC,OALV,EAMUH,gBANV,EAOUD,UAPV,EAOgC;AAAA;;AANtB,aAAAwS,IAAA,GAAAA,IAAA;AACA,aAAAC,YAAA,GAAAA,YAAA;AACA,aAAAC,gBAAA,GAAAA,gBAAA;AACA,aAAAvS,YAAA,GAAAA,YAAA;AACA,aAAAC,OAAA,GAAAA,OAAA;AACA,aAAAH,gBAAA,GAAAA,gBAAA;AACA,aAAAD,UAAA,GAAAA,UAAA;AAbH,aAAAqE,mBAAA,GAAoC,IAAI,4CAAJ,EAApC;AACA,aAAA4I,YAAA,GAA6B,IAAI,4CAAJ,EAA7B;AACA,aAAAC,WAAA,GAA4B,IAAI,4CAAJ,EAA5B;AACP,aAAAtK,IAAA,GAAO,CAAP;AACA,aAAAC,QAAA,GAAW,CAAX;AAUK;;;;2CAEctC,Y,EAAe;AAChC,cAAI,0EAAa4K,UAAb,KAA4B,WAAhC,EAA6C;AAC3C,iBAAKuH,gBAAL,CAAsBtH,kBAAtB,CAAyC7K,YAAzC;AACD,WAFD,MAEO,IAAI,0EAAa4K,UAAb,KAA4B,OAAhC,EAAyC;AAC9C,mBAAO,KAAKhL,YAAL,CAAkBiL,kBAAlB,EAAP;AACD;AACF;;;iCAEQ/F,M,EAAQkB,M,EAAQC,I,EAAMb,M,EAAQwB,G,EAA4D;AAAA,cAAvDwL,iBAAuD,uEAAnC,KAAmC;AAAA,cAA5BC,mBAA4B,uEAAN,IAAM;AAEjG;AACA;AACA,cAAInM,WAAW,GAAG,IAAIb,IAAJ,CAASD,MAAT,CAAlB;;AACA,cAAIN,MAAM,KAAK,QAAf,EAAyB;AACvBoB,uBAAW,CAACC,QAAZ,CAAqB,EAArB,EAAyB,EAAzB,EAA6B,CAA7B;AACD,WAFD,MAEO;AACLD,uBAAW,CAACC,QAAZ,CAAqB,EAArB,EAAyB,EAAzB,EAA6B,CAA7B;AACD;;AAED,cAAImM,QAAQ,GAAG,IAAIjN,IAAJ,EAAf;;AACA,cAAI+M,iBAAJ,EAAuB;AACrBE,oBAAQ,GAAGD,mBAAX;AACD,WAdgG,CAejG;;;AAEA,cAAIE,OAAO,GAAG3M,IAAI,CAAC4M,KAAL,CAAW,CAACtM,WAAW,CAACwJ,OAAZ,KAAwB4C,QAAQ,CAAC5C,OAAT,EAAzB,IAA+C,IAA1D,CAAd;AACA,cAAI+C,OAAO,GAAG7M,IAAI,CAAC4M,KAAL,CAAWD,OAAO,GAAG,EAArB,CAAd;AACA,cAAIG,KAAK,GAAG9M,IAAI,CAAC4M,KAAL,CAAWC,OAAO,GAAG,EAArB,CAAZ;AACA,cAAIE,OAAO,GAAI/M,IAAI,CAAC4M,KAAL,CAAWE,KAAK,GAAG,EAAnB,CAAD,GAA2B,KAAzC,CApBiG,CAoBjD;;AAEhD,cAAItM,UAAU,GAAG,SAAjB;;AACA,cAAItB,MAAM,KAAK,WAAf,EAA4B;AAC1BsB,sBAAU,GAAG,WAAb;AACD,WAFD,MAEO,IAAItB,MAAM,KAAK,QAAf,EAAyB;AAC9BsB,sBAAU,GAAG,YAAb;AACD;;AACD,cAAIX,IAAI,GAAG,KAAKC,MAAL,CAAYU,UAAZ,CAAX,CA5BiG,CA8BjG;;AACA,cAAIC,SAAS,GAAGO,GAAhB;AAEA,cAAIN,MAAM,GAAG,IAAb;;AACA,cAAIL,IAAI,KAAK,IAAb,EAAmB;AACjBK,kBAAM,GAAG,qEAAsBC,EAA/B;AACD;;AACD,cAAIN,IAAI,KAAK,IAAb,EAAmB;AACjBK,kBAAM,GAAG,qEAAsBE,EAA/B;AACD;;AAED,cAAIC,EAAE,GAAG,KAAKC,WAAL,CAAiB5B,MAAjB,EAAyBW,IAAzB,EAA+BO,MAA/B,EAAuC,0EAAaW,aAApD,EAAmET,WAAnE,EAAgFI,MAAhF,EAAwFD,SAAxF,CAAT;AACA,cAAIuM,IAAI,GAAGnM,EAAE,GAAG,GAAhB;AACA,cAAIoM,QAAQ,GAAG,0EAAalM,aAAb,GAA6B,GAA5C,CA3CiG,CA6CjG;;AAEA,cAAImM,EAAE,GAAG,CAAClN,IAAI,CAAC/B,GAAL,CAAS4B,IAAI,GAAGO,MAAhB,IAA0B,CAAC6M,QAAQ,GAAIjN,IAAI,CAACmN,GAAL,CAASH,IAAT,EAAe,CAAf,IAAoB,CAAjC,IAAuCD,OAAlE,KAA8EC,IAAI,GAAGhN,IAAI,CAACoN,IAAL,CAAUL,OAAV,CAArF,CAAT;AACA,cAAI9L,KAAK,GAAG,CAAZ;;AACA,cAAIZ,IAAI,KAAK,IAAb,EAAmB;AACjBY,iBAAK,GAAG,KAAKoM,MAAL,CAAYH,EAAZ,CAAR;AACD,WAFD,MAEO,IAAI7M,IAAI,KAAK,IAAb,EAAmB;AACxBY,iBAAK,GAAG,KAAKoM,MAAL,CAAYH,EAAZ,IAAkB,CAA1B;AACD;;AACDjM,eAAK,GAAGjB,IAAI,CAACC,KAAL,CAAW,CAACgB,KAAK,GAAG,OAAT,IAAoB,GAA/B,IAAsC,GAA9C;AACA,iBAAOA,KAAP;AACD;;;+BAEMb,M,EAAkC;AAAA,cAAlBkK,SAAkB,uEAAN,IAAM;;AACvC;AAEA,cAAIlK,MAAM,KAAK,YAAf,EAA6B;AAC3B,gBAAIjB,UAAU,GAAS,0EAAaoF,wBAAb,CAAsC,0EAAaC,IAAb,GAAoB,0EAAarD,gBAAvE,CAAvB;AACA,gBAAIkJ,WAAW,GAAG,IAAlB;;AACA,gBAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AACpC0K,yBAAW,GAAG,GAAd;AACD,aAFD,MAEO,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA;AACLA,yBAAW,GAAGlL,UAAU,CAACQ,QAAX,KAAwB,CAAtC;AACD;;AACD,gBAAIH,MAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAA0C2K,WAA1C,GAAyD,CAAC,MAAMlL,UAAU,CAACS,OAAX,EAAP,EAA6BqE,KAA7B,CAAmC,CAAC,CAApC,CAAtE;AACA7D,kBAAM,GAAG,WAAWZ,MAAX,GAAoB,0EAAa2B,gBAAjC,GAAoD,KAA7D,CAb2B,CAc3B;AACD;;AAED,cAAIH,GAAG,GAAG,KAAKnH,UAAL,CAAgBiG,MAAhB,CAAuBM,MAAvB,CAAV;;AACA,cAAIkK,SAAJ,EAAe;AACbA,qBAAS,CAACtJ,GAAV,GAAgBA,GAAhB;AACD;;AAED,iBAAOA,GAAP;AACD,S,CAED;;;;wCACgBsM,M,EAAQC,M,EAAQ;AAE9B;AAEA;AACA,cAAIC,KAAK,GAAG,CAAZ;AACA,cAAIC,OAAO,GAAG,IAAIhO,IAAJ,CAAS6N,MAAM,CAACxD,OAAP,EAAT,CAAd;;AACA,iBAAO2D,OAAO,IAAIF,MAAlB,EAA0B;AACtB,gBAAIG,SAAS,GAAGD,OAAO,CAACE,MAAR,EAAhB;;AACA,gBAAGD,SAAS,KAAK,CAAd,IAAmBA,SAAS,KAAK,CAApC,EAAuC;AACrCF,mBAAK;AACN;;AACDC,mBAAO,CAACG,OAAR,CAAgBH,OAAO,CAAC7N,OAAR,KAAoB,CAApC;AACH;;AACD,iBAAO4N,KAAK,GAAG,CAAf;AAEA;;;;;;;;;;;;;;;;;;;AAuBD;;;oCAGWtO,M,EAAQW,I,EAAMO,M,EAAQ6M,Q,EAAUY,W,EAAaxN,I,EAAMI,S,EAAW;AACxE,cAAIqN,IAAI,GAAG,EAAX;AACA,cAAIC,GAAG,GAAG,CAAV;AACA,cAAIlN,EAAE,GAAG,CAAT;AAEA;;;AAGA;;;;;;;;;;AAYA,iBAAQiN,IAAI,GAAGC,GAAR,GAAe,MAAtB,EAA8B;AAC5B,gBAAI,KAAKC,kBAAL,CAAwB9O,MAAxB,EAAgCW,IAAhC,EAAsCO,MAAtC,EAA8C6M,QAA9C,EAAwDY,WAAxD,EAAqE,CAACC,IAAI,GAAGC,GAAR,IAAe,CAApF,EAAuF1N,IAAvF,IAA+FI,SAAnG,EAA8G;AAC5GqN,kBAAI,GAAG,CAACA,IAAI,GAAGC,GAAR,IAAe,CAAtB;AACD,aAFD,MAEO;AACLA,iBAAG,GAAG,CAACD,IAAI,GAAGC,GAAR,IAAe,CAArB;AACD;AACF;;AACDlN,YAAE,GAAG,CAACiN,IAAI,GAAGC,GAAR,IAAe,CAApB;AACA,iBAAOlN,EAAP;AACD;;;2CAEkB3B,M,EAAQW,I,EAAMO,M,EAAQ6M,Q,EAAUY,W,EAAaI,U,EAAY5N,I,EAAM6N,Q,EAAW;AAC3F,cAAIC,EAAE,GAAG,CAAT;AACA,cAAI7N,WAAW,GAAG,IAAIb,IAAJ,CAASoO,WAAT,CAAlB;;AACA,cAAI3O,MAAM,KAAK,QAAf,EAAyB;AACvBoB,uBAAW,CAACC,QAAZ,CAAqB,EAArB,EAAyB,EAAzB,EAA6B,CAA7B;AACD,WAFD,MAEO;AACLD,uBAAW,CAACC,QAAZ,CAAqB,EAArB,EAAyB,EAAzB,EAA6B,CAA7B;AACD;;AAED,cAAI,CAAC2N,QAAL,EAAe;AACbA,oBAAQ,GAAG,CAAX;AACD;;AAED,cAAIxB,QAAQ,GAAG,IAAIjN,IAAJ,EAAf;AACAiN,kBAAQ,CAACkB,OAAT,CAAiBlB,QAAQ,CAAC9M,OAAT,KAAqBsO,QAAtC;AAEA,cAAIE,SAAS,GAAG,KAAKC,eAAL,CAAqB3B,QAArB,EAA+BpM,WAA/B,CAAhB;AACA,cAAIqM,OAAO,GAAGyB,SAAS,GAAG,KAA1B,CAjB2F,CAmB3F;;AACA,cAAIvB,OAAO,GAAG7M,IAAI,CAAC4M,KAAL,CAAWD,OAAO,GAAG,EAArB,CAAd;AACA,cAAIG,KAAK,GAAG9M,IAAI,CAAC4M,KAAL,CAAWC,OAAO,GAAG,EAArB,CAAZ;AACA,cAAIE,OAAO,GAAI/M,IAAI,CAAC4M,KAAL,CAAWE,KAAK,GAAG,EAAnB,CAAD,GAA2B,KAAzC,CAtB2F,CAsB3C;;AAEhD,cAAIA,KAAK,GAAG,EAAZ,EAAgB;AACd,mBAAO,CAAP;AACD,WAFD,MAGK;AACH,gBAAIE,IAAI,GAAGiB,UAAU,GAAG,GAAxB;AACAhB,oBAAQ,GAAGA,QAAQ,GAAG,GAAtB;AAEA,gBAAIC,EAAE,GAAG,CAAClN,IAAI,CAAC/B,GAAL,CAAS4B,IAAI,GAAGO,MAAhB,IAA0B,CAAC6M,QAAQ,GAAIjN,IAAI,CAACmN,GAAL,CAASH,IAAT,EAAe,CAAf,IAAoB,CAAjC,IAAuCD,OAAlE,KAA8EC,IAAI,GAAGhN,IAAI,CAACoN,IAAL,CAAUL,OAAV,CAArF,CAAT,CAJG,CAKH;;AACA,gBAAIuB,EAAE,GAAGpB,EAAE,GAAIF,IAAI,GAAGhN,IAAI,CAACoN,IAAL,CAAUL,OAAV,CAAtB;AAEA,gBAAIwB,SAAS,GAAInO,MAAD,GAAWJ,IAAI,CAACwO,GAAL,CAAS,CAAC,CAAD,GAAKvB,QAAL,GAAgBF,OAAzB,CAA3B;;AAEA,gBAAI1M,IAAI,KAAK,qEAAsBM,EAAnC,EAAuC;AACrCwN,gBAAE,GAAGtO,IAAI,GAAG,KAAKwN,MAAL,CAAYH,EAAZ,CAAP,GAAyBqB,SAAS,GAAG,KAAKlB,MAAL,CAAYiB,EAAZ,CAA1C;AACD;;AAED,gBAAIjO,IAAI,KAAK,qEAAsBO,EAAnC,EAAuC;AACrCuN,gBAAE,GAAGI,SAAS,GAAG,KAAKlB,MAAL,CAAY,CAAC,CAAD,GAAKiB,EAAjB,CAAZ,GAAmCzO,IAAI,GAAG,KAAKwN,MAAL,CAAY,CAAC,CAAD,GAAKH,EAAjB,CAA/C;AACD;AACF;;AACD,iBAAOiB,EAAP;AACD;;;+BAEMM,C,EAAG;AACR,cAAIC,iBAAiB,GAAG1O,IAAI,CAACoN,IAAL,CAAU,KAAK1Q,QAAf,CAAxB;AACA,iBAAO,MAAM,KAAKiS,IAAL,CAAU,EAAEF,CAAC,GAAG,KAAKhS,IAAX,KAAoBiS,iBAAiB,GAAG1O,IAAI,CAACoN,IAAL,CAAU,CAAV,CAAxC,CAAV,CAAb;AACD,S,CAED;AACA;;;;6BACKqB,C,EAAG;AACN,cAAIG,CAAC,GAAG5O,IAAI,CAACwG,GAAL,CAASiI,CAAT,CAAR;AACA,cAAII,CAAC,GAAG,KAAK,IAAID,CAAC,GAAG,CAAb,CAAR;AACA,cAAIvF,CAAC,GAAGwF,CAAC,GAAG7O,IAAI,CAACwO,GAAL,CAAS,CAACI,CAAD,GAAKA,CAAL,GAAS,UAAT,GAAsBC,CAAC,IAAI,aACxCA,CAAC,IAAI,aAAaA,CAAC,IAAI,aAAaA,CAAC,IAAI,CAAC,UAAD,GACzCA,CAAC,IAAI,aAAaA,CAAC,IAAI,CAAC,UAAD,GAAcA,CAAC,IAAI,aAC1CA,CAAC,IAAI,CAAC,UAAD,GAAcA,CAAC,GAAG,UAAtB,CADqC,CAAnB,CAAlB,CADoC,CAAlB,CAAlB,CADmC,CAAhC,CAAZ;AAIA,iBAAOJ,CAAC,IAAI,CAAL,GAASpF,CAAT,GAAa,IAAIA,CAAxB;AACD;;;kCAEShJ,I,EAAI;AACZ,cAAIyO,YAAY,GAAG,EAAnB;;AACA,cAAI,0EAAanQ,YAAb,KAA8B,KAAlC,EAAyC;AACvCmQ,wBAAY,GAAG,KAAf;AACD;;AACD,cAAIC,KAAK,GAAG,IAAIC,KAAJ,EAAZ;;AACA,cAAI3O,IAAI,KAAK,SAAb,EAAwB;AACtB0O,iBAAK,CAACE,GAAN,GAAYH,YAAY,GAAG,kCAA3B;AACD,WAFD,MAEO,IAAIzO,IAAI,KAAK,OAAb,EAAsB;AAC3B0O,iBAAK,CAACE,GAAN,GAAYH,YAAY,GAAG,0BAA3B;AACD,WAFM,MAEA,IAAIzO,IAAI,KAAK,MAAb,EAAqB;AAC1B0O,iBAAK,CAACE,GAAN,GAAYH,YAAY,GAAG,0BAA3B;AACD;;AACDC,eAAK,CAACG,IAAN;AACAH,eAAK,CAACI,IAAN;AACD;;;4BAEGC,U,EAAY;AACd,cAAIC,WAAW,GAAG,EAAlB;AAEA,cAAIC,GAAG,GAAGF,UAAV;AACA,iBAAO,KAAK/C,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,CAAP;AACD;;;yCAEgBnQ,M,EAAawF,K,EAAOsC,qB,EAAuBwI,Q,EAAW;AACrE,cAAIC,QAAQ,GAAQ,IAAIC,QAAJ,EAApB;AACAD,kBAAQ,CAACE,MAAT,CAAgB,QAAhB,EAA0B,WAA1B;AACA;;;;;;;;AASA;;AAEA,eAAK,IAAI1I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,qBAAqB,CAACE,MAA1C,EAAkDD,CAAC,EAAnD,EAAuD;AACrD,gBAAIE,OAAO,GAAGH,qBAAqB,CAACC,CAAD,CAAnC;AACA;;;;;;;AAOA;AACA;;AAEA,gBAAIE,OAAO,CAACG,IAAR,KAAiB,IAAjB,IAAyBH,OAAO,CAACG,IAAR,KAAiB,CAA9C,EAAiD;AAC/C,kBAAIsI,UAAU,GAAGzI,OAAO,CAAC7D,KAAR,CAAcW,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB,CAAjB,CAD+C,CACF;;AAC7C,kBAAI5D,IAAI,GAAG,EAAX;;AACA,kBAAI8G,OAAO,CAAC7D,KAAR,CAAc5E,QAAd,CAAuB,IAAvB,CAAJ,EAAkC;AAChC2B,oBAAI,GAAG,IAAP;AACD;;AACD,kBAAI8G,OAAO,CAAC7D,KAAR,CAAc5E,QAAd,CAAuB,IAAvB,CAAJ,EAAkC;AAChC2B,oBAAI,GAAG,IAAP;AACD;;AACD,kBAAIwP,KAAK,GAAG,MAAZ;;AACA,kBAAI1I,OAAO,CAAC5B,GAAR,GAAc,CAAlB,EAAqB;AACnBsK,qBAAK,GAAG,KAAR;AACD;;AAED,kBAAIC,IAAI,GAAG,KAAX;;AACA,kBAAIN,QAAQ,CAAC9Q,QAAT,CAAkB,OAAlB,CAAJ,EAAgC;AAC9BoR,oBAAI,GAAG,KAAP;AACD;;AAED,kBAAIC,WAAW,GAAG,IAAlB;;AACA,kBAAIP,QAAQ,KAAK,OAAjB,EAA0B;AACxBO,2BAAW,GAAG,CAAd;AACD,eAFD,MAEO,IAAIP,QAAQ,KAAK,WAAjB,EAA8B;AACnCO,2BAAW,GAAG,CAAd;AACD;;AAED,kBAAIzM,KAAK,GAAGpE,MAAM,GAAG,0EAAasF,IAAtB,GAA6BE,KAAzC;AAEA+K,sBAAQ,CAACE,MAAT,CAAgB,YAAhB,EAA8BG,IAA9B;AACAL,sBAAQ,CAACE,MAAT,CAAgB,WAAhB,EAA6B,KAA7B;AACAF,sBAAQ,CAACE,MAAT,CAAgB,SAAhB,EAA2BrM,KAA3B;AACAmM,sBAAQ,CAACE,MAAT,CAAgB,eAAhB,EAAiCtP,IAAjC;AACAoP,sBAAQ,CAACE,MAAT,CAAgB,gBAAhB,EAAkCC,UAAlC;AACAH,sBAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAyB3P,IAAI,CAACwG,GAAL,CAASW,OAAO,CAAC5B,GAAjB,IAAwBwK,WAAjD;AACAN,sBAAQ,CAACE,MAAT,CAAgB,SAAhB,EAA2BE,KAA3B;AACD;AAEF;AAED;;;AAGA;;;AAEA,iBAAO,KAAKxD,IAAL,CAAU2D,IAAV,CAAe,4CAAf,EAA6DP,QAA7D,CAAP;AAA8E;;;;AAI/E;;;0CAEiBQ,O,EAAS;AACzB,cAAI,0EAAajL,UAAb,KAA4B,WAAhC,EAA6C;AAC3C,iBAAKuH,gBAAL,CAAsB1H,iBAAtB,CAAwCoL,OAAxC;AACD,WAFD,MAEO,IAAI,0EAAajL,UAAb,KAA4B,OAAhC,EAAyC;AAC9C,iBAAKhL,YAAL,CAAkB6K,iBAAlB,CAAoCoL,OAApC;AACD;AACF;;;yCAEgB7V,Y,EAAe;AAC9B,cAAI,0EAAa4K,UAAb,KAA4B,WAAhC,EAA6C;AAC3C,iBAAKuH,gBAAL,CAAsB3B,gBAAtB,CAAuCxQ,YAAvC;AACD,WAFD,MAEO,IAAI,0EAAa4K,UAAb,KAA4B,OAAhC,EAAyC;AAC9C,iBAAKhL,YAAL,CAAkBkW,UAAlB;AACD;AACF;;;4CAEmB;AAClB,cAAI,0EAAalL,UAAb,KAA4B,WAAhC,EAA6C;AAC3C,mBAAO,KAAKlL,gBAAL,CAAsBoL,iBAAtB,EAAP;AACD,WAFD,MAEO,IAAI,0EAAaF,UAAb,KAA4B,OAAhC,EAAyC;AAC9C,mBAAO,KAAK/K,OAAL,CAAaiL,iBAAb,EAAP;AACD;AACF;;;+BAEM;AACL,cAAI,0EAAahC,QAAb,KAA0B,OAA9B,EAAuC;AACrC,mBAAO,KAAKoJ,YAAL,CAAkBlL,IAAlB,EAAP;AACD;AACF;;;oCAEW9G,S,EAAW6V,K,EAAO;AAC5B,cAAI,0EAAajN,QAAb,KAA0B,OAA9B,EAAuC;AACrC,mBAAO,KAAKoJ,YAAL,CAAkB3K,WAAlB,CAA8BrH,SAA9B,EAAyC6V,KAAzC,CAAP;AACD;AACF;;;iCAEQ/V,Y,EAAc;AACrB,cAAI,0EAAa8I,QAAb,KAA0B,OAA9B,EAAuC;AACrC,mBAAO,KAAKoJ,YAAL,CAAkBvK,QAAlB,CAA2B3H,YAA3B,CAAP;AACD;AACF;;;qCAEYA,Y,EAAc;AACzB,cAAI,0EAAa8I,QAAb,KAA0B,OAA9B,EAAuC;AACrC,mBAAO,KAAKoJ,YAAL,CAAkBhK,YAAlB,CAA+BlI,YAA/B,CAAP;AACD;AACF;;;kCAESA,Y,EAAc;AACtB,cAAI,0EAAa8I,QAAb,KAA0B,OAA9B,EAAuC;AACrC,mBAAO,KAAKoJ,YAAL,CAAkBnH,SAAlB,CAA4B/K,YAA5B,CAAP;AACD;AACF;;;mCAEUA,Y,EAAc+F,M,EAAgBoF,G,EAAamB,S,EAAmBZ,I,EACvEpC,W,EAAqBgC,U,EAAoBE,S,EAAmB;AAC5D,cAAI,0EAAa1C,QAAb,KAA0B,OAA9B,EAAuC;AACrC,gBAAIoC,KAAK,GAAG;AACV,wBAAUnF,MADA;AAEV,qBAAOoF,GAFG;AAGV,sBAAQmB,SAHE;AAIV,sBAAQZ,IAJE;AAKV,6BAAepC,WALL;AAMV,4BAAcgC,UANJ;AAOV,2BAAaE,SAPH;AAQV,8BAAgB,CARN;AASV,0BAAY,KATF;AAUV,8BAAgB,OAVN;AAWV,0BAAY,CAXF;AAYV,4BAAc;AAZJ,aAAZ;AAcA5H,mBAAO,CAACC,GAAR,CAAY,YAAYqH,KAAxB;AACA,mBAAO,KAAKgH,YAAL,CAAkB8D,WAAlB,CAA8BhW,YAA9B,EAA4CkL,KAA5C,CAAP;AACD;AACF;;;;;;;uBAzaU8G,U,EAAU,uH,EAAA,0H,EAAA,kI,EAAA,0H,EAAA,4I,EAAA,kI,EAAA,uH;AAAA,K;;;aAAVA,U;AAAU,eAAVA,UAAU,K;AAAA,kBAFT;;;;;sEAEDA,U,EAAU;cAHtB,wDAGsB;eAHX;AACViE,oBAAU,EAAE;AADF,S;AAGW,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfvB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;ACUY;;AAEI;;AACI;;AAAgC;AAAA;;AAAA;AAAA;AAAA;;AAAhC;;AACJ;;AACA;;AAA8D;AAAA;;AAAA;AAAA;AAAA;;AAC1D;;AAAwB;;AAAK;;AAC7B;;AAA0B;;AAAS;;AACnC;;AAAuB;;AAAM;;AACjC;;AACA;;AAA4B;AAAA;;AAAA;AAAA;AAAA;;AAA5B;;AACA;;AAA4B;AAAA;;AAAA;AAAA;AAAA;;AAA5B;;AACA;;AAAuC;AAAA;;AAAA;AAAA;AAAA;;AAAvC;;AACA;;AAA8D;AAAA;;AAAA;AAAA;AAAA;;AAC1D;;AAAkB;;AAAC;;AACnB;;AAAkB;;AAAC;;AACvB;;AACA;;AAAyC;AAAA;;AAAA;AAAA;AAAA;;AAAzC;;AACA;;AAAM;;AAAwB;;AAC9B;;AAA+B;;AAAkB;;AAErD;;;;;;;;AAlBwC;;AAAA;;AAE0B;;AAAA;;AAKlC;;AAAA;;AACA;;AAAA;;AACW;;AAAA;;AACuB;;AAAA;;AAIrB;;AAAA;;AACnC;;AAAA;;AACyB;;AAAA;;;;;;AAqB3B;;AACI;;AACI;;AACJ;;AACA;;AACI;;AACJ;;AACA;;AACI;;AACJ;;AACA;;AACI;;AACJ;;AASJ;;;;;;AAnBQ;;AAAA;;AAGA;;AAAA;;AAGA;;AAAA;;AAGA;;AAAA;;;;;;AAkEZ;;AACI;;AASJ;;;;;;AARQ;;AAAA,mGAA0B,QAA1B,EAA0B,sBAA1B,EAA0B,SAA1B,EAA0B,uBAA1B,EAA0B,QAA1B,EAA0B,sBAA1B,EAA0B,QAA1B,EAA0B,sBAA1B,EAA0B,WAA1B,EAA0B,oBAA1B,EAA0B,SAA1B,EAA0B,uBAA1B;;;;;;;;AAoDJ;;AACI;;AAAkE;AAAA;;AAAA;;AAAA;AAAA;;AAC9D;;AAAsB;;AAAK;;AAC3B;;AAA0B;;AAAS;;AACnC;;AAAuB;;AAAM;;AACjC;;AACA;;AAAuC;AAAA;;AAAA;;AAAA;AAAA;;AAAvC;;AACA;;AAAsC;AAAA;;AAAA;;AAAA;AAAA;;AAAtC;;AACA;;AAAkE;AAAA;;AAAA;;AAAA;AAAA;;AAC9D;;AAAoB;;AAAC;;AACrB;;AAAyB;;AAAC;;AAC9B;;AACA;;AAAgD;AAAA;;AAAA;;AAAA;AAAA;;AAAhD;;AACA;;AAA4D;AAAA;;AAAA;;AAAA;AAAA;;AAAkC;;AAAI;;AAClG;;AAA4D;AAAA;;AAAA;;AAAA,iBAAS,YAAT;AAAsC,SAAtC;;AAAwC;;AAAM;;AAC1G;;AAAwD;AAAA;;AAAA;;AAAA,+CAA+B,IAAC,GAAhC;AAAmC,SAAnC;;AAAsC;;AAAI;;AAClG;;AAAwD;AAAA;;AAAA;;AAAA,+CAA+B,GAA/B;AAAkC,SAAlC;;AAAqC;;AAAI;;AACjG;;AAAwD;AAAA;;AAAA;;AAAA,+CAA+B,IAAC,EAAhC;AAAkC,SAAlC;;AAAqC;;AAAG;;AAChG;;AAAwD;AAAA;;AAAA;;AAAA,+CAA+B,EAA/B;AAAiC,SAAjC;;AAAoC;;AAAG;;AAC/F;;AAAwD;AAAA;;AAAA;;AAAA,+CAA+B,IAAC,CAAhC;AAAiC,SAAjC;;AAAoC;;AAAE;;AAC9F;;AAAwD;AAAA;;AAAA;;AAAA,+CAA+B,CAA/B;AAAgC,SAAhC;;AAAmC;;AAAE;;AAC7F;;AAAwD;AAAA;;AAAA;;AAAA,+CAA+B,IAAC,CAAhC;AAAiC,SAAjC;;AAAoC;;AAAE;;AAC9F;;AAAwD;AAAA;;AAAA;;AAAA,+CAA+B,CAA/B;AAAgC,SAAhC;;AAAmC;;AAAE;;AAC7F;;AAAyF;AAAA;;AAAA;;AAAA;AAAA;;AAAzF;;AACA;;AAAK;;AAA2C;;AACpD;;;;;;AAxBsE;;AAAA;;AAK3B;;AAAA;;AACD;;AAAA;;AAC4B;;AAAA;;AAIlB;;AAAA;;AAY3C;;AAAA;;;;;;;;AA6BG;;AACI;;AACI;;AAAgC;AAAA;;AAAA;;AAAA;AAAA;;AAAhC;;AACA;;AAAgC;AAAA;;AAAA;;AAAA;AAAA;;AAAhC;;AACJ;;AACJ;;;;;;AAHwC;;AAAA,8FAA0B,UAA1B,EAA0B,kBAA1B;;AACA;;AAAA,oGAAgC,UAAhC,EAAgC,kBAAhC;;;;;;;;;;;;;;;;;;;;;AAJ5C;;AACI;;AASA;;AACI;;AAA0D;AAAA;;AAAA;AAAA;AAAA;;AAA1D;;AACJ;;AACA;;AACI;;AAAmC;AAAA;;AAAA;AAAA;AAAA;;AAAnC;;AACJ;;AACA;;AACI;;AAAsC;AAAA;;AAAA;AAAA;AAAA;;AAAtC;;AACJ;;AACA;;AACI;;AAAyC;AAAA;;AAAA;AAAA;AAAA;;AAAzC;;AACJ;;AACA;;AACI;;AAAwC;AAAA;;AAAA;AAAA;AAAA;;AAAxC;;AACJ;;AACA;;AACI;;AACJ;;AACA;;AACI;;AAIE;;AACF;;AACJ;;AACA;;AACI;;AAAmD;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAA6B;;AAAC;;AACrF;;AACA;;AACI;;AAAmD;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAA8B;;AAAC;;AACtF;;AACJ;;;;;;;;AA1C0D;;AAClD;;AAAA;;AAUuC;;AAAA,2FAAkB,SAAlB,EAAkB,WAAlB;;AAGJ;;AAAA;;AAGG;;AAAA;;AAGG;;AAAA;;AAGD;;AAAA;;AAGxC;;AAAA;;AAGM;;AAAA;;AAIJ;;AAAA;;;;;;AA6E1B;;AACI;;AACI;;AACI;;AASJ;;AACJ;;AAEA;;AACI;;AACI;;AASJ;;AACA;;AACI;;AASJ;;AACJ;;AACJ;;;;;;AAnCgB;;AAAA,4GAAmC,QAAnC,EAAmC,+BAAnC,EAAmC,SAAnC,EAAmC,0BAAnC,EAAmC,QAAnC,EAAmC,yBAAnC,EAAmC,QAAnC,EAAmC,sBAAnC,EAAmC,WAAnC,EAAmC,oBAAnC,EAAmC,SAAnC,EAAmC,uBAAnC;;AAcA;;AAAA,uGAA8B,QAA9B,EAA8B,0BAA9B,EAA8B,SAA9B,EAA8B,0BAA9B,EAA8B,QAA9B,EAA8B,yBAA9B,EAA8B,QAA9B,EAA8B,sBAA9B,EAA8B,WAA9B,EAA8B,oBAA9B,EAA8B,SAA9B,EAA8B,uBAA9B;;AAWA;;AAAA,uGAA8B,QAA9B,EAA8B,0BAA9B,EAA8B,SAA9B,EAA8B,0BAA9B,EAA8B,QAA9B,EAA8B,yBAA9B,EAA8B,QAA9B,EAA8B,sBAA9B,EAA8B,WAA9B,EAA8B,oBAA9B,EAA8B,SAA9B,EAA8B,uBAA9B;;;;;;;;AAmE5B;;AACI;;AACI;;AACI;;AACJ;;AACA;;AACI;;AACI;;AACI;;AAAkE;AAAA;;AAAA;;AAAA;AAAA;;AAC9D;;AAAsB;;AAAK;;AAC3B;;AAA0B;;AAAS;;AACnC;;AAAuB;;AAAM;;AACjC;;AACA;;AAAyD;AAAA;;AAAA;;AAAA;AAAA;;AAAzD;;AACA;;AAA6C;AAAA;;AAAA;;AAAA;AAAA;;AAA7C;;AAEA;;AAAkE;AAAA;;AAAA;;AAAA;AAAA;;AAC9D;;AAAsB;;AAAK;;AAC3B;;AAA0B;;AAAS;;AACnC;;AAAuB;;AAAM;;AACjC;;AACA;;AAAyD;AAAA;;AAAA;;AAAA;AAAA;;AAAzD;;AACA;;AAA6C;AAAA;;AAAA;;AAAA;AAAA;;AAA7C;;AAEA;;AAAkE;AAAA;;AAAA;;AAAA;AAAA;;AAC9D;;AAAsB;;AAAK;;AAC3B;;AAA0B;;AAAS;;AACnC;;AAAuB;;AAAM;;AACjC;;AACA;;AAAyD;AAAA;;AAAA;;AAAA;AAAA;;AAAzD;;AACA;;AAA6C;AAAA;;AAAA;;AAAA;AAAA;;AAA7C;;AAEJ;;AACA;;AACI;;AASJ;;AACJ;;AACJ;;AACJ;;AACJ;;;;;;AAvCsF;;AAAA;;AAKT;;AAAA;;AACZ;;AAAA;;AAEqB;;AAAA;;AAKT;;AAAA;;AACZ;;AAAA;;AAEqB;;AAAA;;AAKT;;AAAA;;AACZ;;AAAA;;AAKzC;;AAAA,iGAAwB,QAAxB,EAAwB,oBAAxB,EAAwB,SAAxB,EAAwB,qBAAxB,EAAwB,QAAxB,EAAwB,oBAAxB,EAAwB,QAAxB,EAAwB,oBAAxB,EAAwB,WAAxB,EAAwB,kBAAxB,EAAwB,SAAxB,EAAwB,qBAAxB;;;;;;AAcxB;;AACI;;AAEI;;AACI;;AACJ;;AAEA;;AAEI;;AACI;;AAEA;;AAGJ;;AAEJ;;AACJ;;AACJ;;;;QDxeaC,c;AAoOX,8BACU1W,UADV,EAEUC,UAFV,EAGUC,gBAHV,EAIUG,OAJV,EAKUF,YALV,EAKoC;AAAA;;AAAA;;AAJ1B,aAAAH,UAAA,GAAAA,UAAA;AACA,aAAAC,UAAA,GAAAA,UAAA;AACA,aAAAC,gBAAA,GAAAA,gBAAA;AACA,aAAAG,OAAA,GAAAA,OAAA;AACA,aAAAF,YAAA,GAAAA,YAAA;AAvOV,aAAAwW,QAAA,GAAW,IAAX;AACA,aAAAC,QAAA,GAAW,IAAX;AACA,aAAAC,QAAA,GAAW,IAAX;AACA,aAAAC,QAAA,GAAW,IAAX;AACA,aAAAC,QAAA,GAAW,IAAX;AACA,aAAAC,WAAA,GAAc,IAAd;AACA,aAAAC,UAAA,GAAa,IAAb;AACA,aAAA7J,qBAAA,GAAwB,IAAxB;AACA,aAAA7H,UAAA,GAAa,IAAb;AACA,aAAA2R,MAAA,GAAS,IAAT;AACA,aAAAC,UAAA,GAAa,IAAb;AACA,aAAAtI,SAAA,GAAY,CAAZ;AACA,aAAAG,SAAA,GAAY,CAAZ;AACA,aAAAoI,QAAA,GAAW,CAAX;AACA,aAAAC,QAAA,GAAW,CAAX;AACA,aAAAC,MAAA,GAAS,CAAT;AACA,aAAAC,MAAA,GAAS,CAAT;AACA,aAAA/B,UAAA,GAAa,EAAb,CAsNoC,CAtNnB;;AACjB,aAAAvP,IAAA,GAAO,IAAP;AACA,aAAAuR,QAAA,GAAW,IAAX;AACA,aAAAC,MAAA,GAAS,EAAT;AACA,aAAApO,GAAA,GAAM,EAAN;AACA,aAAAqO,QAAA,GAAW,EAAX;AACA,aAAApS,MAAA,GAAS,OAAT;AACA,aAAAqS,SAAA,GAAY,EAAZ;AACA,aAAA9U,IAAA,GAAO,CAAP;AACA,aAAAC,QAAA,GAAW,CAAX;AACA,aAAA8U,eAAA,GAAkB,WAAlB;AACA,aAAAhF,iBAAA,GAAoB,KAApB;AACA,aAAAiF,kBAAA,GAAqB,YAArB;AACA,aAAAC,iBAAA,GAAoB,YAApB;AACA,aAAAjF,mBAAA,GAAsB,IAAIhN,IAAJ,EAAtB;AACA,aAAAkS,eAAA,GAAkB,KAAlB;AACA,aAAAC,gBAAA,GAAmB,CAAnB;AACA,aAAAC,gBAAA,GAAmB,CAAnB;AACA,aAAAC,gBAAA,GAAmB,EAAnB;AACA,aAAAC,0BAAA,GAA6B,EAA7B;AACA,aAAAC,cAAA,GAAiB,KAAjB;AACA,aAAAC,WAAA,GAAc,KAAd;AACA,aAAAC,eAAA,GAAkB,KAAlB;AACA,aAAAC,kBAAA,GAAqB,IAArB;AACA,aAAAC,YAAA,GAAe,IAAf;AACA,aAAAC,MAAA,GAAS,EAAT;AACA,aAAAC,cAAA,GAAiB,EAAjB;AACA,aAAAC,aAAA,GAAgB,EAAhB;AACA,aAAAC,aAAA,GAAgB,QAAhB;AACA,aAAAC,eAAA,GAAkB,KAAlB;AACA,aAAAC,eAAA,GAAkB,KAAlB;AACA,aAAAC,YAAA,GAAe,CAAf;AAEO,aAAAC,aAAA,GAAiC;AACtC;;;AAEA;;AAHsC,SAAjC;AAMA,aAAAC,iBAAA,GAAqC,EAArC;AACA,aAAAC,iBAAA,GAAqC,EAArC;AACA,aAAAC,sBAAA,GAA0C,EAA1C;AACA,aAAAC,eAAA,GAA2B;AAAC;AAAD,SAA3B;AACA,aAAAC,mBAAA,GAA+B,EAA/B;AACA,aAAAC,mBAAA,GAA+B,EAA/B;AACA,aAAAC,wBAAA,GAAoC,EAApC;AACP;;;;AAGO,aAAAC,gBAAA,GAAmB;AACxB;;;;;;;;;;;;;;;;;;;;;;;;;AADwB,SAAnB;AA2BA,aAAAC,mBAAA,GAAsB,EAAtB;AACA,aAAAC,eAAA,GAA2B;AAChC;;;;AAIA;AACEC,qBAAW,EAAE,SADf;AAEEC,qBAAW,EAAE,CAFf;AAGEC,qBAAW,EAAE;AAHf,SALgC,EAUhC;AACEF,qBAAW,EAAE,OADf;AAEEC,qBAAW,EAAE,CAFf;AAGEC,qBAAW,EAAE;AAHf,SAVgC,EAehC;AACEF,qBAAW,EAAE,SADf;AAEEC,qBAAW,EAAE,CAFf;AAGEC,qBAAW,EAAE;AAHf,SAfgC,EAoBhC;AACEF,qBAAW,EAAE,SADf;AAEEC,qBAAW,EAAE,CAFf;AAGEC,qBAAW,EAAE;AAHf,SApBgC,EAyBhC;AACEF,qBAAW,EAAE,SADf;AAEEC,qBAAW,EAAE,CAFf;AAGEC,qBAAW,EAAE,CAHf;AAIEC,oBAAU,EAAE,CAAC,EAAD,EAAK,CAAL;AAJd,SAzBgC,EA+BhC;AACEH,qBAAW,EAAE,OADf;AAEEC,qBAAW,EAAE,CAFf;AAGEC,qBAAW,EAAE,CAHf;AAIEC,oBAAU,EAAE,CAAC,EAAD,EAAK,CAAL;AAJd,SA/BgC,EAqChC;AACEH,qBAAW,EAAE,SADf;AAEEC,qBAAW,EAAE,CAFf;AAGEC,qBAAW,EAAE,CAHf;AAIEC,oBAAU,EAAE,CAAC,EAAD,EAAK,CAAL;AAJd,SArCgC,EA2ChC;AACEH,qBAAW,EAAE,SADf;AAEEC,qBAAW,EAAE,CAFf;AAGEC,qBAAW,EAAE,CAHf;AAIEC,oBAAU,EAAE,CAAC,EAAD,EAAK,CAAL;AAJd,SA3CgC,CAA3B;AAkDA,aAAAC,kBAAA,GAA8B,CACnC;AACEJ,qBAAW,EAAE,SADf;AAEEC,qBAAW,EAAE,CAFf;AAGEC,qBAAW,EAAE;AAHf,SADmC,CAA9B;AAOA,aAAAG,eAAA,GAAkB,KAAlB,CAgF6B,CAhFJ;;AACzB,aAAAC,aAAA,GAAgB,MAAhB;AACA,aAAAC,gBAAA,GAAmB,CAAC,sDAAD,CAAnB;AAEP,aAAAC,eAAA,GAAkB,QAAlB;AACA,aAAAC,mBAAA,GAAsB,IAAtB;AACA,aAAAC,cAAA,GAAiB,IAAjB;AACA,aAAAC,eAAA,GAAkB,QAAlB;AACA,aAAAC,mBAAA,GAAsB,IAAtB;AACA,aAAAC,cAAA,GAAiB,IAAjB;AACA,aAAAC,eAAA,GAAkB,QAAlB;AACA,aAAAC,mBAAA,GAAsB,IAAtB;AACA,aAAAC,cAAA,GAAiB,IAAjB;AACO,aAAAC,WAAA,GAA+B,EAA/B;AACA,aAAAC,aAAA,GAAyB,EAAzB;AACA,aAAAC,cAAA,GAAiB;AACtBC,oBAAU,EAAE,IADU;AAEtBC,gBAAM,EAAE;AACNC,iBAAK,EAAE,CAAC,EAAD,CADD;AAENC,iBAAK,EAAE,CACL;AACEhc,gBAAE,EAAE,UADN;AAEEoR,sBAAQ,EAAE;AAFZ,aADK,EAQL;AACEpR,gBAAE,EAAE,UADN;AAEEoR,sBAAQ,EAAE;AAFZ,aARK;AAFD,WAFc;AA4BtB6K,kBAAQ,EAAE;AACRC,gBAAI,EAAE,OADE;AAERC,qBAAS,EAAE;AAFH,WA5BY;AAgCtBC,mBAAS,EAAE;AACTC,oBAAQ,EAAE;AADD,WAhCW;AAmCtBC,kBAAQ,EAAE;AACRC,gBAAI,EAAE;AACJC,kBAAI,EAAE;AADF;AADE;AAnCY,SAAjB;AAyCA,aAAAC,aAAA,GAAyB,CAAE;AAAEhC,qBAAW,EAAE,SAAf;AAA0BC,qBAAW,EAAE,CAAvC;AAA0CC,qBAAW,EAAE;AAAvD,SAAF,EAA8D;AAAEF,qBAAW,EAAE,OAAf;AAAwBC,qBAAW,EAAE,CAArC;AAAwCC,qBAAW,EAAE;AAArD,SAA9D,CAAzB;AACA,aAAA+B,aAAA,GAAgB,KAAhB,CAuB6B,CAvBN;;AACvB,aAAAC,WAAA,GAAc,MAAd;AACA,aAAAC,cAAA,GAAiB,CAAC,sDAAD,CAAjB;AAEP,aAAAC,aAAA,GAAgB,CACd;AAAErS,eAAK,EAAE,KAAT;AAAgBpE,gBAAM,EAAE,QAAxB;AAAkCM,gBAAM,EAAE,0EAAa2B;AAAvD,SADc,EAEd;AAAEmC,eAAK,EAAE,MAAT;AAAiBpE,gBAAM,EAAE,QAAzB;AAAmCM,gBAAM,EAAE;AAA3C,SAFc,EAGd;AAAE8D,eAAK,EAAE,MAAT;AAAiBpE,gBAAM,EAAE,QAAzB;AAAmCM,gBAAM,EAAE;AAA3C,SAHc,EAId;AAAE8D,eAAK,EAAE,QAAT;AAAmBpE,gBAAM,EAAE,QAA3B;AAAqCM,gBAAM,EAAE;AAA7C,SAJc,EAKd;AAAE8D,eAAK,EAAE,QAAT;AAAmBpE,gBAAM,EAAE,QAA3B;AAAqCM,gBAAM,EAAE;AAA7C,SALc,CAAhB;AAqBE,aAAK5F,UAAL,CAAgBkN,YAAhB,CAA6BhJ,SAA7B,CAAuC,UAAAK,GAAG,EAAI;AAC5CH,iBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCE,GAAtC,EAD4C,CAE5C;;AAEA,cAAImF,KAAK,GAAG,OAAI,CAACsS,WAAL,CAAiBzX,GAAG,CAACgC,MAArB,CAAZ;;AACAnC,iBAAO,CAACC,GAAR,CAAY,+BAA+BqF,KAA3C;AACA;;;;;;;;AAOA,iBAAI,CAACuS,WAAL,CAAiB1X,GAAG,CAACoH,GAArB,EAA0BjC,KAA1B,EAAiCnF,GAAG,CAAC6C,GAArC,EAb4C,CAaD;;AAC5C,SAdD;AAgBA,aAAKpH,UAAL,CAAgBmN,WAAhB,CAA4BjJ,SAA5B,CAAsC,UAAAK,GAAG,EAAI;AAC3CH,iBAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqCE,GAArC,EAD2C,CAE3C;;AAEA,cAAImF,KAAK,GAAG,OAAI,CAACsS,WAAL,CAAiBzX,GAAG,CAACgC,MAArB,CAAZ;;AACAnC,iBAAO,CAACC,GAAR,CAAY,4BAA4BqF,KAAxC;;AAEA,iBAAI,CAACwS,eAAL,CAAqBxS,KAArB,EAA4BnF,GAAG,CAACkC,IAAhC;AACD,SARD;AAUA,aAAKvG,gBAAL,CAAsBsE,eAAtB,CAAsCN,SAAtC,CAAgD,UAAAK,GAAG,EAAI;AACrDH,iBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCE,GAAtC;;AACA,cAAIA,GAAG,KAAK,WAAZ,EAAyB;AACvB,mBAAI,CAAC4X,yBAAL;AACD;AACF,SALD;AAOA,aAAK9b,OAAL,CAAamE,eAAb,CAA6BN,SAA7B,CAAuC,UAAAK,GAAG,EAAI;AAC5CH,iBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCE,GAAtC;;AACA,cAAIA,GAAG,KAAK,WAAZ,EAAyB;AACvB,mBAAI,CAAC4X,yBAAL;AACD;AACF,SALD;AAOA;;;;;;;;;;;;;;AAeD;;;;oCAEW5V,M,EAAQ;AAClBA,gBAAM,GAAGA,MAAM,CAAC4D,OAAP,CAAe,MAAf,EAAuB,EAAvB,CAAT;AACA,cAAI7E,MAAM,GAAG,EAAb;;AACA,cAAIiB,MAAM,CAAC6D,UAAP,CAAkB,OAAlB,CAAJ,EAAgC;AAC9B9E,kBAAM,GAAG,OAAT;AACAiB,kBAAM,GAAGA,MAAM,CAAC4D,OAAP,CAAe,OAAf,EAAwB,EAAxB,CAAT;AACD;;AACD,cAAI5D,MAAM,CAAC6D,UAAP,CAAkB,WAAlB,CAAJ,EAAoC;AAClC9E,kBAAM,GAAG,WAAT;AACAiB,kBAAM,GAAGA,MAAM,CAAC4D,OAAP,CAAe,WAAf,EAA4B,EAA5B,CAAT;AACD;;AACD,cAAI5D,MAAM,CAAC6D,UAAP,CAAkB,QAAlB,CAAJ,EAAiC;AAC/B9E,kBAAM,GAAG,QAAT;AACAiB,kBAAM,GAAGA,MAAM,CAAC4D,OAAP,CAAe,QAAf,EAAyB,EAAzB,CAAT;AACD;;AACD,cAAI1D,IAAI,GAAG,EAAX;;AACA,cAAIF,MAAM,CAACzB,QAAP,CAAgB,IAAhB,CAAJ,EAA2B;AACzB2B,gBAAI,GAAG,IAAP;AACD;;AACD,cAAIF,MAAM,CAACzB,QAAP,CAAgB,IAAhB,CAAJ,EAA2B;AACzB2B,gBAAI,GAAG,IAAP;AACD;;AACDF,gBAAM,GAAGA,MAAM,CAAC8D,KAAP,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAAT,CAtBkB,CAsBY;;AAE9B,cAAI7D,MAAM,GAAGD,MAAM,CAAC+D,SAAP,CAAiB,CAAjB,CAAb;AACA,cAAI1E,MAAM,GAAGW,MAAM,CAAC+D,SAAP,CAAiB,CAAjB,EAAoB,CAApB,CAAb,CAzBkB,CAyBmB;;AAErC,iBAAO9D,MAAM,GAAGC,IAAhB;AACD;;;mCAEO;AAAA;;AAEN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AAEA;AACA;AACA;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AAEA,eAAKgS,MAAL,GAAc,EAAd;;AACA,eAAK,IAAIzK,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG,0EAAaoO,SAAzC,EAAoDpO,KAAK,IAAI,CAA7D,EAAgE;AAC9D,iBAAKyK,MAAL,CAAYxO,IAAZ,CAAiB;AAACoS,sBAAQ,EAAE,KAAX;AAAkBC,oBAAM,EAAE,SAA1B;AAAqCC,oBAAM,EAAE,EAA7C;AAAiDjX,oBAAM,EAAE,WAAzD;AAAsEM,oBAAM,EAAE,YAA9E;AAA4F4W,qBAAO,EAAE,GAArG;AAA0GC,mBAAK,EAAE,EAAjH;AAAqH7Q,oBAAM,EAAE;AAA7H,aAAjB;AACD;;AAED,cAAI8Q,cAAc,GAAGzX,WAAW,CAAC,YAAM;AACrC,gBAAI,OAAI,CAACwT,MAAT,EAAiB;AACf,qBAAI,CAACA,MAAL,CAAYrP,OAAZ,CAAoB,UAACuT,KAAD,EAAU;AAC5BA,qBAAK,CAAC/Q,MAAN,GAAe,EAAf;;AACA,oBAAI+Q,KAAK,CAACN,QAAV,EAAoB;AAElB,sBAAIjV,GAAG,GAAG,IAAV;;AACA,sBAAIuV,KAAK,CAACL,MAAV,EAAkB;AAEhB,wBAAIjO,IAAI,GAAG,OAAI,CAACuO,aAAL,CAAmB;AAAElT,2BAAK,EAAGiT,KAAK,CAACL;AAAhB,qBAAnB,EAA6CK,KAAK,CAACrX,MAAnD,EAA2DqX,KAAK,CAAC/W,MAAjE,CAAX;;AACAwB,uBAAG,GAAGiH,IAAN;;AACA,wBAAIsO,KAAK,CAACJ,MAAV,EAAkB;AAChB,0BAAIM,IAAI,GAAG,OAAI,CAACD,aAAL,CAAmB;AAAElT,6BAAK,EAAGiT,KAAK,CAACJ;AAAhB,uBAAnB,EAA6CI,KAAK,CAACrX,MAAnD,EAA2DqX,KAAK,CAAC/W,MAAjE,CAAX;;AACAwB,yBAAG,IAAIyV,IAAP;AACD;AAEF,mBATD,MASO;AAAE;AACPzV,uBAAG,GAAG,OAAI,CAACnH,UAAL,CAAgBiG,MAAhB,CAAuByW,KAAK,CAACrX,MAA7B,CAAN;AACD;;AAED,sBAAIqX,KAAK,CAACH,OAAN,KAAkB,GAAtB,EAA2B;AACzB,wBAAIpV,GAAG,GAAGuV,KAAK,CAACF,KAAhB,EAAuB;AACrBE,2BAAK,CAAC/Q,MAAN,GAAe,OAAf;;AACA,6BAAI,CAAC5L,UAAL,CAAgBgN,SAAhB,CAA0B,SAA1B;AACD,qBAHD,MAGO;AACL2P,2BAAK,CAAC/Q,MAAN,GAAe,EAAf;AACD;AACF;;AACD,sBAAI+Q,KAAK,CAACH,OAAN,KAAkB,GAAtB,EAA2B;AACzB,wBAAIpV,GAAG,GAAGuV,KAAK,CAACF,KAAhB,EAAuB;AACrBE,2BAAK,CAAC/Q,MAAN,GAAe,OAAf;;AACA,6BAAI,CAAC5L,UAAL,CAAgBgN,SAAhB,CAA0B,SAA1B;AACD,qBAHD,MAGO;AACL2P,2BAAK,CAAC/Q,MAAN,GAAe,EAAf;AACD;AACF;AACF;AAEF,eApCD;AAqCD;AACF,WAxC+B,EAwC7B,IAxC6B,CAAhC;AA0CA,cAAI5G,gBAAgB,GAAGC,WAAW,CAAC,YAAM;AACvC,gBAAI,CAAC,OAAI,CAACoT,WAAV,EAAuB;AACrB,qBAAI,CAACyE,eAAL,CAAqB,OAAI,CAAC7F,UAA1B;AACD;;AACD,mBAAI,CAAC8F,gBAAL;AACD,WALiC,EAK/B,IAL+B,CAAlC;AAOA,cAAIC,iBAAiB,GAAG/X,WAAW,CAAC,YAAM;AACxC,gBAAI,CAAC,OAAI,CAACoT,WAAV,EAAuB;AACrB,qBAAI,CAAC4E,SAAL;AACD;AACF,WAJkC,EAIhC,KAJgC,CAAnC;AAMA,cAAIC,iBAAiB,GAAGjY,WAAW,CAAC,YAAM,CACxC;AACD,WAFkC,EAEhC,IAFgC,CAAnC;;AAIA,eAAK,IAAIiE,GAAG,GAAG,CAAf,EAAkBA,GAAG,IAAI,CAAzB,EAA4BA,GAAG,EAA/B,EAAmC;AACjC,gBAAIiU,cAAc,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,mBAAmBrU,GAAxC,CAAX,CAArB;;AAEA,gBAAIiU,cAAc,IAAIA,cAAc,CAACK,MAArC,EAA6C;AAC3C,kBAAItU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAKyN,QAAL,GAAgBwG,cAAhB;AACD;;AACD,kBAAIjU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAK0N,QAAL,GAAgBuG,cAAhB;AACD;;AACD,kBAAIjU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAK2N,QAAL,GAAgBsG,cAAhB;AACD;;AACD,kBAAIjU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAK4N,QAAL,GAAgBqG,cAAhB;AACD;;AACD,kBAAIjU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAK6N,QAAL,GAAgBoG,cAAhB;AACD;AACF;AACF;AACF;;;8CAGqBM,K,EAAO;AAC3B;AACA,cAAI,KAAK7E,aAAL,KAAuB,QAA3B,EAAqC;AACnC,iBAAK8E,iBAAL;AACD,WAFD,MAEO,IAAI,KAAK9E,aAAL,KAAuB,SAA3B,EAAsC;AAC3C,iBAAK+E,kBAAL;AACD;AACF;;;6CAEoB;AACvB;;;;;;;;;;;;;;;;AAiBI,eAAKhF,aAAL,GAAqB,EAArB;AACA,cAAIiF,KAAK,GAAG,KAAKlF,cAAL,CAAoBkF,KAApB,CAA0B,YAA1B,CAAZ;AACAxZ,iBAAO,CAACC,GAAR,CAAYuZ,KAAZ;;AAEA,cAAIA,KAAJ,EAAW;AACT,iBAAK,IAAIvQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuQ,KAAK,CAACtQ,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACrC,kBAAIoO,IAAI,GAAGmC,KAAK,CAACvQ,CAAD,CAAhB;AACAoO,kBAAI,GAAGA,IAAI,CAACtR,OAAL,CAAa,IAAb,EAAmB,IAAnB,CAAP;AACA,kBAAI0T,OAAO,GAAGpC,IAAI,CAACmC,KAAL,CAAW,IAAX,CAAd;AAEA,kBAAIre,CAAC,GAAG,IAAI,0DAAJ,EAAR;AACAA,eAAC,CAAC+F,MAAF,GAAWuY,OAAO,CAAC,CAAD,CAAP,CAAWD,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAAX;AACAre,eAAC,CAACmK,KAAF,GAAUmU,OAAO,CAAC,CAAD,CAAP,CAAWD,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,IAA2BC,OAAO,CAAC,CAAD,CAAP,CAAWD,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAArC;AAEAre,eAAC,CAACoM,GAAF,GAAQd,MAAM,CAACgT,OAAO,CAAC,CAAD,CAAP,CAAWD,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAAD,CAAd;;AACA,kBAAIC,OAAO,CAAC,CAAD,CAAP,KAAe,MAAnB,EAA2B;AACzBte,iBAAC,CAACoM,GAAF,GAAQ,CAACpM,CAAC,CAACoM,GAAX;AACD;;AACDpM,eAAC,CAACkd,KAAF,GAAU5R,MAAM,CAACgT,OAAO,CAAC,CAAD,CAAR,CAAhB;AAEAte,eAAC,CAACue,QAAF,GAAa,KAAK9G,WAAlB;AACA,mBAAK2B,aAAL,CAAmB1O,IAAnB,CAAwB1K,CAAxB;AACD;AACF;;AACD6E,iBAAO,CAACC,GAAR,CAAY,KAAKsU,aAAjB;AACD;;;4CAEmB;AAElB;;;;;;;;;;;AAYA,eAAKA,aAAL,GAAqB,EAArB;AACA,cAAIiF,KAAK,GAAG,KAAKlF,cAAL,CAAoBkF,KAApB,CAA0B,QAA1B,CAAZ,CAfkB,CAgBlB;;AACA,cAAIA,KAAJ,EAAW;AACT,iBAAK,IAAIvQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuQ,KAAK,CAACtQ,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACrC,kBAAIoO,IAAI,GAAGmC,KAAK,CAACvQ,CAAD,CAAhB;AACA,kBAAI3B,KAAK,GAAG+P,IAAI,CAACmC,KAAL,CAAW,IAAX,CAAZ;AACAxZ,qBAAO,CAACC,GAAR,CAAYqH,KAAZ;AAEA,kBAAInM,CAAC,GAAG,IAAI,0DAAJ,EAAR;AACAA,eAAC,CAAC+F,MAAF,GAAWoG,KAAK,CAAC,CAAD,CAAL,CAASkS,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAX;AACAre,eAAC,CAACqG,MAAF,GAAW8F,KAAK,CAAC,CAAD,CAAL,CAASkS,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAX;AACAre,eAAC,CAACmK,KAAF,GAAUgC,KAAK,CAAC,CAAD,CAAL,CAASkS,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAV;AAEAre,eAAC,CAACgH,MAAF,GAAW,KAAKwX,eAAL,CAAqBxe,CAAC,CAAC+F,MAAvB,EAA+B/F,CAAC,CAACqG,MAAjC,EAAyCrG,CAAC,CAACmK,KAA3C,CAAX;AAEA,kBAAImU,OAAO,GAAGnS,KAAK,CAAC,CAAD,CAAL,CAASkS,KAAT,CAAe,IAAf,CAAd;AACAre,eAAC,CAACoM,GAAF,GAAQd,MAAM,CAACgT,OAAO,CAAC,CAAD,CAAP,CAAWD,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAAD,CAAd;;AACA,kBAAIC,OAAO,CAAC,CAAD,CAAP,KAAe,MAAnB,EAA2B;AACzBte,iBAAC,CAACoM,GAAF,GAAQ,CAACpM,CAAC,CAACoM,GAAX;AACD;;AACDpM,eAAC,CAACkd,KAAF,GAAU5R,MAAM,CAACgT,OAAO,CAAC,CAAD,CAAR,CAAhB;AAEAte,eAAC,CAACue,QAAF,GAAa,KAAK9G,WAAlB;AACA,mBAAK2B,aAAL,CAAmB1O,IAAnB,CAAwB1K,CAAxB;AACD;AACF;;AACD6E,iBAAO,CAACC,GAAR,CAAY,KAAKsU,aAAjB;AACD;;;8CAEqB;AACpB,eAAK,IAAItL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKsL,aAAL,CAAmBrL,MAAvC,EAA+CD,CAAC,EAAhD,EAAoD;AAClD,iBAAK4O,WAAL,CAAiB,KAAKtD,aAAL,CAAmBtL,CAAnB,EAAsB1B,GAAvC,EAA4C,KAAKgN,aAAL,CAAmBtL,CAAnB,EAAsB3D,KAAlE,EAAyE,KAAKiP,aAAL,CAAmBtL,CAAnB,EAAsBoP,KAA/F;AACD;AACF;;;oCAEWvT,G,EAAG;AACb,cAAI8U,gBAAgB,GAAG,cAAc9U,GAAd,GAAoB,GAApB,GAA0B,KAAK+U,eAAL,EAA1B,GAAmD,MAA1E;AACA7Z,iBAAO,CAACC,GAAR,CAAY,aAAZ,EAA2B2Z,gBAA3B;AACA,cAAIb,cAAc,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,mBAAmBrU,GAAxC,CAAX,CAArB;;AACA,cAAIiU,cAAc,IAAIA,cAAc,CAACK,MAArC,EAA6C;AAC3C,gBAAIlY,MAAM,GAAG6X,cAAc,CAAC7X,MAA5B;AACA,gBAAIC,UAAU,GAAG4X,cAAc,CAACvX,MAAhC;AACA,gBAAIwH,qBAAqB,GAAG+P,cAAc,CAACK,MAA3C;AACApZ,mBAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BiB,MAA1B,EAAkCC,UAAlC,EAA8C6H,qBAA9C;AAEA,gBAAI8Q,GAAG,GAAG,EAAV;AACAA,eAAG,IAAI5Y,MAAM,GAAG,GAAT,GAAeC,UAAf,GAA4B,MAAnC;AACA6H,iCAAqB,CAAChE,OAAtB,CAA8B,UAAAP,GAAG,EAAI;AACnC,kBAAIsV,GAAG,GAAG,EAAV;AACAA,iBAAG,IAAItV,GAAG,CAAC8C,GAAJ,GAAU,GAAV,GAAgB9C,GAAG,CAACa,KAApB,GAA4B,GAA5B,GAAkCb,GAAG,CAACjD,MAAtC,GAA+C,GAA/C,GAAqDiD,GAAG,CAAC8E,KAAzD,GAAiE,GAAjE,GAAuE9E,GAAG,CAAC6E,IAAlF;AACAwQ,iBAAG,IAAIC,GAAG,GAAG,MAAb;AACD,aAJD;AAMA,gBAAMC,YAAY,GAAG,IAAIC,IAAJ,CAAS,CAACH,GAAD,CAAT,EAAgB;AACnCzX,kBAAI,EAAE;AAD6B,aAAhB,CAArB;;AAIA,gBAAI9B,MAAM,CAAC2Z,SAAP,IAAoB3Z,MAAM,CAAC2Z,SAAP,CAAiBC,gBAAzC,EAA2D;AACzD;AACA5Z,oBAAM,CAAC2Z,SAAP,CAAiBC,gBAAjB,CAAkCH,YAAlC,EAAgDJ,gBAAhD;AACD,aAHD,MAGO;AACL,kBAAMQ,OAAO,GAAGC,GAAG,CAACC,eAAJ,CAAoBN,YAApB,CAAhB;AACA,kBAAMO,IAAI,GAAGlS,QAAQ,CAACmS,aAAT,CAAuB,GAAvB,CAAb;AACAD,kBAAI,CAAC9Z,IAAL,GAAY2Z,OAAZ;AACAG,kBAAI,CAACE,MAAL,GAAc,QAAd;AACApS,sBAAQ,CAACqS,IAAT,CAAcC,WAAd,CAA0BJ,IAA1B;AACAA,kBAAI,CAACK,QAAL,GAAgBhB,gBAAhB;AACAW,kBAAI,CAACM,KAAL;AACAN,kBAAI,CAACO,UAAL,CAAgBC,WAAhB,CAA4BR,IAA5B;AACD;AACF;AACF;;;0CAEiB;AAChB,cAAI5T,IAAI,GAAG,IAAIlF,IAAJ,EAAX;AACA,cAAIuZ,CAAC,GAAGrU,IAAI,CAAC/E,OAAL,EAAR;AACA,cAAIqZ,CAAC,GAAGtU,IAAI,CAAChF,QAAL,KAAkB,CAA1B,CAHgB,CAGa;;AAC7B,cAAIuZ,CAAC,GAAGvU,IAAI,CAACjF,WAAL,EAAR;AACA,cAAIyZ,CAAC,GAAGxU,IAAI,CAACyU,QAAL,EAAR;AACA,cAAIC,IAAI,GAAG1U,IAAI,CAAC2U,UAAL,EAAX;AACA,cAAIC,CAAC,GAAG5U,IAAI,CAAC6U,UAAL,EAAR;AACA,cAAIC,MAAM,GAAG,MAAMT,CAAC,IAAI,CAAL,GAAS,MAAMA,CAAf,GAAmBA,CAAzB,KAA+BC,CAAC,IAAI,CAAL,GAAS,MAAMA,CAAf,GAAmBA,CAAlD,IAAuDC,CAAvD,GAA2D,GAA3D,IAAkEC,CAAC,IAAI,CAAL,GAAS,MAAMA,CAAf,GAAmBA,CAArF,KAA2FE,IAAI,IAAI,CAAR,GAAY,MAAMA,IAAlB,GAAyBA,IAApH,KAA6HE,CAAC,IAAI,CAAL,GAAS,MAAMA,CAAf,GAAmBA,CAAhJ,CAAb;AACA,iBAAOE,MAAP;AACD;;;yCAEgBC,S,EAAW;AAAA;;AAC1B,cAAIC,UAAU,GAAGD,SAAS,CAACjB,MAAV,CAAiBmB,KAAjB,CAAuB,CAAvB,CAAjB;AAEA,cAAIC,MAAM,GAAe,IAAIC,UAAJ,EAAzB;AACAD,gBAAM,CAACE,UAAP,CAAkBJ,UAAlB;;AAEAE,gBAAM,CAACG,MAAP,GAAgB,UAAAxhB,CAAC,EAAI;AACnB,gBAAIyhB,GAAG,GAAWC,MAAM,CAACL,MAAM,CAACM,MAAR,CAAxB,CADmB,CAEnB;;AACA,mBAAI,CAACC,cAAL,CAAoBH,GAApB;AACD,WAJD;AAKD;;;uCAEcI,U,EAAY;AACzB,cAAIC,qBAAqB,GAAGD,UAAU,CAAC7C,KAAX,CAAiB,UAAjB,CAA5B;AAEA,cAAI+C,YAAY,GAAGD,qBAAqB,CAACzP,MAAtB,CAA6B,UAAS2P,IAAT,EAAe;AAC7D,mBAAOA,IAAI,KAAK,EAAhB;AACD,WAFkB,CAAnB,CAHyB,CAOzB;;AAEA,cAAIC,SAAS,GAAGF,YAAY,CAAC,CAAD,CAAZ,CAAgB/C,KAAhB,CAAsB,GAAtB,CAAhB,CATyB,CASmB;;AAE5C,yEAAWkD,YAAX,GAA0B,EAA1B;;AACA,eAAK,IAAI9S,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG2S,YAAY,CAACrT,MAAzC,EAAiDU,KAAK,EAAtD,EAA0D;AAExD;AACA;AAEA,gBAAI4P,KAAK,GAAG+C,YAAY,CAAC3S,KAAD,CAAZ,CAAoB4P,KAApB,CAA0B,GAA1B,CAAZ;AAEA,gBAAImD,WAAW,GAAGnD,KAAK,CAAC,CAAD,CAAvB;AACA;;;;AAIA,gBAAIoD,QAAQ,GAAG,EAAf;AACAA,oBAAQ,GAAG,+DAAWF,YAAX,CAAwBC,WAAxB,CAAX,CAbwD,CAaP;;AACjD,gBAAI,CAACC,QAAL,EAAe;AACbA,sBAAQ,GAAG,EAAX;AACD;;AAEDA,oBAAQ,CAACpD,KAAK,CAAC,CAAD,CAAN,CAAR,GAAqB/S,MAAM,CAAC+S,KAAK,CAAC,CAAD,CAAN,CAA3B,CAlBwD,CAkBlB;;AACtC,2EAAWkD,YAAX,CAAwBC,WAAxB,IAAuCC,QAAvC;AACD;;AAED5c,iBAAO,CAACC,GAAR,CAAY,cAAZ,EAA4B,+DAAWyc,YAAvC;;AAEA,cAAI,+DAAWA,YAAf,EAA6B;AAC3B,sFAAa3Q,mBAAb,GAAmC,IAAnC;AACD;;AAED,eAAK0C,mBAAL,GAA2B,IAAIhN,IAAJ,CAAS,KAAKiS,iBAAd,CAA3B;AACA,eAAKjF,mBAAL,CAAyBlM,QAAzB,CAAkC,KAAKsR,gBAAvC;AACA,eAAKpF,mBAAL,CAAyBoO,UAAzB,CAAoC,KAAK/I,gBAAzC;AAEA,cAAIgJ,gBAAgB,GAAG,KAAK,CAAC,MAAM,KAAKrO,mBAAL,CAAyB7M,OAAzB,EAAP,EAA2CqE,KAA3C,CAAiD,CAAC,CAAlD,CAAL,GAA4D,GAA5D,GAAkE,CAAC,OAAO,KAAKwI,mBAAL,CAAyB9M,QAAzB,KAAsC,CAA7C,CAAD,EAAkDsE,KAAlD,CAAwD,CAAC,CAAzD,CAAlE,GAAgI,GAAhI,GAAsI,KAAKwI,mBAAL,CAAyB/M,WAAzB,EAA7J;AACA,eAAKqS,0BAAL,GAAkC+I,gBAAgB,GAAG,GAAnB,GAAyB,CAAC,MAAM,KAAKrO,mBAAL,CAAyB2M,QAAzB,EAAP,EAA4CnV,KAA5C,CAAkD,CAAC,CAAnD,CAAzB,GAAiF,GAAjF,GAAuF,CAAC,MAAM,KAAKwI,mBAAL,CAAyB6M,UAAzB,EAAP,EAA8CrV,KAA9C,CAAoD,CAAC,CAArD,CAAvF,GAAiJ,KAAnL,CA7CyB,CA6CiK;;AAE1L,eAAK8W,sBAAL,CAA4B,KAAKvJ,eAAjC,EAAkD,KAAKO,0BAAvD,EAAmF,KAAKN,kBAAxF;AAEA,eAAKuJ,eAAL,CAAqB,KAAKxJ,eAA1B,EAA2C,KAAKC,kBAAhD;AACD;;;gDAEkC;AAAA,cAAb4H,IAAa,uEAAN,IAAM;;AAEjC,cAAI,KAAK1H,eAAL,KAAyB,KAAzB,IAAmC0H,IAAI,IAAIA,IAAI,GAAG,CAAtD,EAA0D;AACxD,gBAAIA,IAAJ,EAAU;AACR,mBAAK5M,mBAAL,CAAyBoO,UAAzB,CAAoC,KAAKpO,mBAAL,CAAyB6M,UAAzB,KAAwCD,IAA5E;AACD,aAFD,MAEO;AACL,mBAAK5M,mBAAL,CAAyBoO,UAAzB,CAAoC,KAAKpO,mBAAL,CAAyB6M,UAAzB,KAAwC7U,MAAM,CAAC,KAAKmN,gBAAN,CAAlF;AACD;;AAED,gBAAK,KAAKnF,mBAAL,CAAyB2M,QAAzB,OAAwC,EAAxC,IAA8C,KAAK3M,mBAAL,CAAyB6M,UAAzB,KAAwC,EAAvF,IAA8F,KAAK7M,mBAAL,CAAyB2M,QAAzB,KAAsC,EAAxI,EAA4I;AAC1I,kBAAI6B,GAAG,GAAG,IAAIxb,IAAJ,CAAS,KAAKgN,mBAAd,CAAV;AACAwO,iBAAG,CAAC1a,QAAJ,CAAa,EAAb;AACA0a,iBAAG,CAACJ,UAAJ,CAAe,EAAf;AAEA,kBAAIK,IAAI,GAAG,KAAKzO,mBAAL,CAAyB3C,OAAzB,KAAqCmR,GAAG,CAACnR,OAAJ,EAAhD,CAL0I,CAK3E;;AAE/D,kBAAIqR,MAAM,GAAG,IAAI1b,IAAJ,CAAS,KAAKgN,mBAAd,CAAb;AACA0O,oBAAM,CAACvN,OAAP,CAAeuN,MAAM,CAACvb,OAAP,KAAmB,CAAlC;AACAub,oBAAM,CAAC5a,QAAP,CAAgB,CAAhB;AACA4a,oBAAM,CAACN,UAAP,CAAkB,EAAlB;AACAM,oBAAM,CAACC,eAAP,CAAuBD,MAAM,CAACE,eAAP,KAA2BH,IAAlD;AAEA,mBAAKzO,mBAAL,GAA2B,IAAIhN,IAAJ,CAAS0b,MAAT,CAA3B,CAb0I,CAe1I;AACD;AACF;;AAED,cAAI,KAAKxJ,eAAL,KAAyB,UAAzB,IAAwC0H,IAAI,IAAIA,IAAI,GAAG,CAA3D,EAA+D;AAC7D,gBAAIA,IAAJ,EAAU;AACR,mBAAK5M,mBAAL,CAAyBoO,UAAzB,CAAoC,KAAKpO,mBAAL,CAAyB6M,UAAzB,KAAwCD,IAA5E;AACD,aAFD,MAEO;AACL,mBAAK5M,mBAAL,CAAyBoO,UAAzB,CAAoC,KAAKpO,mBAAL,CAAyB6M,UAAzB,KAAwC7U,MAAM,CAAC,KAAKmN,gBAAN,CAAlF;AACD;;AAED,gBAAK,KAAKnF,mBAAL,CAAyB2M,QAAzB,OAAwC,CAAxC,IAA6C,KAAK3M,mBAAL,CAAyB6M,UAAzB,KAAwC,EAAtF,IAA6F,KAAK7M,mBAAL,CAAyB2M,QAAzB,KAAsC,CAAvI,EAA0I;AACxI,kBAAIkC,GAAG,GAAG,IAAI7b,IAAJ,CAAS,KAAKgN,mBAAd,CAAV;AACA6O,iBAAG,CAAC/a,QAAJ,CAAa,CAAb;AACA+a,iBAAG,CAACT,UAAJ,CAAe,EAAf;;AAEA,kBAAIK,KAAI,GAAGI,GAAG,CAACxR,OAAJ,KAAgB,KAAK2C,mBAAL,CAAyB3C,OAAzB,EAA3B,CALwI,CAKzE;;;AAE/D,kBAAIqR,OAAM,GAAG,IAAI1b,IAAJ,CAAS,KAAKgN,mBAAd,CAAb;;AACA0O,qBAAM,CAACvN,OAAP,CAAeuN,OAAM,CAACvb,OAAP,KAAmB,CAAlC;;AACAub,qBAAM,CAAC5a,QAAP,CAAgB,EAAhB;;AACA4a,qBAAM,CAACN,UAAP,CAAkB,EAAlB;;AACAM,qBAAM,CAACC,eAAP,CAAuBD,OAAM,CAACE,eAAP,KAA2BH,KAAlD;;AAEA,mBAAKzO,mBAAL,GAA2B,IAAIhN,IAAJ,CAAS0b,OAAT,CAA3B,CAbwI,CAexI;AACD;AACF;;AAED,cAAIL,gBAAgB,GAAG,KAAK,CAAC,MAAM,KAAKrO,mBAAL,CAAyB7M,OAAzB,EAAP,EAA2CqE,KAA3C,CAAiD,CAAC,CAAlD,CAAL,GAA4D,GAA5D,GAAkE,CAAC,OAAO,KAAKwI,mBAAL,CAAyB9M,QAAzB,KAAsC,CAA7C,CAAD,EAAkDsE,KAAlD,CAAwD,CAAC,CAAzD,CAAlE,GAAgI,GAAhI,GAAsI,KAAKwI,mBAAL,CAAyB/M,WAAzB,EAA7J;AACA,eAAKqS,0BAAL,GAAkC+I,gBAAgB,GAAG,GAAnB,GAAyB,CAAC,MAAM,KAAKrO,mBAAL,CAAyB2M,QAAzB,EAAP,EAA4CnV,KAA5C,CAAkD,CAAC,CAAnD,CAAzB,GAAiF,GAAjF,GAAuF,CAAC,MAAM,KAAKwI,mBAAL,CAAyB6M,UAAzB,EAAP,EAA8CrV,KAA9C,CAAoD,CAAC,CAArD,CAAvF,GAAiJ,KAAnL,CAvDiC,CAuDyJ;;AAE1L,eAAK8W,sBAAL,CAA4B,KAAKvJ,eAAjC,EAAkD,KAAKO,0BAAvD,EAAmF,KAAKN,kBAAxF;AACD;;;+CAEsBvS,M,EAAQqc,c,EAAgB1N,W,EAAa;AAE1D,cAAI2N,cAAc,GAAGD,cAArB;AAEAvd,iBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCud,cAAtC;;AAEA,6CAAyBniB,MAAM,CAACoiB,OAAP,CAAe,+DAAWf,YAA1B,CAAzB,qCAAkE;AAAA;AAAA,gBAAxD9Q,GAAwD;AAAA,gBAAnDrD,KAAmD;;AAChE;AAEA,gBAAIqD,GAAG,KAAK1K,MAAR,IAAmB0K,GAAG,CAAC5F,UAAJ,CAAe9E,MAAf,MAA2B0K,GAAG,CAAC8R,QAAJ,CAAa,IAAb,KAAsB9R,GAAG,CAAC8R,QAAJ,CAAa,IAAb,CAAjD,CAAvB,EAA8F;AAE5F,kBAAI9R,GAAG,KAAK1K,MAAZ,EAAoB;AAClB,oBAAIiB,MAAM,GAAGjB,MAAb;;AACA,oBAAIA,MAAM,KAAK,OAAf,EAAwB;AACtBiB,wBAAM,GAAG,SAAT;AACD;;AACD,oBAAIjB,MAAM,KAAK,QAAf,EAAyB;AACvB,sBAAIC,UAAU,GAAS,0EAAaoF,wBAAb,CAAsC,0EAAaC,IAAb,GAAoB,0EAAarD,gBAAvE,CAAvB;AACA,sBAAIkJ,WAAW,GAAG,IAAlB;;AACA,sBAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AACpC0K,+BAAW,GAAG,GAAd;AACD,mBAFD,MAEO,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,+BAAW,GAAG,GAAd;AACD,mBAFM,MAEA,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,+BAAW,GAAG,GAAd;AACD,mBAFM,MAEA;AACLA,+BAAW,GAAGlL,UAAU,CAACQ,QAAX,KAAwB,CAAtC;AACD;;AACD,sBAAIH,MAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAA0C2K,WAA1C,GAAyD,CAAC,MAAMlL,UAAU,CAACS,OAAX,EAAP,EAA6BqE,KAA7B,CAAmC,CAAC,CAApC,CAAtE;AACA9D,wBAAM,GAAG,WAAWX,MAAX,GAAoB,0EAAa2B,gBAAjC,GAAoD,KAA7D;AACD;;AACD,qBAAKtH,UAAL,CAAgByE,MAAhB,CAAuB6B,MAAvB,EAA+BoG,KAAK,CAACiV,cAAD,CAApC;AACD,eArBD,MAqBO;AACL,oBAAIlY,KAAK,GAAGsG,GAAZ;AACAtG,qBAAK,GAAGA,KAAK,CAACS,OAAN,CAAc7E,MAAd,EAAsB,EAAtB,CAAR;AACAoE,qBAAK,GAAGA,KAAK,CAACS,OAAN,CAAc,IAAd,EAAoB,EAApB,CAAR;;AAEA,oBAAI5D,OAAM,GAAG,KAAKwX,eAAL,CAAqBzY,MAArB,EAA6B2O,WAA7B,EAA0CvK,KAA1C,CAAb;;AAEA,oBAAItC,GAAG,GAAGuF,KAAK,CAACiV,cAAD,CAAf;AAEA,qBAAK3hB,UAAL,CAAgByE,MAAhB,CAAuB6B,OAAvB,EAA+Ba,GAA/B;AACD;AACF;AACF;;AAED,eAAK8U,eAAL,CAAqB,KAAKtE,eAA1B,EAA2C,IAA3C;AACA,eAAKqF,SAAL;AAEA7Y,iBAAO,CAACC,GAAR,CAAY,QAAZ,EAAsB,KAAKpE,UAAL,CAAgB8hB,MAAtC;AACD;;;wCAEezc,M,EAAQ2O,W,EAAavK,K,EAAO;AAC1C,cAAIrH,iBAAiB,GAAG,KAAxB;AACA,cAAIkD,UAAU,GAAG,IAAIM,IAAJ,CAASoO,WAAT,CAAjB;AACA1O,oBAAU,CAACoB,QAAX,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B;AAEA,cAAIoJ,sBAAsB,GAAG,0EAAatF,kBAA1C;;AACA,cAAInF,MAAM,KAAK,QAAf,EAAyB;AACvByK,kCAAsB,GAAG,0EAAapF,wBAAtC;AACD;;AACD,eAAK,IAAIqF,GAAT,IAAgBD,sBAAhB,EAAwC;AACtC,gBAAIA,sBAAsB,CAACE,cAAvB,CAAsCD,GAAtC,CAAJ,EAAgD;AAC5C;AACA,kBAAIzK,UAAU,CAAC2K,OAAX,OAAyBH,sBAAsB,CAACC,GAAD,CAAtB,CAA4BE,OAA5B,EAA7B,EAAoE;AAClE;AACA7N,iCAAiB,GAAG,IAApB;AACA;AACD;AACJ;AACF;;AAED,cAAIuD,MAAM,GAAG,IAAb;;AACA,cAAIvD,iBAAJ,EAAuB;AACrBuD,kBAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAAyC,0EAAa0K,aAAb,CAA2BjL,UAAU,CAACQ,QAAX,KAAwB,CAAnD,CAAlD;AACD,WAFD,MAEO;AACL,gBAAI0K,WAAW,GAAG,IAAlB;;AACA,gBAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AACpC0K,yBAAW,GAAG,GAAd;AACD,aAFD,MAEO,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA;AACLA,yBAAW,GAAGlL,UAAU,CAACQ,QAAX,KAAwB,CAAtC;AACD;;AACDH,kBAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAA0C2K,WAA1C,GAAyD,CAAC,MAAMlL,UAAU,CAACS,OAAX,EAAP,EAA6BqE,KAA7B,CAAmC,CAAC,CAApC,CAAlE;AACD;;AAED,cAAI6T,GAAG,GAAG5Y,MAAM,GAAGM,MAAT,GAAkB8D,KAA5B;AAEA,iBAAOwU,GAAP;AACD;;;kCAGS4B,S,EAAW5W,G,EAAK;AAAA;;AACxB,cAAI6W,UAAU,GAAGD,SAAS,CAACjB,MAAV,CAAiBmB,KAAjB,CAAuB,CAAvB,CAAjB;AAEA,cAAIC,MAAM,GAAe,IAAIC,UAAJ,EAAzB;AACAD,gBAAM,CAACE,UAAP,CAAkBJ,UAAlB;;AAEAE,gBAAM,CAACG,MAAP,GAAgB,UAAAxhB,CAAC,EAAI;AACnB,gBAAIyhB,GAAG,GAAWC,MAAM,CAACL,MAAM,CAACM,MAAR,CAAxB;AACAnc,mBAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBgc,GAApB;;AACA,mBAAI,CAAC2B,cAAL,CAAoB9Y,GAApB,EAAyB,IAAzB,EAA+BmX,GAA/B;AACD,WAJD;AAKD;;;8CAEqBI,U,EAAY;AAChC,cAAIC,qBAAqB,GAAGD,UAAU,CAAC7C,KAAX,CAAiB,UAAjB,CAA5B;AAEA,cAAI+C,YAAY,GAAGD,qBAAqB,CAACzP,MAAtB,CAA6B,UAAS2P,IAAT,EAAe;AAC7D,mBAAOA,IAAI,KAAK,EAAhB;AACD,WAFkB,CAAnB;AAIAxc,iBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8Bsc,YAA9B;AAEA,cAAIE,SAAS,GAAGF,YAAY,CAAC,CAAD,CAAZ,CAAgB/C,KAAhB,CAAsB,GAAtB,CAAhB;AACA,cAAItY,MAAM,GAAGub,SAAS,CAAC,CAAD,CAAtB;AACA,cAAItb,UAAU,GAAGsb,SAAS,CAAC,CAAD,CAA1B;AACA,cAAIrD,MAAM,GAAG,EAAb;;AACA,eAAK,IAAIxP,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG2S,YAAY,CAACrT,MAAzC,EAAiDU,KAAK,EAAtD,EAA0D;AACxD,gBAAIyN,IAAI,GAAGkF,YAAY,CAAC3S,KAAD,CAAZ,CAAoB4P,KAApB,CAA0B,GAA1B,CAAX;AACAJ,kBAAM,CAACvT,IAAP,CAAY;AAAE0B,iBAAG,EAAEd,MAAM,CAAC4Q,IAAI,CAAC,CAAD,CAAL,CAAb;AAAwB/R,mBAAK,EAAE+R,IAAI,CAAC,CAAD,CAAnC;AAAwC7V,oBAAM,EAAE6V,IAAI,CAAC,CAAD,CAApD;AAAyD9N,mBAAK,EAAE9C,MAAM,CAAC4Q,IAAI,CAAC,CAAD,CAAL,CAAtE;AAAiF/N,kBAAI,EAAE7C,MAAM,CAAC4Q,IAAI,CAAC,CAAD,CAAL;AAA7F,aAAZ;AACD;;AAED,cAAI0B,cAAc,GAAG;AAAE7X,kBAAM,EAAE,EAAV;AAAcM,kBAAM,EAAE,EAAtB;AAA0B4X,kBAAM,EAAE;AAAlC,WAArB;AACAL,wBAAc,CAAC7X,MAAf,GAAwBA,MAAxB;AACA6X,wBAAc,CAACvX,MAAf,GAAwBL,UAAxB;AACA4X,wBAAc,CAACK,MAAf,GAAwBA,MAAxB;AAEA,iBAAOL,cAAP;AACD;;;0CAEiD;AAAA,cAAlC7X,MAAkC,uEAAzB,IAAyB;AAAA,cAAnBC,UAAmB,uEAAN,IAAM;;AAChD,cAAID,MAAM,IAAIC,UAAd,EAA0B;AACxB,iBAAKpF,YAAL,CAAkBkF,iBAAlB,CAAoCoC,IAApC,CAAyC,CAACnC,MAAD,EAASC,UAAT,CAAzC;AACD,WAFD,MAEO,IAAI,KAAKD,MAAL,IAAe,KAAKC,UAAxB,EAAoC;AACzC,iBAAKpF,YAAL,CAAkBkF,iBAAlB,CAAoCoC,IAApC,CAAyC,CAAC,KAAKnC,MAAN,EAAc,KAAKC,UAAnB,CAAzC;AACD,WAFM,MAEA;AACLnB,mBAAO,CAACC,GAAR,CAAY,iBAAZ;AACD;AACF;;;qDAE4BsY,K,EAAQ;AACnC,cAAI,KAAKrX,MAAL,IAAe,KAAKC,UAApB,IAAkC,KAAK6H,qBAA3C,EAAkE;AAChE,iBAAK6U,gCAAL,CAAsC,KAAK3c,MAA3C,EAAmD,KAAKC,UAAxD,EAAoE,KAAK6H,qBAAzE;AACD,WAFD,MAEO;AACLhJ,mBAAO,CAACC,GAAR,CAAY,sBAAZ;AACD;AACF;;;oDAE2B;AAC1B,eAAK,IAAI6E,GAAG,GAAG,CAAf,EAAkBA,GAAG,IAAI,CAAzB,EAA4BA,GAAG,EAA/B,EAAmC;AACjC,gBAAIiU,cAAc,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,mBAAmBrU,GAAxC,CAAX,CAArB;;AAEA,gBAAIiU,cAAc,IAAIA,cAAc,CAACK,MAArC,EAA6C;AAC3C,kBAAItU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAKyN,QAAL,GAAgBwG,cAAhB;AACD;;AACD,kBAAIjU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAK0N,QAAL,GAAgBuG,cAAhB;AACD;;AACD,kBAAIjU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAK2N,QAAL,GAAgBsG,cAAhB;AACD;;AACD,kBAAIjU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAK4N,QAAL,GAAgBqG,cAAhB;AACD;;AACD,kBAAIjU,GAAG,KAAK,CAAZ,EAAe;AACb,qBAAK6N,QAAL,GAAgBoG,cAAhB;AACD;;AACD,kBAAI7X,MAAM,GAAG6X,cAAc,CAAC7X,MAA5B;AACA,kBAAIC,UAAU,GAAG4X,cAAc,CAACvX,MAAhC;AACA,kBAAI4X,MAAM,GAAGL,cAAc,CAACK,MAA5B;AACA,mBAAKyE,gCAAL,CAAsC3c,MAAtC,EAA8CC,UAA9C,EAA0DiY,MAA1D;AACD;AACF;;AAED,eAAK0E,eAAL;AAEA;;;;;AAKD;;;0CAEiB;AAAA;;AAChB,cAAIhY,GAAG,GAAG,EAAV;;AACA,cAAI,KAAKuO,MAAT,EAAiB;AACf,iBAAKA,MAAL,CAAYrP,OAAZ,CAAoB,UAACP,GAAD,EAAS;AAC3B,kBAAIA,GAAG,CAACwT,QAAR,EAAkB;AAEhB,oBAAIxT,GAAG,CAACyT,MAAR,EAAgB;AACd,sBAAItR,EAAE,GAAG,OAAI,CAACmX,qBAAL,CAA2BtZ,GAAG,CAACyT,MAA/B,EAAuCzT,GAAG,CAACvD,MAA3C,EAAmDuD,GAAG,CAACjD,MAAvD,CAAT;;AACAsE,qBAAG,CAACD,IAAJ,CAASe,EAAT;AACD;;AAED,oBAAInC,GAAG,CAAC0T,MAAR,EAAgB;AACd,sBAAInM,EAAE,GAAG,OAAI,CAAC+R,qBAAL,CAA2BtZ,GAAG,CAAC0T,MAA/B,EAAuC1T,GAAG,CAACvD,MAA3C,EAAmDuD,GAAG,CAACjD,MAAvD,CAAT;;AACAsE,qBAAG,CAACD,IAAJ,CAASmG,EAAT;AACD;AACF;AACF,aAbD;AAcD;;AACDhM,iBAAO,CAACC,GAAR,CAAY,aAAZ,EAA2B6F,GAA3B;AACA,eAAKlK,UAAL,CAAgBiL,iBAAhB,CAAkCf,GAAlC;AACD;;;8CAEqBR,K,EAAOpE,M,EAAQM,M,EAAQ;AAC3C,cAAIW,MAAM,GAAGmD,KAAb;AACA,cAAIjD,IAAI,GAAG,EAAX;;AACA,cAAIF,MAAM,CAACzB,QAAP,CAAgB,IAAhB,CAAJ,EAA2B;AACzB2B,gBAAI,GAAG,IAAP;AACD;;AACD,cAAIF,MAAM,CAACzB,QAAP,CAAgB,IAAhB,CAAJ,EAA2B;AACzB2B,gBAAI,GAAG,IAAP;AACD;;AACDrC,iBAAO,CAACC,GAAR,CAAY,mCAAmCkC,MAA/C;AACAA,gBAAM,GAAGA,MAAM,CAAC8D,KAAP,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAAT,CAV2C,CAUb;;AAE9B,cAAI9E,UAAU,GAAG,IAAIM,IAAJ,CAASD,MAAT,EAAiB8E,YAAjB,EAAjB,CAZ2C,CAYO;;AAElD,cAAIM,EAAE,GAAG,IAAI,yDAAJ,EAAT;AACAA,YAAE,CAACpF,MAAH,GAAYL,UAAZ;AACAyF,YAAE,CAAC1F,MAAH,GAAYA,MAAZ;AACA0F,YAAE,CAACxE,MAAH,GAAYqE,MAAM,CAACtE,MAAD,CAAlB;AACAyE,YAAE,CAACvE,IAAH,GAAUA,IAAV;AAEA,iBAAOuE,EAAP;AACD;;;yDAEgC1F,M,EAAQ2O,W,EAAauJ,M,EAAQ;AAAA;;AAC5D,cAAItT,GAAG,GAAG,EAAV;AAEAsT,gBAAM,CAACpU,OAAP,CAAe,UAAAP,GAAG,EAAI;AACpB,gBAAImC,EAAE,GAAG,OAAI,CAACmX,qBAAL,CAA2BtZ,GAAG,CAACa,KAA/B,EAAsCpE,MAAtC,EAA8CuD,GAAG,CAACjD,MAAlD,CAAT;;AACAsE,eAAG,CAACD,IAAJ,CAASe,EAAT;AACD,WAHD;AAKA,cAAIzF,UAAU,GAAG,IAAIM,IAAJ,CAASoO,WAAT,EAAsBvJ,YAAtB,EAAjB;AAEA,cAAIM,EAAE,GAAG,IAAI,yDAAJ,EAAT;AACAA,YAAE,CAACpF,MAAH,GAAYL,UAAZ;AACAyF,YAAE,CAAC1F,MAAH,GAAYA,MAAZ;AACA0F,YAAE,CAACxE,MAAH,GAAYqE,MAAM,CAAC,KAAK0N,kBAAN,CAAlB;AACAvN,YAAE,CAACvE,IAAH,GAAU,IAAV;AACAyD,aAAG,CAACD,IAAJ,CAASe,EAAT;AAEA,cAAIoF,EAAE,GAAG,IAAI,yDAAJ,EAAT;AACAA,YAAE,CAACxK,MAAH,GAAYL,UAAZ;AACA6K,YAAE,CAAC9K,MAAH,GAAYA,MAAZ;AACA8K,YAAE,CAAC5J,MAAH,GAAYqE,MAAM,CAAC,KAAK0N,kBAAN,CAAlB;AACAnI,YAAE,CAAC3J,IAAH,GAAU,IAAV;AACAyD,aAAG,CAACD,IAAJ,CAASmG,EAAT;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCAhM,iBAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyC6F,GAAzC;AACA,eAAKlK,UAAL,CAAgBiL,iBAAhB,CAAkCf,GAAlC;AACD;;;mDAE0B5E,M,EAAQ2O,W,EAAavK,K,EAAO;AACrD,cAAIQ,GAAG,GAAG,EAAV;AAEA,cAAI3D,MAAM,GAAGmD,KAAb;AACA,cAAIjD,IAAI,GAAG,EAAX;;AACA,cAAIF,MAAM,CAACzB,QAAP,CAAgB,IAAhB,CAAJ,EAA2B;AACzB2B,gBAAI,GAAG,IAAP;AACD;;AACD,cAAIF,MAAM,CAACzB,QAAP,CAAgB,IAAhB,CAAJ,EAA2B;AACzB2B,gBAAI,GAAG,IAAP;AACD;;AACDrC,iBAAO,CAACC,GAAR,CAAY,wCAAwCkC,MAApD;AACAA,gBAAM,GAAGA,MAAM,CAAC8D,KAAP,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAAT,CAZqD,CAYvB;;AAE9B,cAAI9E,UAAU,GAAG,IAAIM,IAAJ,CAASoO,WAAT,EAAsBvJ,YAAtB,EAAjB;AAEA,cAAIM,EAAE,GAAG,IAAI,yDAAJ,EAAT;AACAA,YAAE,CAACpF,MAAH,GAAYL,UAAZ;AACAyF,YAAE,CAAC1F,MAAH,GAAYA,MAAZ;AACA0F,YAAE,CAACxE,MAAH,GAAYqE,MAAM,CAACtE,MAAD,CAAlB;AACAyE,YAAE,CAACvE,IAAH,GAAUA,IAAV;AACAyD,aAAG,CAACD,IAAJ,CAASe,EAAT;AAEA5G,iBAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmC6F,GAAnC;AACA,eAAKlK,UAAL,CAAgBiL,iBAAhB,CAAkCf,GAAlC;AACD;;;uCAGchB,G,EAA4C;AAAA;;AAAA,cAAvCkZ,UAAuC,uEAA1B,KAA0B;AAAA,cAAnB3B,UAAmB,uEAAN,IAAM;AACzD,cAAItD,cAAc,GAAG,IAArB;;AACA,cAAI,CAACiF,UAAL,EAAiB;AACfjF,0BAAc,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,mBAAmBrU,GAAxC,CAAX,CAAjB;AACD,WAFD,MAEO;AACLiU,0BAAc,GAAG,KAAKkF,qBAAL,CAA2B5B,UAA3B,CAAjB;AACD;;AACD,eAAKzJ,WAAL,GAAmB9N,GAAnB;AACA9E,iBAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgC8Y,cAAhC;AAEA,eAAK/P,qBAAL,GAA6B,IAA7B;;AACA,cAAI+P,cAAc,IAAIA,cAAc,CAACK,MAArC,EAA6C;AAC3C,iBAAKlY,MAAL,GAAc6X,cAAc,CAAC7X,MAA7B;AACA,iBAAKC,UAAL,GAAkB4X,cAAc,CAACvX,MAAjC;AACA,iBAAKwH,qBAAL,GAA6B+P,cAAc,CAACK,MAA5C;AAEA,iBAAKpQ,qBAAL,CAA2BhE,OAA3B,CAAmC,UAAAxK,CAAC,EAAI;AACtCA,eAAC,CAACyd,QAAF,GAAa,IAAb;AACAzd,eAAC,CAAC0jB,cAAF,GAAmB,IAAnB;AACD,aAHD;;AAKA,gBAAI,KAAKhd,MAAL,KAAgB,OAApB,EAA6B;AAC3B,mBAAKqS,SAAL,GAAiB,EAAjB;AACD,aAFD,MAEO,IAAI,KAAKrS,MAAL,KAAgB,WAApB,EAAiC;AACtC,mBAAKqS,SAAL,GAAiB,EAAjB;AACD,aAFM,MAEA;AACL,mBAAKA,SAAL,GAAiB,IAAjB;AACD;;AAED,iBAAKvK,qBAAL,CAA2BiC,IAA3B,CAAgC,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAExC;AACA;;AAEA;;;;;;;AAQA;AAEA,kBAAID,CAAC,CAAC5B,IAAF,KAAW,CAAX,IAAgB6B,CAAC,CAAC7B,IAAF,KAAW,CAA/B,EAAkC;AAChC;AACA,uBAAO,OAAI,CAAC6U,iBAAL,CAAuBjT,CAAC,CAAC5F,KAAzB,EAAgC6F,CAAC,CAAC7F,KAAlC,CAAP;AACD;;AACD,kBAAI4F,CAAC,CAAC5B,IAAF,KAAW,CAAX,IAAgB6B,CAAC,CAAC7B,IAAF,KAAW,CAA/B,EAAkC;AAChC,uBAAO,CAAC,CAAR;AACD;;AACD,kBAAI4B,CAAC,CAAC5B,IAAF,KAAW,CAAX,IAAgB6B,CAAC,CAAC7B,IAAF,KAAW,CAA/B,EAAkC;AAChC,uBAAO,CAAP;AACD;;AACD,kBAAI8U,QAAQ,GAAGlT,CAAC,CAAC5F,KAAF,CAAQW,KAAR,CAAc,CAAd,EAAiB,CAAC,CAAlB,CAAf;AACA,kBAAIoY,QAAQ,GAAGlT,CAAC,CAAC7F,KAAF,CAAQW,KAAR,CAAc,CAAd,EAAiB,CAAC,CAAlB,CAAf;;AACA,kBAAImY,QAAQ,KAAKC,QAAb,IAAyBnT,CAAC,CAAC5F,KAAF,CAAQ5E,QAAR,CAAiB,IAAjB,CAAzB,IAAmDyK,CAAC,CAAC7F,KAAF,CAAQ5E,QAAR,CAAiB,IAAjB,CAAvD,EAA+E;AAAE;AAC/E,uBAAO,CAAC,CAAR;AACD;;AACD,kBAAI0d,QAAQ,KAAKC,QAAb,IAAyBnT,CAAC,CAAC5F,KAAF,CAAQ5E,QAAR,CAAiB,IAAjB,CAAzB,IAAmDyK,CAAC,CAAC7F,KAAF,CAAQ5E,QAAR,CAAiB,IAAjB,CAAvD,EAA+E;AAAE;AAC/E,uBAAO,CAAP;AACD,eAhCuC,CAiCxC;;;AACA,qBAAO,OAAI,CAACyd,iBAAL,CAAuBjT,CAAC,CAAC5F,KAAzB,EAAgC6F,CAAC,CAAC7F,KAAlC,CAAP;AAED,aApCD;AAqCD;;AACD,oFAAa0D,qBAAb,GAAqC,KAAKA,qBAA1C;AACA,eAAKsV,mBAAL;AACA,eAAK3F,gBAAL;AACD;;;0CAEiB4F,M,EAAQC,M,EAAQ;AAEhC;AACA,cAAID,MAAM,CAAC7d,QAAP,CAAgB,IAAhB,KAAyB8d,MAAM,CAAC9d,QAAP,CAAgB,IAAhB,CAA7B,EAAoD;AAAE;AACpD,mBAAO,CAAC,CAAR;AACD;;AACD,cAAI6d,MAAM,CAAC7d,QAAP,CAAgB,IAAhB,KAAyB8d,MAAM,CAAC9d,QAAP,CAAgB,IAAhB,CAA7B,EAAoD;AAAE;AACpD,mBAAO,CAAP;AACD,WAR+B,CAUhC;;;AACA,cAAI0d,QAAQ,GAAGG,MAAM,CAACtY,KAAP,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAAf;AACA,cAAIoY,QAAQ,GAAGG,MAAM,CAACvY,KAAP,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAAf;;AACA,cAAImY,QAAQ,GAAGC,QAAf,EAAyB;AACvB,mBAAO,CAAC,CAAR;AACD;;AACD,iBAAO,CAAP;AAED;;;8CAEqB;AACpB;;;;;;;;;;;;;;AAcD;;;sCAEmD;AAAA,cAAxC9W,GAAwC,uEAAlC,IAAkC;AAAA,cAA5BjC,KAA4B,uEAApB,IAAoB;AAAA,cAAdiE,KAAc,uEAAN,IAAM;;AAClD,cAAI,KAAKP,qBAAL,KAA+B,IAAnC,EAAyC;AACvC,iBAAKA,qBAAL,GAA6B,EAA7B;AACD;;AACD,cAAIgS,CAAC,GAAG,IAAIvZ,IAAJ,CAAS,KAAKN,UAAd,CAAR;AACA,cAAIsd,UAAU,GAAG,CAAE,KAAF,EAAS,KAAT,EAAgB,KAAhB,EAAuB,KAAvB,EACC,KADD,EACQ,KADR,EACe,KADf,EACsB,KADtB,EAEC,KAFD,EAEQ,KAFR,EAEe,KAFf,EAEsB,KAFtB,CAAjB;AAGA,cAAIC,GAAG,GAAG,CAAC,MAAM1D,CAAC,CAACpZ,OAAF,EAAP,EAAoBqE,KAApB,CAA0B,CAAC,CAA3B,CAAV;AACA,cAAI0Y,UAAU,GAAG3D,CAAC,CAACrZ,QAAF,EAAjB;AACA,cAAIid,SAAS,GAAGH,UAAU,CAACE,UAAD,CAA1B;AACA,cAAInY,IAAI,GAAGwU,CAAC,CAACtZ,WAAF,EAAX;AACA,cAAImd,UAAU,GAAGH,GAAG,GAAGE,SAAN,GAAkBpY,IAAnC,CAZkD,CAalD;;AACA,eAAKwC,qBAAL,CAA2BnD,IAA3B,CAAgC;AAAE0B,eAAG,EAAEA,GAAP;AAAYjC,iBAAK,EAAEA,KAAnB;AAA0B9D,kBAAM,EAAEqd,UAAlC;AAA8CtV,iBAAK,EAAEA,KAArD;AAA4DD,gBAAI,EAAE,CAAlE;AAAqE2O,oBAAQ,EAAE,IAA/E;AAAqFiG,0BAAc,EAAE;AAArG,WAAhC;AACD;;;0CAEiBY,G,EAA6C;AAAA,cAAxCvX,GAAwC,uEAAlC,IAAkC;AAAA,cAA5BjC,KAA4B,uEAApB,IAAoB;AAAA,cAAdiE,KAAc,uEAAN,IAAM;AAC7D,cAAIyR,CAAC,GAAG,IAAIvZ,IAAJ,CAAS,KAAKN,UAAd,CAAR;AACA,cAAIsd,UAAU,GAAG,CAAE,KAAF,EAAS,KAAT,EAAgB,KAAhB,EAAuB,KAAvB,EACC,KADD,EACQ,KADR,EACe,KADf,EACsB,KADtB,EAEC,KAFD,EAEQ,KAFR,EAEe,KAFf,EAEsB,KAFtB,CAAjB;AAGA,cAAIC,GAAG,GAAG,CAAC,MAAM1D,CAAC,CAACpZ,OAAF,EAAP,EAAoBqE,KAApB,CAA0B,CAAC,CAA3B,CAAV;AACA,cAAI0Y,UAAU,GAAG3D,CAAC,CAACrZ,QAAF,EAAjB;AACA,cAAIid,SAAS,GAAGH,UAAU,CAACE,UAAD,CAA1B;AACA,cAAInY,IAAI,GAAGwU,CAAC,CAACtZ,WAAF,EAAX;AACA,cAAImd,UAAU,GAAGH,GAAG,GAAGE,SAAN,GAAkBpY,IAAnC,CAT6D,CAU7D;;AACAsY,aAAG,CAACjZ,IAAJ,CAAS;AAAE0B,eAAG,EAAEA,GAAP;AAAYjC,iBAAK,EAAEA,KAAnB;AAA0B9D,kBAAM,EAAEqd,UAAlC;AAA8CtV,iBAAK,EAAEA,KAArD;AAA4DD,gBAAI,EAAE,CAAlE;AAAqE2O,oBAAQ,EAAE,IAA/E;AAAqFiG,0BAAc,EAAE;AAArG,WAAT;AACD;;;sCAEazZ,G,EAAK;AACjB,eAAKuE,qBAAL,CAA2BnD,IAA3B,CAAgC;AAAE0B,eAAG,EAAE,CAAP;AAAUjC,iBAAK,EAAEb,GAAG,CAACa,KAArB;AAA4B9D,kBAAM,EAAEiD,GAAG,CAACjD,MAAxC;AAAgD+H,iBAAK,EAAE9E,GAAG,CAAC8E,KAA3D;AAAkED,gBAAI,EAAE7E,GAAG,CAAC6E,IAA5E;AAAkF2O,oBAAQ,EAAE,IAA5F;AAAkGiG,0BAAc,EAAE;AAAlH,WAAhC;AACD;;;uCAEczZ,G,EAAK;AAElB,cAAIsa,WAAW,GAAG,CAAC,GAAnB;;AACA,eAAK,IAAInV,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG,KAAKZ,qBAAL,CAA2BE,MAAvD,EAA+DU,KAAK,EAApE,EAAwE;AACtE,gBAAIT,OAAO,GAAG,KAAKH,qBAAL,CAA2BY,KAA3B,CAAd;;AACA,gBAAIT,OAAO,CAAC5B,GAAR,KAAgB9C,GAAG,CAAC8C,GAApB,IAA2B4B,OAAO,CAAC7D,KAAR,KAAkBb,GAAG,CAACa,KAAjD,IAA0D6D,OAAO,CAAC3H,MAAR,KAAmBiD,GAAG,CAACjD,MAAjF,IAA2F2H,OAAO,CAACI,KAAR,KAAkB9E,GAAG,CAAC8E,KAAjH,IACAJ,OAAO,CAACG,IAAR,KAAiB7E,GAAG,CAAC6E,IADzB,EAC+B;AAC7ByV,yBAAW,GAAGnV,KAAd;AACA;AACD;AACF;;AACD,cAAImV,WAAW,KAAK,CAAC,GAArB,EAA0B;AACxB,iBAAK/V,qBAAL,CAA2BgW,MAA3B,CAAkCD,WAAlC,EAA+C,CAA/C;AACD;AACF;;;0CAEiB;AAChB,eAAKT,mBAAL;AACA,eAAKzF,SAAL;AACA,eAAKoG,SAAL;AACD;;;yCAEgBna,G,EAAK;AACpB,eAAK8Y,cAAL,CAAoB9Y,GAApB;AACA,eAAK+T,SAAL;AACA,eAAKoG,SAAL;AACD;;;sCAEana,G,EAAK;AAEjB;AACA;AACA,cAAMoa,aAAa,GAAG,SAAhBA,aAAgB,GAAc;AAAA,gBAAbJ,GAAa,uEAAP,EAAO;AAClC,gBAAM3e,GAAG,GAAG2e,GAAG,CAACK,MAAJ,CAAW,UAACC,GAAD,EAAMC,GAAN,EAAc;AAEnC;AAEA,kBAAIA,GAAG,CAAC/V,IAAJ,KAAa,CAAjB,EAAoB;AAClB8V,mBAAG,CAACvZ,IAAJ,CAASwZ,GAAT;AACA,uBAAOD,GAAP;AACD;;AAED,kBAAIC,GAAG,CAACC,WAAJ,KAAoB,IAAxB,EAA8B;AAC5B,uBAAOF,GAAP;AACD,eAXkC,CAanC;;;AAEA,kBAAIG,KAAK,GAAG,KAAZ;;AAEA,mBAAK,IAAItW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmW,GAAG,CAAClW,MAAxB,EAAgCD,CAAC,EAAjC,EAAqC;AAEnC,oBAAImW,GAAG,CAACnW,CAAD,CAAH,CAAOqW,WAAP,KAAuB,IAA3B,EAAiC;AAC/B;AACD;;AAED,oBAAIF,GAAG,CAACnW,CAAD,CAAH,CAAOK,IAAP,KAAgB,CAAhB,IAAqB8V,GAAG,CAACnW,CAAD,CAAH,CAAO3D,KAAP,KAAiB+Z,GAAG,CAAC/Z,KAA1C,IAAmD8Z,GAAG,CAACnW,CAAD,CAAH,CAAOzH,MAAP,KAAkB6d,GAAG,CAAC7d,MAA7E,EAAqF;AACnF+d,uBAAK,GAAG,IAAR;;AAEA,sBAAKH,GAAG,CAACnW,CAAD,CAAH,CAAO1B,GAAP,GAAa,CAAb,IAAkB8X,GAAG,CAAC9X,GAAJ,GAAU,CAA7B,IAAoC6X,GAAG,CAACnW,CAAD,CAAH,CAAO1B,GAAP,GAAa,CAAb,IAAkB8X,GAAG,CAAC9X,GAAJ,GAAU,CAApE,EAAwE;AACtE6X,uBAAG,CAACnW,CAAD,CAAH,CAAOM,KAAP,GAAe,CAAE6V,GAAG,CAACnW,CAAD,CAAH,CAAOM,KAAP,GAAe6V,GAAG,CAACnW,CAAD,CAAH,CAAO1B,GAAvB,GAA+B8X,GAAG,CAAC9V,KAAJ,GAAY8V,GAAG,CAAC9X,GAAhD,KAAyD6X,GAAG,CAACnW,CAAD,CAAH,CAAO1B,GAAP,GAAa8X,GAAG,CAAC9X,GAA1E,CAAf;AACA6X,uBAAG,CAACnW,CAAD,CAAH,CAAOM,KAAP,GAAgBvH,IAAI,CAACC,KAAL,CAAW,CAACmd,GAAG,CAACnW,CAAD,CAAH,CAAOM,KAAP,GAAe,OAAhB,IAA2B,KAAtC,IAA+C,KAA/D,CAFsE,CAEC;;AACvE6V,uBAAG,CAACnW,CAAD,CAAH,CAAO1B,GAAP,IAAc8X,GAAG,CAAC9X,GAAlB;AACD,mBAJD,MAIO;AACL,wBAAIiY,OAAO,GAAGJ,GAAG,CAACnW,CAAD,CAAH,CAAO1B,GAAP,GAAa8X,GAAG,CAAC9X,GAA/B;;AAEA,wBAAIiY,OAAO,KAAK,CAAhB,EAAmB;AAAE;AAEnB,0BAAIxd,IAAI,CAACwG,GAAL,CAAS4W,GAAG,CAACnW,CAAD,CAAH,CAAO1B,GAAhB,IAAuBvF,IAAI,CAACwG,GAAL,CAAS6W,GAAG,CAAC9X,GAAb,CAA3B,EAA8C;AAE5C,4BAAIkY,IAAI,GAAGpkB,MAAM,CAACqkB,MAAP,CAAc,EAAd,EAAkBN,GAAG,CAACnW,CAAD,CAArB,CAAX;AACAwW,4BAAI,CAAClY,GAAL,GAAWiY,OAAX;AACAC,4BAAI,CAAClW,KAAL,GAAa6V,GAAG,CAACnW,CAAD,CAAH,CAAOM,KAApB;AACAkW,4BAAI,CAACH,WAAL,GAAmB,IAAnB;AACAF,2BAAG,CAACvZ,IAAJ,CAAS4Z,IAAT;AAEAL,2BAAG,CAACnW,CAAD,CAAH,CAAO1B,GAAP,GAAa,CAAC8X,GAAG,CAAC9X,GAAlB;AACA6X,2BAAG,CAACnW,CAAD,CAAH,CAAOK,IAAP,GAAc+V,GAAG,CAAC9V,KAAlB,CAT4C,CAW5C;AACD,uBAZD,MAYO;AAEL,4BAAIkW,KAAI,GAAGpkB,MAAM,CAACqkB,MAAP,CAAc,EAAd,EAAkBN,GAAG,CAACnW,CAAD,CAArB,CAAX;;AACAwW,6BAAI,CAAClY,GAAL,GAAWiY,OAAX;AACAC,6BAAI,CAAClW,KAAL,GAAa8V,GAAG,CAAC9V,KAAjB;AACAkW,6BAAI,CAACH,WAAL,GAAmB,IAAnB;AACAF,2BAAG,CAACvZ,IAAJ,CAAS4Z,KAAT;AAEAL,2BAAG,CAACnW,CAAD,CAAH,CAAOK,IAAP,GAAc+V,GAAG,CAAC9V,KAAlB;AACD;AAEF,qBAzBD,MAyBO;AACL6V,yBAAG,CAACnW,CAAD,CAAH,CAAOK,IAAP,GAAc+V,GAAG,CAAC9V,KAAlB;AACD;AACF;AACF;AACF;;AACD,kBAAIgW,KAAK,KAAK,KAAd,EAAqB;AACnBH,mBAAG,CAACvZ,IAAJ,CAASwZ,GAAT;AACD;;AACD,qBAAOD,GAAP;AACD,aApEW,EAoET,EApES,CAAZ;AAqEA,mBAAOjf,GAAP;AACD,WAvED;;AAwEA,eAAK6I,qBAAL,GAA6BkW,aAAa,CAAC,KAAKlW,qBAAN,CAA1C,CA5EiB,CA6EjB;;AACAhJ,iBAAO,CAACC,GAAR,CAAY,KAAK+I,qBAAjB;;AAEA,cAAId,OAAO,CAAC,eAAepD,GAAf,GAAqB,GAAtB,CAAX,EAAuC;AACrC,gBAAIiU,cAAc,GAAG;AAAE7X,oBAAM,EAAE,EAAV;AAAcM,oBAAM,EAAE,EAAtB;AAA0B4X,oBAAM,EAAE;AAAlC,aAArB;AAEAL,0BAAc,CAAC7X,MAAf,GAAwB,KAAKA,MAA7B;AACA6X,0BAAc,CAACvX,MAAf,GAAwB,KAAKL,UAA7B;AAEA,iBAAK6H,qBAAL,CAA2BhE,OAA3B,CAAmC,UAAAmE,OAAO,EAAI;AAC5C,qBAAOA,OAAO,CAAC8O,QAAf;AACA,qBAAO9O,OAAO,CAAC+U,cAAf;AACA,qBAAO/U,OAAO,CAAClE,GAAf;AACD,aAJD;AAMA8T,0BAAc,CAACK,MAAf,GAAwB,KAAKpQ,qBAA7B;AAEAhJ,mBAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkC8Y,cAAlC;AACA/Y,mBAAO,CAACC,GAAR,CAAY,yBAAZ,EAAuC+Y,IAAI,CAAC2G,SAAL,CAAe5G,cAAf,CAAvC;AACAG,wBAAY,CAAC0G,OAAb,CACE,mBAAmB9a,GADrB,EAEEkU,IAAI,CAAC2G,SAAL,CAAe5G,cAAf,CAFF;AAIA,iBAAK8G,gBAAL,CAAsB/a,GAAtB,EApBqC,CAqBrC;;AAEA,iBAAK,IAAIA,IAAG,GAAG,CAAf,EAAkBA,IAAG,IAAI,CAAzB,EAA4BA,IAAG,EAA/B,EAAmC;AACjC,kBAAIiU,eAAc,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,mBAAmBrU,IAAxC,CAAX,CAArB;;AAEA,kBAAIiU,eAAc,IAAIA,eAAc,CAACK,MAArC,EAA6C;AAC3C,oBAAItU,IAAG,KAAK,CAAZ,EAAe;AACb,uBAAKyN,QAAL,GAAgBwG,eAAhB;AACD;;AACD,oBAAIjU,IAAG,KAAK,CAAZ,EAAe;AACb,uBAAK0N,QAAL,GAAgBuG,eAAhB;AACD;;AACD,oBAAIjU,IAAG,KAAK,CAAZ,EAAe;AACb,uBAAK2N,QAAL,GAAgBsG,eAAhB;AACD;;AACD,oBAAIjU,IAAG,KAAK,CAAZ,EAAe;AACb,uBAAK4N,QAAL,GAAgBqG,eAAhB;AACD;;AACD,oBAAIjU,IAAG,KAAK,CAAZ,EAAe;AACb,uBAAK6N,QAAL,GAAgBoG,eAAhB;AACD;AACF;AACF;AACF;AACF;;;2CAEkB;AACjB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCD;;;oDAE2B;AAE1B,cAAI9G,OAAO,GAAG,EAAd;AACA,cAAI6N,eAAJ;AACA,cAAIvY,GAAJ;;AACA,cAAI,KAAKyB,qBAAT,EAAgC;AAC9B,iBAAKA,qBAAL,CAA2BhE,OAA3B,CAAmC,UAAAmE,OAAO,EAAI;AAC5C,kBAAIA,OAAO,CAACG,IAAR,KAAiB,CAArB,EAAwB;AACtB,oBAAIsI,UAAU,GAAGzI,OAAO,CAAC7D,KAAR,CAAcW,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB,CAAjB,CADsB,CACuB;;AAC7C,oBAAIgM,OAAO,CAACvR,QAAR,CAAiBkR,UAAjB,CAAJ,EAAkC;AAChCkO,iCAAe,GAAGlO,UAAlB;AACArK,qBAAG,GAAGvF,IAAI,CAACwG,GAAL,CAASW,OAAO,CAAC5B,GAAjB,CAAN;AACD,iBAHD,MAGO;AACL0K,yBAAO,CAACpM,IAAR,CAAa+L,UAAb;AACD;AACF;AACF,aAVD;AAYA5R,mBAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgC6f,eAAhC;;AACA,gBAAIA,eAAJ,EAAqB;AACnB,mBAAK9W,qBAAL,CAA2BhE,OAA3B,CAAmC,UAAAmE,OAAO,EAAI;AAC5C,oBAAIA,OAAO,CAACG,IAAR,KAAiB,CAArB,EAAwB;AACtB,sBAAIsI,UAAU,GAAGzI,OAAO,CAAC7D,KAAR,CAAcW,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB,CAAjB,CADsB,CACuB;;AAC7C,sBAAI2L,UAAU,KAAKkO,eAAnB,EAAoC;AAClC3W,2BAAO,CAAC8O,QAAR,GAAmB,KAAnB;AACD;AACF;AACF,eAPD;AAQD;;AAEDjY,mBAAO,CAACC,GAAR,CAAY,WAAZ,EAAyB,KAAK+I,qBAA9B;AACD;;AACD,iBAAO,CAAC8W,eAAD,EAAkBvY,GAAlB,CAAP;AACD;;;4CAEmBuY,e,EAAiBvY,G,EAAKlF,I,EAAM;AAE9C,cAAID,MAAJ;;AACA,cAAI,KAAK4G,qBAAT,EAAgC;AAC9B,iBAAKA,qBAAL,CAA2BhE,OAA3B,CAAmC,UAAAmE,OAAO,EAAI;AAC5C,kBAAIA,OAAO,CAACG,IAAR,KAAiB,CAArB,EAAwB;AAEtB,oBAAIH,OAAO,CAAC8O,QAAZ,EAAsB;AACpB,sBAAI9O,OAAO,CAAC7D,KAAR,CAAc5E,QAAd,CAAuB2B,IAAvB,KAAgC8G,OAAO,CAAC5B,GAAR,KAAgBA,GAApD,EAAyD;AACvDnF,0BAAM,GAAG+G,OAAO,CAAC7D,KAAR,CAAcW,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB,CAAT,CADuD,CAClB;AACtC;AACF;AACF;AACF,aATD;AAUD;;AACDjG,iBAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BmC,MAA7B;AACA,iBAAOA,MAAP;AACD;;;6CAEoBiX,K,EAAO;AAC1B,cAAIA,KAAK,CAAC0G,aAAN,CAAoBC,OAAxB,EAAiC;AAC/B,gBAAI,KAAKC,cAAT,EAAyB;AACvB,kBAAIC,WAAW,GAAG,KAAKD,cAAvB;AACA,kBAAIH,eAAe,GAAG,KAAKK,yBAAL,EAAtB;AACA,kBAAIC,eAAe,GAAG,KAAK5H,aAAL,CAAmB;AAAElT,qBAAK,EAAG4a,WAAW,GAAG;AAAxB,eAAnB,EAAmD,KAAKhf,MAAxD,EAAgE,KAAKC,UAArE,CAAtB;AACA,mBAAK0W,WAAL,CAAiB,CAACiI,eAAe,CAAC,CAAD,CAAjC,EAAsCI,WAAW,GAAG,IAApD,EAA0DE,eAA1D;AACA,kBAAIC,eAAe,GAAG,KAAK7H,aAAL,CAAmB;AAAElT,qBAAK,EAAG4a,WAAW,GAAG;AAAxB,eAAnB,EAAmD,KAAKhf,MAAxD,EAAgE,KAAKC,UAArE,CAAtB;AACA,mBAAK0W,WAAL,CAAiB,CAACiI,eAAe,CAAC,CAAD,CAAjC,EAAsCI,WAAW,GAAG,IAApD,EAA0DG,eAA1D;AACA,mBAAKC,eAAL;AACD;AACF,WAVD,MAUO;AACL,iBAAKT,gBAAL,CAAsB,KAAKjN,WAA3B;AACD;AACF;;;oCAEW;AAAA;;AAEV,cAAI2N,QAAQ,GAAG;AAAEC,iBAAK,EAAE;AAAT,WAAf;AACA,cAAIxd,GAAG,GAAG,CAAV;;AACA,cAAI,KAAK9B,MAAL,KAAgB,QAApB,EAA8B;AAC5B,gBAAI,KAAKgT,eAAT,EAA0B;AACxB,kBAAIuM,UAAU,GAAG,KAAKjI,aAAL,CAAmB;AAAElT,qBAAK,EAAG,KAAK6O,kBAAL,GAA0B;AAApC,eAAnB,EAA+D,KAAKjT,MAApE,EAA4E,KAAKC,UAAjF,CAAjB;AACA,kBAAIuf,UAAU,GAAG,KAAKlI,aAAL,CAAmB;AAAElT,qBAAK,EAAG,KAAK6O,kBAAL,GAA0B;AAApC,eAAnB,EAA+D,KAAKjT,MAApE,EAA4E,KAAKC,UAAjF,CAAjB;AACA6B,iBAAG,GAAGyd,UAAU,GAAGC,UAAb,GAA0B,KAAKvM,kBAArC,CAHwB,CAGiC;;AACzDnR,iBAAG,GAAIhB,IAAI,CAACC,KAAL,CAAW,CAACe,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA3C,CAJwB,CAKxB;AACD,aAND,MAMO;AACLA,iBAAG,GAAG2d,UAAU,CAAC,KAAKC,YAAL,EAAD,CAAhB;AACA5d,iBAAG,GAAIhB,IAAI,CAACC,KAAL,CAAW,CAACe,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA3C,CAFK,CAE4C;AAClD;AACF,WAXD,MAWO;AACLA,eAAG,GAAGoD,QAAQ,CAAC,KAAKwa,YAAL,EAAD,CAAd;AACD;;AACD5gB,iBAAO,CAACC,GAAR,CAAY,UAAZ,EAAwB+C,GAAxB;AACA,cAAI6d,KAAK,GAAG,IAAZ;AACA,cAAIC,SAAS,GAAG,CAAhB;AACA,cAAIC,QAAQ,GAAG,EAAf;;AACA,cAAI,KAAK7f,MAAL,KAAgB,WAApB,EAAiC;AAC/B2f,iBAAK,GAAG,IAAR;AACAE,oBAAQ,GAAG,GAAX;AACD;;AACD,cAAI,KAAK7f,MAAL,KAAgB,QAApB,EAA8B;AAC5B2f,iBAAK,GAAG,CAAR;AACAC,qBAAS,GAAG,IAAZ;AACAC,oBAAQ,GAAG,IAAX;AACD;;AAED,cAAI,KAAK3M,YAAL,IAAqB,KAAKlT,MAAL,KAAgB,QAAzC,EAAmD;AACjD2f,iBAAK,GAAG,KAAKzM,YAAb;AACD;;AAED,cAAI4M,WAAW,GAAGhe,GAAG,GAAG6d,KAAxB;AACA,cAAII,WAAW,GAAGje,GAAG,GAAG6d,KAAxB;AACA,cAAIK,eAAe,GAAG,EAAtB;AAEA,cAAIC,YAAY,GAAG,CAAnB;AAEA,cAAIC,SAAS,GAAG,EAAhB;AAEA,cAAIC,WAAW,GAAG,EAAlB;AACA,cAAIC,WAAW,GAAG,EAAlB;AACA,cAAIC,WAAW,GAAG,EAAlB;;AAEA,cAAI,KAAKvY,qBAAT,EAAgC;AAE9B,gBAAI,KAAKyL,eAAL,IAAwB,KAAKC,eAAjC,EAAkD;AAChD,kBAAIoL,eAAe,GAAG,KAAKK,yBAAL,EAAtB;AACA,mBAAKnX,qBAAL,CAA2BhE,OAA3B,CAAmC,UAAAmE,OAAO,EAAI;AAC5CkY,2BAAW,CAACxb,IAAZ,CAAiBsD,OAAjB;AACAmY,2BAAW,CAACzb,IAAZ,CAAiBsD,OAAjB;AACAoY,2BAAW,CAAC1b,IAAZ,CAAiBsD,OAAjB;AACD,eAJD;AAMA,kBAAI9G,IAAI,GAAG,IAAX;;AACA,kBAAI,KAAKqS,eAAT,EAA0B;AACxBrS,oBAAI,GAAG,IAAP;AACA0e,wBAAQ,GAAG,CAAC,GAAZ;AACD;;AAED,kBAAIS,YAAY,GAAG,KAAKC,mBAAL,CAAyB3B,eAAe,CAAC,CAAD,CAAxC,EAA6CA,eAAe,CAAC,CAAD,CAA5D,EAAiEzd,IAAjE,CAAnB;AAEA,kBAAI6d,WAAW,GAAGsB,YAAY,GAAGT,QAAjC;AACA,kBAAIX,eAAe,GAAG,KAAK5H,aAAL,CAAmB;AAAElT,qBAAK,EAAG4a,WAAW,GAAG;AAAxB,eAAnB,EAAmD,KAAKhf,MAAxD,EAAgE,KAAKC,UAArE,CAAtB;AACA,mBAAKugB,iBAAL,CAAuBL,WAAvB,EAAoC,CAACvB,eAAe,CAAC,CAAD,CAApD,EAAyDI,WAAW,GAAG,IAAvE,EAA6EE,eAA7E;AACA,kBAAIC,eAAe,GAAG,KAAK7H,aAAL,CAAmB;AAAElT,qBAAK,EAAG4a,WAAW,GAAG;AAAxB,eAAnB,EAAmD,KAAKhf,MAAxD,EAAgE,KAAKC,UAArE,CAAtB;AACA,mBAAKugB,iBAAL,CAAuBL,WAAvB,EAAoC,CAACvB,eAAe,CAAC,CAAD,CAApD,EAAyDI,WAAW,GAAG,IAAvE,EAA6EG,eAA7E;AACArgB,qBAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BohB,WAA5B;AAEA,kBAAIM,WAAW,GAAGH,YAAY,GAAG,IAAET,QAAnC;AACA,kBAAIa,eAAe,GAAG,KAAKpJ,aAAL,CAAmB;AAAElT,qBAAK,EAAGqc,WAAW,GAAG;AAAxB,eAAnB,EAAmD,KAAKzgB,MAAxD,EAAgE,KAAKC,UAArE,CAAtB;AACA,mBAAKugB,iBAAL,CAAuBJ,WAAvB,EAAoC,CAACxB,eAAe,CAAC,CAAD,CAApD,EAAyD6B,WAAW,GAAG,IAAvE,EAA6EC,eAA7E;AACA,kBAAIC,eAAe,GAAG,KAAKrJ,aAAL,CAAmB;AAAElT,qBAAK,EAAGqc,WAAW,GAAG;AAAxB,eAAnB,EAAmD,KAAKzgB,MAAxD,EAAgE,KAAKC,UAArE,CAAtB;AACA,mBAAKugB,iBAAL,CAAuBJ,WAAvB,EAAoC,CAACxB,eAAe,CAAC,CAAD,CAApD,EAAyD6B,WAAW,GAAG,IAAvE,EAA6EE,eAA7E;AACA7hB,qBAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BqhB,WAA5B;AAEA,kBAAIQ,WAAW,GAAGN,YAAY,GAAG,IAAET,QAAnC;AACA,kBAAIgB,eAAe,GAAG,KAAKvJ,aAAL,CAAmB;AAAElT,qBAAK,EAAGwc,WAAW,GAAG;AAAxB,eAAnB,EAAmD,KAAK5gB,MAAxD,EAAgE,KAAKC,UAArE,CAAtB;AACA,mBAAKugB,iBAAL,CAAuBH,WAAvB,EAAoC,CAACzB,eAAe,CAAC,CAAD,CAApD,EAAyDgC,WAAW,GAAG,IAAvE,EAA6EC,eAA7E;AACA,kBAAIC,eAAe,GAAG,KAAKxJ,aAAL,CAAmB;AAAElT,qBAAK,EAAGwc,WAAW,GAAG;AAAxB,eAAnB,EAAmD,KAAK5gB,MAAxD,EAAgE,KAAKC,UAArE,CAAtB;AACA,mBAAKugB,iBAAL,CAAuBH,WAAvB,EAAoC,CAACzB,eAAe,CAAC,CAAD,CAApD,EAAyDgC,WAAW,GAAG,IAAvE,EAA6EE,eAA7E;AACAhiB,qBAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BshB,WAA5B;AACD;;AAED,iBAAKvY,qBAAL,CAA2BhE,OAA3B,CAAmC,UAAAmE,OAAO,EAAI;AAC5C,kBAAIA,OAAO,CAACG,IAAR,IAAgBH,OAAO,CAACG,IAAR,GAAe,CAAnC,EAAsC;AACpC,oBAAI2Y,MAAM,GAAG,OAAI,CAACC,MAAL,CAAY/Y,OAAZ,CAAb;;AACAgY,4BAAY,IAAIc,MAAhB;AACD;;AAED,kBAAI,OAAI,CAACjO,cAAL,IAAuB7K,OAAO,CAAC+U,cAAR,KAA2B,IAAtD,EAA4D;AAC1DkD,yBAAS,CAACvb,IAAV,CAAesD,OAAf;AACD;AACF,aATD;;AAWA,iBAAK,IAAIgZ,KAAK,GAAGnB,WAAjB,EAA8BmB,KAAK,IAAIlB,WAAvC,EAAoDkB,KAAK,IAAIrB,SAA7D,EAAwE;AACtE,kBAAI7b,GAAG,GAAG,CAAV;AACA,kBAAIkL,EAAE,GAAG,CAAT;AACA,kBAAIiS,EAAE,GAAG,CAAT;AACA,kBAAIC,EAAE,GAAG,CAAT;AACA,kBAAIC,UAAU,GAAG,CAAjB;AACA,kBAAIC,SAAS,GAAG,CAAhB;AACA,kBAAIC,WAAW,GAAG,CAAlB;AACA,kBAAIC,WAAW,GAAG,CAAlB;AACA,kBAAI3D,GAAG,GAAG,EAAV;AAEAqD,mBAAK,GAAIngB,IAAI,CAACC,KAAL,CAAW,CAACkgB,KAAK,GAAG,OAAT,IAAoB,GAA/B,IAAsC,GAA/C,CAXsE,CAWjB;;AAErD,kBAAI,KAAKnO,cAAT,EAAyB;AACvB8K,mBAAG,GAAG,KAAK4D,mBAAL,CAAyB,KAAK1Z,qBAA9B,EAAqDmZ,KAArD,EAA4Dnf,GAA5D,EAAiE,IAAjE,CAAN;AACAsf,0BAAU,IAAIxD,GAAG,CAAC,CAAD,CAAjB;AACAwD,0BAAU,IAAInB,YAAd;AACAmB,0BAAU,GAAItgB,IAAI,CAACC,KAAL,CAAW,CAACqgB,UAAU,GAAG,OAAd,IAAyB,GAApC,IAA2C,GAAzD;AAEAC,yBAAS,IAAIzD,GAAG,CAAC,CAAD,CAAhB;AACAyD,yBAAS,IAAIpB,YAAb;AACAoB,yBAAS,GAAIvgB,IAAI,CAACC,KAAL,CAAW,CAACsgB,SAAS,GAAG,OAAb,IAAwB,GAAnC,IAA0C,GAAvD;AAEAzD,mBAAG,GAAG,KAAK4D,mBAAL,CAAyBtB,SAAzB,EAAoCe,KAApC,EAA2Cnf,GAA3C,EAAgD,KAAhD,CAAN;AAED,eAZD,MAYO,IAAI,KAAKyR,eAAL,IAAwB,KAAKC,eAAjC,EAAkD;AACvDoK,mBAAG,GAAG,KAAK4D,mBAAL,CAAyBrB,WAAzB,EAAsCc,KAAtC,EAA6Cnf,GAA7C,EAAkD,IAAlD,CAAN;AACAsf,0BAAU,IAAIxD,GAAG,CAAC,CAAD,CAAjB;AACAwD,0BAAU,IAAInB,YAAd;AACAmB,0BAAU,GAAItgB,IAAI,CAACC,KAAL,CAAW,CAACqgB,UAAU,GAAG,OAAd,IAAyB,GAApC,IAA2C,GAAzD;AAEAxD,mBAAG,GAAG,KAAK4D,mBAAL,CAAyBpB,WAAzB,EAAsCa,KAAtC,EAA6Cnf,GAA7C,EAAkD,IAAlD,CAAN;AACAwf,2BAAW,IAAI1D,GAAG,CAAC,CAAD,CAAlB;AACA0D,2BAAW,IAAIrB,YAAf;AACAqB,2BAAW,GAAIxgB,IAAI,CAACC,KAAL,CAAW,CAACugB,WAAW,GAAG,OAAf,IAA0B,GAArC,IAA4C,GAA3D;AAEA1D,mBAAG,GAAG,KAAK4D,mBAAL,CAAyBnB,WAAzB,EAAsCY,KAAtC,EAA6Cnf,GAA7C,EAAkD,IAAlD,CAAN;AACAyf,2BAAW,IAAI3D,GAAG,CAAC,CAAD,CAAlB;AACA2D,2BAAW,IAAItB,YAAf;AACAsB,2BAAW,GAAIzgB,IAAI,CAACC,KAAL,CAAW,CAACwgB,WAAW,GAAG,OAAf,IAA0B,GAArC,IAA4C,GAA3D;AAEA3D,mBAAG,GAAG,KAAK4D,mBAAL,CAAyB,KAAK1Z,qBAA9B,EAAqDmZ,KAArD,EAA4Dnf,GAA5D,EAAiE,KAAjE,CAAN;AAED,eAlBM,MAkBA;AACL8b,mBAAG,GAAG,KAAK4D,mBAAL,CAAyB,KAAK1Z,qBAA9B,EAAqDmZ,KAArD,EAA4Dnf,GAA5D,EAAiE,KAAjE,CAAN;AACD;;AAEDiC,iBAAG,IAAI6Z,GAAG,CAAC,CAAD,CAAV;AACA7Z,iBAAG,IAAIkc,YAAP;AACAlc,iBAAG,GAAIjD,IAAI,CAACC,KAAL,CAAW,CAACgD,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA3C;AAEAkL,gBAAE,IAAI2O,GAAG,CAAC,CAAD,CAAT;AACA3O,gBAAE,IAAIgR,YAAN;AACAhR,gBAAE,GAAInO,IAAI,CAACC,KAAL,CAAW,CAACkO,EAAE,GAAG,OAAN,IAAiB,GAA5B,IAAmC,GAAzC;AAEAiS,gBAAE,IAAItD,GAAG,CAAC,CAAD,CAAT;AACAsD,gBAAE,IAAIjB,YAAN;AACAiB,gBAAE,GAAIpgB,IAAI,CAACC,KAAL,CAAW,CAACmgB,EAAE,GAAG,OAAN,IAAiB,GAA5B,IAAmC,GAAzC;AAEAC,gBAAE,IAAIvD,GAAG,CAAC,CAAD,CAAT;AACAuD,gBAAE,IAAIlB,YAAN;AACAkB,gBAAE,GAAIrgB,IAAI,CAACC,KAAL,CAAW,CAACogB,EAAE,GAAG,OAAN,IAAiB,GAA5B,IAAmC,GAAzC;AAEAnB,6BAAe,CAACrb,IAAhB,CAAqBZ,GAArB;AACAsb,sBAAQ,CAACC,KAAT,CAAe3a,IAAf,CAAoB;AAAE8c,qBAAK,EAAE1d,GAAT;AAAc2d,0BAAU,EAAET,KAA1B;AAAiCU,qBAAK,EAAE1S,EAAxC;AAA4C2S,kBAAE,EAAEV,EAAhD;AAAoDW,kBAAE,EAAEV,EAAxD;AAA4DW,uBAAO,EAAEV,UAArE;AAAiFW,yBAAS,EAAEV,SAA5F;AAAuGW,wBAAQ,EAAEV,WAAjH;AAA8HW,wBAAQ,EAAEV;AAAxI,eAApB;AACD;;AAEDziB,mBAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBsgB,QAAzB;AAEA,iBAAK1N,UAAL,GAAkB0N,QAAlB;AACA,iBAAK7H,eAAL,CAAqB6H,QAArB;AAEA,iBAAKxN,UAAL,GAAkB,EAAlB;;AACA,iBAAK,IAAI9J,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsX,QAAQ,CAACC,KAAT,CAAetX,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;AAC9C,kBAAIE,OAAO,GAAGoX,QAAQ,CAACC,KAAT,CAAevX,CAAf,CAAd;AACA,kBAAIma,YAAY,GAAG7C,QAAQ,CAACC,KAAT,CAAevX,CAAC,GAAG,CAAnB,CAAnB;;AACA,kBAAKE,OAAO,CAACwZ,KAAR,GAAgB,CAAhB,IAAqBS,YAAY,CAACT,KAAb,IAAsB,CAA5C,IAAmDxZ,OAAO,CAACwZ,KAAR,GAAgB,CAAhB,IAAqBS,YAAY,CAACT,KAAb,IAAsB,CAAlG,EAAsG;AACpG,qBAAK5P,UAAL,GAAkB,KAAKA,UAAL,GAAkBqQ,YAAY,CAACR,UAA/B,GAA4C,GAA9D;AACD;AACF;AACF;AAED;;;;;;;;;;;;;AAgBD;;;4CAEmBpmB,S,EAAW2lB,K,EAAOnf,G,EAAKqgB,O,EAAS;AAAA;;AAClD,cAAIpe,GAAG,GAAG,CAAV;AACA,cAAIkL,EAAE,GAAG,CAAT;AACA,cAAIiS,EAAE,GAAG,CAAT;AACA,cAAIC,EAAE,GAAG,CAAT;AACA7lB,mBAAS,CAACwI,OAAV,CAAkB,UAAAmE,OAAO,EAAI;AAC3B;;;;;;;AAQA,gBAAIA,OAAO,CAACG,IAAR,KAAiB,IAAjB,IAAyBH,OAAO,CAACG,IAAR,KAAiB,CAA9C,EAAiD;AAC/C,kBAAIjH,IAAI,GAAG,IAAX;AACA,kBAAIK,MAAM,GAAG,IAAb;;AACA,kBAAIyG,OAAO,CAAC7D,KAAR,CAAc5E,QAAd,CAAuB,IAAvB,KAAgCyI,OAAO,CAAC5B,GAAR,GAAc,CAAlD,EAAqD;AACnDlF,oBAAI,GAAG,qEAAsBihB,MAA7B;AACA5gB,sBAAM,GAAG,qEAAsBC,EAA/B;AACD;;AACD,kBAAIwG,OAAO,CAAC7D,KAAR,CAAc5E,QAAd,CAAuB,IAAvB,KAAgCyI,OAAO,CAAC5B,GAAR,GAAc,CAAlD,EAAqD;AACnDlF,oBAAI,GAAG,qEAAsBkhB,MAA7B;AACA7gB,sBAAM,GAAG,qEAAsBE,EAA/B;AACD;;AACD,kBAAIuG,OAAO,CAAC7D,KAAR,CAAc5E,QAAd,CAAuB,IAAvB,KAAgCyI,OAAO,CAAC5B,GAAR,GAAc,CAAlD,EAAqD;AACnDlF,oBAAI,GAAG,qEAAsBmhB,KAA7B;AACA9gB,sBAAM,GAAG,qEAAsBC,EAA/B;AACD;;AACD,kBAAIwG,OAAO,CAAC7D,KAAR,CAAc5E,QAAd,CAAuB,IAAvB,KAAgCyI,OAAO,CAAC5B,GAAR,GAAc,CAAlD,EAAqD;AACnDlF,oBAAI,GAAG,qEAAsBohB,KAA7B;AACA/gB,sBAAM,GAAG,qEAAsBE,EAA/B;AACD;;AACD,kBAAIgP,UAAU,GAAGzI,OAAO,CAAC7D,KAAR,CAAcW,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB,CAAjB,CAnB+C,CAmBF;;AAE7C,kBAAIzE,MAAM,GAAG2H,OAAO,CAAC3H,MAArB,CArB+C,CAqBlB;;AAE7B,kBAAI0N,EAAE,GAAG,IAAIzN,IAAJ,CAASD,MAAT,CAAT,CAvB+C,CAuBpB;;AAC3B,kBAAI8O,EAAE,GAAG,IAAI7O,IAAJ,CAAS,OAAI,CAACN,UAAd,CAAT;;AACA,kBAAI+N,EAAE,CAACxN,WAAH,OAAqB4O,EAAE,CAAC5O,WAAH,EAArB,IAAyCwN,EAAE,CAACvN,QAAH,OAAkB2O,EAAE,CAAC3O,QAAH,EAA3D,IAA4EuN,EAAE,CAACtN,OAAH,OAAiB0O,EAAE,CAAC1O,OAAH,EAAjG,EAA+G;AAC7G,oBAAIyhB,OAAO,IAAI,CAACla,OAAO,CAAC8O,QAAxB,EAAkC;AAChChT,qBAAG,IAAI,OAAI,CAACid,MAAL,CAAY/Y,OAAZ,CAAP;AACD,iBAFD,MAEO;AACLlE,qBAAG,IAAI,OAAI,CAACye,4BAAL,CAAkCvB,KAAlC,EAAyCvQ,UAAzC,EAAqDzI,OAAO,CAAC5B,GAA7D,EAAkE4B,OAAO,CAACI,KAA1E,EAAiFlH,IAAjF,CAAP;AACD;AACF,eAND,MAMO;AAAE;AAEP,oBAAIshB,EAAE,GAAG,IAAIliB,IAAJ,EAAT,CAFK,CAEgB;;AACrB,oBAAI2O,SAAS,GAAG,OAAI,CAACxU,UAAL,CAAgByU,eAAhB,CAAgCsT,EAAhC,EAAoCrT,EAApC,CAAhB;;AACA,oBAAIJ,QAAQ,GAAGE,SAAf,CAJK,CAKL;AACA;;AAEA,oBAAI3N,SAAS,GAAG,OAAI,CAAC+V,aAAL,CAAmB;AAAElT,uBAAK,EAAG6D,OAAO,CAAC7D;AAAlB,iBAAnB,EAA8C,OAAI,CAACpE,MAAnD,EAA2DM,MAA3D,CAAhB;;AACA,oBAAIqB,EAAE,GAAG,OAAI,CAACC,WAAL,CAAiBE,GAAjB,EAAsB4O,UAAtB,EAAkC,0EAAa7O,aAA/C,EAA8DvB,MAA9D,EAAsEkB,MAAtE,EAA8ED,SAA9E,CAAT,CATK,CAUL;;;AAEA,oBAAImhB,GAAG,GAAG,OAAI,CAACC,2BAAL,CAAiC1B,KAAjC,EAAwCvQ,UAAxC,EAAoD,0EAAa7O,aAAjE,EAAgFvB,MAAhF,EAAwFqB,EAAxF,EAA4FH,MAA5F,EAAoGwN,QAApG,CAAV;;AACA0T,mBAAG,GAAGA,GAAG,GAAGza,OAAO,CAACI,KAApB;AACAqa,mBAAG,GAAGA,GAAG,GAAGza,OAAO,CAAC5B,GAApB;AACAtC,mBAAG,IAAI2e,GAAP;AACD,eA/C8C,CAiD/C;;;AAEA,kBAAIP,OAAO,IAAI,CAACla,OAAO,CAAC8O,QAAxB,EAAkC;AAChC9H,kBAAE,IAAI,OAAI,CAAC+R,MAAL,CAAY/Y,OAAZ,CAAN;AACD,eAFD,MAEO;AACL,oBAAI1G,UAAS,GAAG,OAAI,CAAC+V,aAAL,CAAmB;AAAElT,uBAAK,EAAG6D,OAAO,CAAC7D;AAAlB,iBAAnB,EAA8C,OAAI,CAACpE,MAAnD,EAA2DM,MAA3D,CAAhB;;AAEA,oBAAIqB,GAAE,GAAG,OAAI,CAACC,WAAL,CAAiBE,GAAjB,EAAsB4O,UAAtB,EAAkC,0EAAa7O,aAA/C,EAA8DvB,MAA9D,EAAsEkB,MAAtE,EAA8ED,UAA9E,CAAT;;AAEA,oBAAImhB,IAAG,GAAG,OAAI,CAACC,2BAAL,CAAiC1B,KAAjC,EAAwCvQ,UAAxC,EAAoD,0EAAa7O,aAAjE,EAAgFvB,MAAhF,EAAwFqB,GAAxF,EAA4FH,MAA5F,CAAV,CALK,CAML;;;AACAkhB,oBAAG,GAAGA,IAAG,GAAGza,OAAO,CAACI,KAApB;AACAqa,oBAAG,GAAGA,IAAG,GAAGza,OAAO,CAAC5B,GAApB;AACA4I,kBAAE,IAAIyT,IAAN;;AAEA,oBAAIE,GAAG,GAAG,OAAI,CAACD,2BAAL,CAAiC1B,KAAjC,EAAwCvQ,UAAxC,EAAoD,0EAAa7O,aAAjE,EAAgFvB,MAAhF,EAAwFqB,GAAxF,EAA4FH,MAA5F,EAAoG,CAApG,CAAV;;AACAohB,mBAAG,GAAGA,GAAG,GAAG3a,OAAO,CAACI,KAApB;AACAua,mBAAG,GAAGA,GAAG,GAAG3a,OAAO,CAAC5B,GAApB;AACA6a,kBAAE,IAAI0B,GAAN;;AAEA,oBAAIC,GAAG,GAAG,OAAI,CAACF,2BAAL,CAAiC1B,KAAjC,EAAwCvQ,UAAxC,EAAoD,0EAAa7O,aAAjE,EAAgFvB,MAAhF,EAAwFqB,GAAxF,EAA4FH,MAA5F,EAAoG,CAApG,CAAV;;AACAqhB,mBAAG,GAAGA,GAAG,GAAG5a,OAAO,CAACI,KAApB;AACAwa,mBAAG,GAAGA,GAAG,GAAG5a,OAAO,CAAC5B,GAApB;AACA8a,kBAAE,IAAI0B,GAAN;AACD;AAEF;AACF,WArFD,EALkD,CA4FlD;;AACA,iBAAO,CAAC9e,GAAD,EAAMkL,EAAN,EAAUiS,EAAV,EAAcC,EAAd,CAAP;AACD;;;oCAEWxgB,I,EAAMO,M,EAAQ6M,Q,EAAUY,W,EAAaxN,I,EAAMI,S,EAAWyN,Q,EAAW;AAC3E,cAAIJ,IAAI,GAAG,EAAX;AACA,cAAIC,GAAG,GAAG,CAAV;AACA,cAAIlN,EAAE,GAAG,CAAT;AAEA;;;;;;AAOA;;;;;;;;AAQA;;;;AAIA,iBAAQiN,IAAI,GAAGC,GAAR,GAAe,MAAtB,EAA8B;AAC5B,gBAAI,KAAK8T,2BAAL,CAAiChiB,IAAjC,EAAuCO,MAAvC,EAA+C6M,QAA/C,EAAyDY,WAAzD,EAAsE,CAACC,IAAI,GAAGC,GAAR,IAAe,CAArF,EAAwF1N,IAAxF,EAA8F6N,QAA9F,IAA0GzN,SAA9G,EAAyH;AACvHqN,kBAAI,GAAG,CAACA,IAAI,GAAGC,GAAR,IAAe,CAAtB;AACD,aAFD,MAEO;AACLA,iBAAG,GAAG,CAACD,IAAI,GAAGC,GAAR,IAAe,CAArB;AACD;AACF;;AACDlN,YAAE,GAAG,CAACiN,IAAI,GAAGC,GAAR,IAAe,CAApB;AACA,iBAAOlN,EAAP;AACD;;;oDAE2BhB,I,EAAMO,M,EAAQ6M,Q,EAAUY,W,EAAaI,U,EAAY5N,I,EAAM6N,Q,EAAW;AAC5F,cAAIC,EAAE,GAAG,CAAT;AACA,cAAI7N,WAAW,GAAG,IAAIb,IAAJ,CAASoO,WAAT,CAAlB;;AACA,cAAI,KAAK3O,MAAL,KAAgB,QAApB,EAA8B;AAC5BoB,uBAAW,CAACC,QAAZ,CAAqB,EAArB,EAAyB,EAAzB,EAA6B,CAA7B;AACD,WAFD,MAEO;AACLD,uBAAW,CAACC,QAAZ,CAAqB,EAArB,EAAyB,EAAzB,EAA6B,CAA7B;AACD;;AAED,cAAI,CAAC2N,QAAL,EAAe;AACbA,oBAAQ,GAAG,CAAX;AACD;;AAED,cAAIxB,QAAQ,GAAG,IAAIjN,IAAJ,EAAf;;AACA,cAAI,KAAK+M,iBAAT,EAA4B;AAC1BE,oBAAQ,GAAG,KAAKD,mBAAhB;AACD;;AAEDC,kBAAQ,CAACkB,OAAT,CAAiBlB,QAAQ,CAAC9M,OAAT,KAAqBsO,QAAtC;AAEA,cAAIE,SAAS,GAAG,KAAKxU,UAAL,CAAgByU,eAAhB,CAAgC3B,QAAhC,EAA0CpM,WAA1C,CAAhB;AACA,cAAIqM,OAAO,GAAGyB,SAAS,GAAG,KAA1B,CArB4F,CAuB5F;;AACA,cAAIvB,OAAO,GAAG7M,IAAI,CAAC4M,KAAL,CAAWD,OAAO,GAAG,EAArB,CAAd;AACA,cAAIG,KAAK,GAAG9M,IAAI,CAAC4M,KAAL,CAAWC,OAAO,GAAG,EAArB,CAAZ;AACA,cAAIE,OAAO,GAAI/M,IAAI,CAAC4M,KAAL,CAAWE,KAAK,GAAG,EAAnB,CAAD,GAA2B,KAAzC,CA1B4F,CA0B5C;;AAEhD;;;;;AAIE,cAAIE,IAAI,GAAGiB,UAAU,GAAG,GAAxB;AACAhB,kBAAQ,GAAGA,QAAQ,GAAG,GAAtB;AAEA,cAAIC,EAAE,GAAG,CAAClN,IAAI,CAAC/B,GAAL,CAAS4B,IAAI,GAAGO,MAAhB,IAA0B,CAAC6M,QAAQ,GAAIjN,IAAI,CAACmN,GAAL,CAASH,IAAT,EAAe,CAAf,IAAoB,CAAjC,IAAuCD,OAAlE,KAA8EC,IAAI,GAAGhN,IAAI,CAACoN,IAAL,CAAUL,OAAV,CAArF,CAAT,CAnC0F,CAoC1F;;AACA,cAAIuB,EAAE,GAAGpB,EAAE,GAAIF,IAAI,GAAGhN,IAAI,CAACoN,IAAL,CAAUL,OAAV,CAAtB;AAEA,cAAIwB,SAAS,GAAInO,MAAD,GAAWJ,IAAI,CAACwO,GAAL,CAAS,CAAC,CAAD,GAAKvB,QAAL,GAAgBF,OAAzB,CAA3B;;AAEA,cAAI1M,IAAI,KAAK,qEAAsBM,EAAnC,EAAuC;AACrCwN,cAAE,GAAGtO,IAAI,GAAG,KAAKwN,MAAL,CAAYH,EAAZ,CAAP,GAAyBqB,SAAS,GAAG,KAAKlB,MAAL,CAAYiB,EAAZ,CAA1C;AACD;;AAED,cAAIjO,IAAI,KAAK,qEAAsBO,EAAnC,EAAuC;AACrCuN,cAAE,GAAGI,SAAS,GAAG,KAAKlB,MAAL,CAAY,CAAC,CAAD,GAAKiB,EAAjB,CAAZ,GAAmCzO,IAAI,GAAG,KAAKwN,MAAL,CAAY,CAAC,CAAD,GAAKH,EAAjB,CAA/C;AACD;AACH;;;AACA,iBAAOiB,EAAP;AACD;;;+BAEMM,C,EAAG;AACR,cAAIC,iBAAiB,GAAG1O,IAAI,CAACoN,IAAL,CAAU,KAAK1Q,QAAf,CAAxB;AACA,iBAAO,MAAM,KAAKiS,IAAL,CAAU,EAAEF,CAAC,GAAG,KAAKhS,IAAX,KAAoBiS,iBAAiB,GAAG1O,IAAI,CAACoN,IAAL,CAAU,CAAV,CAAxC,CAAV,CAAb;AACD,S,CAED;AACA;;;;6BACKqB,C,EAAG;AACN,cAAIG,CAAC,GAAG5O,IAAI,CAACwG,GAAL,CAASiI,CAAT,CAAR;AACA,cAAII,CAAC,GAAG,KAAK,IAAID,CAAC,GAAG,CAAb,CAAR;AACA,cAAIvF,CAAC,GAAGwF,CAAC,GAAG7O,IAAI,CAACwO,GAAL,CAAS,CAACI,CAAD,GAAKA,CAAL,GAAS,UAAT,GAAsBC,CAAC,IAAI,aACxCA,CAAC,IAAI,aAAaA,CAAC,IAAI,aAAaA,CAAC,IAAI,CAAC,UAAD,GACzCA,CAAC,IAAI,aAAaA,CAAC,IAAI,CAAC,UAAD,GAAcA,CAAC,IAAI,aAC1CA,CAAC,IAAI,CAAC,UAAD,GAAcA,CAAC,GAAG,UAAtB,CADqC,CAAnB,CAAlB,CADoC,CAAlB,CAAlB,CADmC,CAAhC,CAAZ;AAIA,iBAAOJ,CAAC,IAAI,CAAL,GAASpF,CAAT,GAAa,IAAIA,CAAxB;AACD;;;qDAE4B8W,K,EAAOvQ,U,EAAYrK,G,EAAKgC,K,EAAOlH,I,EAAM;AAChE,cAAI4C,GAAG,GAAG,CAAV;;AACA,cAAI5C,IAAI,KAAK,qEAAsBihB,MAAnC,EAA2C;AACzC,gBAAInB,KAAK,GAAGvQ,UAAZ,EAAwB;AACtB3M,iBAAG,GAAG,CAAC2M,UAAU,GAAGuQ,KAAb,GAAqB5Y,KAAtB,IAA+BvH,IAAI,CAACwG,GAAL,CAASjB,GAAT,CAArC;AACD,aAFD,MAEO;AACLtC,iBAAG,GAAGsE,KAAK,GAAGvH,IAAI,CAACwG,GAAL,CAASjB,GAAT,CAAd;AACD;AACF;;AACD,cAAIlF,IAAI,KAAK,qEAAsBkhB,MAAnC,EAA2C;AACzC,gBAAIpB,KAAK,GAAGvQ,UAAZ,EAAwB;AACtB3M,iBAAG,GAAG,CAAC,CAAC2M,UAAD,GAAcuQ,KAAd,GAAsB5Y,KAAvB,IAAgCvH,IAAI,CAACwG,GAAL,CAASjB,GAAT,CAAtC;AACD,aAFD,MAEO;AACLtC,iBAAG,GAAGsE,KAAK,GAAGvH,IAAI,CAACwG,GAAL,CAASjB,GAAT,CAAd;AACD;AACF;;AACD,cAAIlF,IAAI,KAAK,qEAAsBmhB,KAAnC,EAA0C;AACxC,gBAAIrB,KAAK,GAAGvQ,UAAZ,EAAwB;AACtB3M,iBAAG,GAAG,CAAC,CAAC2M,UAAD,GAAcuQ,KAAd,GAAsB5Y,KAAvB,IAAgCvH,IAAI,CAACwG,GAAL,CAASjB,GAAT,CAAtC;AACD,aAFD,MAEO;AACLtC,iBAAG,GAAGsE,KAAK,GAAG,CAACvH,IAAI,CAACwG,GAAL,CAASjB,GAAT,CAAf;AACD;AACF;;AACD,cAAIlF,IAAI,KAAK,qEAAsBohB,KAAnC,EAA0C;AACxC,gBAAItB,KAAK,GAAGvQ,UAAZ,EAAwB;AACtB3M,iBAAG,GAAG,CAAC2M,UAAU,GAAGuQ,KAAb,GAAqB5Y,KAAtB,IAA+BvH,IAAI,CAACwG,GAAL,CAASjB,GAAT,CAArC;AACD,aAFD,MAEO;AACLtC,iBAAG,GAAGsE,KAAK,GAAG,CAACvH,IAAI,CAACwG,GAAL,CAASjB,GAAT,CAAf;AACD;AACF,WA7B+D,CA+BhE;;;AAEA,cAAItC,GAAG,KAAK,CAAZ,EAAe;AACbA,eAAG,GAAIjD,IAAI,CAACC,KAAL,CAAW,CAACgD,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA3C;AACD;;AACD,iBAAOA,GAAP;AACD;;;oCAEW;AAAA;;AACV;;;;;;;;AASA,cAAI+V,CAAC,GAAG,IAAIvZ,IAAJ,CAAS,KAAKN,UAAd,CAAR,CAVU,CAWV;;AACA,cAAIuF,KAAK,GAAG,0EAAa0F,aAAb,CAA2B4O,CAAC,CAACrZ,QAAF,KAAe,CAA1C,CAAZ;;AAEA3B,iBAAO,CAACC,GAAR,CAAY,aAAZ,EAA2B,KAAK+I,qBAAhC;AACA,eAAKpN,UAAL,CAAgBooB,gBAAhB,CAAiC,KAAK9iB,MAAtC,EAA8CwF,KAA9C,EAAqD,KAAKsC,qBAA1D,EAAiF,KAAK9H,MAAtF,EAA8FpB,SAA9F,CAAwG,UAACK,GAAD,EAAc;AACpHH,mBAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BE,GAA3B;;AACA,gBAAIA,GAAG,CAAC8jB,KAAR,EAAe;AACb,qBAAI,CAACnR,MAAL,GAAc9Q,IAAI,CAACC,KAAL,CAAW9B,GAAG,CAAC8jB,KAAJ,CAAUA,KAArB,EAA4B9f,cAA5B,EAAd;AACD;AACF,WALD,EAMA,UAAAX,KAAK,EAAI;AACPxD,mBAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BuD,KAA/B;AACD,WARD;AASD;;;iCAEQ;AACP;AACA,cAAI,KAAKsP,MAAT,EAAiB;AACf,gBAAIoR,GAAG,GAAI,KAAKC,cAAL,KAAwBxD,UAAU,CAAC,KAAK7N,MAAL,CAAY/M,OAAZ,CAAoB,IAApB,EAA0B,EAA1B,CAAD,CAAnC,GAAsE,GAAhF;AACAme,eAAG,GAAIliB,IAAI,CAACC,KAAL,CAAW,CAACiiB,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA3C;AACA,mBAAOA,GAAP;AACD;AACF;;;+BAEMzf,G,EAAKvD,M,EAAS2O,W,EAAc;AACjC,cAAI5K,GAAG,GAAG,IAAV;AACA,cAAIqE,IAAI,GAAG,IAAX;;AACA,cAAI7E,GAAG,CAAC6E,IAAJ,KAAa,IAAb,IAAqB7E,GAAG,CAAC6E,IAAJ,KAAa,CAAtC,EAAyC;AACvCA,gBAAI,GAAG7E,GAAG,CAAC6E,IAAX;AACD,WAFD,MAEO;AACLA,gBAAI,GAAG,KAAKkP,aAAL,CAAmB/T,GAAnB,EAAwBvD,MAAxB,EAAgC2O,WAAhC,CAAP;AACD;;AAED,cAAIpL,GAAG,CAAC8C,GAAJ,GAAU,CAAd,EAAiB;AACf,gBAAIlC,CAAC,GAAG,CAACiE,IAAI,GAAG7E,GAAG,CAAC8E,KAAZ,IAAqB9E,GAAG,CAAC8C,GAAjC;AACAtC,eAAG,GAAGI,CAAN;AACD,WAHD,MAGO,IAAIZ,GAAG,CAAC8C,GAAJ,GAAU,CAAd,EAAiB;AACtB,gBAAIlC,GAAC,GAAG,CAACZ,GAAG,CAAC8E,KAAJ,GAAYD,IAAb,IAAqB,CAAC7E,GAAG,CAAC8C,GAAlC;;AACAtC,eAAG,GAAGI,GAAN;AACD;AACD;;;;;AAGAJ,aAAG,GAAIjD,IAAI,CAACC,KAAL,CAAW,CAACgD,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA3C;AACAR,aAAG,CAACQ,GAAJ,GAAUA,GAAV;AACA,iBAAOA,GAAP;AACD;;;2CAEkB;AAAA;;AACjB,cAAIhC,KAAK,GAAG,CAAZ;AACA,cAAImW,MAAM,GAAG,KAAKpQ,qBAAlB;;AACA,cAAIoQ,MAAJ,EAAY;AACVA,kBAAM,CAACpU,OAAP,CAAe,UAAAP,GAAG,EAAI;AACpB,kBAAIA,GAAG,CAAC6E,IAAJ,KAAa,IAAb,IAAqB7E,GAAG,CAAC6E,IAAJ,KAAa,CAAtC,EAAyC;AAEvC,oBAAI,OAAI,CAAC0K,cAAL,IAAuB,CAACvP,GAAG,CAACwT,QAAhC,EAA0C;AACxC;AACD;;AAED,oBAAI5V,IAAI,GAAG,EAAX;AACA,oBAAIkZ,CAAC,GAAG9W,GAAG,CAACa,KAAZ;;AACA,oBAAIiW,CAAC,CAAC7a,QAAF,CAAW,IAAX,CAAJ,EAAsB;AACpB2B,sBAAI,GAAG,IAAP;AACD;;AACD,oBAAIkZ,CAAC,CAAC7a,QAAF,CAAW,IAAX,CAAJ,EAAsB;AACpB2B,sBAAI,GAAG,IAAP;AACD;;AACD,oBAAID,MAAM,GAAGmZ,CAAC,CAACtV,KAAF,CAAQ,CAAR,EAAW,CAAC,CAAZ,CAAb,CAduC,CAcV;;AAC7B,oBAAIjD,GAAG,GAAG,OAAI,CAACwV,aAAL,CAAmB/T,GAAnB,CAAV;;AAEAxB,qBAAK,IAAK,OAAI,CAACrH,UAAL,CAAgBsH,QAAhB,CAAyB,OAAI,CAAChC,MAA9B,EAAsCkB,MAAtC,EAA8CC,IAA9C,EAAoDoC,GAAG,CAACjD,MAAxD,EAAgEwB,GAAhE,EAAqE,OAAI,CAACwL,iBAA1E,EAA6F,OAAI,CAACC,mBAAlG,IAAyHhK,GAAG,CAAC8C,GAAvI;AACD;AACF,aApBD;AAqBD;;AAEDtE,eAAK,GAAGjB,IAAI,CAACC,KAAL,CAAW,CAACgB,KAAK,GAAG,OAAT,IAAoB,GAA/B,IAAsC,GAA9C;AAEA,cAAImhB,cAAc,GAAG,YAAapiB,IAAI,CAACC,KAAL,CAAW,CAAE,CAACgB,KAAD,GAAO,EAAR,GAAc,OAAf,IAA0B,GAArC,IAA4C,GAAzD,GACC,UADD,GACejB,IAAI,CAACC,KAAL,CAAW,CAAE,CAACgB,KAAD,GAAO,GAAR,GAAe,OAAhB,IAA2B,GAAtC,IAA6C,GAD5D,GAEC,UAFD,GAEejB,IAAI,CAACC,KAAL,CAAW,CAAE,CAACgB,KAAD,GAAO,GAAR,GAAe,OAAhB,IAA2B,GAAtC,IAA6C,GAF5D,GAGC,UAHD,GAGejB,IAAI,CAACC,KAAL,CAAW,CAAE,CAACgB,KAAD,GAAO,GAAR,GAAe,OAAhB,IAA2B,GAAtC,IAA6C,GAH5D,GAGmE,IAHxF;AAIA,iBAAOA,KAAK,GAAGmhB,cAAf;AACD;;;qDAE4B;AAC3B,cAAInf,GAAG,GAAG,KAAKkf,cAAL,EAAV;AAEA,cAAIE,OAAO,GAAG,CAAd;AACA,cAAIjL,MAAM,GAAG,KAAKpQ,qBAAlB;;AACA,cAAIoQ,MAAJ,EAAY;AACVA,kBAAM,CAACpU,OAAP,CAAe,UAAAP,GAAG,EAAI;AACpB,kBAAIA,GAAG,CAAC6E,IAAJ,KAAa,IAAb,IAAqB7E,GAAG,CAAC6E,IAAJ,KAAa,CAAtC,EAAyC;AACvC+a,uBAAO,IAAI,EAAX;AACD,eAFD,MAEO;AACLA,uBAAO,IAAI,EAAX;AACD;AACF,aAND;AAOD;;AAED,iBAAQpf,GAAG,GAAGof,OAAd;AACD;;;yCAE0B;AAAA;;AAAA,cAAZvf,GAAY,uEAAN,IAAM;AACzB,cAAIG,GAAG,GAAG,CAAV;AACA,cAAIqf,YAAY,GAAG,CAAnB;AACA,cAAIlL,MAAM,GAAG,IAAb;AACA,cAAIlY,MAAM,GAAG,IAAb;AACA,cAAIM,MAAM,GAAG,IAAb;;AACA,cAAIsD,GAAG,KAAK,IAAZ,EAAkB;AAChBsU,kBAAM,GAAG,KAAKpQ,qBAAd;AACD;;AACD,cAAIlE,GAAG,KAAK,CAAR,IAAa,KAAKyN,QAAtB,EAAgC;AAC9B6G,kBAAM,GAAG,KAAK7G,QAAL,CAAc6G,MAAvB;AACAlY,kBAAM,GAAG,KAAKqR,QAAL,CAAcrR,MAAvB;AACAM,kBAAM,GAAG,KAAK+Q,QAAL,CAAc/Q,MAAvB;AACD;;AACD,cAAIsD,GAAG,KAAK,CAAR,IAAa,KAAK0N,QAAtB,EAAgC;AAC9B4G,kBAAM,GAAG,KAAK5G,QAAL,CAAc4G,MAAvB;AACAlY,kBAAM,GAAG,KAAKsR,QAAL,CAActR,MAAvB;AACAM,kBAAM,GAAG,KAAKgR,QAAL,CAAchR,MAAvB;AACD;;AACD,cAAIsD,GAAG,KAAK,CAAR,IAAa,KAAK2N,QAAtB,EAAgC;AAC9B2G,kBAAM,GAAG,KAAK3G,QAAL,CAAc2G,MAAvB;AACAlY,kBAAM,GAAG,KAAKuR,QAAL,CAAcvR,MAAvB;AACAM,kBAAM,GAAG,KAAKiR,QAAL,CAAcjR,MAAvB;AACD;;AACD,cAAIsD,GAAG,KAAK,CAAR,IAAa,KAAK4N,QAAtB,EAAgC;AAC9B0G,kBAAM,GAAG,KAAK1G,QAAL,CAAc0G,MAAvB;AACAlY,kBAAM,GAAG,KAAKwR,QAAL,CAAcxR,MAAvB;AACAM,kBAAM,GAAG,KAAKkR,QAAL,CAAclR,MAAvB;AACD;;AACD,cAAIsD,GAAG,KAAK,CAAR,IAAa,KAAK6N,QAAtB,EAAgC;AAC9ByG,kBAAM,GAAG,KAAKzG,QAAL,CAAcyG,MAAvB;AACAlY,kBAAM,GAAG,KAAKyR,QAAL,CAAczR,MAAvB;AACAM,kBAAM,GAAG,KAAKmR,QAAL,CAAcnR,MAAvB;AACD;;AACD,cAAI4X,MAAJ,EAAY;AACVA,kBAAM,CAACpU,OAAP,CAAe,UAAAP,GAAG,EAAI;AACpB,kBAAIK,GAAJ,EAAS;AACP,oBAAIyf,MAAM,GAAG,OAAI,CAACrC,MAAL,CAAYzd,GAAZ,EAAiBvD,MAAjB,EAAyBuD,GAAG,CAACjD,MAA7B,CAAb;;AACAyD,mBAAG,IAAIsf,MAAP;AACAD,4BAAY,IAAIC,MAAM,GAAGviB,IAAI,CAACwG,GAAL,CAAS/D,GAAG,CAAC8C,GAAb,CAAzB,CAHO,CAIP;AACD,eALD,MAKO;AACL,oBAAIgd,OAAM,GAAG,OAAI,CAACrC,MAAL,CAAYzd,GAAZ,CAAb,CADK,CAC0B;;;AAC/BQ,mBAAG,IAAIsf,OAAP;AACAD,4BAAY,IAAIC,OAAM,GAAGviB,IAAI,CAACwG,GAAL,CAAS/D,GAAG,CAAC8C,GAAb,CAAzB;AACD;AACF,aAXD;AAYD;;AACDtC,aAAG,GAAIjD,IAAI,CAACC,KAAL,CAAW,CAACgD,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA3C;AACAqf,sBAAY,GAAItiB,IAAI,CAACC,KAAL,CAAW,CAACqiB,YAAY,GAAG,OAAhB,IAA2B,GAAtC,IAA6C,GAA7D,CAjDyB,CAkDzB;;AAEA,eAAKvoB,YAAL,CAAkBiF,iBAAlB,CAAoCqC,IAApC,CAAyC,CAAC4B,GAAD,EAAMqf,YAAN,CAAzC;AACA,iBAAOrf,GAAP;AACD;;;oCAEWsT,K,EAAO;AACjB,cAAIA,KAAK,CAACN,QAAV,EAAoB;AAClB,gBAAIM,KAAK,CAACL,MAAV,EAAkB;AAChB,kBAAIjO,IAAI,GAAI,KAAKuO,aAAL,CAAmB;AAAElT,qBAAK,EAAGiT,KAAK,CAACL;AAAhB,eAAnB,EAA6CK,KAAK,CAACrX,MAAnD,EAA2DqX,KAAK,CAAC/W,MAAjE,CAAZ;AACA,kBAAIwB,GAAG,GAAGiH,IAAV;;AACA,kBAAIsO,KAAK,CAACJ,MAAV,EAAkB;AAChB,oBAAIM,IAAI,GAAI,KAAKD,aAAL,CAAmB;AAAElT,uBAAK,EAAGiT,KAAK,CAACJ;AAAhB,iBAAnB,EAA6CI,KAAK,CAACrX,MAAnD,EAA2DqX,KAAK,CAAC/W,MAAjE,CAAZ;AACAwB,mBAAG,IAAIyV,IAAP;AACD;;AACD,qBAAOzV,GAAP;AACD,aARD,MAQO;AAAE;AACP,qBAAO,KAAKnH,UAAL,CAAgBiG,MAAhB,CAAuByW,KAAK,CAACrX,MAA7B,CAAP;AACD;AACF;AACF;AAEH;;;;;;sCAIgBuD,G,EAAKvD,M,EAAS2O,W,EAAc;AAExC,cAAI,CAAC3O,MAAL,EAAa;AACXA,kBAAM,GAAG,KAAKA,MAAd;AACD;;AACD,cAAI,CAAC2O,WAAL,EAAkB;AAChBA,uBAAW,GAAGpL,GAAG,CAACjD,MAAlB,CADgB,CACU;AAC3B;;AAED,cAAIvD,iBAAiB,GAAG,KAAxB;AACA,cAAIkD,UAAU,GAAG,IAAIM,IAAJ,CAASoO,WAAT,CAAjB;AACA1O,oBAAU,CAACoB,QAAX,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B;AAEA,cAAIoJ,sBAAsB,GAAG,0EAAatF,kBAA1C;;AACA,cAAInF,MAAM,KAAK,QAAf,EAAyB;AACvByK,kCAAsB,GAAG,0EAAapF,wBAAtC;AACD;;AACD,eAAK,IAAIqF,GAAT,IAAgBD,sBAAhB,EAAwC;AACtC,gBAAIA,sBAAsB,CAACE,cAAvB,CAAsCD,GAAtC,CAAJ,EAAgD;AAC5C;AACA,kBAAIzK,UAAU,CAAC2K,OAAX,OAAyBH,sBAAsB,CAACC,GAAD,CAAtB,CAA4BE,OAA5B,EAA7B,EAAoE;AAClE;AACA7N,iCAAiB,GAAG,IAApB;AACA;AACD;AACJ;AACF;;AAED,cAAIuD,MAAM,GAAG,IAAb;;AACA,cAAIvD,iBAAJ,EAAuB;AACrBuD,kBAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAAyC,0EAAa0K,aAAb,CAA2BjL,UAAU,CAACQ,QAAX,KAAwB,CAAnD,CAAlD;AACD,WAFD,MAEO;AACL,gBAAI0K,WAAW,GAAG,IAAlB;;AACA,gBAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AACpC0K,yBAAW,GAAG,GAAd;AACD,aAFD,MAEO,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA;AACLA,yBAAW,GAAGlL,UAAU,CAACQ,QAAX,KAAwB,CAAtC;AACD;;AACDH,kBAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAA0C2K,WAA1C,GAAyD,CAAC,MAAMlL,UAAU,CAACS,OAAX,EAAP,EAA6BqE,KAA7B,CAAmC,CAAC,CAApC,CAAlE;AACD;;AAED,cAAI6T,GAAG,GAAG5Y,MAAM,GAAGM,MAAT,GAAkBiD,GAAG,CAACa,KAAhC,CA7CwC,CA8CxC;;AACA,iBAAO,KAAKzJ,UAAL,CAAgBiG,MAAhB,CAAuBgY,GAAvB,CAAP;AACD;;;qCAEY5Y,M,EAAS;AAEpB,cAAI,CAACA,MAAL,EAAa;AACXA,kBAAM,GAAG,KAAKA,MAAd;AACD;;AAED,cAAIoE,KAAK,GAAG,SAAZ;;AACA,cAAIpE,MAAM,KAAK,WAAf,EAA4B;AAC1BoE,iBAAK,GAAG,WAAR;AACD;;AACD,cAAIpE,MAAM,KAAK,QAAf,EAAyB;AACvB,gBAAIC,UAAU,GAAS,0EAAaoF,wBAAb,CAAsC,0EAAaC,IAAb,GAAoB,0EAAarD,gBAAvE,CAAvB;AACA,gBAAIkJ,WAAW,GAAG,IAAlB;;AACA,gBAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AACpC0K,yBAAW,GAAG,GAAd;AACD,aAFD,MAEO,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA;AACLA,yBAAW,GAAGlL,UAAU,CAACQ,QAAX,KAAwB,CAAtC;AACD;;AACD,gBAAIH,MAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAA0C2K,WAA1C,GAAyD,CAAC,MAAMlL,UAAU,CAACS,OAAX,EAAP,EAA6BqE,KAA7B,CAAmC,CAAC,CAApC,CAAtE,CAZuB,CAavB;;AACAX,iBAAK,GAAG,WAAW9D,MAAX,GAAoB,0EAAa2B,gBAAjC,GAAoD,KAA5D,CAduB,CAgBvB;AACD;;AAED,eAAKtB,IAAL,GAAY,KAAKhG,UAAL,CAAgBiG,MAAhB,CAAuBwD,KAAvB,CAAZ;AAEA,iBAAO,KAAKzD,IAAZ;AACD;;;wCAEeyD,K,EAAOjD,I,EAAM;AAE3B,+CAAyBhH,MAAM,CAACoiB,OAAP,CAAe,+DAAWf,YAA1B,CAAzB,wCAAkE;AAAA;AAAA,gBAAxD9Q,GAAwD;AAAA,gBAAnDrD,KAAmD;;AAEhE,gBAAIqD,GAAG,KAAKtG,KAAR,IAAkBsG,GAAG,CAAC5F,UAAJ,CAAe,KAAKwN,eAApB,KAAwC5H,GAAG,CAAC8R,QAAJ,CAAapY,KAAb,CAA9D,EAAoF;AAElF,kBAAIkf,SAAS,GAAG;AAAEhE,qBAAK,EAAE;AAAT,eAAhB;AAEA,kBAAIiE,SAAS,GAAG,KAAK1Q,0BAAL,CAAgCyF,KAAhC,CAAsC,GAAtC,EAA2C,CAA3C,CAAhB;;AAEA,mDAAmBne,MAAM,CAACoiB,OAAP,CAAelV,KAAf,CAAnB,wCAA0C;AAAA;AAAA,oBAAhCmc,CAAgC;AAAA,oBAA7BC,CAA6B;;AACxC,oBAAID,CAAC,CAAC1e,UAAF,CAAaye,SAAb,CAAJ,EAA6B;AAC3BD,2BAAS,CAAChE,KAAV,CAAgB3a,IAAhB,CAAqB;AAAE+e,yBAAK,EAAEF,CAAT;AAAYG,yBAAK,EAAEF;AAAnB,mBAArB;AACD;AACF;;AAED3kB,qBAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBwkB,SAArB,EAAgCD,SAAhC,EAA2Cjc,KAA3C;AACA,mBAAKuc,kBAAL,CAAwBN,SAAxB,EAAmCniB,IAAnC;AACD;AACF;AACF;;;2CAEkBlC,G,EAAKkC,I,EAAM;AAC5B,cAAIlC,GAAJ,EAAS;AACP,gBAAIkT,MAAM,GAAG,EAAb;AACA,gBAAIwR,KAAK,GAAG,EAAZ;;AAEA,gBAAI1kB,GAAG,CAACqgB,KAAJ,IAAapb,KAAK,CAAC2f,OAAN,CAAc5kB,GAAG,CAACqgB,KAAlB,CAAjB,EAA2C;AACzCrgB,iBAAG,CAACqgB,KAAJ,CAAUxb,OAAV,CAAkB,UAAAmE,OAAO,EAAI;AAE3BkK,sBAAM,CAACxN,IAAP,CAAYsD,OAAO,CAACyb,KAApB;AACAC,qBAAK,CAAChf,IAAN,CAAWsD,OAAO,CAAC0b,KAAnB;AACD,eAJD;AAKD;;AAED,gBAAI,CAACxiB,IAAL,EAAW;AACT,mBAAK8S,wBAAL,GAAgC9B,MAAhC;AACA,mBAAK0B,sBAAL,GAA8B,CAC5B;AAAEiQ,oBAAI,EAAEH,KAAR;AAAeD,qBAAK,EAAE;AAAtB,eAD4B,CAA9B;AAGD,aALD,MAKO,IAAIviB,IAAI,KAAK,IAAb,EAAmB;AACxB,mBAAK4S,mBAAL,GAA2B5B,MAA3B;AACA,mBAAKwB,iBAAL,GAAyB,CACvB;AAAEmQ,oBAAI,EAAEH,KAAR;AAAeD,qBAAK,EAAE;AAAtB,eADuB,CAAzB;AAGD,aALM,MAKA,IAAIviB,IAAI,KAAK,IAAb,EAAmB;AACxB,mBAAK6S,mBAAL,GAA2B7B,MAA3B;AACA,mBAAKyB,iBAAL,GAAyB,CACvB;AAAEkQ,oBAAI,EAAEH,KAAR;AAAeD,qBAAK,EAAE;AAAtB,eADuB,CAAzB;AAGD;;AAED,iBAAKvP,mBAAL,GAA2B;AACzBsB,wBAAU,EAAE,IADa;AAEzBC,oBAAM,EAAE;AACNC,qBAAK,EAAE,CAAC,EAAD;AADD,eAFiB;AAKzBE,sBAAQ,EAAE;AACRC,oBAAI,EAAE,OADE;AAERC,yBAAS,EAAE;AAFH,eALe;AASzBC,uBAAS,EAAE;AACTC,wBAAQ,EAAE;AADD;AATc,aAA3B;AAiBD;AACF;;;wCAEehX,G,EAAK;AAAA;;AACnB,cAAIA,GAAJ,EAAS;AACP,iBAAKkT,MAAL,GAAc,EAAd;AACA,iBAAKpO,GAAL,GAAW,EAAX;AACA,gBAAIoe,OAAO,GAAG,EAAd;AACA,gBAAId,SAAS,GAAG,EAAhB;AACA,gBAAI0C,QAAQ,GAAG,EAAf;AACA,gBAAIC,QAAQ,GAAG,EAAf;AACA,gBAAI/U,EAAE,GAAG,EAAT;AACA,gBAAIiS,EAAE,GAAG,EAAT;AACA,gBAAIC,EAAE,GAAG,EAAT;AACA,iBAAK/O,QAAL,GAAgB,EAAhB;AACA,gBAAI9D,KAAK,GAAG,CAAZ;;AACA,gBAAIrP,GAAG,CAACqgB,KAAJ,IAAapb,KAAK,CAAC2f,OAAN,CAAc5kB,GAAG,CAACqgB,KAAlB,CAAjB,EAA2C;AACzCrgB,iBAAG,CAACqgB,KAAJ,CAAUxb,OAAV,CAAkB,UAAAmE,OAAO,EAAI;AAC3B;AACAqG,qBAAK;;AACL,oBAAIA,KAAK,GAAG,GAAZ,EAAiB;AACf;;;AAGD;;AACD,uBAAI,CAAC6D,MAAL,CAAYxN,IAAZ,CAAiBsD,OAAO,CAACyZ,UAAzB;;AACA,uBAAI,CAAC3d,GAAL,CAASY,IAAT,CAAcsD,OAAO,CAACwZ,KAAtB;;AACAxS,kBAAE,CAACtK,IAAH,CAAQsD,OAAO,CAAC0Z,KAAhB;AACAT,kBAAE,CAACvc,IAAH,CAAQsD,OAAO,CAAC2Z,EAAhB;AACAT,kBAAE,CAACxc,IAAH,CAAQsD,OAAO,CAAC4Z,EAAhB;;AACA,uBAAI,CAACzP,QAAL,CAAczN,IAAd,CAAmB,CAAnB;;AAEA,oBAAI,OAAI,CAACmO,cAAT,EAAyB;AACvBqP,yBAAO,CAACxd,IAAR,CAAasD,OAAO,CAAC6Z,OAArB;AACAT,2BAAS,CAAC1c,IAAV,CAAesD,OAAO,CAAC8Z,SAAvB;AACD;;AAED,oBAAI,OAAI,CAACxO,eAAL,IAAwB,OAAI,CAACC,eAAjC,EAAkD;AAChD2O,yBAAO,CAACxd,IAAR,CAAasD,OAAO,CAAC6Z,OAArB;AACAiC,0BAAQ,CAACpf,IAAT,CAAcsD,OAAO,CAAC+Z,QAAtB;AACAgC,0BAAQ,CAACrf,IAAT,CAAcsD,OAAO,CAACga,QAAtB;AACD;AAED;;AACD,eA3BD;AA4BD,aAzCM,CA0CP;AACA;;;AACA,iBAAKnO,eAAL,GAAuB,KAAK3B,MAA5B;AACA,iBAAKuB,aAAL,GAAqB,CACnB;AAAEoQ,kBAAI,EAAE,KAAK/f,GAAb;AAAkB2f,mBAAK,EAAE;AAAzB,aADmB,EAEnB;AAAEI,kBAAI,EAAE7U,EAAR;AAAYyU,mBAAK,EAAE,KAAnB;AAA0BtN,kBAAI,EAAE;AAAhC,aAFmB,EAGnB;AAAE0N,kBAAI,EAAE5C,EAAR;AAAYwC,mBAAK,EAAE,KAAnB;AAA0BtN,kBAAI,EAAE;AAAhC,aAHmB,EAInB;AAAE0N,kBAAI,EAAE3C,EAAR;AAAYuC,mBAAK,EAAE,KAAnB;AAA0BtN,kBAAI,EAAE;AAAhC,aAJmB,EAKnB;AAAE0N,kBAAI,EAAE3B,OAAR;AAAiBuB,mBAAK,EAAE,SAAxB;AAAmCtN,kBAAI,EAAE;AAAzC,aALmB,EAMnB;AAAE0N,kBAAI,EAAEzC,SAAR;AAAmBqC,mBAAK,EAAE,WAA1B;AAAuCtN,kBAAI,EAAE;AAA7C,aANmB,EAOnB;AAAE0N,kBAAI,EAAEC,QAAR;AAAkBL,mBAAK,EAAE,UAAzB;AAAqCtN,kBAAI,EAAE;AAA3C,aAPmB,EAQnB;AAAE0N,kBAAI,EAAEE,QAAR;AAAkBN,mBAAK,EAAE,UAAzB;AAAqCtN,kBAAI,EAAE;AAA3C,aARmB,CAArB;AAYA,gBAAItU,GAAG,GAAG,CAAV;;AACA,gBAAI,KAAK9B,MAAL,KAAgB,QAApB,EAA8B;AAE5B,kBAAI,KAAKgT,eAAT,EAA0B;AACxB,oBAAIuM,UAAU,GAAG,KAAKjI,aAAL,CAAmB;AAAElT,uBAAK,EAAG,KAAK6O,kBAAL,GAA0B;AAApC,iBAAnB,EAA+D,KAAKjT,MAApE,EAA4E,KAAKC,UAAjF,CAAjB;AACA,oBAAIuf,UAAU,GAAG,KAAKlI,aAAL,CAAmB;AAAElT,uBAAK,EAAG,KAAK6O,kBAAL,GAA0B;AAApC,iBAAnB,EAA+D,KAAKjT,MAApE,EAA4E,KAAKC,UAAjF,CAAjB;AACA6B,mBAAG,GAAGyd,UAAU,GAAGC,UAAb,GAA0B,KAAKvM,kBAArC,CAHwB,CAGiC;;AACzDnR,mBAAG,GAAIhB,IAAI,CAACC,KAAL,CAAW,CAACe,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA3C;AACAhD,uBAAO,CAACC,GAAR,CAAY,cAAc+C,GAA1B;AACD,eAND,MAMO;AACLA,mBAAG,GAAG2d,UAAU,CAAC,KAAKC,YAAL,EAAD,CAAhB;AACA5d,mBAAG,GAAIhB,IAAI,CAACC,KAAL,CAAW,CAACe,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA3C,CAFK,CAE4C;AAClD;AACF,aAZD,MAYO;AACLA,iBAAG,GAAGoD,QAAQ,CAAC,KAAKwa,YAAL,EAAD,CAAd;AACD;;AAED,iBAAKxL,gBAAL,GAAwB;AACtBuB,wBAAU,EAAE,IADU;AAEtBC,oBAAM,EAAE;AACNC,qBAAK,EAAE,CAAC,EAAD;AADD,eAFc;AAKtBE,sBAAQ,EAAE;AACRC,oBAAI,EAAE,OADE;AAERC,yBAAS,EAAE;AAFH,eALY;AAStBC,uBAAS,EAAE;AACTC,wBAAQ,EAAE;AADD,eATW;AAYtBgO,wBAAU,EAAE;AACVC,sBAAM,EAAE,CAAC,OAAD,CADE;AAEVC,2BAAW,EAAE,KAAKC,mBAAL,CAAyBtiB,GAAzB;AAFH;AAZU,aAAxB;AAiBD;AACF;;;4CAEmBA,G,EAAK;AACvB,cAAIqiB,WAAW,GAAG,EAAlB;AAEA;;;;;;;;;;;;;;;;;AAkBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DJ;;;AAEM;;;;;;;AAOA;;AACN;;;;;;;;;;;;;;;AAeQ;;;;;AAKA;;;AAGA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDJA,qBAAW,CAACxf,IAAZ,CAAiB;AACf0f,oBAAQ,EAAE,mBADK;AAEfljB,gBAAI,EAAE,MAFS;AAGf2U,gBAAI,EAAE,UAHS;AAIfwO,mBAAO,EAAE,UAJM;AAKfjd,iBAAK,EAAEvF,GALQ;AAMfuS,uBAAW,EAAE,QANE;AAOfC,uBAAW,EAAE,CAPE;AAQfoP,iBAAK,EAAE;AACLa,qBAAO,EAAE,CAAC,EADL;AAELC,qBAAO,EAAE,IAFJ;AAGLC,uBAAS,EAAE,QAHN;AAILC,qBAAO,EAAE5iB;AAJJ;AARQ,WAAjB,EA1KuB,CA0LvB;;AACA,iBAAOqiB,WAAP;AACD;;;mDAE0BA,W,EAAaljB,M,EAAQ;AAC9C,eAAI,IAAI8G,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGoc,WAAW,CAACnc,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC1C,gBAAI9G,MAAM,KAAKkjB,WAAW,CAACpc,CAAD,CAAX,CAAeV,KAA9B,EAAqC;AACnC,qBAAO,IAAP;AACD;AACF;;AACD,iBAAO,KAAP;AACD;;;kDAEyB;AACxB,cAAI8K,MAAM,GAAG,EAAb;AACA,cAAIwS,MAAM,GAAG,EAAb;AACA,cAAIhkB,IAAI,GAAG,EAAX;AACA,cAAIikB,WAAW,GAAG,KAAK/pB,YAAL,CAAkBgqB,eAAlB,CAAkC,MAAlC,EAA0C,QAA1C,EAAoD,YAApD,CAAlB;AACA,cAAIC,WAAW,GAAG,KAAKjqB,YAAL,CAAkBgqB,eAAlB,CAAkC,MAAlC,EAA0C,QAA1C,EAAoD,YAApD,CAAlB;AACA,cAAIE,aAAa,GAAG,KAAKlqB,YAAL,CAAkBgqB,eAAlB,CAAkC,KAAlC,EAAyC,QAAzC,EAAmD,0EAAa5iB,gBAAhE,CAApB;;AACA,cAAI2iB,WAAJ,EAAiB;AACfA,uBAAW,CAAC9gB,OAAZ,CAAoB,UAAAkhB,OAAO,EAAI;AAC7B,kBAAIC,OAAO,GAAGD,OAAO,CAACE,IAAtB;AACAJ,yBAAW,CAAChhB,OAAZ,CAAoB,UAAAqhB,OAAO,EAAI;AAC7B,oBAAIF,OAAO,KAAKE,OAAO,CAACD,IAAxB,EAA8B;AAC5B,sBAAI/gB,CAAC,GAAG6gB,OAAO,CAAC7N,KAAR,GAAgBgO,OAAO,CAAChO,KAAhC;AACAhT,mBAAC,GAAGrD,IAAI,CAACC,KAAL,CAAW,CAACoD,CAAC,GAAG,OAAL,IAAgB,GAA3B,IAAkC,GAAtC,CAF4B,CAEe;;AAC3CgO,wBAAM,CAACxN,IAAP,CAAYsgB,OAAZ;AACAN,wBAAM,CAAChgB,IAAP,CAAYR,CAAZ;AACA;AACD;AACF,eARD;;AASA,kBAAI4gB,aAAJ,EAAmB;AACjBA,6BAAa,CAACjhB,OAAd,CAAsB,UAAAwX,IAAI,EAAI;AAC5B,sBAAI2J,OAAO,KAAK3J,IAAI,CAAC4J,IAArB,EAA2B;AACzBvkB,wBAAI,CAACgE,IAAL,CAAU2W,IAAI,CAACnE,KAAf;AACA;AACD;AACF,iBALD;AAMD;AACF,aAnBD;AAoBD,WA5BuB,CA8BxB;;;AACA,eAAK5B,aAAL,GAAqBpD,MAArB;AACA,eAAKmD,WAAL,GAAmB,CACjB;AAAEwO,gBAAI,EAAEa,MAAR;AAAgBjB,iBAAK,EAAE;AAAvB,WADiB,EAEjB;AAAEI,gBAAI,EAAEnjB,IAAR;AAAc+iB,iBAAK,EAAE,YAArB;AAAmC0B,mBAAO,EAAE;AAA5C,WAFiB,CAAnB;AAID;;;;;;;uBA9jFUhU,c,EAAc,wH,EAAA,+H,EAAA,2I,EAAA,qJ,EAAA,4H;AAAA,K;;;YAAdA,c;AAAc,gC;AAAA;AAAA;0EAkOd,6D,EAAoB,I;;;;;;;;;;;;;;;;ACnPjC;;AACI;;AAEI;;AACI;;AACJ;;AAEA;;AACI;;AAuBA;;AAA2C;AAAA,mBAAS,IAAAwL,eAAA,EAAT;AAA0B,WAA1B;;AAA4B;;AAAY;;AACvF;;AAEJ;;AACJ;;AAEA;;AACI;;AAEI;;AACI;;AACJ;;AAEA;;AACI;;AAAU;AAAA;AAAA,aAA4B,eAA5B,EAA4B;AAAA,mBAAkB,IAAAyI,qBAAA,QAAlB;AAA+C,WAA3E;;AAA0G;;AACpH;;AACI;;AACI;;AAsBJ;;AACJ;;AAEA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAAoD;;AAAM;;AAC9D;;AACA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAAqD;;AAAO;;AAChE;;AAEA;;AAAiF;AAAA,mBAAS,IAAAC,mBAAA,EAAT;AAA8B,WAA9B;;AAAgC;;AAAG;;AACxH;;AACJ;;AACJ;;AAEA;;AACI;;AAEI;;AACI;;AACJ;;AAEA;;AAEI;;AACI;;AAAM;;AAAY;;AAGY;;AAAuB;;AAAO;;AAC5D;;AAAwB;;AAAC;;AACzB;;AAAM;;AAAY;;AAGY;;AAAuB;;AAAO;;AAC5D;;AAAwB;;AAAC;;AACzB;;AAAM;;AAAY;;AAGY;;AAAuB;;AAAO;;AAC5D;;AAAwB;;AAAC;;AACzB;;AAAM;;AAAY;;AAGY;;AAAuB;;AAAO;;AAC5D;;AAAwB;;AAAC;;AACzB;;AAAM;;AAAY;;AAGY;;AAAuB;;AAAO;;AAChE;;AACA;;AACA;;AAEI;;AAYA;;AAEI;;AACI;;AAAgD;;AAAK;;AACrD;;AAAqF;AAAA;AAAA;;AAArF;;AACJ;;AAEA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAAsD;;AAAuB;;AAC7E;;AAAwE;AAAA;AAAA;;AAAxE;;AACJ;;AAEA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAAkD;;AAAW;;AACjE;;AAEA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAAwD;;AAAiB;;AAC7E;;AAEA;;AACI;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAAsD;;AAAO;;AACjE;;AAEA;;AACI;;AAAgC;AAAA;AAAA;;AAAhC;;AACA;;AAAsD;;AAAO;;AAEjE;;AAEA;;AACI;;AAAgC;AAAA;AAAA,aAA4B,QAA5B,EAA4B;AAAA,mBAAW,IAAAC,oBAAA,QAAX;AAAuC,WAAnE;;AAAhC;;AACA;;AAAqD;;AAAc;;AACnE;;AAAwE;AAAA;AAAA;;AAAxE;;AACJ;;AACJ;;AAEA;;AA2BA;;AAAkB;;AAAiC;;AACnD;;AAAkE;AAAA;AAAA;;AAC9D;;AAAsB;;AAAK;;AAC3B;;AAA0B;;AAAS;;AACnC;;AAAuB;;AAAM;;AACjC;;AACA;;AAAyD;AAAA;AAAA;;AAAzD;;AACA;;AAAiE;AAAA,mBAAS,IAAAC,4BAAA,EAAT;AAAuC,WAAvC;;AAAyC;;AAAY;;AACtH;;AAA4D;AAAA,mBAAS,IAAA1J,eAAA,EAAT;AAA0B,WAA1B;;AAA4B;;AAAiB;;AAEzG;;AAcI;;AACI;;AA2CJ;;AACJ;;AAEA;;AAA4D;AAAA,mBAAS,IAAAnF,WAAA,EAAT;AAAsB,WAAtB;;AAAwB;;AAAG;;AACvF;;AAA4D;AAAA,mBAAS,IAAAyI,eAAA,EAAT;AAA0B,WAA1B;;AAA4B;;AAAO;;AAC/F;;AACI;;AAA4D;AAAA,mBAAS,IAAAqG,aAAA,CAAc,CAAd,CAAT;AAAyB,WAAzB;;AAA2B;;AAAM;;AAC7F;;AAA4D;AAAA,mBAAS,IAAAA,aAAA,CAAc,CAAd,CAAT;AAAyB,WAAzB;;AAA2B;;AAAM;;AAC7F;;AAA4D;AAAA,mBAAS,IAAAA,aAAA,CAAc,CAAd,CAAT;AAAyB,WAAzB;;AAA2B;;AAAM;;AAC7F;;AAA4D;AAAA,mBAAS,IAAAA,aAAA,CAAc,CAAd,CAAT;AAAyB,WAAzB;;AAA2B;;AAAM;;AAC7F;;AAA4D;AAAA,mBAAS,IAAAA,aAAA,CAAc,CAAd,CAAT;AAAyB,WAAzB;;AAA2B;;AAAM;;AACjG;;AACA;;AACI;;AAA4D;AAAA,mBAAS,IAAA9G,gBAAA,CAAiB,CAAjB,CAAT;AAA4B,WAA5B;;AAA8B;;AAAM;;AAChG;;AAA4D;AAAA,mBAAS,IAAAA,gBAAA,CAAiB,CAAjB,CAAT;AAA4B,WAA5B;;AAA8B;;AAAM;;AAChG;;AAA4D;AAAA,mBAAS,IAAAA,gBAAA,CAAiB,CAAjB,CAAT;AAA4B,WAA5B;;AAA8B;;AAAM;;AAChG;;AAA4D;AAAA,mBAAS,IAAAA,gBAAA,CAAiB,CAAjB,CAAT;AAA4B,WAA5B;;AAA8B;;AAAM;;AAChG;;AAA4D;AAAA,mBAAS,IAAAA,gBAAA,CAAiB,CAAjB,CAAT;AAA4B,WAA5B;;AAA8B;;AAAM;;AACpG;;AACA;;AACI;;AAA4D;AAAA,mBAAS,IAAAte,WAAA,CAAY,CAAZ,CAAT;AAAuB,WAAvB;;AAAyB;;AAAQ;;AAC7F;;AAA4D;AAAA,mBAAS,IAAAA,WAAA,CAAY,CAAZ,CAAT;AAAuB,WAAvB;;AAAyB;;AAAQ;;AAC7F;;AAA4D;AAAA,mBAAS,IAAAA,WAAA,CAAY,CAAZ,CAAT;AAAuB,WAAvB;;AAAyB;;AAAQ;;AAC7F;;AAA4D;AAAA,mBAAS,IAAAA,WAAA,CAAY,CAAZ,CAAT;AAAuB,WAAvB;;AAAyB;;AAAQ;;AAC7F;;AAA4D;AAAA,mBAAS,IAAAA,WAAA,CAAY,CAAZ,CAAT;AAAuB,WAAvB;;AAAyB;;AAAQ;;AACjG;;AACA;;AACI;;AAA4D;AAAA;;AAAA;;AAAA,mBAAS,WAAT;AAAiC,WAAjC;;AAAmC;;AAAM;;AACrG;;AAKA;AAAA,mBAAU,IAAAqlB,SAAA,SAAkB,CAAlB,CAAV;AAA8B,WAA9B;;AALA;;AAYJ;;AAEA;;AACI;;AACA;;AAIE;;AACF;;AACA;;AACI;;AACJ;;AACJ;;AACA;;AAAkB;;AAA+B;;AACjD;;AAAkB;;AAAoB;;AACtC;;AAAkB;;AAAqB;;AACvC;;AAAkB;;AAA4B;;AAC9C;;AAAkB;;AAAsD;;AACxE;;AAAkB;;AAAsD;;AAC5E;;AAEJ;;AAKA;;AAyCA;;AACI;;AAAG;;AAAc;;AACjB;;AAgBA;;AAEA;;AAAG;;AAAqB;;AACxB;;AAGA;;AACA;;AAAG;;AAAkB;;AACrB;;AAYA;;AACA;;AAAG;;AAAU;;AACb;;AAGA;;AACA;;AAAG;;AAAS;;AACZ;;AACA;;AACA;;AAAG;;AAAQ;;AACX;;AAEJ;;AACJ;;AACJ;;AACJ;;AAEA;;AAiDA;;;;AA9d+C;;AAAA;;AAqCzB;;AAAA;;AAGE;;AAAA;;AA0BwB;;AAAA;;AAIA;;AAAA;;AAmBR;;AAAA;;AAGM;;AAAA;;AAEN;;AAAA;;AAGM;;AAAA;;AAEN;;AAAA;;AAGM;;AAAA;;AAEN;;AAAA;;AAGM;;AAAA;;AAEN;;AAAA;;AAGM;;AAAA;;AAKL;;AAAA;;AAgBoE;;AAAA;;AAIrD;;AAAA;;AAEwC;;AAAA;;AAIxC;;AAAA;;AAKA;;AAAA;;AAMI;;AAAA;;AAKA;;AAAA;;AAMA;;AAAA;;AAEwC;;AAAA;;AAI9D;;AAAA;;AA2BA;;AAAA;;AACgD;;AAAA;;AAKT;;AAAA;;AAmB7C;;AAAA;;AAuFF;;AAAA;;AAIJ;;AAAA;;AAGE;;AAAA;;AAGU;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AACA;;AAAA;;AAQrB;;AAAA;;AAgGkC;;AAAA;;AAiDP;;AAAA;;;;;;;;;sEDrd/BtU,c,EAAc;cAL1B,uDAK0B;eALhB;AACTzE,kBAAQ,EAAE,WADD;AAETC,qBAAW,EAAE,wBAFJ;AAGTC,mBAAS,EAAE,CAAC,wBAAD;AAHF,S;AAKgB,Q;;;;;;;;;;;;;;gBAkOxB,uD;iBAAU,6D,EAAoB;AAAE,sBAAQ;AAAV,W;;;;;;;;;;;;;;;;;;;;AErPjC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAwBa8Y,W;;;;;YAAAA;;;;yBAAAA,W;AAAW,O;AAAA,iBAFX,CAAC,2DAAD,C;AAAc,gBAXhB,CACP,4DADO,EAEP,uEAFO,EAGP,oEAHO,EAIP,qEAJO,EAKP,0DALO,EAMP,kEANO,EAOP,uDAPO,CAWgB;;;;0HAEdA,W,EAAW;AAAA,uBAHP,+DAGO;AAHO,kBAT3B,4DAS2B,EAR3B,uEAQ2B,EAP3B,oEAO2B,EAN3B,qEAM2B,EAL3B,0DAK2B,EAJ3B,kEAI2B,EAH3B,uDAG2B,CAGP;AANR,kBAEJ,+DAFI;AAMQ,O;AAJE,K;;;;;sEAIbA,W,EAAW;cAdvB,sDAcuB;eAdd;AACRprB,iBAAO,EAAE,CACP,4DADO,EAEP,uEAFO,EAGP,oEAHO,EAIP,qEAJO,EAKP,0DALO,EAMP,kEANO,EAOP,uDAPO,CADD;AAURZ,iBAAO,EAAE,CAAC,+DAAD,CAVD;AAWRoT,sBAAY,EAAE,CAAC,+DAAD,CAXN;AAYRC,mBAAS,EAAE,CAAC,2DAAD;AAZH,S;AAcc,Q;;;;;;;;;;;;;;;;;;ACxBxB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAWa4Y,Y;AAOX,4BACUzY,IADV,EAEUxS,UAFV,EAGUyS,YAHV,EAIUC,gBAJV,EAI4C;AAAA;;AAHlC,aAAAF,IAAA,GAAAA,IAAA;AACA,aAAAxS,UAAA,GAAAA,UAAA;AACA,aAAAyS,YAAA,GAAAA,YAAA;AACA,aAAAC,gBAAA,GAAAA,gBAAA;AATH,aAAArO,mBAAA,GAAoC,IAAI,4CAAJ,EAApC;AACA,aAAAe,iBAAA,GAAkC,IAAI,4CAAJ,EAAlC;AACA,aAAAD,iBAAA,GAAkC,IAAI,4CAAJ,EAAlC;AACP,aAAA+lB,YAAA,GAAe,IAAIC,GAAJ,EAAf;AAOK;;;;wCAEW1hB,K,EAAOpE,M,EAAQM,M,EAAQ;AACrC,iBAAO,KAAKulB,YAAL,CAAkBxV,GAAlB,CAAsBrQ,MAAM,GAAG,GAAT,GAAeM,MAAf,GAAwB,GAAxB,GAA8B8D,KAApD,CAAP;AACD;;;yCAEgBqS,a,EAAe;AAAA;;AAC9B3X,iBAAO,CAACC,GAAR,CAAY,uBAAZ;AACA0X,uBAAa,CAAC3S,OAAd,CAAsB,UAAAmE,OAAO,EAAI;AAC/B,gBAAI0c,MAAM,GAAG7M,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBhQ,OAAO,CAACjI,MAAR,GAAiB,GAAjB,GAAuBiI,OAAO,CAAC3H,MAA/B,GAAwC,GAAxC,GAA8C2H,OAAO,CAAC7D,KAA3E,CAAX,CAAb;;AACA,mBAAI,CAACyhB,YAAL,CAAkBE,GAAlB,CAAsB9d,OAAO,CAACjI,MAAR,GAAiB,GAAjB,GAAuBiI,OAAO,CAAC3H,MAA/B,GAAwC,GAAxC,GAA8C2H,OAAO,CAAC7D,KAA5E,EAAmFugB,MAAnF;AACD,WAHD;AAIA7lB,iBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsC,KAAK8mB,YAA3C;AACD;;;0CAEiBpP,a,EAAe;AAAA;;AAE/B,gEAAS,GAAT,EAAc7X,SAAd,CAAwB,UAAConB,GAAD,EAAS;AAC/B;AACA,gBAAIC,UAAU,GAAG,IAAI1lB,IAAJ,EAAjB;AACA0lB,sBAAU,CAAC5kB,QAAX,CAAoB,EAApB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B;AACA,gBAAI6kB,QAAQ,GAAG,IAAI3lB,IAAJ,EAAf;AACA2lB,oBAAQ,CAAC7kB,QAAT,CAAkB,CAAlB,EAAqB,EAArB,EAAyB,CAAzB,EAA4B,CAA5B;AAEA,gBAAI8kB,QAAQ,GAAG,IAAI5lB,IAAJ,GAAWqK,OAAX,EAAf;;AACA,gBAAIub,QAAQ,GAAGF,UAAU,CAACrb,OAAX,EAAf,EAAqC;AACnC;AACD;;AACD,gBAAIub,QAAQ,GAAGD,QAAQ,CAACtb,OAAT,EAAf,EAAmC;AACjC;AACD;;AACD,gBAAI,IAAIrK,IAAJ,GAAWkO,MAAX,OAAwB,CAAxB,IAA6B,IAAIlO,IAAJ,GAAWkO,MAAX,OAAwB,CAAzD,EAA4D;AAC1D;AACD;;AAEDgI,yBAAa,CAAC3S,OAAd,CAAsB,UAAAmE,OAAO,EAAI;AAE/B,kBAAI7D,KAAK,GAAG6D,OAAO,CAAC7D,KAApB;AACA,kBAAIpE,MAAM,GAAGiI,OAAO,CAACjI,MAArB;AACA,kBAAIM,MAAM,GAAG2H,OAAO,CAAC3H,MAArB;AACA,kBAAIwB,GAAG,GAAG,IAAV;;AACA,kBAAIsC,KAAK,KAAK,KAAV,IAAmBA,KAAK,KAAK,MAAjC,EAAyC;AACvCtC,mBAAG,GAAG,OAAI,CAAC4d,YAAL,CAAkB1f,MAAlB,CAAN;AACD,eAFD,MAEO;AACL8B,mBAAG,GAAG,OAAI,CAACwV,aAAL,CAAmBlT,KAAnB,EAA0BpE,MAA1B,EAAkCM,MAAlC,CAAN;AACD;;AAED,kBAAIwB,GAAJ,EAAS;AACP,oBAAI8b,GAAG,GAAG,OAAI,CAACiI,YAAL,CAAkBxV,GAAlB,CAAsBrQ,MAAM,GAAG,GAAT,GAAeM,MAAf,GAAwB,GAAxB,GAA8B8D,KAApD,CAAV;;AACA,oBAAI,CAACwZ,GAAL,EAAU;AACRA,qBAAG,GAAG,EAAN;AACD;;AAED,oBAAI9D,CAAC,GAAG,IAAIvZ,IAAJ,EAAR,CANO,CAOP;;AACA,oBAAI6lB,OAAO,GAAG,CAACtM,CAAC,CAACtZ,WAAF,EAAD,EAAkBsZ,CAAC,CAACrZ,QAAF,KAAe,CAAjC,EAAoCqZ,CAAC,CAACpZ,OAAF,EAApC,EAAiD2lB,IAAjD,CAAsD,GAAtD,IACE,GADF,GAEA,CAACvM,CAAC,CAACI,QAAF,EAAD,EAAeJ,CAAC,CAACM,UAAF,EAAf,EAA+BiM,IAA/B,CAAoC,GAApC,CAFd,CARO,CAWP;;AAEA,oBAAIhI,KAAK,GAAG,IAAZ;;AACA,qBAAK,IAAItW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6V,GAAG,CAAC5V,MAAxB,EAAgCD,CAAC,EAAjC,EAAqC;AACnC,sBAAI6V,GAAG,CAAC7V,CAAD,CAAH,CAAOmd,IAAP,IAAetH,GAAG,CAAC7V,CAAD,CAAH,CAAOmd,IAAP,KAAgBkB,OAAnC,EAA4C;AAC1C/H,yBAAK,GAAGtW,CAAR;AACA;AACD;AACF;;AACD,oBAAIsW,KAAK,KAAK,IAAd,EAAoB;AAClBT,qBAAG,CAACS,KAAD,CAAH,GAAa;AAAE6G,wBAAI,EAAEkB,OAAR;AAAiBjP,yBAAK,EAAErV;AAAxB,mBAAb;AACD,iBAFD,MAEO;AACL8b,qBAAG,CAACjZ,IAAJ,CAAS;AAAEugB,wBAAI,EAAEkB,OAAR;AAAiBjP,yBAAK,EAAErV;AAAxB,mBAAT;AACD,iBAxBM,CA0BP;;;AACA,uBAAI,CAAC+jB,YAAL,CAAkBE,GAAlB,CAAsB/lB,MAAM,GAAG,GAAT,GAAeM,MAAf,GAAwB,GAAxB,GAA8B8D,KAApD,EAA2DwZ,GAA3D,EA3BO,CA4BP;;AACD;AACF,aA1CD;AA2CD,WA7DD;AA8DD;;;sCAEaxZ,K,EAAOpE,M,EAAQ2O,W,EAAa;AAExC,cAAI5R,iBAAiB,GAAG,KAAxB;AACA,cAAIkD,UAAU,GAAG,IAAIM,IAAJ,CAASoO,WAAT,CAAjB;AACA1O,oBAAU,CAACoB,QAAX,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B;AAEA,cAAIoJ,sBAAsB,GAAG,0EAAatF,kBAA1C;;AACA,cAAInF,MAAM,KAAK,QAAf,EAAyB;AACvByK,kCAAsB,GAAG,0EAAapF,wBAAtC;AACD;;AACD,eAAK,IAAIqF,GAAT,IAAgBD,sBAAhB,EAAwC;AACtC,gBAAIA,sBAAsB,CAACE,cAAvB,CAAsCD,GAAtC,CAAJ,EAAgD;AAC5C;AACA,kBAAIzK,UAAU,CAAC2K,OAAX,OAAyBH,sBAAsB,CAACC,GAAD,CAAtB,CAA4BE,OAA5B,EAA7B,EAAoE;AAClE;AACA7N,iCAAiB,GAAG,IAApB;AACA;AACD;AACJ;AACF;;AAED,cAAIuD,MAAM,GAAG,IAAb;;AACA,cAAIvD,iBAAJ,EAAuB;AACrBuD,kBAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAAyC,0EAAa0K,aAAb,CAA2BjL,UAAU,CAACQ,QAAX,KAAwB,CAAnD,CAAlD;AACD,WAFD,MAEO;AACL,gBAAI0K,WAAW,GAAG,IAAlB;;AACA,gBAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AACpC0K,yBAAW,GAAG,GAAd;AACD,aAFD,MAEO,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA;AACLA,yBAAW,GAAGlL,UAAU,CAACQ,QAAX,KAAwB,CAAtC;AACD;;AACDH,kBAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAA0C2K,WAA1C,GAAyD,CAAC,MAAMlL,UAAU,CAACS,OAAX,EAAP,EAA6BqE,KAA7B,CAAmC,CAAC,CAApC,CAAlE;AACD;;AAED,cAAI6T,GAAG,GAAG5Y,MAAM,GAAGM,MAAT,GAAkB8D,KAA5B,CAtCwC,CAuCxC;;AACA,iBAAO,KAAKzJ,UAAL,CAAgBiG,MAAhB,CAAuBgY,GAAvB,CAAP;AACD;;;qCAEY5Y,M,EAAQ;AAEnB,cAAIoE,KAAK,GAAG,SAAZ;;AACA,cAAIpE,MAAM,KAAK,WAAf,EAA4B;AAC1BoE,iBAAK,GAAG,WAAR;AACD;;AACD,cAAIpE,MAAM,KAAK,QAAf,EAAyB;AACvB,gBAAIC,UAAU,GAAS,0EAAaoF,wBAAb,CAAsC,0EAAaC,IAAb,GAAoB,0EAAarD,gBAAvE,CAAvB;AACA,gBAAIkJ,WAAW,GAAG,IAAlB;;AACA,gBAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AACpC0K,yBAAW,GAAG,GAAd;AACD,aAFD,MAEO,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,yBAAW,GAAG,GAAd;AACD,aAFM,MAEA;AACLA,yBAAW,GAAGlL,UAAU,CAACQ,QAAX,KAAwB,CAAtC;AACD;;AACD,gBAAIH,MAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAA0C2K,WAA1C,GAAyD,CAAC,MAAMlL,UAAU,CAACS,OAAX,EAAP,EAA6BqE,KAA7B,CAAmC,CAAC,CAApC,CAAtE;AACAX,iBAAK,GAAG,WAAW9D,MAAX,GAAoB,0EAAa2B,gBAAjC,GAAoD,KAA5D,CAbuB,CAcvB;AACD;;AAED,cAAItB,IAAI,GAAG,KAAKhG,UAAL,CAAgBiG,MAAhB,CAAuBwD,KAAvB,CAAX;AAEA,iBAAOzD,IAAP;AACD;;;2CAEkB;AAAA;;AACjB;AACA,gEAAS,IAAT,EAAe/B,SAAf,CAAyB,UAAConB,GAAD,EAAS;AAAA,uDAEP,OAAI,CAACH,YAFE;AAAA;;AAAA;AAEhC,kEAA4C;AAAA;AAAA,oBAAlCnb,GAAkC;AAAA,oBAA7BrD,KAA6B;;AAE1C,oBAAIif,GAAG,GAAGjf,KAAV,CAF0C,CAG1C;AACA;;AACA2Q,4BAAY,CAAC0G,OAAb,CACEhU,GADF,EAEEoN,IAAI,CAAC2G,SAAL,CAAe6H,GAAf,CAFF;AAID;AAX+B;AAAA;AAAA;AAAA;AAAA;AAYjC,WAZD;AAaD;;;;;;;uBAnLUV,Y,EAAY,uH,EAAA,sH,EAAA,0H,EAAA,kI;AAAA,K;;;aAAZA,Y;AAAY,eAAZA,YAAY,K;AAAA,kBAFX;;;;;sEAEDA,Y,EAAY;cAHxB,wDAGwB;eAHb;AACVzU,oBAAU,EAAE;AADF,S;AAGa,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXzB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAWaoV,sB;AAEX,sCACUpZ,IADV,EAEUxS,UAFV,EAEgC;AAAA;;AADtB,aAAAwS,IAAA,GAAAA,IAAA;AACA,aAAAxS,UAAA,GAAAA,UAAA;AACL;;;;4CAEe6rB,U,EAAY;AAC9B;AACA,eAAKC,kBAAL,CAAwBD,UAAxB;AACD;;;2CAEkBA,U,EAAY;AAC7B,cAAME,YAAY,GAAG,IAAIC,UAAJ,CAAeH,UAAf,CAArB;;AACA,cAAIE,YAAY,YAAYC,UAA5B,EAAwC;AACtC,gBAAI7Q,IAAI,GAAG4Q,YAAY,CAAC,CAAD,CAAvB,CADsC,CAEtC;AACA;;AACA,gBAAI5Q,IAAI,KAAK,6DAAqB8Q,UAAlC,EAA8C;AAC5C,mBAAKC,eAAL,CAAqBH,YAArB;AACD,aAFD,MAEO,IAAI5Q,IAAI,KAAK,6DAAqBgR,kBAAlC,EAAsD,CAE5D,CAFM,MAEA,IAAIhR,IAAI,KAAK,6DAAqBiR,SAAlC,EAA6C,CAEnD,CAFM,MAEA,IAAIjR,IAAI,KAAK,6DAAqBkR,cAAlC,EAAkD,CAExD,CAFM,MAEA,IAAIlR,IAAI,KAAK,6DAAqBmR,GAAlC,EAAuC,CAE7C,CAFM,MAEA,IAAInR,IAAI,KAAK,6DAAqBoR,EAAlC,EAAsC;AAC3CpoB,qBAAO,CAACC,GAAR,CAAY,mBAAZ;AACD,aAFM,MAEA,IAAI+W,IAAI,KAAK,6DAAqBqR,aAAlC,EAAiD,CAEvD,CAFM,MAEA,IAAIrR,IAAI,KAAK,6DAAqBsR,iBAAlC,EAAqD,CAE3D;AACF,WArBD,MAqBO;AACLtoB,mBAAO,CAACwD,KAAR,CAAc,kDAAd;AACD;AACF;;;wCAEe+kB,O,EAAqB;AACnC;;AACA;;;AAGA,cAAIljB,CAAC,GAAG,IAAI,uDAAJ,EAAR;AACAA,WAAC,CAACmjB,aAAF,GAAkBD,OAAO,CAAC,CAAD,CAAzB;AAEA,cAAIE,UAAU,GAAG,GAAjB;;AACA,cAAIpjB,CAAC,CAACmjB,aAAF,KAAoB,CAAxB,EAA2B;AACzBC,sBAAU,GAAG,QAAb;AACD,WAXkC,CAanC;AACA;AACA;;;AACApjB,WAAC,CAACqjB,KAAF,GAAU,KAAKC,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,CAAjB,EAAoB,CAApB,CAAvB,EAA+C,EAA/C,CAAV;AACAvjB,WAAC,CAACrC,GAAF,GAAQ,KAAK2lB,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,CAAjB,EAAoB,EAApB,CAAvB,EAAgD,EAAhD,IAAsDH,UAA9D;AACApjB,WAAC,CAACwjB,QAAF,GAAa,KAAKF,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,CAAb;AACAvjB,WAAC,CAACyjB,eAAF,GAAoB,KAAKH,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,CAApB;AACAvjB,WAAC,CAACmH,MAAF,GAAW,KAAKmc,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,CAAX;AACAvjB,WAAC,CAAC0jB,QAAF,GAAa,KAAKJ,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,IAAuDH,UAApE;AACApjB,WAAC,CAAC2jB,YAAF,GAAiB,KAAKL,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,CAAjB;AACAvjB,WAAC,CAAC4jB,QAAF,GAAa,KAAKN,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,IAAuDH,UAApE;AACApjB,WAAC,CAAC6jB,YAAF,GAAiB,KAAKP,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,CAAjB;AACAvjB,WAAC,CAAC8jB,aAAF,GAAkB,KAAKR,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,CAAlB;AACAvjB,WAAC,CAAC+jB,cAAF,GAAmB,KAAKT,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,CAAnB;AACAvjB,WAAC,CAACgkB,GAAF,GAAQ,KAAKV,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,IAAuDH,UAA/D;AACApjB,WAAC,CAACikB,kBAAF,GAAuB,KAAKX,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,CAAvB;AACAvjB,WAAC,CAACvB,IAAF,GAAS,KAAK6kB,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,IAAuDH,UAAhE;AACApjB,WAAC,CAACyK,IAAF,GAAS,KAAK6Y,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,IAAuDH,UAAhE;AACApjB,WAAC,CAAC0K,GAAF,GAAQ,KAAK4Y,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,IAAuDH,UAA/D;AACApjB,WAAC,CAACwf,KAAF,GAAU,KAAK8D,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,IAAuDH,UAAjE;AACApjB,WAAC,CAACkkB,SAAF,GAAc,KAAKZ,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,IAAuDH,UAArE;AACApjB,WAAC,CAACmkB,QAAF,GAAa,KAAKb,iBAAL,CAAuBJ,OAAO,CAACK,QAAR,CAAiB,EAAjB,EAAqB,EAArB,CAAvB,EAAiD,EAAjD,IAAuDH,UAApE,CAlCmC,CAmCnC;AACA;;AACA;;;;;;AAKA,eAAKgB,UAAL,CAAgBpkB,CAAhB;AACD;;;+CAE8BkjB,O,EAAmB;AAChD,cAAImB,UAAU,GAAGxN,MAAM,CAACyN,YAAP,CAAoBC,KAApB,CAA0B,IAA1B,EAAgCrB,OAAhC,CAAjB;AACA,iBAAOmB,UAAP;AACD;;;0CAEiBG,a,EAA2BC,Q,EAAgB;AAC3D,cAAIC,KAAK,GAAG,CAAZ;AACA,cAAIC,OAAO,GAAG,CAAd;AACA,cAAIC,UAAU,GAAG,CAAjB;;AAEA,eAAKD,OAAO,GAAGF,QAAf,EAAyBE,OAAO,IAAI,CAApC,EAAuCA,OAAO,IAAI,CAAlD,EAAqD;AACnDD,iBAAK,IAAI,CAACF,aAAa,CAACI,UAAD,CAAb,GAA4B,IAA7B,KAAsCD,OAA/C;AACAC,sBAAU,GAFyC,CAGnD;AACD;;AAED,iBAAOF,KAAP;AACD;;;mCAEU1kB,C,EAAoB;AAC7B,cAAI6kB,cAAc,GAAG,mEAAapjB,iBAAb,CAA+ByK,GAA/B,CAAmClM,CAAC,CAACqjB,KAArC,CAArB;;AAEA,cAAIwB,cAAJ,EAAoB;AAClB;AACA,gBAAI1Q,KAAK,GAAG0Q,cAAc,CAAC/nB,MAAf,CAAsBqX,KAAtB,CAA4B,GAA5B,CAAZ;AACA,gBAAItY,MAAM,GAAGsY,KAAK,CAAC,CAAD,CAAlB;AACA,gBAAIpX,MAAM,GAAG+D,KAAK,CAACqT,KAAK,CAACA,KAAK,CAACtQ,MAAN,GAAe,CAAhB,CAAN,CAAL,GAAwCsQ,KAAK,CAACA,KAAK,CAACtQ,MAAN,GAAe,CAAhB,CAA7C,GAAkEzC,MAAM,CAAC+S,KAAK,CAACA,KAAK,CAACtQ,MAAN,GAAe,CAAhB,CAAN,CAArF;AACA,gBAAI7G,IAAI,GAAGmX,KAAK,CAACA,KAAK,CAACtQ,MAAN,GAAe,CAAhB,CAAhB;AAEA,gBAAI1H,MAAM,GAAG,EAAb;;AACA,gBAAIgY,KAAK,CAACtQ,MAAN,KAAiB,CAArB,EAAwB;AAAC;AACvB1H,oBAAM,GAAG,mEAAagF,IAAb,GAAoBgT,KAAK,CAAC,CAAD,CAAlC,CADsB,CACiB;AACvC;AACD,aAHD,MAGO;AAAE;AACP,kBAAIrY,UAAU,GAAG,IAAIM,IAAJ,CAASyoB,cAAc,CAAC1oB,MAAxB,CAAjB,CADK,CAEL;;AACA,kBAAI6K,WAAW,GAAG,IAAlB;;AACA,kBAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AACpC0K,2BAAW,GAAG,GAAd;AACD,eAFD,MAEO,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,2BAAW,GAAG,GAAd;AACD,eAFM,MAEA,IAAIlL,UAAU,CAACQ,QAAX,KAAwB,CAAxB,KAA8B,EAAlC,EAAsC;AAC3C0K,2BAAW,GAAG,GAAd;AACD,eAFM,MAEA;AACLA,2BAAW,GAAGlL,UAAU,CAACQ,QAAX,KAAwB,CAAtC;AACD;;AACDH,oBAAM,GAAG,MAAML,UAAU,CAACO,WAAX,KAA2B,IAAjC,IAA0C2K,WAA1C,GAAyD,CAAC,MAAMlL,UAAU,CAACS,OAAX,EAAP,EAA6BqE,KAA7B,CAAmC,CAAC,CAApC,CAAlE,CAbK,CAaqG;AAC3G;;AAED,gBAAI9D,MAAM,GAAGjB,MAAM,GAAGM,MAAT,GAAkBY,MAAlB,GAA2BC,IAAxC,CA3BkB,CA2B4B;AAE9C;;AACA,iBAAKxG,UAAL,CAAgByE,MAAhB,CAAuB6B,MAAvB,EAA+BkD,CAAC,CAACrC,GAAjC;AACA,iBAAKnH,UAAL,CAAgBsuB,MAAhB,CAAuBhoB,MAAvB,EAA+BkD,CAAC,CAACgkB,GAAjC;AACA,iBAAKxtB,UAAL,CAAgBuuB,SAAhB,CAA0BjoB,MAA1B,EAAkCkD,CAAC,CAACmH,MAApC,EAhCkB,CAiClB;AACA;AACD,WAnCD,MAmCO;AAAE;AACP,gBAAIrK,QAAM,GAAG,EAAb;;AACA,gBAAIkD,CAAC,CAACqjB,KAAF,KAAY,KAAhB,EAAuB;AACrBvmB,sBAAM,GAAG,SAAT;AACD,aAFD,MAEO,IAAIkD,CAAC,CAACqjB,KAAF,KAAY,KAAhB,EAAuB;AAC5BvmB,sBAAM,GAAG,WAAT;AACD,aAFM,MAEA,IAAIkD,CAAC,CAACqjB,KAAF,KAAY,CAAhB,EAAmB;AACxBvmB,sBAAM,GAAG,QAAT;AACD,aAFM,MAEA;AACLnC,qBAAO,CAACwD,KAAR,CAAc6B,CAAC,CAACqjB,KAAhB,EAAuB,sBAAvB;AACD;;AACD,iBAAK7sB,UAAL,CAAgByE,MAAhB,CAAuB6B,QAAvB,EAA+BkD,CAAC,CAACrC,GAAjC;AACA,iBAAKnH,UAAL,CAAgBsuB,MAAhB,CAAuBhoB,QAAvB,EAA+BkD,CAAC,CAACgkB,GAAjC;AACA,iBAAKxtB,UAAL,CAAgBuuB,SAAhB,CAA0BjoB,QAA1B,EAAkCkD,CAAC,CAACmH,MAApC;AACD;AACF;;;;;;;uBA7JUib,sB,EAAsB,uH,EAAA,+G;AAAA,K;;;aAAtBA,sB;AAAsB,eAAtBA,sBAAsB,K;AAAA,kBAFrB;;;;;sEAEDA,sB,EAAsB;cAHlC,wDAGkC;eAHvB;AACVpV,oBAAU,EAAE;AADF,S;AAGuB,Q;;;;;;;;;;;;;;;;;;;;;;;;ACXnC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAUagY,gB;AAGX;AAEA,gCACUhc,IADV,EAEUic,gBAFV,EAE4C;AAAA;;AADlC,aAAAjc,IAAA,GAAAA,IAAA;AACA,aAAAic,gBAAA,GAAAA,gBAAA;AALV,aAAAC,OAAA,GAAU,iCAAV;AAMK;;;;2CAEcnuB,Y,EAAe;AAAA;;AAChC,cAAIiV,WAAW,GAAG;AAChBmZ,wBAAY,EAAE;AADE,WAAlB;AAIA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,sCAAzB;AACA,eAAKlc,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,EAAgCvR,SAAhC,CAA0C,UAACK,GAAD,EAAc;AACtDH,mBAAO,CAACC,GAAR,CAAY,qCAAZ,EAAmDE,GAAnD;;AACA,gBAAIA,GAAJ,EAAS;AACP,iFAAa2G,iBAAb,CAA+B2jB,KAA/B;;AACA,mBAAK,IAAItvB,CAAT,IAAcgF,GAAd,EAAmB;AACjB,oBAAIA,GAAG,CAAChF,CAAD,CAAH,YAAkBiK,KAAtB,EAA6B;AAC3BjF,qBAAG,CAAChF,CAAD,CAAH,CAAO6J,OAAP,CAAe,UAAAiE,CAAC,EAAI;AAClB,wBAAI5D,CAAC,GAAG,IAAI,2DAAJ,EAAR;AACAA,qBAAC,CAAClD,MAAF,GAAW8G,CAAC,CAAC9G,MAAb,CAFkB,CAEG;;AACrBkD,qBAAC,CAACqlB,OAAF,GAAYjkB,MAAM,CAACwC,CAAC,CAACyhB,OAAH,CAAlB;AACArlB,qBAAC,CAAC7D,MAAF,GAAW,IAAIC,IAAJ,CAASwH,CAAC,CAACzH,MAAF,GAAW,IAApB,EAA0B8E,YAA1B,EAAX;AACAjB,qBAAC,CAACmjB,aAAF,GAAkBvf,CAAC,CAACuf,aAApB;AACAnjB,qBAAC,CAACmM,QAAF,GAAavI,CAAC,CAACuI,QAAf;AACAnM,qBAAC,CAACslB,OAAF,GAAY1hB,CAAC,CAAC0hB,OAAd;AACAtlB,qBAAC,CAAC3K,IAAF,GAAS+L,MAAM,CAACwC,CAAC,CAACvO,IAAH,CAAf,CARkB,CASlB;AACA;;AACA;;;;AAGA,wBAAI2K,CAAC,CAAC3K,IAAF,KAAW,KAAf,EAAsB,CACpB;AACD;;AACD,uFAAaoM,iBAAb,CAA+BmgB,GAA/B,CAAmC5hB,CAAC,CAAC3K,IAArC,EAA2C2K,CAA3C;AACD,mBAlBD;AAmBD;AACF;;AAED,qBAAI,CAACuH,gBAAL,CAAsBxQ,YAAtB;AAED;;AACD4D,mBAAO,CAACC,GAAR,CAAY,uDAAZ,EAAqE,mEAAa6G,iBAAlF;AACD,WAhCD,EAiCA,UAAAtD,KAAK,EAAI;AACPxD,mBAAO,CAACC,GAAR,CAAY,2CAAZ,EAAyDuD,KAAzD;AACD,WAnCD;AAoCD;;;yCAEgBpH,Y,EAAc;AAC7B,eAAKkuB,gBAAL,CAAsBM,OAAtB,CAA8BxuB,YAA9B;AACD;;;0CAEiByuB,W,EAA2B;AAAA;;AAC3C;;;;;;;;AASA,cAAI/L,GAAG,GAAG,EAAV;AACA+L,qBAAW,CAAC7lB,OAAZ,CAAoB,UAAA8lB,UAAU,EAAI;AAChC,gBAAI5pB,MAAM,GAAG,OAAI,CAAC6pB,mBAAL,CAAyBD,UAAzB,CAAb;;AACA,gBAAI5pB,MAAJ,EAAY;AACV4d,iBAAG,CAACjZ,IAAJ,CAAS,CAAC3E,MAAM,CAACsnB,aAAR,EAAuBtnB,MAAM,CAACxG,IAA9B,CAAT;AACD;AACF,WALD;AAMA,cAAI+I,OAAO,GAAGuV,IAAI,CAAC2G,SAAL,CAAe;AAAC,iBAAM,WAAP;AAAoB,iBAAMb,GAA1B;AAA+B,iBAAM,8DAAsBkM;AAA3D,WAAf,CAAd;AAEAhrB,iBAAO,CAACC,GAAR,CAAY,wBAAwBwD,OAApC;AACA,eAAK6mB,gBAAL,CAAsBW,WAAtB,CAAkCxnB,OAAlC;AACD;;;4CAEmBqnB,U,EAAsB;AAC5C;;;;;;;AAOI,cAAII,aAAa,GAAG,IAApB;;AACA,6EAAapkB,iBAAb,CAA+B9B,OAA/B,CAAuC,UAAAmE,OAAO,EAAI;AAClD;AACE;AACA,gBAAIqQ,KAAK,GAAGrQ,OAAO,CAAChH,MAAR,CAAeqX,KAAf,CAAqB,GAArB,CAAZ;AACA,gBAAItY,MAAM,GAAGsY,KAAK,CAAC,CAAD,CAAlB;AACA,gBAAIpX,MAAM,GAAGoX,KAAK,CAACA,KAAK,CAACtQ,MAAN,GAAe,CAAhB,CAAlB;AACA,gBAAI7G,IAAI,GAAGmX,KAAK,CAACA,KAAK,CAACtQ,MAAN,GAAe,CAAhB,CAAhB,CANgD,CAOhD;;AACA,gBAAI4hB,UAAU,CAACtpB,MAAX,KAAsB2H,OAAO,CAAC3H,MAA9B,IACCspB,UAAU,CAAC5pB,MAAX,KAAsBA,MADvB,IAEC4pB,UAAU,CAAC1oB,MAAX,KAAsBqE,MAAM,CAACrE,MAAD,CAF7B,IAGC0oB,UAAU,CAACzoB,IAAX,KAAoBA,IAHzB,EAG+B;AAC7B6oB,2BAAa,GAAG/hB,OAAhB;AACA;AACD;AACF,WAfD;;AAgBA,iBAAO+hB,aAAP;AAEA;;;;;;;;;;;;;;;;;;;;;;AAsBD;;;;;;;uBAlIUb,gB,EAAgB,uH,EAAA,2H;AAAA,K;;;aAAhBA,gB;AAAgB,eAAhBA,gBAAgB,K;AAAA,kBAFf;;;;;sEAEDA,gB,EAAgB;cAH5B,wDAG4B;eAHjB;AACVhY,oBAAU,EAAE;AADF,S;AAGiB,Q;;;;;;;;;;;;;;;;;;;;;;;;ACV7B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,kD,CAQA;AACA;;;QAKa8Y,Y;AAIX,4BACU9c,IADV,EAEUpS,OAFV,EAEwC;AAAA;;AAD9B,aAAAoS,IAAA,GAAAA,IAAA;AACA,aAAApS,OAAA,GAAAA,OAAA;AAJV,aAAAsuB,OAAA,GAAU,qCAAV;AAKK;;;;0CAEa,CAEjB;;;qCAEY;AAAA;;AAEX,eAAKnnB,IAAL,GAAYtD,SAAZ,CAAsB,UAACK,GAAD,EAAc;AAClCH,mBAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BE,GAA1B;;AACA,gBAAIA,GAAG,IAAIA,GAAG,CAAC6kB,IAAf,EAAqB;AACnB,iFAAaoG,cAAb,GAA8BjrB,GAAG,CAAC6kB,IAAJ,CAASqG,SAAvC;AACA,iFAAaC,aAAb,GAA6BnrB,GAAG,CAAC6kB,IAAJ,CAASuG,QAAtC;AACA,iFAAaC,iBAAb,GAAiCrrB,GAAG,CAAC6kB,IAAJ,CAASyG,YAA1C;;AAEA,qBAAI,CAACxvB,OAAL,CAAa2uB,OAAb;AACD;AACF,WATD,EAUA,UAAApnB,KAAK,EAAI;AACPxD,mBAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCuD,KAAhC;AACD,WAZD;AAaD;;;6CAEoB;AAAA;;AACnB,cAAI6N,WAAW,GAAG;AAChBmZ,wBAAY,EAAE;AADE,WAAlB;AAIA,cAAIlZ,GAAG,GAAG,sFAAV;AACA,eAAKjD,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,EAAgCvR,SAAhC,CAA0C,UAACK,GAAD,EAAc;AACtDH,mBAAO,CAACC,GAAR,CAAY,iCAAZ,EAA+CE,GAA/C;;AACA,gBAAIA,GAAJ,EAAS;AACP,iFAAa2G,iBAAb,CAA+B2jB,KAA/B;;AACAtqB,iBAAG,CAAC6E,OAAJ,CAAY,UAAAiE,CAAC,EAAI;AAEf;AAEA,oBAAI5D,CAAC,GAAG,IAAI,2DAAJ,EAAR;AAEA,oBAAIojB,UAAU,GAAG,GAAjB;;AACA,oBAAIxf,CAAC,CAACyiB,QAAF,KAAe,KAAnB,EAA0B;AACxBjD,4BAAU,GAAG,QAAb;AACD;;AAEDpjB,iBAAC,CAACnE,MAAF,GAAW+H,CAAC,CAAC0iB,IAAb;AACAtmB,iBAAC,CAACjD,MAAF,GAAWqE,MAAM,CAACwC,CAAC,CAAC7G,MAAH,CAAN,GAAmBqmB,UAA9B;;AACA,oBAAIxf,CAAC,CAAC9G,MAAF,CAASub,QAAT,CAAkB,IAAlB,CAAJ,EAA6B;AAC3BrY,mBAAC,CAACmE,UAAF,GAAe,IAAf;AACD;;AACD,oBAAIP,CAAC,CAAC9G,MAAF,CAASub,QAAT,CAAkB,IAAlB,CAAJ,EAA6B;AAC3BrY,mBAAC,CAACmE,UAAF,GAAe,IAAf;AACD;;AACD,oBAAIP,CAAC,CAAC9G,MAAF,CAASub,QAAT,CAAkB,KAAlB,CAAJ,EAA8B;AAC5BrY,mBAAC,CAACmE,UAAF,GAAe,KAAf;AACD;;AAEDnE,iBAAC,CAAClD,MAAF,GAAW8G,CAAC,CAAC9G,MAAb,CAvBe,CAuBM;;AACrBkD,iBAAC,CAACqlB,OAAF,GAAYjkB,MAAM,CAACwC,CAAC,CAAC6D,OAAH,CAAlB;AACAzH,iBAAC,CAAC7D,MAAF,GAAW,IAAIC,IAAJ,CAASwH,CAAC,CAACzH,MAAX,EAAmB8E,YAAnB,EAAX,CAzBe,CA0Bf;;AACAjB,iBAAC,CAACmM,QAAF,GAAavI,CAAC,CAACyiB,QAAf,CA3Be,CA4Bf;;AACArmB,iBAAC,CAAC3K,IAAF,GAAS+L,MAAM,CAACwC,CAAC,CAACyf,KAAH,CAAf,CA7Be,CA8Bf;AACA;;AACA;;;;AAGA,oBAAIrjB,CAAC,CAAC3K,IAAF,KAAW,KAAf,EAAsB,CACpB;AACD;;AACD,mFAAaoM,iBAAb,CAA+BmgB,GAA/B,CAAmC5hB,CAAC,CAAC3K,IAArC,EAA2C2K,CAA3C;AAED,eAxCD;;AA0CA,qBAAI,CAAC6M,UAAL;AACD;;AACDlS,mBAAO,CAACC,GAAR,CAAY,mDAAZ,EAAiE,mEAAa6G,iBAA9E;AACD,WAjDD,EAkDA,UAAAtD,KAAK,EAAI;AACPxD,mBAAO,CAACC,GAAR,CAAY,uCAAZ,EAAqDuD,KAArD;AACD,WApDD;AAqDD;;;0CAEiBqnB,W,EAA2B;AAAA;;AAC3C;;;;;;;;AASA,cAAI/L,GAAG,GAAG,EAAV;AACA+L,qBAAW,CAAC7lB,OAAZ,CAAoB,UAAA8lB,UAAU,EAAI;AAChC,gBAAI5pB,MAAM,GAAG,OAAI,CAAC6pB,mBAAL,CAAyBD,UAAzB,CAAb;AAED,WAHD,EAX2C,CAe3C;;AAEA,cAAIc,kBAAkB,GAAG,2BAAzB;AACA,cAAIC,IAAI,GAAG,6BAA6BD,kBAA7B,GAAkD,aAAlD,GAAkE,mEAAaR,cAA/E,GAAgG,aAAhG,GAAgH,mEAAaU,WAA7H,GAA2I,cAA3I,GAA4J,mEAAaA,WAAzK,GAAuL,IAAlM;AAGA9rB,iBAAO,CAACC,GAAR,CAAY,8BAA8B4rB,IAA1C;AACA,eAAK5vB,OAAL,CAAagvB,WAAb,CAAyBY,IAAzB;AACD;;;4CAEmBf,U,EAAsB;AAC5C;;;;;;AAMI,cAAII,aAAa,GAAG,IAApB;;AACA,6EAAapkB,iBAAb,CAA+B9B,OAA/B,CAAuC,UAAAmE,OAAO,EAAI;AAEhD;AACA,gBAAI2hB,UAAU,CAACtpB,MAAX,KAAsB2H,OAAO,CAAC3H,MAA9B,IACCspB,UAAU,CAAC5pB,MAAX,KAAsBiI,OAAO,CAACjI,MAD/B,IAEC4pB,UAAU,CAAC1oB,MAAX,KAAsB+G,OAAO,CAAC/G,MAF/B,IAGC0oB,UAAU,CAACzoB,IAAX,KAAoB8G,OAAO,CAACK,UAHjC,EAG6C;AAC3C0hB,2BAAa,GAAG/hB,OAAhB;AACA;AACD;AACF,WAVD;;AAWA,iBAAO+hB,aAAP;AACD;;;+BAGM;AACL;;AAGA,cAAI7Z,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvB,8BAAgB,kBADO;AAEvB,wBAAU,kBAFa;AAGvB,4BAAc,MAHS;AAIvB,4BAAc,KAJS;AAKvB,iCAAmB,aALI;AAMvB,kCAAoB,gBANG;AAOvB,8BAAgB,mBAPO;AAQvB,8BAAgB,mEAAaC;AARN,aAAhB,CADO;AAWhBxB,wBAAY,EAAE;AAXE,WAAlB;AAcA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,iDAAzB;AAEA,cAAI7P,IAAI,GAAG;AAAC,0BAAa,mEAAaoR,WAA3B;AAAuC,wBAAW,mEAAaG;AAA/D,WAAX;AAEA,iBAAO,KAAK5d,IAAL,CAAU2D,IAAV,CAAeV,GAAf,EAAoBoJ,IAApB,EAA0BrJ,WAA1B,CAAP;AAEA;;;;;;;;;;AAUD;;;iCAEQjV,Y,EAAc;AAErB,cAAIiV,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvBG,2BAAa,EAAE,YAAY9vB,YADJ;AAEvB,8BAAgB,kBAFO;AAGvB,wBAAU,kBAHa;AAIvB,4BAAc,MAJS;AAKvB,4BAAc,KALS;AAMvB,iCAAmB,aANI;AAOvB,kCAAoB,gBAPG;AAQvB,8BAAgB,mBARO;AASvB,8BAAgB,mEAAa4vB;AATN,aAAhB,CADO;AAYhBxB,wBAAY,EAAE;AAZE,WAAlB;AAeA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,0CAAzB;AACA,iBAAO,KAAKlc,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,CAAP;AAEA;;;;;;;;;;;;;;;;;;;;;AAqBD;;;qCAEYjV,Y,EAAc;AAEzB;;;;AAIA;;;AAIA,cAAIiV,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvBG,2BAAa,EAAE,YAAY9vB,YADJ;AAEvB,8BAAgB,kBAFO;AAGvB,wBAAU,kBAHa;AAIvB,4BAAc,MAJS;AAKvB,4BAAc,KALS;AAMvB,iCAAmB,aANI;AAOvB,kCAAoB,gBAPG;AAQvB,8BAAgB,mBARO;AASvB,8BAAgB,mEAAa4vB;AATN,aAAhB,CADO;AAYhBxB,wBAAY,EAAE;AAZE,WAAlB;AAeA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,gDAAzB;AACA,iBAAO,KAAKlc,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,CAAP;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CD;;;kCAESjV,Y,EAAc;AAEtB;;;AAIA,cAAIiV,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvBG,2BAAa,EAAE,YAAY9vB,YADJ;AAEvB,8BAAgB,kBAFO;AAGvB,wBAAU,kBAHa;AAIvB,4BAAc,MAJS;AAKvB,4BAAc,KALS;AAMvB,iCAAmB,aANI;AAOvB,kCAAoB,gBAPG;AAQvB,8BAAgB,mBARO;AASvB,8BAAgB,mEAAa4vB;AATN,aAAhB,CADO;AAYhBxB,wBAAY,EAAE;AAZE,WAAlB;AAeA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,iDAAzB;AACA,iBAAO,KAAKlc,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,CAAP;AACD;;;oCAEWjV,Y,EAAcse,I,EAAM;AAE9B,cAAIrJ,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvBG,2BAAa,EAAE9vB,YADQ;AAEvB,8BAAgB;AAFO,aAAhB,CADO;AAKhBouB,wBAAY,EAAE;AALE,WAAlB;AAQA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,QAAzB;AAEA,iBAAO,KAAKlc,IAAL,CAAU2D,IAAV,CAAeV,GAAf,EAAoBoJ,IAApB,EAA0BrJ,WAA1B,CAAP;AACD;;;;;;;uBA7UU8Z,Y,EAAY,uH,EAAA,qI;AAAA,K;;;aAAZA,Y;AAAY,eAAZA,YAAY,K;AAAA,kBAFX;;;;;sEAEDA,Y,EAAY;cAHxB,wDAGwB;eAHb;AACV9Y,oBAAU,EAAE;AADF,S;AAGa,Q;;;;;;;;;;;;;;;;;;;;;;;;ACdzB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,oD,CAMA;;;QAMa8Z,qB;AASX,qCACUC,sBADV,EACwD;AAAA;;AAA9C,aAAAA,sBAAA,GAAAA,sBAAA;AARH,aAAAhsB,eAAA,GAAgC,IAAI,4CAAJ,EAAhC;AAGP,aAAAisB,eAAA,GAAkB,iEAAlB;AACA,aAAAC,IAAA,GAAO,8DAAP;AAKK;;;;4CAEgB;AACnB,cAAI,KAAKC,SAAL,IAAkB,KAAKA,SAAL,CAAeC,IAAf,KAAwB,CAA9C,EAAiD;AAC/C,mBAAO,IAAP;AACD;;AACD,iBAAO,KAAP;AACD;;;kCAEM;AAAA;;AAEL,eAAKD,SAAL,GAAiB,IAAIE,SAAJ,CACf,KAAKJ,eADU,CAAjB;AAGA,eAAKE,SAAL,CAAeG,UAAf,GAA4B,aAA5B;;AACA,eAAKH,SAAL,CAAeI,MAAf,GAAwB,YAAM;AAC5B,mBAAI,CAACC,YAAL,CAAkBvT,KAAlB;AACD,WAFD;;AAGA,eAAKkT,SAAL,CAAeM,SAAf,GAA2B,UAAAC,YAAY,EAAI;AACzC,mBAAI,CAACC,eAAL,CAAqBD,YAArB;AACD,WAFD;;AAGA,eAAKP,SAAL,CAAeS,OAAf,GAAyB,UAAA3T,KAAK,EAAI;AAChC,mBAAI,CAAC4T,aAAL,CAAmB5T,KAAnB;AACD,WAFD;;AAGA,eAAKkT,SAAL,CAAeW,OAAf,GAAyB,UAAA7T,KAAK,EAAI;AAChC,mBAAI,CAAC8T,aAAL,CAAmB9T,KAAnB;AACD,WAFD;AAGD;;;qCAEYA,K,EAAY;AACvBrZ,iBAAO,CAACC,GAAR,CAAY,8BAAZ;AACA;;;;;;AAMA,cAAImtB,IAAI,GAAG,wCAAwC,mEAAahC,cAArD,GAAsE,aAAtE,GAAsF,mEAAaU,WAAnG,GAAiH,cAAjH,GAAkI,mEAAaA,WAA/I,GAA6J,IAAxK;;AACA,eAAKb,WAAL,CAAiBmC,IAAjB;AAEA,eAAKC,aAAL;AACD;;;wCAEe;AAAA;;AACd,eAAKC,iBAAL,GAAyBzsB,WAAW,CAAC,YAAM;AACzC;AACA,gBAAI4C,OAAO,GAAG,wCAAwC,mEAAa2nB,cAArD,GAAsE,aAAtE,GAAsF,mEAAaU,WAAnG,GAAiH,cAAjH,GAAkI,mEAAaA,WAA/I,GAA6J,IAA3K;;AACA,mBAAI,CAACb,WAAL,CAAiBxnB,OAAjB;AACD,WAJmC,EAIjC,KAJiC,CAApC;AAKD;;;kDAEyB;AACxBzD,iBAAO,CAACC,GAAR,CAAY,8BAAZ;AACA,cAAIstB,eAAe,GAAG,mEAAaC,cAAb,CAA4B,mEAAarqB,gBAAzC,CAAtB;AACA,cAAIM,OAAO,GAAGuV,IAAI,CAAC2G,SAAL,CAAe;AAC3B,iBAAM,WADqB;AAE3B,iBAAM,CAAC,CAAC,CAAD,EAAI,KAAJ,CAAD,EAAa,CAAC,CAAD,EAAI,KAAJ,CAAb,EAAyB,CAAC,CAAD,EAAI,CAAJ,CAAzB,EAAiC,CAAC,CAAD,EAAI4N,eAAJ;AAAoB;AAArD,aAFqB;AAG3B,iBAAM,8DAAsBvC;AAHD,WAAf,CAAd,CAHwB,CAQxB;AACA;;AAEAhrB,iBAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BstB,eAA/B;AAEA,eAAKtC,WAAL,CAAiBxnB,OAAjB;AACD;;;wCAEeqpB,Y,EAA4B;AAC1C9sB,iBAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+B6sB,YAA/B,EAA6CA,YAAY,CAAC9H,IAA1D,EAD0C,CAE1C;;AACA;;;;AAIA,cAAIyI,OAAO,GAAGC,IAAI,CAACZ,YAAY,CAAC9H,IAAd,CAAlB,CAP0C,CAS1C;;AACA,cAAI2I,QAAQ,GAAGF,OAAO,CAACjU,KAAR,CAAc,EAAd,EAAkBze,GAAlB,CAAsB,UAAU0V,CAAV,EAAa;AAAE,mBAAOA,CAAC,CAACmd,UAAF,CAAa,CAAb,CAAP;AAAyB,WAA9D,CAAf,CAV0C,CAY1C;;AACA,cAAIC,OAAO,GAAG,IAAIhG,UAAJ,CAAe8F,QAAf,CAAd,CAb0C,CAe1C;;AACA,cAAIxR,MAAM,GAAG,KAAK2R,KAAL,CAAW,6CAAaD,OAAb,CAAX,CAAb;;AAEA7tB,iBAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBkc,MAAtB;AAEA,cAAI4R,IAAI,GAAG/U,IAAI,CAACC,KAAL,CAAWkD,MAAX,EAAmB,CAAnB,CAAX;;AACA,cAAI4R,IAAI,IAAIA,IAAI,CAACC,GAAL,KAAa,WAAzB,EAAsC;AACpChuB,mBAAO,CAACC,GAAR,CAAY,oBAAZ,EADoC,CAGpC;AACA;;AACA;;;;;AAKA,iBAAKG,eAAL,CAAqBiD,IAArB,CAA0B,WAA1B;AAEA;;;AAIA;AAEA;AAEA;AAED;AACF;;;8BAGK4qB,K,EAAO;AACX,cAAIC,QAAQ,GAAG,EAAf;;AACA,cAAI;AACC,iBAAK,IAAIjlB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGglB,KAAK,CAAC/kB,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AAClCilB,sBAAQ,CAACroB,IAAT,CAAcqW,MAAM,CAACyN,YAAP,CAAoBsE,KAAK,CAAChlB,CAAD,CAAzB,CAAd;AACJ;AACL,WAJD,CAIE,OAAOzO,CAAP,EAAU,CAAG;;AAEf,iBAAO0zB,QAAQ,CAAC3G,IAAT,CAAc,EAAd,CAAP;AACD;;;sCAEalO,K,EAAY;AACxBrZ,iBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCoZ,KAAtC;AACD;;;sCAEaA,K,EAAiB;AAAA;;AAC7BrZ,iBAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCoZ,KAApC;AACA8U,uBAAa,CAAC,KAAKb,iBAAN,CAAb;AACA,eAAKf,SAAL,GAAiB,IAAjB;AACAlrB,oBAAU,CAAC,YAAM;AACf,gBAAI,OAAI,CAACkrB,SAAL,IAAkB,OAAI,CAACA,SAAL,CAAeC,IAAf,KAAwB,CAA9C,EAAiD,CAC/C;AACD,aAFD,MAEO;AACLxsB,qBAAO,CAACC,GAAR,CAAY,wBAAZ;;AACA,qBAAI,CAAC2qB,OAAL;AACD;AAEF,WARS,EAQP,IARO,CAAV;AASD;;;oCAEWnnB,O,EAAO;AACjB,cAAI,KAAK8oB,SAAL,IAAkB,KAAKA,SAAL,CAAeC,IAAf,KAAwB,CAA9C,EAAiD;AAC/CxsB,mBAAO,CAACC,GAAR,CAAY,qCAAqCwD,OAAjD;AACA,iBAAK8oB,SAAL,CAAe6B,IAAf,CAAoB3qB,OAApB;AACD,WAHD,MAGO;AACLzD,mBAAO,CAACC,GAAR,CACE,4EADF,EAEEwD,OAFF;AAID;AACF;;;;;;;uBArKU0oB,qB,EAAqB,wI;AAAA,K;;;aAArBA,qB;AAAqB,eAArBA,qBAAqB,K;AAAA,kBAFpB;;;;;sEAEDA,qB,EAAqB;cAHjC,wDAGiC;eAHtB;AACV9Z,oBAAU,EAAE;AADF,S;AAGsB,Q;;;;;;;;;;;;;;;;;;;;;;ACTlC;AAAA;;;AAAA;AAAA;AAAA;;QAAagc,Y;;;;AACJ,iBAAArnB,UAAA,GAAa,WAAb,C,CAA0B;;AAC1B,iBAAA9B,QAAA,GAAW,OAAX;AACA,iBAAAtB,UAAA,GAAa,YAAb;AACA,iBAAA0qB,aAAA,GAAgB,YAAhB;AACA,iBAAAxC,WAAA,GAAc,SAAd;AACA,iBAAAG,aAAA,GAAgB,aAAhB;AACA,iBAAAD,WAAA,GAAc,UAAd;AACA,iBAAAZ,cAAA,GAAiB,EAAjB;AACA,iBAAAE,aAAA,GAAgB,EAAhB;AACA,iBAAAE,iBAAA,GAAoB,EAApB;AACA,iBAAAhlB,IAAA,GAAO,IAAP,C,CAAa;;AACb,iBAAAzD,aAAA,GAAgB,CAAhB,C,CAAmB;;AACnB,iBAAAiG,qBAAA,GAAwB,EAAxB;AACA,iBAAA+C,mBAAA,GAAsB,KAAtB;AACA,iBAAApL,YAAA,GAAe,IAAf;AACA,iBAAAqX,SAAA,GAAY,CAAZ;AAEP;;;;;;;AAMO,iBAAAwV,cAAA,GAAiB;AACtB,aAAO,IADe;AAEtB,aAAO,KAFe;AAGtB,aAAO,IAHe;AAItB,aAAO,IAJe;AAKtB,aAAO,IALe;AAMtB,aAAO,IANe;AAOtB,aAAO,IAPe;AAQtB,aAAO,IARe;AAStB,aAAO,IATe;AAUtB,aAAO,IAVe;AAWtB,aAAO,IAXe;AAYtB,aAAO;AAZe,KAAjB;AAeA,iBAAArqB,gBAAA,GAAmB,IAAI1B,IAAJ,GAAW0C,cAAX,CAA0B,SAA1B,EAAqC;AAAEuC,WAAK,EAAE;AAAT,KAArC,EAAyD6nB,WAAzD,GAAuEroB,SAAvE,CAAiF,CAAjF,EAAmF,CAAnF,CAAnB,C,CAA0G;;AAE1G,iBAAAY,iBAAA,GAAoB,IAAIkgB,GAAJ,EAApB;AAEA,iBAAA5a,aAAA,GAAgB;AACrB,SAAI,KADiB;AAErB,SAAI,KAFiB;AAGrB,SAAI,KAHiB;AAIrB,SAAI,KAJiB;AAKrB,SAAI,KALiB;AAMrB,SAAI,KANiB;AAOrB,SAAI,KAPiB;AAQrB,SAAI,KARiB;AASrB,SAAI,KATiB;AAUrB,UAAK,KAVgB;AAWrB,UAAK,KAXgB;AAYrB,UAAK;AAZgB,KAAhB;AAeT;;;;;;;;;;;;;;;;;;;;AAoBS,iBAAA/F,kBAAA,GAAqB;AAC1B,eAAS,IAAI5E,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CADiB;AAE1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAFiB;AAG1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAHiB;AAI1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAJiB;AAK1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CALiB;AAM1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CANiB;AAO1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAPiB;AAQ1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CARiB;AAS1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CATiB;AAU1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAViB;AAW1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,EAAf,EAAmB,EAAnB,CAXiB;AAY1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,EAAf,EAAmB,EAAnB,CAZiB;AAa1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAbiB;AAc1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAdiB;AAe1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAfiB;AAgB1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAhBiB;AAiB1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAjBiB;AAkB1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAlBiB;AAmB1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAnBiB;AAoB1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CApBiB;AAqB1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CArBiB;AAsB1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAtBiB;AAuB1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAvBiB;AAwB1B,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB;AAxBiB,KAArB;AA2BA,iBAAA8E,wBAAA,GAA2B;AAChC,eAAS,IAAI9E,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CADuB;AAEhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAFuB;AAGhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAHuB;AAIhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAJuB;AAKhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CALuB;AAMhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CANuB;AAOhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAPuB;AAQhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CARuB;AAShC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CATuB;AAUhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAVuB;AAWhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,EAAf,EAAmB,EAAnB,CAXuB;AAYhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,EAAf,EAAmB,EAAnB,CAZuB;AAahC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAbuB;AAchC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAduB;AAehC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAfuB;AAgBhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAhBuB;AAiBhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAjBuB;AAkBhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAlBuB;AAmBhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAnBuB;AAoBhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CApBuB;AAqBhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CArBuB;AAsBhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAtBuB;AAuBhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB,CAvBuB;AAwBhC,eAAS,IAAIA,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,EAAlB;AAxBuB,KAA3B;AA4BP;;AACO,iBAAAxC,QAAA,GAAW;AAChB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,KAApH;AAA2H,eAAO,GAAlI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OADI;AAEhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,KAApH;AAA2H,eAAO,EAAlI;AAAsI,mBAAW,EAAjJ;AAAqJ,sBAAc;AAAnK,OAFE;AAGhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,GAAD,CAAlJ;AAAyJ,sBAAc,CAAC,GAAD;AAAvK,OAHE;AAIhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,OAApH;AAA6H,eAAO,CAApI;AAAuI,mBAAW,CAAC,IAAD,EAAO,IAAP,CAAlJ;AAAgK,sBAAc,CAAC,IAAD;AAA9K,OAJE;AAKhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,GAAD,CAAlJ;AAAyJ,sBAAc,CAAC,GAAD,EAAM,GAAN;AAAvK,OALI;AAMhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,IAAD,CAAlJ;AAA0J,sBAAc,CAAC,IAAD,EAAO,IAAP;AAAxK,OANE;AAOhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,OAApH;AAA6H,eAAO,CAApI;AAAuI,mBAAW,CAAC,KAAD,CAAlJ;AAA2J,sBAAc,CAAC,KAAD;AAAzK,OAPE;AAQhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OARE;AAShB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OATE;AAUhB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAVQ;AAWhB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAXG;AAYhB,eAAS;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAZO;AAahB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAbG;AAchB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAdI;AAehB,iBAAW;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAfK;AAgBhB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAhBG;AAiBhB,gBAAU;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,OAApH;AAA6H,eAAO,CAApI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAjBM;AAkBhB,iBAAW;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAlBK;AAmBhB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAnBQ;AAoBhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OApBI;AAqBhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OArBI;AAsBhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAtBE;AAuBhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAvBI;AAwBhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAxBE;AAyBhB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAzBG;AA0BhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA1BE;AA2BhB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,OAApH;AAA6H,eAAO,EAApI;AAAwI,mBAAW,EAAnJ;AAAuJ,sBAAc;AAArK,OA3BQ;AA4BhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA5BS;AA6BhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA7BS;AA8BhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA9BI;AA+BhB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA/BG;AAgChB,YAAM;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAhCU;AAiChB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAjCS;AAkChB,gBAAU;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAlCM;AAmChB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,QAApH;AAA8H,eAAO,CAArI;AAAwI,mBAAW,EAAnJ;AAAuJ,sBAAc;AAArK,OAnCG;AAoChB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OApCQ;AAqChB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OArCQ;AAsChB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,KAApH;AAA2H,eAAO,EAAlI;AAAsI,mBAAW,EAAjJ;AAAqJ,sBAAc;AAAnK,OAtCG;AAuChB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,CAAjI;AAAoI,mBAAW,EAA/I;AAAmJ,sBAAc;AAAjK,OAvCI;AAwChB,iBAAW;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,MAApH;AAA4H,eAAO,CAAnI;AAAsI,mBAAW,EAAjJ;AAAqJ,sBAAc;AAAnK,OAxCK;AAyChB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAzCQ;AA0ChB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA1CI;AA2ChB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,KAApH;AAA2H,eAAO,EAAlI;AAAsI,mBAAW,EAAjJ;AAAqJ,sBAAc;AAAnK,OA3CG;AA4ChB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA5CE;AA6ChB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA7CE;AA8ChB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA9CG;AA+ChB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,OAApH;AAA6H,eAAO,CAApI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA/CS;AAgDhB,eAAS;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,OAApH;AAA6H,eAAO,EAApI;AAAwI,mBAAW,EAAnJ;AAAuJ,sBAAc;AAArK,OAhDO;AAiDhB,eAAS;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,MAApH;AAA4H,eAAO,CAAnI;AAAsI,mBAAW,EAAjJ;AAAqJ,sBAAc;AAAnK,OAjDO;AAkDhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAlDE;AAmDhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAnDS;AAoDhB,eAAS;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OApDO;AAqDhB,gBAAU;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,MAApH;AAA4H,eAAO,CAAnI;AAAsI,mBAAW,EAAjJ;AAAqJ,sBAAc;AAAnK,OArDM;AAsDhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,KAApH;AAA2H,eAAO,EAAlI;AAAsI,mBAAW,EAAjJ;AAAqJ,sBAAc;AAAnK,OAtDS;AAuDhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,IAAD,CAAlJ;AAA0J,sBAAc,CAAC,IAAD;AAAxK,OAvDS;AAwDhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,IAAD,EAAO,IAAP,CAAlJ;AAAgK,sBAAc,CAAC,IAAD,EAAO,IAAP;AAA9K,OAxDI;AAyDhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,IAAD,EAAO,GAAP,CAAlJ;AAA+J,sBAAc,CAAC,IAAD,EAAO,IAAP;AAA7K,OAzDE;AA0DhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,IAAD,CAAlJ;AAA0J,sBAAc,CAAC,IAAD;AAAxK,OA1DE;AA2DhB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,GAAD,CAAlJ;AAAyJ,sBAAc,CAAC,GAAD;AAAvK,OA3DG;AA4DhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,IAAD,CAAlJ;AAA0J,sBAAc,CAAC,IAAD;AAAxK,OA5DE;AA6DhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,GAAD,CAAlJ;AAAyJ,sBAAc,CAAC,GAAD,EAAM,IAAN;AAAvK,OA7DE;AA8DhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,CAAC,IAAD,CAAlJ;AAA0J,sBAAc,CAAC,IAAD;AAAxK,OA9DE;AA+DhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA/DE;AAgEhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAhEE;AAiEhB,gBAAU;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAjEM;AAkEhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAlEI;AAmEhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAnEI;AAoEhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OApEI;AAqEhB,gBAAU;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OArEM;AAsEhB,eAAS;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAtEO;AAuEhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAvES;AAwEhB,eAAS;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,OAApH;AAA6H,eAAO,CAApI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAxEO;AAyEhB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAzEQ;AA0EhB,eAAS;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA1EO;AA2EhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA3EI;AA4EhB,iBAAW;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA5EK;AA6EhB,iBAAW;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA7EK;AA8EhB,mBAAa;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA9EG;AA+EhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA/EE;AAgFhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAhFS;AAiFhB,gBAAU;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAjFM;AAkFhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAlFE;AAmFhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAnFE;AAoFhB,kBAAY;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OApFI;AAqFhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OArFS;AAsFhB,eAAS;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAtFO;AAuFhB,gBAAU;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAvFM;AAwFhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAxFE;AAyFhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAzFE;AA0FhB,gBAAU;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA1FM;AA2FhB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA3FQ;AA4FhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA5FS;AA6FhB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA7FQ;AA8FhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,OAApH;AAA6H,eAAO,CAApI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA9FE;AA+FhB,eAAS;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OA/FO;AAgGhB,aAAO;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAhGS;AAiGhB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAjGQ;AAkGhB,iBAAW;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAlGK;AAmGhB,iBAAW;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OAnGK;AAoGhB,oBAAc;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OApGE;AAqGhB,cAAQ;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK,OArGQ;AAsGhB,iBAAW;AAAE,eAAO,IAAT;AAAe,kBAAU,IAAzB;AAA+B,gBAAQ,IAAvC;AAA6C,gBAAQ,IAArD;AAA2D,gBAAQ,IAAnE;AAAyE,kBAAU,IAAnF;AAAyF,qBAAa,IAAtG;AAA4G,gBAAQ,IAApH;AAA0H,eAAO,IAAjI;AAAuI,mBAAW,EAAlJ;AAAsJ,sBAAc;AAApK;AAtGK,KAAX;AAyGA,iBAAAuvB,WAAA,GAAc,0vBAAd;AACA,iBAAAC,WAAA,GAAc,qgBAAd;;;;;;;;;;;;;;;;ACnPT;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,oE,CAMA;AACA;;;QAKaC,Y;AAMX,4BACUrgB,IADV,EAC0B;AAAA;;AAAhB,aAAAA,IAAA,GAAAA,IAAA;AALV,aAAAkc,OAAA,GAAU,8BAAV;AACA,aAAAoE,OAAA,GAAU,oCAAV;AACA,aAAAC,OAAA,GAAU,4CAAV;AAIK;;;;+BAEE;AACL;;AAGA,cAAIvd,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvB;AACA,8BAAgB;AAFO,aAAhB,CADO;AAKhBvB,wBAAY,EAAE;AALE,WAAlB;AAQA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,MAAzB;AACA,cAAI7P,IAAI,GAAG;AAAE,sBAAU,mEAAa9W,UAAzB;AAAqC,0BAAe,mEAAa0qB;AAAjE,WAAX;AAEA,iBAAO,KAAKjgB,IAAL,CAAU2D,IAAV,CAAeV,GAAf,EAAoBoJ,IAApB,EAA0BrJ,WAA1B,CAAP;AACD;;;oCAEW/U,S,EAAW6V,K,EAAO;AAC5B;AACA,iBAAO,KAAKoY,OAAL,GAAe,cAAf,GAAgC,sBAAhC,GAAyDjuB,SAAzD,GAAqE,SAArE,GAAiF6V,KAAxF;AACD;;;iCAEQ/V,Y,EAAc;AAErB,cAAIiV,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvBG,2BAAa,EAAE9vB,YADQ;AAEvB,8BAAgB;AAFO,aAAhB,CADO;AAKhBouB,wBAAY,EAAE;AALE,WAAlB;AAQA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,OAAzB;AACA,iBAAO,KAAKlc,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,CAAP;AACD;;;qCAEYjV,Y,EAAc;AAEzB;;;;AAIA;;;AAIA,cAAIiV,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvBG,2BAAa,EAAE9vB,YADQ;AAEvB,8BAAgB;AAFO,aAAhB,CADO;AAKhBouB,wBAAY,EAAE;AALE,WAAlB;AAQA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,WAAzB;AACA,iBAAO,KAAKlc,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,CAAP;AACD;;;kCAESjV,Y,EAAc;AAEtB;;;AAIA,cAAIiV,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvBG,2BAAa,EAAE9vB,YADQ;AAEvB,8BAAgB;AAFO,aAAhB,CADO;AAKhBouB,wBAAY,EAAE;AALE,WAAlB;AAQA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,QAAzB;AACA,iBAAO,KAAKlc,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,CAAP;AACD;;;oCAEWjV,Y,EAAcse,I,EAAM;AAE9B,cAAIrJ,WAAW,GAAG;AAChB0a,mBAAO,EAAE,IAAI,gEAAJ,CAAgB;AACvBG,2BAAa,EAAE9vB,YADQ;AAEvB,8BAAgB;AAFO,aAAhB,CADO;AAKhBouB,wBAAY,EAAE;AALE,WAAlB;AAQA,cAAIlZ,GAAG,GAAG,KAAKiZ,OAAL,GAAe,QAAzB;AAEA,iBAAO,KAAKlc,IAAL,CAAU2D,IAAV,CAAeV,GAAf,EAAoBoJ,IAApB,EAA0BrJ,WAA1B,CAAP;AACD;;;;;;;uBApGUqd,Y,EAAY,uH;AAAA,K;;;aAAZA,Y;AAAY,eAAZA,YAAY,K;AAAA,kBAFX;;;;;sEAEDA,Y,EAAY;cAHxB,wDAGwB;eAHb;AACVrc,oBAAU,EAAE;AADF,S;AAGa,Q;;;;;;;;;;;;;;;;;;;;;;ACZzB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAUawc,e;AAgEX,+BACUxgB,IADV,EAC0B;AAAA;;AAAhB,aAAAA,IAAA,GAAAA,IAAA;AA/DN;;;;;;;;;;;;;;;;;;;AAoBF;;;;;;;;;;;;;;;AAeF,aAAAygB,WAAA,GAAc;AACZ,2BAAiB;AAAE,uBAAW,KAAb;AAAoB,uBAAW;AAA/B,WADL;AAEZ,2BAAiB;AAAE,uBAAW,IAAb;AAAmB,uBAAW;AAA9B;AAFL,SAAd;AAKA,aAAAC,WAAA,GAAc,EAAd;AAEA,aAAAC,iBAAA,GAAoB,EAApB,CAqB0B,CAnB1B;AACA;AACA;AACA;AACA;;AAEA,aAAArd,MAAA,GAAS,EAAT;AACA,aAAAvO,IAAA,GAAO,EAAP;AACA,aAAA6rB,WAAA,GAAc,EAAd;AACA,aAAAC,SAAA,GAAY,EAAZ;AACA,aAAAC,OAAA,GAAU,EAAV;AACA,aAAAtf,WAAA,GAAc,EAAd;AAEA,aAAAuf,KAAA,GAAQ,IAAR;AAEA,aAAApK,IAAA,GAAO,EAAP;AACA,aAAAqK,WAAA,GAAc,EAAd;AAIK;;;;qCAEQ1d,M,EAAQvO,I,EAAM6rB,W,EAAaC,S,EAAWC,O,EAAStf,W,EAAa;AAAA;;AAEvE,eAAK8B,MAAL,GAAcA,MAAd;AACA,eAAKvO,IAAL,GAAYA,IAAZ;AACA,eAAK6rB,WAAL,GAAmBA,WAAnB;AACA,eAAKC,SAAL,GAAiBA,SAAjB;AACA,eAAKC,OAAL,GAAeA,OAAf;AACA,eAAKtf,WAAL,GAAmBA,WAAnB;AAEA,cAAIke,IAAI,GAAG/U,IAAI,CAACC,KAAL,CAAW,KAAKgW,WAAhB,CAAX;AACA,cAAIK,KAAK,GAAGvB,IAAI,CAAC/I,IAAL,CAAU,CAAV,EAAasK,KAAzB;AAEAtvB,iBAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyC8tB,IAAI,CAAC/I,IAAL,CAAU,CAAV,EAAasK,KAAb,CAAmBpmB,MAA5D,EAAoE6kB,IAAI,CAAC/I,IAAL,CAAU,CAAV,CAApE;;AAZuE,qCAc9D/b,CAd8D;AAerE5H,sBAAU,CAAC,YAAM;AACf,kBAAIkuB,IAAI,GAAGD,KAAK,CAACrmB,CAAD,CAAhB;AACAjJ,qBAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBgJ,CAApB,EAAuBsmB,IAAvB;;AACA,qBAAI,CAACpW,OAAL,CAAaoW,IAAb;AACD,aAJS,EAIPtmB,CAAC,GAAG,OAAI,CAACmmB,KAJF,CAAV;AAfqE;;AAcvE,eAAK,IAAInmB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqmB,KAAK,CAACpmB,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AAAA,kBAA9BA,CAA8B;AAMtC;AACF;;;gCAEOsmB,I,EAAM;AAAA;;AAEZ,cAAMxD,OAAO,GAAG,IAAI,gEAAJ,CAAgB;AAC9B,6BAAiB,KAAK3oB;AADQ,WAAhB,CAAhB;AAGA,cAAIiO,WAAW,GAAG;AAChBmZ,wBAAY,EAAE,MADE;AAEhBuB,mBAAO,EAAEA;AAFO,WAAlB;AAKA,cAAI5pB,MAAM,GAAGotB,IAAI,CAACC,aAAlB,CAVY,CAUqB;;AACjC,cAAI9G,KAAK,GAAG6G,IAAI,CAACE,gBAAjB;AACAzvB,iBAAO,CAACC,GAAR,CAAYkC,MAAZ,EAAoBumB,KAApB;AAEA,cAAItmB,MAAM,GAAGD,MAAM,CAAC+D,SAAP,CAAiB,EAAjB,CAAb;AACA,cAAIZ,KAAK,GAAG,WAAW,KAAKqM,MAAhB,GAAyBvP,MAArC;;AACA,cAAIA,MAAM,CAAC1B,QAAP,CAAgB,KAAhB,CAAJ,EAA4B;AAC1B4E,iBAAK,GAAG,QAAR;AACD,WAlBW,CAoBZ;AACA;AACA;;;AAEA,cAAIgM,GAAG,GAAG,yDAAyDoX,KAAzD,GAAiE,mCAAjE,GAAuG,KAAKwG,SAA5G,GAAwH,MAAxH,GAAiI,KAAKC,OAAhJ;AAEA,eAAK9gB,IAAL,CAAUkD,GAAV,CAAcD,GAAd,EAAmBD,WAAnB,EAAgCvR,SAAhC,CAA0C,UAACK,GAAD,EAAc;AACtDH,mBAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BqF,KAA3B,EAAkCnF,GAAlC;;AACA,gBAAIA,GAAG,CAAC6kB,IAAJ,CAAS0K,OAAb,EAAsB;AACpB,kBAAI5Q,GAAG,GAAG3e,GAAG,CAAC6kB,IAAJ,CAAS0K,OAAnB;;AACA,kBAAI5Q,GAAG,CAAC5V,MAAJ,KAAe,CAAnB,EAAsB;AACpBlJ,uBAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCqF,KAAjC;AACD;;AACD,mBAAK,IAAIqqB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG7Q,GAAG,CAAC5V,MAAxB,EAAgCymB,CAAC,EAAjC,EAAqC;AACnC,oBAAIxmB,OAAO,GAAG2V,GAAG,CAAC6Q,CAAD,CAAjB;AAEA,oBAAItQ,GAAG,GAAG,OAAI,CAAC2F,IAAL,CAAU1f,KAAV,CAAV,CAHmC,CAGP;;AAC5B,oBAAI,CAAC+Z,GAAL,EAAU;AACRA,qBAAG,GAAG,EAAN;AACD;;AACD,oBAAIrE,CAAC,GAAG,OAAI,CAACnB,eAAL,CAAqB1Q,OAAO,CAAC,CAAD,CAA5B,CAAR;;AACAkW,mBAAG,CAACrE,CAAD,CAAH,GAAS,CAAE7R,OAAO,CAAC,CAAD,CAAT,EAAcA,OAAO,CAAC,CAAD,CAArB,EAA0BA,OAAO,CAAC,CAAD,CAAjC,EAAsCA,OAAO,CAAC,CAAD,CAA7C,EAAkDA,OAAO,CAAC,CAAD,CAAzD,EAA8DA,OAAO,CAAC,CAAD,CAArE,CAAT;AAEA,uBAAI,CAAC6b,IAAL,CAAU1f,KAAV,IAAmB+Z,GAAnB;AACD;AACF;;AAEDrf,mBAAO,CAACC,GAAR,CAAY,UAAZ,EAAwB5E,MAAM,CAACV,IAAP,CAAY,OAAI,CAACqqB,IAAjB,EAAuB9b,MAA/C,EAAuD,OAAI,CAAC8b,IAA5D;AACD,WAtBD;AAuBD;;;sCAEU;AACT,cAAI4K,aAAa,GAAG,SAApB;;AACA,cAAI,KAAKje,MAAL,KAAgB,IAApB,EAA0B;AACxBie,yBAAa,GAAG,QAAhB;AACD;;AACD,cAAIhW,gBAAgB,GAAG,KAAK/J,WAAL,GAAmB,GAAnB,GAAyB+f,aAAzB,GAAyC,MAAhE;AACA5vB,iBAAO,CAACC,GAAR,CAAY,aAAZ,EAA2B2Z,gBAA3B;;AACA,cAAI,KAAKoL,IAAT,EAAe;AAEb,gBAAIlL,GAAG,GAAG,EAAV;AACAA,eAAG,IAAI,+DAAP;;AAEA,iBAAK,IAAIlO,GAAT,IAAgB,KAAKoZ,IAArB,EAA2B;AAAE;AAC3B,mBAAK,IAAI6K,IAAT,IAAiB,KAAK7K,IAAL,CAAUpZ,GAAV,CAAjB,EAAiC;AAAE;AACjC,oBAAImO,GAAG,GAAG,EAAV;AACA,oBAAI+E,GAAG,GAAG,KAAKkG,IAAL,CAAUpZ,GAAV,EAAeikB,IAAf,CAAV;AACA9V,mBAAG,IAAInO,GAAG,GAAG,GAAN,GAAYikB,IAAZ,GAAmB,GAAnB,GAAyB/Q,GAAG,CAAC,CAAD,CAA5B,GAAkC,GAAlC,GAAwCA,GAAG,CAAC,CAAD,CAA3C,GAAiD,GAAjD,GAAuDA,GAAG,CAAC,CAAD,CAA1D,GAAgE,GAAhE,GAAsEA,GAAG,CAAC,CAAD,CAAzE,GAA+E,GAA/E,GAAqFA,GAAG,CAAC,CAAD,CAAxF,GAA8F,GAA9F,GAAoGA,GAAG,CAAC,CAAD,CAA9G;AACAhF,mBAAG,IAAIC,GAAG,GAAG,MAAb;AACD;AACF;;AAED,gBAAMC,YAAY,GAAG,IAAIC,IAAJ,CAAS,CAACH,GAAD,CAAT,EAAgB;AACnCzX,kBAAI,EAAE;AAD6B,aAAhB,CAArB;;AAIA,gBAAI9B,MAAM,CAAC2Z,SAAP,IAAoB3Z,MAAM,CAAC2Z,SAAP,CAAiBC,gBAAzC,EAA2D;AAAE;AAC3D5Z,oBAAM,CAAC2Z,SAAP,CAAiBC,gBAAjB,CAAkCH,YAAlC,EAAgDJ,gBAAhD;AACD,aAFD,MAEO;AACL,kBAAMQ,OAAO,GAAGC,GAAG,CAACC,eAAJ,CAAoBN,YAApB,CAAhB;AACA,kBAAMO,IAAI,GAAGlS,QAAQ,CAACmS,aAAT,CAAuB,GAAvB,CAAb;AACAD,kBAAI,CAAC9Z,IAAL,GAAY2Z,OAAZ;AACAG,kBAAI,CAACE,MAAL,GAAc,QAAd;AACApS,sBAAQ,CAACqS,IAAT,CAAcC,WAAd,CAA0BJ,IAA1B;AACAA,kBAAI,CAACK,QAAL,GAAgBhB,gBAAhB;AACAW,kBAAI,CAACM,KAAL;AACAN,kBAAI,CAACO,UAAL,CAAgBC,WAAhB,CAA4BR,IAA5B;AACD;AACF;AACF;;;0CAE2B;AAAA,cAAZT,GAAY,uEAAN,IAAM;;AAC1B,cAAI,CAACA,GAAL,EAAU;AACRA,eAAG,GAAG,IAAIrY,IAAJ,EAAN;AACD;;AACD,cAAIkF,IAAI,GAAG,IAAIlF,IAAJ,CAASqY,GAAT,CAAX;AACA,cAAIkB,CAAC,GAAGrU,IAAI,CAAC/E,OAAL,EAAR;AACA,cAAIqZ,CAAC,GAAGtU,IAAI,CAAChF,QAAL,KAAkB,CAA1B,CAN0B,CAMG;;AAC7B,cAAIuZ,CAAC,GAAGvU,IAAI,CAACjF,WAAL,EAAR;AACA,cAAIyZ,CAAC,GAAGxU,IAAI,CAACyU,QAAL,EAAR;AACA,cAAIC,IAAI,GAAG1U,IAAI,CAAC2U,UAAL,EAAX;AACA,cAAIC,CAAC,GAAG5U,IAAI,CAAC6U,UAAL,EAAR,CAV0B,CAW1B;;AACA,cAAIC,MAAM,GAAG,MAAMT,CAAC,IAAI,CAAL,GAAS,MAAMA,CAAf,GAAmBA,CAAzB,IAA8B,GAA9B,IAAqCC,CAAC,IAAI,CAAL,GAAS,MAAMA,CAAf,GAAmBA,CAAxD,IAA6D,GAA7D,GAAmEC,CAAnE,GAAuE,GAAvE,IAA8EC,CAAC,IAAI,CAAL,GAAS,MAAMA,CAAf,GAAmBA,CAAjG,IAAsG,GAAtG,IAA6GE,IAAI,IAAI,CAAR,GAAY,MAAMA,IAAlB,GAAyBA,IAAtI,IAA8I,GAA9I,IAAqJE,CAAC,IAAI,CAAL,GAAS,MAAMA,CAAf,GAAmBA,CAAxK,CAAb;AACA,iBAAOE,MAAP;AACD;;;uCAEc;AAEb,cAAIzc,gBAAgB,GAAG,CAAvB;AACA,cAAIC,QAAQ,GAAG,EAAf;AAEA,cAAI6wB,gBAAgB,GAAG,CAAvB;AACA,cAAIC,aAAa,GAAG,CAApB,CANa,CAQb;;AACA,eAAK,IAAInkB,GAAT,IAAgB,mEAAa3M,QAA7B,EAAuC;AACrC,gBAAI,mEAAaA,QAAb,CAAsB4M,cAAtB,CAAqCD,GAArC,CAAJ,EAA+C;AAE7C;AACA,kBAAIH,IAAI,GAAG,IAAX;AACA,kBAAIukB,QAAQ,GAAG,EAAf;AACA,kBAAIC,OAAO,GAAG,EAAd;;AAEA,kBAAI,mEAAahxB,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,CAAJ,EAAwC;AACtCH,oBAAI,GAAG,CAAC,mEAAaxM,QAAb,CAAsB2M,GAAtB,EAA2B,KAA3B,IAAoC,mEAAa3M,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,CAArC,IAA2E,GAA3E,GAAiF,mEAAa3M,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,CAAxF;AACAH,oBAAI,GAAGzJ,IAAI,CAACC,KAAL,CAAW,CAACwJ,IAAI,GAAG,OAAR,IAAmB,GAA9B,IAAqC,GAA5C;AAEA,oBAAIykB,QAAQ,GAAG,mEAAajxB,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,CAAf;AACA,oBAAIukB,OAAO,GAAG,mEAAalxB,QAAb,CAAsB2M,GAAtB,EAA2B,KAA3B,CAAd;;AACA,oBAAIA,GAAG,KAAK,UAAZ,EAAwB;AACtBskB,0BAAQ,GAAGA,QAAQ,GAAG,IAAtB;AACAC,yBAAO,GAAGA,OAAO,GAAG,IAApB;AACD;;AACD,oBAAIvkB,GAAG,KAAK,YAAZ,EAA0B;AACxBskB,0BAAQ,GAAGA,QAAQ,GAAG,GAAtB;AACAC,yBAAO,GAAGA,OAAO,GAAG,GAApB;AACD;;AAEDL,gCAAgB,IAAKI,QAAQ,GAAG,mEAAajxB,QAAb,CAAsB2M,GAAtB,EAA2B,KAA3B,CAAhC;AACAmkB,6BAAa,IAAKI,OAAO,GAAG,mEAAalxB,QAAb,CAAsB2M,GAAtB,EAA2B,KAA3B,CAA5B;AAEA,oBAAIwkB,SAAS,GAAG,CAAC,GAAjB;AACA,oBAAIC,IAAI,GAAG,IAAX;;AACA,qBAAK,IAAIpnB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,mEAAahK,QAAb,CAAsB2M,GAAtB,EAA2B,SAA3B,EAAsC1C,MAA1D,EAAkED,CAAC,EAAnE,EAAuE;AACrE,sBAAIE,OAAO,GAAG,mEAAalK,QAAb,CAAsB2M,GAAtB,EAA2B,SAA3B,EAAsC3C,CAAtC,CAAd;AAEA,sBAAIqnB,WAAW,GAAG,CAAC,mEAAarxB,QAAb,CAAsB2M,GAAtB,EAA2B,KAA3B,IAAoCzC,OAArC,IAAgD,GAAhD,GAAsDA,OAAxE;;AACA,sBAAImnB,WAAW,GAAG,CAAd,IAAmBA,WAAW,GAAGF,SAArC,EAAgD;AAC9CA,6BAAS,GAAGE,WAAZ;AACAD,wBAAI,GAAGlnB,OAAP;AACD;AACF;;AACD,oBAAIknB,IAAI,KAAK,IAAb,EAAmB;AACjBD,2BAAS,GAAGpuB,IAAI,CAACC,KAAL,CAAW,CAACmuB,SAAS,GAAG,OAAb,IAAwB,GAAnC,IAA0C,GAAtD;AACAJ,0BAAQ,GAAGI,SAAS,GAAG,IAAZ,GAAmBC,IAAnB,GAA0B,GAArC;AACD;;AAED,oBAAIE,QAAQ,GAAG,GAAf;AACA,oBAAIpwB,GAAG,GAAG,IAAV;;AACA,qBAAK,IAAI8I,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAG,mEAAahK,QAAb,CAAsB2M,GAAtB,EAA2B,YAA3B,EAAyC1C,MAA7D,EAAqED,GAAC,EAAtE,EAA0E;AACxE,sBAAIE,QAAO,GAAG,mEAAalK,QAAb,CAAsB2M,GAAtB,EAA2B,YAA3B,EAAyC3C,GAAzC,CAAd;AAEA,sBAAIunB,UAAU,GAAG,CAAC,mEAAavxB,QAAb,CAAsB2M,GAAtB,EAA2B,KAA3B,IAAoCzC,QAArC,IAAgD,GAAhD,GAAsDA,QAAvE;;AACA,sBAAIqnB,UAAU,GAAG,CAAb,IAAkBA,UAAU,GAAGD,QAAnC,EAA6C;AAC3CA,4BAAQ,GAAGC,UAAX;AACArwB,uBAAG,GAAGgJ,QAAN;AACD;AACF;;AACD,oBAAIhJ,GAAG,KAAK,IAAZ,EAAkB;AAChBowB,0BAAQ,GAAGvuB,IAAI,CAACC,KAAL,CAAW,CAACsuB,QAAQ,GAAG,OAAZ,IAAuB,GAAlC,IAAyC,GAApD;AACAN,yBAAO,GAAGM,QAAQ,GAAG,IAAX,GAAkBpwB,GAAlB,GAAwB,GAAlC;AACD;AACF;;AAEDlB,sBAAQ,CAAC4G,IAAT,CAAc;AAAEP,qBAAK,EAAEsG,GAAT;AAAcY,sBAAM,EAAE,mEAAavN,QAAb,CAAsB2M,GAAtB,EAA2B,QAA3B,CAAtB;AAA4D5I,mBAAG,EAAE,mEAAa/D,QAAb,CAAsB2M,GAAtB,EAA2B,KAA3B,CAAjE;AAAoG6kB,oBAAI,EAAE,mEAAaxxB,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,CAA1G;AACE8kB,oBAAI,EAAE,mEAAazxB,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,CADR;AAC4C+kB,oBAAI,EAAE,mEAAa1xB,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,CADlD;AACsFglB,sBAAM,EAAE,mEAAa3xB,QAAb,CAAsB2M,GAAtB,EAA2B,QAA3B,CAD9F;AAEEilB,yBAAS,EAAE,mEAAa5xB,QAAb,CAAsB2M,GAAtB,EAA2B,WAA3B,CAFb;AAEsDH,oBAAI,EAAEA,IAF5D;AAEkEqlB,uBAAO,EAAEd,QAF3E;AAEqFe,0BAAU,EAAEd;AAFjG,eAAd;AAGD;AACF;;AAEDjxB,0BAAgB,GAAG,CAAC+wB,aAAa,GAAGD,gBAAjB,IAAqC,GAArC,GAA2CA,gBAA9D;AACA9wB,0BAAgB,GAAGgD,IAAI,CAACC,KAAL,CAAW,CAACjD,gBAAgB,GAAG,OAApB,IAA+B,GAA1C,IAAiD,GAApE;AAEA8wB,0BAAgB,GAAG9tB,IAAI,CAACC,KAAL,CAAW6tB,gBAAX,CAAnB;AACAC,uBAAa,GAAG/tB,IAAI,CAACC,KAAL,CAAW8tB,aAAX,CAAhB,CA9Ea,CA+Eb;;AAEA,iBAAO;AAAE,gCAAoB/wB,gBAAtB;AAAwC,wBAAYC,QAApD;AAA8D,yBAAa6wB,gBAA3E;AAA6F,2BAAeC;AAA5G,WAAP;AACD;;;0CAEiB;AAAA;;AAChB,cAAI1e,WAAW,GAAG;AAChBmZ,wBAAY,EAAE;AADE,WAAlB;AAIA,cAAIwG,gBAAgB,GAAG,mEAAvB;AAEA;;;;AAIA,eAAK3iB,IAAL,CAAUkD,GAAV,CAAcyf,gBAAd,EAAgC3f,WAAhC,EAA6CvR,SAA7C,CAAuD,UAACK,GAAD,EAAc;AACnEH,mBAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCE,GAAjC;AACA,gBAAI8wB,MAAM,GAAG9wB,GAAG,CAAC6kB,IAAjB;AACAiM,kBAAM,CAACjsB,OAAP,CAAe,UAAAmE,OAAO,EAAI;AACxB,kBAAI,mEAAalK,QAAb,CAAsB4M,cAAtB,CAAqC1C,OAAO,CAAChH,MAA7C,CAAJ,EAA0D;AACxD,mFAAalD,QAAb,CAAsBkK,OAAO,CAAChH,MAA9B,EAAsC,KAAtC,IAA+CH,IAAI,CAACC,KAAL,CAAW,CAACkH,OAAO,CAAC+nB,SAAR,GAAoB,OAArB,IAAgC,GAA3C,IAAkD,GAAjG;AACA,mFAAajyB,QAAb,CAAsBkK,OAAO,CAAChH,MAA9B,EAAsC,QAAtC,IAAkDH,IAAI,CAACC,KAAL,CAAW,CAACkH,OAAO,CAACgoB,iBAAR,GAA4B,OAA7B,IAAwC,GAAnD,IAA0D,GAA5G;AACA,mFAAalyB,QAAb,CAAsBkK,OAAO,CAAChH,MAA9B,EAAsC,MAAtC,IAAgDH,IAAI,CAACC,KAAL,CAAW,CAACkH,OAAO,CAACioB,OAAR,GAAkB,OAAnB,IAA8B,GAAzC,IAAgD,GAAhG,CAHwD,CAIxD;;AACA,mFAAanyB,QAAb,CAAsBkK,OAAO,CAAChH,MAA9B,EAAsC,MAAtC,IAAgDH,IAAI,CAACC,KAAL,CAAW,CAACkH,OAAO,CAACkoB,YAAR,GAAuB,OAAxB,IAAmC,GAA9C,IAAqD,GAArG;AACA,oBAAIR,SAAS,GAAG,CAAC1nB,OAAO,CAAC+nB,SAAR,GAAoB/nB,OAAO,CAACmoB,QAA7B,IAAyC,GAAzC,GAA+CnoB,OAAO,CAACmoB,QAAvE;AACA,mFAAaryB,QAAb,CAAsBkK,OAAO,CAAChH,MAA9B,EAAsC,WAAtC,IAAqDH,IAAI,CAACC,KAAL,CAAW,CAAC4uB,SAAS,GAAG,OAAb,IAAwB,GAAnC,IAA0C,GAA/F;AACD;AACF,aAVD;AAWD,WAdD;AAgBAxvB,oBAAU,CAAC,YAAM;AAAE,mBAAI,CAACkwB,gBAAL;AAA0B,WAAnC,EAAqC,IAArC,CAAV;AAEAlwB,oBAAU,CAAC,YAAM;AAAE,mBAAI,CAACmwB,mBAAL;AAA6B,WAAtC,EAAwC,IAAxC,CAAV,CA7BgB,CA+BhB;AACD;;;2CAEkB;AACjB,cAAIngB,WAAW,GAAG;AAChBmZ,wBAAY,EAAE;AADE,WAAlB;AAIA,cAAIiH,UAAU,GAAG,yCAAjB;AAEA,eAAKpjB,IAAL,CAAUkD,GAAV,CAAckgB,UAAd,EAA0BpgB,WAA1B,EAAuCvR,SAAvC,CAAiD,UAACK,GAAD,EAAc;AAC7DH,mBAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BE,GAA9B;AACA,gBAAI8wB,MAAM,GAAG9wB,GAAG,CAAC6kB,IAAjB;AACAiM,kBAAM,CAACjsB,OAAP,CAAe,UAAAmE,OAAO,EAAI;AACxB,kBAAI,mEAAalK,QAAb,CAAsB4M,cAAtB,CAAqC1C,OAAO,CAACS,KAA7C,CAAJ,EAAyD;AACvD,mFAAa3K,QAAb,CAAsBkK,OAAO,CAACS,KAA9B,EAAqC,KAArC,IAA8C5H,IAAI,CAACC,KAAL,CAAW,CAACkH,OAAO,CAACuoB,IAAR,GAAe,OAAhB,IAA2B,GAAtC,IAA6C,GAA3F;AACA,mFAAazyB,QAAb,CAAsBkK,OAAO,CAACS,KAA9B,EAAqC,MAArC,IAA+C5H,IAAI,CAACC,KAAL,CAAW,CAACkH,OAAO,CAACwoB,aAAR,GAAwB,OAAzB,IAAoC,GAA/C,IAAsD,GAArG,CAFuD,CAGvD;;AACA,mFAAa1yB,QAAb,CAAsBkK,OAAO,CAACS,KAA9B,EAAqC,MAArC,IAA+C5H,IAAI,CAACC,KAAL,CAAW,CAACkH,OAAO,CAACkoB,YAAR,GAAuB,OAAxB,IAAmC,GAA9C,IAAqD,GAApG;AACA,oBAAIR,SAAS,GAAG,CAAC1nB,OAAO,CAACuoB,IAAR,GAAevoB,OAAO,CAACmoB,QAAxB,IAAoC,GAApC,GAA0CnoB,OAAO,CAACmoB,QAAlE;AACA,mFAAaryB,QAAb,CAAsBkK,OAAO,CAACS,KAA9B,EAAqC,WAArC,IAAoD5H,IAAI,CAACC,KAAL,CAAW,CAAC4uB,SAAS,GAAG,OAAb,IAAwB,GAAnC,IAA0C,GAA9F;AACD;AACF,aATD;AAUD,WAbD;AAcD;;;8CAEqB;AAAA;;AACpB,cAAIxf,WAAW,GAAG;AAChBmZ,wBAAY,EAAE;AADE,WAAlB;AAIA,cAAI9b,QAAQ,GAAG,IAAIjN,IAAJ,EAAf;AACA,cAAImwB,SAAS,GAAG,IAAInwB,IAAJ,EAAhB;AACAmwB,mBAAS,CAAChiB,OAAV,CAAkBgiB,SAAS,CAAChwB,OAAV,KAAsB,GAAxC,EAPoB,CASpB;;AACA,cAAIiwB,kBAAkB,GAAG,oDAAzB;;AAVoB,uCAYXjmB,GAZW;AAalB,gBAAI,mEAAa3M,QAAb,CAAsB4M,cAAtB,CAAqCD,GAArC,CAAJ,EAA+C;AAC7C;AAGA;AAEA;AAEA,kBAAI8Y,CAAC,GAAG9Y,GAAG,GAAG,KAAd;;AACA,kBAAI8Y,CAAC,KAAK,aAAV,EAAyB;AACvBA,iBAAC,GAAG,SAAJ;AACD;;AACD,kBAAIA,CAAC,KAAK,eAAV,EAA2B;AACzBA,iBAAC,GAAG,YAAJ;AACD,eAd4C,CAe7C;AACA;;;AAEA,kBAAIoN,QAAQ,GAAGD,kBAAkB,GAAGnN,CAArB,GAAyB,qFAAxC;;AAEA,qBAAI,CAACrW,IAAL,CAAUkD,GAAV,CAAcugB,QAAd,EAAwBzgB,WAAxB,EAAqCvR,SAArC,CAA+C,UAACK,GAAD,EAAc;AAC3D,oBAAIA,GAAJ,EAAS;AACP;AACA;AACA,sBAAI4xB,QAAQ,GAAG5xB,GAAG,CAACqgB,KAAJ,CAAUrE,MAAV,CAAiB,CAAjB,EAAoB6V,UAApB,CAA+BC,QAA/B,CAAwC,CAAxC,EAA2CA,QAA1D;;AACA,sBAAIF,QAAQ,YAAY3sB,KAAxB,EAA+B;AAE7B,wBAAIpC,GAAG,GAAG,mEAAa/D,QAAb,CAAsB2M,GAAtB,EAA2B,KAA3B,CAAV;;AACA,wBAAI,CAAC5I,GAAL,EAAU;AACRA,yBAAG,GAAG7C,GAAG,CAACqgB,KAAJ,CAAUrE,MAAV,CAAiB,CAAjB,EAAoB+V,IAApB,CAAyBC,kBAA/B;AACA,yFAAalzB,QAAb,CAAsB2M,GAAtB,EAA2B,KAA3B,IAAoC5I,GAApC;AAEA,0BAAIovB,QAAQ,GAAGjyB,GAAG,CAACqgB,KAAJ,CAAUrE,MAAV,CAAiB,CAAjB,EAAoB+V,IAApB,CAAyBG,iBAAxC;AACA,0BAAIC,UAAU,GAAG,CAAjB;AACA,0BAAIC,UAAU,GAAGpyB,GAAG,CAACqgB,KAAJ,CAAUrE,MAAV,CAAiB,CAAjB,EAAoBqW,SAArC;;AACA,0BAAI,IAAI/wB,IAAJ,CAAS2wB,QAAQ,GAAG,IAApB,EAA0BxwB,OAA1B,OAAwC,IAAIH,IAAJ,CAAS8wB,UAAU,CAACA,UAAU,CAACrpB,MAAX,GAAoB,CAArB,CAAV,GAAoC,IAA7C,EAAmDtH,OAAnD,EAA5C,EAA0G;AACxG0wB,kCAAU,GAAG,CAAb;AACD;;AAED,0BAAIG,GAAG,GAAGV,QAAQ,CAACA,QAAQ,CAAC7oB,MAAT,GAAkBopB,UAAnB,CAAlB;AACAG,yBAAG,GAAG,CAACzvB,GAAG,GAAGyvB,GAAP,IAAc,GAAd,GAAoBA,GAA1B;AACAA,yBAAG,GAAGzwB,IAAI,CAACC,KAAL,CAAW,CAACwwB,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA1C;AACA,yFAAaxzB,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,IAAqC6mB,GAArC;AAEA,0BAAIC,MAAM,GAAGX,QAAQ,CAACA,QAAQ,CAAC7oB,MAAT,GAAkB,EAAnB,CAArB;AACAwpB,4BAAM,GAAG,CAAC1vB,GAAG,GAAG0vB,MAAP,IAAiB,GAAjB,GAAuBA,MAAhC;AACAA,4BAAM,GAAG1wB,IAAI,CAACC,KAAL,CAAW,CAACywB,MAAM,GAAG,OAAV,IAAqB,GAAhC,IAAuC,GAAhD;AACA,yFAAazzB,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,IAAqC8mB,MAArC;AAEA,0BAAIC,OAAO,GAAGxyB,GAAG,CAACqgB,KAAJ,CAAUrE,MAAV,CAAiB,CAAjB,EAAoB6V,UAApB,CAA+BY,KAA/B,CAAqC,CAArC,EAAwC9iB,IAAtD;AACA,0BAAI+iB,QAAQ,GAAG7wB,IAAI,CAAC8wB,GAAL,CAASlJ,KAAT,CAAe,IAAf,EAAqB+I,OAArB,CAAf;AAEA,0BAAI9B,SAAS,GAAG,CAAC7tB,GAAG,GAAG6vB,QAAP,IAAmB,GAAnB,GAAyBA,QAAzC;AACA,yFAAa5zB,QAAb,CAAsB2M,GAAtB,EAA2B,WAA3B,IAA0C5J,IAAI,CAACC,KAAL,CAAW,CAAC4uB,SAAS,GAAG,OAAb,IAAwB,GAAnC,IAA0C,GAApF,CAzBQ,CA2BR;AACD;;AAED,wBAAIkC,KAAK,GAAGhB,QAAQ,CAACA,QAAQ,CAAC7oB,MAAT,GAAkB,CAAnB,CAApB;AACA6pB,yBAAK,GAAG,CAAC/vB,GAAG,GAAG+vB,KAAP,IAAgB,GAAhB,GAAsBA,KAA9B;AACAA,yBAAK,GAAG/wB,IAAI,CAACC,KAAL,CAAW,CAAC8wB,KAAK,GAAG,OAAT,IAAoB,GAA/B,IAAsC,GAA9C;AACA,wBAAIC,MAAM,GAAGjB,QAAQ,CAACA,QAAQ,CAAC7oB,MAAT,GAAkB,EAAnB,CAArB;AACA8pB,0BAAM,GAAG,CAAChwB,GAAG,GAAGgwB,MAAP,IAAiB,GAAjB,GAAuBA,MAAhC;AACAA,0BAAM,GAAGhxB,IAAI,CAACC,KAAL,CAAW,CAAC+wB,MAAM,GAAG,OAAV,IAAqB,GAAhC,IAAuC,GAAhD;AACAhzB,2BAAO,CAACC,GAAR,CAAY2L,GAAZ,EAAiBmnB,KAAjB,EAAwBC,MAAxB;AACA,uFAAa/zB,QAAb,CAAsB2M,GAAtB,EAA2B,MAA3B,IAAqCmnB,KAArC;AACA,uFAAa9zB,QAAb,CAAsB2M,GAAtB,EAA2B,QAA3B,IAAuConB,MAAvC;AACD;AACF;AACF,eAjDD;AAkDD;AAnFiB;;AAYpB,eAAK,IAAIpnB,GAAT,IAAgB,mEAAa3M,QAA7B,EAAuC;AAAA,mBAA9B2M,GAA8B;AAwEtC;AACF;;;yCAEgB;AACf5L,iBAAO,CAACC,GAAR,CAAY,KAAK8uB,WAAjB;AAEA,cAAInV,gBAAgB,GAAG,cAAc,KAAKC,eAAL,EAAd,GAAuC,MAA9D;AACA7Z,iBAAO,CAACC,GAAR,CAAY,aAAZ,EAA2B2Z,gBAA3B;;AAEA,cAAI,KAAKmV,WAAT,EAAsB;AAEpB,gBAAIjV,GAAG,GAAG,EAAV;AACAA,eAAG,IAAI,6DAAP;;AAEA,iBAAK,IAAIlO,GAAT,IAAgB,KAAKmjB,WAArB,EAAkC;AAEhC,mBAAKC,iBAAL,GAAyB,EAAzB;;AAEA,mBAAK,IAAItK,CAAT,IAAc,KAAKqK,WAAL,CAAiBnjB,GAAjB,CAAd,EAAqC;AAEnC,oBAAI,KAAKmjB,WAAL,CAAiBnjB,GAAjB,EAAsB8Y,CAAtB,EAAyB,WAAzB,IAAwC,CAAC,EAA7C,EAAiD;AAC/C;AACA,sBAAIjF,IAAI,GAAGpkB,MAAM,CAACqkB,MAAP,CAAc,EAAd,EAAkB,KAAKqP,WAAL,CAAiBnjB,GAAjB,EAAsB8Y,CAAtB,CAAlB,CAAX;AACAjF,sBAAI,CAAC,OAAD,CAAJ,GAAgBiF,CAAhB;AACA,uBAAKsK,iBAAL,CAAuBnpB,IAAvB,CAA4B4Z,IAA5B;AACD;AACF;;AAED,mBAAKuP,iBAAL,CAAuB/jB,IAAvB,CAA4B,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAEpC;AACA;AAEA,oBAAID,CAAC,CAAC,MAAD,CAAD,GAAYC,CAAC,CAAC,MAAD,CAAjB,EAA2B;AACzB,yBAAO,CAAC,CAAR;AACD,iBAFD,MAEO;AACL,yBAAO,CAAP;AACD;AACF,eAVD;AAYAnL,qBAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkC,KAAK+uB,iBAAvC;AAEA,kBAAIiE,WAAW,GAAG,KAAKjE,iBAAL,CAAuB/oB,KAAvB,CAA6B,CAA7B,EAAgC,EAAhC,CAAlB;AACAjG,qBAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BgzB,WAA5B;AAEA,kBAAIC,WAAW,GAAG,CAAlB;AAEA,kBAAIC,YAAY,GAAG,EAAnB;;AACA,mBAAK,IAAIlqB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgqB,WAAW,CAAC/pB,MAAhC,EAAwCD,CAAC,EAAzC,EAA6C;AAC3C,oBAAImqB,GAAG,GAAG,CAACH,WAAW,CAAChqB,CAAD,CAAX,CAAe,MAAf,IAAyBgqB,WAAW,CAAChqB,CAAD,CAAX,CAAe,OAAf,CAA1B,IAAqD,GAArD,GAA2DgqB,WAAW,CAAChqB,CAAD,CAAX,CAAe,OAAf,CAArE;AACAmqB,mBAAG,GAAGpxB,IAAI,CAACC,KAAL,CAAW,CAACmxB,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA1C;AACAF,2BAAW,IAAIE,GAAf;AACAD,4BAAY,IAAI,MAAMC,GAAtB;AACD;;AAED,kBAAIC,WAAW,GAAGH,WAAW,GAAGD,WAAW,CAAC/pB,MAA5C;AACAmqB,yBAAW,GAAGrxB,IAAI,CAACC,KAAL,CAAW,CAACoxB,WAAW,GAAG,OAAf,IAA0B,GAArC,IAA4C,GAA1D;AACArzB,qBAAO,CAACC,GAAR,CAAYozB,WAAZ,EAAyB,KAAKhE,WAAL,CAAiBzjB,GAAjB,CAAzB;AAEA,kBAAI0nB,UAAU,GAAG,KAAK1nB,GAAL,GAAW,GAAX,GAAiBynB,WAAjB,GAA+B,GAA/B,GAAqC,KAAKhE,WAAL,CAAiBzjB,GAAjB,CAArC,GAA6DunB,YAA7D,GAA4E,MAA7F;AACAnzB,qBAAO,CAACC,GAAR,CAAYqzB,UAAZ;AAEAxZ,iBAAG,IAAIwZ,UAAP;AACD;;AAED,gBAAMtZ,YAAY,GAAG,IAAIC,IAAJ,CAAS,CAACH,GAAD,CAAT,EAAgB;AACnCzX,kBAAI,EAAE;AAD6B,aAAhB,CAArB;;AAIA,gBAAI9B,MAAM,CAAC2Z,SAAP,IAAoB3Z,MAAM,CAAC2Z,SAAP,CAAiBC,gBAAzC,EAA2D;AAAE;AAC3D5Z,oBAAM,CAAC2Z,SAAP,CAAiBC,gBAAjB,CAAkCH,YAAlC,EAAgDJ,gBAAhD;AACD,aAFD,MAEO;AACL,kBAAMQ,OAAO,GAAGC,GAAG,CAACC,eAAJ,CAAoBN,YAApB,CAAhB;AACA,kBAAMO,IAAI,GAAGlS,QAAQ,CAACmS,aAAT,CAAuB,GAAvB,CAAb;AACAD,kBAAI,CAAC9Z,IAAL,GAAY2Z,OAAZ;AACAG,kBAAI,CAACE,MAAL,GAAc,QAAd;AACApS,sBAAQ,CAACqS,IAAT,CAAcC,WAAd,CAA0BJ,IAA1B;AACAA,kBAAI,CAACK,QAAL,GAAgBhB,gBAAhB;AACAW,kBAAI,CAACM,KAAL;AACAN,kBAAI,CAACO,UAAL,CAAgBC,WAAhB,CAA4BR,IAA5B;AACD;AACF;AACF;;;yCAEgB;AACf,eAAKgZ,aAAL;AACD;;;wCAEe;AAAA;;AACd;AACA;AAEA,cAAIliB,WAAW,GAAG;AAChBmZ,wBAAY,EAAE;AADE,WAAlB;AAIA,cAAIqH,kBAAkB,GAAG,oDAAzB;AAEA,cAAI2B,YAAY,GAAG,EAAnB;AACA,cAAI/O,SAAS,GAAG,IAAIhjB,IAAJ,EAAhB;;AAXc,uCAYLwH,CAZK;AAaZ,gBAAIwqB,aAAa,GAAG,IAAIhyB,IAAJ,EAApB;AACAgyB,yBAAa,CAAC7jB,OAAd,CAAsB6U,SAAS,CAAC7iB,OAAV,KAAuB,KAAKqH,CAAlD;AAEA,gBAAIyqB,eAAe,GAAG,IAAIjyB,IAAJ,EAAtB;AACAiyB,2BAAe,CAAC9jB,OAAhB,CAAwB6U,SAAS,CAAC7iB,OAAV,KAAuB,KAAKqH,CAA5B,GAAiC,GAAzD;;AAjBY,yCAmBH2C,GAnBG;AAoBV,kBAAI,mEAAa3M,QAAb,CAAsB4M,cAAtB,CAAqCD,GAArC,CAAJ,EAA+C;AAE7C,oBAAI8Y,CAAC,GAAG9Y,GAAG,GAAG,KAAd;;AACA,oBAAI8Y,CAAC,KAAK,aAAV,EAAyB;AACvBA,mBAAC,GAAG,SAAJ;AACD;;AACD,oBAAIA,CAAC,KAAK,eAAV,EAA2B;AACzBA,mBAAC,GAAG,YAAJ;AACD;;AAED,oBAAIoN,QAAQ,GAAGD,kBAAkB,GAAGnN,CAArB,GAAyB,qFAAxC;AACAoN,wBAAQ,IAAI9vB,IAAI,CAAC4M,KAAL,CAAW8kB,eAAe,CAAC5nB,OAAhB,KAA4B,IAAvC,IAA+C,WAA/C,GAA6D9J,IAAI,CAAC4M,KAAL,CAAW6kB,aAAa,CAAC3nB,OAAd,KAA0B,IAArC,CAAzE;;AAEA,uBAAI,CAACuC,IAAL,CAAUkD,GAAV,CAAcugB,QAAd,EAAwBzgB,WAAxB,EAAqCvR,SAArC,CAA+C,UAACK,GAAD,EAAc;AAC3D,sBAAIA,GAAJ,EAAS;AACP;AACA;AACA,wBAAI4xB,QAAQ,GAAG5xB,GAAG,CAACqgB,KAAJ,CAAUrE,MAAV,CAAiB,CAAjB,EAAoB6V,UAApB,CAA+BC,QAA/B,CAAwC,CAAxC,EAA2CA,QAA1D;;AACA,wBAAIF,QAAQ,YAAY3sB,KAAxB,EAA+B;AAE7B,0BAAIia,GAAG,GAAG,EAAV;AACAA,yBAAG,CAAC,MAAD,CAAH,GAAc0S,QAAQ,CAACA,QAAQ,CAAC7oB,MAAT,GAAkB,CAAnB,CAAtB;AACAmW,yBAAG,CAAC,OAAD,CAAH,GAAe0S,QAAQ,CAACA,QAAQ,CAAC7oB,MAAT,GAAkB,EAAnB,CAAvB,CAJ6B,CAIkB;;AAE/C,0BAAI0C,GAAG,KAAK,UAAZ,EAAwB;AACtB,4BAAIwnB,GAAG,GAAG,CAAC/T,GAAG,CAAC,MAAD,CAAH,GAAcA,GAAG,CAAC,OAAD,CAAlB,IAA+B,GAA/B,GAAqCA,GAAG,CAAC,OAAD,CAAlD;AACA+T,2BAAG,GAAGpxB,IAAI,CAACC,KAAL,CAAW,CAACmxB,GAAG,GAAG,OAAP,IAAkB,GAA7B,IAAoC,GAA1C;AACA,+BAAI,CAAC/D,WAAL,CAAiBoE,aAAa,CAACE,kBAAd,EAAjB,IAAuDP,GAAvD;AACD;;AAED,0BAAIV,MAAM,GAAGX,QAAQ,CAACA,QAAQ,CAAC7oB,MAAT,GAAkB,EAAnB,CAArB,CAZ6B,CAYgB;;AAC7CwpB,4BAAM,GAAG,CAACrT,GAAG,CAAC,OAAD,CAAH,GAAeqT,MAAhB,IAA0B,GAA1B,GAAgCA,MAAzC;AACAA,4BAAM,GAAG1wB,IAAI,CAACC,KAAL,CAAW,CAACywB,MAAM,GAAG,OAAV,IAAqB,GAAhC,IAAuC,GAAhD;AACArT,yBAAG,CAAC,MAAD,CAAH,GAAcqT,MAAd;AAEA,0BAAIC,OAAO,GAAGxyB,GAAG,CAACqgB,KAAJ,CAAUrE,MAAV,CAAiB,CAAjB,EAAoB6V,UAApB,CAA+BY,KAA/B,CAAqC,CAArC,EAAwC9iB,IAAtD;AACA6iB,6BAAO,GAAGA,OAAO,CAAC1sB,KAAR,CAAc,CAAd,EAAiB,CAAC,EAAlB,CAAV;AACA,0BAAI4sB,QAAQ,GAAG7wB,IAAI,CAAC8wB,GAAL,CAASlJ,KAAT,CAAe,IAAf,EAAqB+I,OAArB,CAAf;AAEA,0BAAI9B,SAAS,GAAG,CAACxR,GAAG,CAAC,OAAD,CAAH,GAAewT,QAAhB,IAA4B,GAA5B,GAAkCA,QAAlD;AACAxT,yBAAG,CAAC,WAAD,CAAH,GAAmBrd,IAAI,CAACC,KAAL,CAAW,CAAC4uB,SAAS,GAAG,OAAb,IAAwB,GAAnC,IAA0C,GAA7D,CAtB6B,CAwB7B;;AAEA,0BAAI,CAAC,OAAI,CAAC9B,WAAL,CAAiB0E,aAAa,CAACE,kBAAd,EAAjB,CAAL,EAA2D;AACzD,+BAAI,CAAC5E,WAAL,CAAiB0E,aAAa,CAACE,kBAAd,EAAjB,IAAuD,EAAvD;AACD;;AACD,6BAAI,CAAC5E,WAAL,CAAiB0E,aAAa,CAACE,kBAAd,EAAjB,EAAqD/nB,GAArD,IAA4DyT,GAA5D;AAED;AACF;AACF,iBAtCD;AAwCD;AAzES;;AAmBZ,iBAAK,IAAIzT,GAAT,IAAgB,mEAAa3M,QAA7B,EAAuC;AAAA,qBAA9B2M,GAA8B;AAuDtC;AA1EW;;AAYd,eAAK,IAAI3C,CAAC,GAAG,EAAb,EAAiBA,CAAC,IAAI,EAAtB,EAA0BA,CAAC,EAA3B,EAA+B;AAAA,mBAAtBA,CAAsB;AA+D9B;AAEF;;;;;;;uBA5kBU4lB,e,EAAe,uH;AAAA,K;;;aAAfA,e;AAAe,eAAfA,eAAe,K;AAAA,kBAFd;;;;;sEAEDA,e,EAAe;cAH3B,wDAG2B;eAHhB;AACVxc,oBAAU,EAAE;AADF,S;AAGgB,Q;;;;;;;;;;;;;;;;;;;;;;ACV5B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAMauhB,U;AAYX;AAAA;;AAVA,aAAAjW,MAAA,GAAS,IAAIqJ,GAAJ,EAAT;AACA,aAAA6M,MAAA,GAAS,IAAI7M,GAAJ,EAAT;AACA,aAAA8M,SAAA,GAAY,IAAI9M,GAAJ,EAAZ;AACA,aAAA+M,KAAA,GAAQ,IAAI/M,GAAJ,EAAR;AACA,aAAAgN,QAAA,GAAW,IAAIhN,GAAJ,EAAX;AAEA,aAAAD,YAAA,GAA+B,IAAI3hB,KAAJ,EAA/B;AAKK;;;;+BAEEhD,M,EAAgB;AACrB,cAAIA,MAAM,KAAK,WAAf,EAA4B,CAC1B;AACD;;AACD,iBAAO,KAAKub,MAAL,CAAYpM,GAAZ,CAAgBnP,MAAhB,CAAP;AACD;;;+BAEMA,M,EAAgBolB,G,EAAa;AAClC,eAAK7J,MAAL,CAAYsJ,GAAZ,CAAgB7kB,MAAhB,EAAwBolB,GAAxB;AACD;;;+BAEMplB,M,EAAgB;AACrB,iBAAO,KAAKyxB,MAAL,CAAYtiB,GAAZ,CAAgBnP,MAAhB,CAAP;AACD;;;+BAEMA,M,EAAgBolB,G,EAAa;AAClC,eAAKqM,MAAL,CAAY5M,GAAZ,CAAgB7kB,MAAhB,EAAwBolB,GAAxB;AACD;;;kCAESplB,M,EAAgB;AACxB,iBAAO,KAAK0xB,SAAL,CAAeviB,GAAf,CAAmBnP,MAAnB,CAAP;AACD;;;kCAESA,M,EAAgBolB,G,EAAa;AACrC,eAAKsM,SAAL,CAAe7M,GAAf,CAAmB7kB,MAAnB,EAA2BolB,GAA3B;AACD;;;8BAEKplB,M,EAAgB;AACpB,iBAAO,KAAK2xB,KAAL,CAAWxiB,GAAX,CAAenP,MAAf,CAAP;AACD;;;8BAEKA,M,EAAgBolB,G,EAAa;AACjC,eAAKuM,KAAL,CAAW9M,GAAX,CAAe7kB,MAAf,EAAuBolB,GAAvB;AACD;;;iCAEQplB,M,EAAgB;AACvB,iBAAO,KAAK4xB,QAAL,CAAcziB,GAAd,CAAkBnP,MAAlB,CAAP;AACD;;;iCAEQA,M,EAAgBolB,G,EAAa;AACpC,eAAKwM,QAAL,CAAc/M,GAAd,CAAkB7kB,MAAlB,EAA0BolB,GAA1B;AACD;;;wCAEeyM,M,EAAgB;AAC9B,iBAAO,KAAKlN,YAAL,CAAkB9gB,KAAlB,CAAwBjE,IAAI,CAAC8wB,GAAL,CAAS,KAAK/L,YAAL,CAAkB7d,MAAlB,GAA2B+qB,MAApC,EAA4C,CAA5C,CAAxB,CAAP;AACD;;;0CAEiB,CAEjB;;;;;;AAtDM,eAAAvX,YAAA,GAAe,EAAf;;;uBAVIkX,U;AAAU,K;;;aAAVA,U;AAAU,eAAVA,UAAU,K;AAAA,kBAFT;;;;;sEAEDA,U,EAAU;cAHtB,wDAGsB;eAHX;AACVvhB,oBAAU,EAAE;AADF,S;AAGW,Q;;;;;;;;;;;;;;;;;;;;ACLvB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAAa6hB,Y;;;;QAQAC,Q,GAAb;AAAA;;AAUE,WAAAzvB,aAAA,GAAyB,KAAzB;AACA,WAAAC,aAAA,GAAyB,KAAzB;AACA,WAAAC,aAAA,GAAyB,KAAzB;AACA,WAAAC,aAAA,GAAyB,KAAzB;AACD,K;;QAEYuvB,W;;;;QAUAC,K;;;;QAcAC,U;;;;QAeAC,mB;;;;QAeAC,U;;;;QAOAC,e;;;;AAuBb,QAAYC,qBAAZ;;AAAA,eAAYA,qBAAZ,EAAiC;AAC/B;AACA;AACA;AACA;AACD,KALD,EAAYA,qBAAqB,KAArBA,qBAAqB,MAAjC;;AAOA,QAAYC,oBAAZ;;AAAA,eAAYA,oBAAZ,EAAgC;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,KAXD,EAAYA,oBAAoB,KAApBA,oBAAoB,MAAhC;;AAaA,QAAYC,qBAAZ;;AAAA,eAAYA,qBAAZ,EAAiC;AAC/B;AACA;AACA;AACA;AACA;AACA;AACD,KAPD,EAAYA,qBAAqB,KAArBA,qBAAqB,MAAjC;;;;;;;;;;;;;;;;;ACjIA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,oD,CAKA;;;QAMaC,gB;AASX,gCACUzI,sBADV,EACwD;AAAA;;AAA9C,aAAAA,sBAAA,GAAAA,sBAAA;AARH,aAAAhsB,eAAA,GAAgC,IAAI,4CAAJ,EAAhC;AAIP,aAAAmqB,OAAA,GAAU,iCAAV;AACA,aAAA8B,eAAA,GAAkB,sEAAlB;AAIK;;;;4CAEe;AAClB,cAAI,KAAKE,SAAL,IAAkB,KAAKA,SAAL,CAAeC,IAAf,KAAwB,CAA9C,EAAiD;AAC/C,mBAAO,IAAP;AACD;;AACD,iBAAO,KAAP;AACD;;;gCAEOpwB,Y,EAAoB;AAAA;;AAE1B,eAAKA,YAAL,GAAoBA,YAApB;AACA,eAAKmwB,SAAL,GAAiB,IAAIE,SAAJ,CACf,KAAKJ,eAAL,GAAuBjwB,YADR,CAAjB;AAGA,eAAKmwB,SAAL,CAAeG,UAAf,GAA4B,aAA5B;;AACA,eAAKH,SAAL,CAAeI,MAAf,GAAwB,YAAM;AAC5B,mBAAI,CAACC,YAAL,CAAkBvT,KAAlB;AACD,WAFD;;AAGA,eAAKkT,SAAL,CAAeM,SAAf,GAA2B,UAAAC,YAAY,EAAI;AACzC,mBAAI,CAACC,eAAL,CAAqBD,YAArB;AACD,WAFD;;AAGA,eAAKP,SAAL,CAAeS,OAAf,GAAyB,UAAA3T,KAAK,EAAI;AAChC,mBAAI,CAAC4T,aAAL,CAAmB5T,KAAnB;AACD,WAFD;;AAGA,eAAKkT,SAAL,CAAeW,OAAf,GAAyB,UAAA7T,KAAK,EAAI;AAChC,mBAAI,CAAC8T,aAAL,CAAmB9T,KAAnB;AACD,WAFD;AAGD;;;qCAEYA,K,EAAY;AACvBrZ,iBAAO,CAACC,GAAR,CAAY,8BAAZ;;AACA,cAAI,mEAAa+G,UAAb,KAA4B,WAAhC,EAA6C;AAC3C,iBAAKqmB,aAAL;AACA,iBAAKyH,uBAAL;AACA,iBAAK10B,eAAL,CAAqBiD,IAArB,CAA0B,WAA1B;AACD;AACF;;;wCAEe;AAAA;;AACd,eAAKiqB,iBAAL,GAAyBzsB,WAAW,CAAC,YAAM;AACzC;AACA,gBAAI4C,OAAO,GAAGuV,IAAI,CAAC2G,SAAL,CAAe;AAAC,mBAAK,GAAN;AAAW,mBAAK,EAAhB;AAAoB,mBAAK;AAAzB,aAAf,CAAd;;AACA,mBAAI,CAACsL,WAAL,CAAiBxnB,OAAjB;AACD,WAJmC,EAIjC,IAJiC,CAApC;AAKD;;;kDAEyB;AACxBzD,iBAAO,CAACC,GAAR,CAAY,8BAAZ;AACA,cAAIstB,eAAe,GAAG,mEAAaC,cAAb,CAA4B,mEAAarqB,gBAAzC,CAAtB;AACA,cAAIM,OAAO,GAAGuV,IAAI,CAAC2G,SAAL,CAAe;AAC3B,iBAAM,WADqB;AAE3B,iBAAM,CAAC,CAAC,CAAD,EAAI,KAAJ,CAAD,EAAa,CAAC,CAAD,EAAI,KAAJ,CAAb,EAAyB,CAAC,CAAD,EAAI,CAAJ,CAAzB,EAAiC,CAAC,CAAD,EAAI4N,eAAJ;AAAoB;AAArD,aAFqB;AAG3B,iBAAM,8DAAsBvC;AAHD,WAAf,CAAd,CAHwB,CAQxB;AACA;;AAEAhrB,iBAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BstB,eAA/B;AAEA,eAAKtC,WAAL,CAAiBxnB,OAAjB;AACD;;;wCAEeqpB,Y,EAA4B;AAC1C;AACA,cAAI,mEAAa9lB,UAAb,KAA4B,WAAhC,EAA6C;AAC3C,iBAAKolB,sBAAL,CAA4B2I,mBAA5B,CAAgDjI,YAAY,CAAC9H,IAA7D;AACD;AACF;;;sCAEa3L,K,EAAY;AACxBrZ,iBAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCoZ,KAAtC;AACD;;;sCAEaA,K,EAAiB;AAAA;;AAC7BrZ,iBAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCoZ,KAApC;AACA8U,uBAAa,CAAC,KAAKb,iBAAN,CAAb;AACA,eAAKf,SAAL,GAAiB,IAAjB;AACAlrB,oBAAU,CAAC,YAAM;AACfrB,mBAAO,CAACC,GAAR,CAAY,wBAAZ;;AACA,mBAAI,CAAC2qB,OAAL,CAAa,OAAI,CAACxuB,YAAlB;AACD,WAHS,EAGP,IAHO,CAAV;AAID;;;oCAEWqH,O,EAAO;AACjB,cAAI,KAAK8oB,SAAL,IAAkB,KAAKA,SAAL,CAAeC,IAAf,KAAwB,CAA9C,EAAiD;AAC/C;AACA,iBAAKD,SAAL,CAAe6B,IAAf,CAAoB3qB,OAApB;AACD,WAHD,MAGO;AACLzD,mBAAO,CAACC,GAAR,CACE,4EADF,EAEEwD,OAFF;AAID;AACF;;;;;;;uBAzGUoxB,gB,EAAgB,wI;AAAA,K;;;aAAhBA,gB;AAAgB,eAAhBA,gBAAgB,K;AAAA,kBAFf;;;;;sEAEDA,gB,EAAgB;cAH5B,wDAG4B;eAHjB;AACVxiB,oBAAU,EAAE;AADF,S;AAGiB,Q;;;;;;;;;;;;;;;;;;;;;;ACX7B;AAAA;;;AAAA;AAAA;AAAA,O,CAAA;AACA;AACA;;;AAEO,QAAM2iB,WAAW,GAAG;AACzBC,gBAAU,EAAE;AADa,KAApB;AAIP;;;;;;;AAOA;;;;;;;;;;;;;;;;;ACfA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAMA,QAAI,sEAAYA,UAAhB,EAA4B;AAC1B;AACD;;AAED,gFAAyBC,eAAzB,CAAyC,yDAAzC,WACS,UAAAC,GAAG;AAAA,aAAIn1B,OAAO,CAACwD,KAAR,CAAc2xB,GAAd,CAAJ;AAAA,KADZ","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","var map = {\n\t\"./af\": \"./node_modules/moment/locale/af.js\",\n\t\"./af.js\": \"./node_modules/moment/locale/af.js\",\n\t\"./ar\": \"./node_modules/moment/locale/ar.js\",\n\t\"./ar-dz\": \"./node_modules/moment/locale/ar-dz.js\",\n\t\"./ar-dz.js\": \"./node_modules/moment/locale/ar-dz.js\",\n\t\"./ar-kw\": \"./node_modules/moment/locale/ar-kw.js\",\n\t\"./ar-kw.js\": \"./node_modules/moment/locale/ar-kw.js\",\n\t\"./ar-ly\": \"./node_modules/moment/locale/ar-ly.js\",\n\t\"./ar-ly.js\": \"./node_modules/moment/locale/ar-ly.js\",\n\t\"./ar-ma\": \"./node_modules/moment/locale/ar-ma.js\",\n\t\"./ar-ma.js\": \"./node_modules/moment/locale/ar-ma.js\",\n\t\"./ar-sa\": \"./node_modules/moment/locale/ar-sa.js\",\n\t\"./ar-sa.js\": \"./node_modules/moment/locale/ar-sa.js\",\n\t\"./ar-tn\": \"./node_modules/moment/locale/ar-tn.js\",\n\t\"./ar-tn.js\": \"./node_modules/moment/locale/ar-tn.js\",\n\t\"./ar.js\": \"./node_modules/moment/locale/ar.js\",\n\t\"./az\": \"./node_modules/moment/locale/az.js\",\n\t\"./az.js\": \"./node_modules/moment/locale/az.js\",\n\t\"./be\": \"./node_modules/moment/locale/be.js\",\n\t\"./be.js\": \"./node_modules/moment/locale/be.js\",\n\t\"./bg\": \"./node_modules/moment/locale/bg.js\",\n\t\"./bg.js\": \"./node_modules/moment/locale/bg.js\",\n\t\"./bm\": \"./node_modules/moment/locale/bm.js\",\n\t\"./bm.js\": \"./node_modules/moment/locale/bm.js\",\n\t\"./bn\": \"./node_modules/moment/locale/bn.js\",\n\t\"./bn-bd\": \"./node_modules/moment/locale/bn-bd.js\",\n\t\"./bn-bd.js\": \"./node_modules/moment/locale/bn-bd.js\",\n\t\"./bn.js\": \"./node_modules/moment/locale/bn.js\",\n\t\"./bo\": \"./node_modules/moment/locale/bo.js\",\n\t\"./bo.js\": \"./node_modules/moment/locale/bo.js\",\n\t\"./br\": \"./node_modules/moment/locale/br.js\",\n\t\"./br.js\": \"./node_modules/moment/locale/br.js\",\n\t\"./bs\": \"./node_modules/moment/locale/bs.js\",\n\t\"./bs.js\": \"./node_modules/moment/locale/bs.js\",\n\t\"./ca\": \"./node_modules/moment/locale/ca.js\",\n\t\"./ca.js\": \"./node_modules/moment/locale/ca.js\",\n\t\"./cs\": \"./node_modules/moment/locale/cs.js\",\n\t\"./cs.js\": \"./node_modules/moment/locale/cs.js\",\n\t\"./cv\": \"./node_modules/moment/locale/cv.js\",\n\t\"./cv.js\": \"./node_modules/moment/locale/cv.js\",\n\t\"./cy\": \"./node_modules/moment/locale/cy.js\",\n\t\"./cy.js\": \"./node_modules/moment/locale/cy.js\",\n\t\"./da\": \"./node_modules/moment/locale/da.js\",\n\t\"./da.js\": \"./node_modules/moment/locale/da.js\",\n\t\"./de\": \"./node_modules/moment/locale/de.js\",\n\t\"./de-at\": \"./node_modules/moment/locale/de-at.js\",\n\t\"./de-at.js\": \"./node_modules/moment/locale/de-at.js\",\n\t\"./de-ch\": \"./node_modules/moment/locale/de-ch.js\",\n\t\"./de-ch.js\": \"./node_modules/moment/locale/de-ch.js\",\n\t\"./de.js\": \"./node_modules/moment/locale/de.js\",\n\t\"./dv\": \"./node_modules/moment/locale/dv.js\",\n\t\"./dv.js\": \"./node_modules/moment/locale/dv.js\",\n\t\"./el\": \"./node_modules/moment/locale/el.js\",\n\t\"./el.js\": \"./node_modules/moment/locale/el.js\",\n\t\"./en-au\": \"./node_modules/moment/locale/en-au.js\",\n\t\"./en-au.js\": \"./node_modules/moment/locale/en-au.js\",\n\t\"./en-ca\": \"./node_modules/moment/locale/en-ca.js\",\n\t\"./en-ca.js\": \"./node_modules/moment/locale/en-ca.js\",\n\t\"./en-gb\": \"./node_modules/moment/locale/en-gb.js\",\n\t\"./en-gb.js\": \"./node_modules/moment/locale/en-gb.js\",\n\t\"./en-ie\": \"./node_modules/moment/locale/en-ie.js\",\n\t\"./en-ie.js\": \"./node_modules/moment/locale/en-ie.js\",\n\t\"./en-il\": \"./node_modules/moment/locale/en-il.js\",\n\t\"./en-il.js\": \"./node_modules/moment/locale/en-il.js\",\n\t\"./en-in\": \"./node_modules/moment/locale/en-in.js\",\n\t\"./en-in.js\": \"./node_modules/moment/locale/en-in.js\",\n\t\"./en-nz\": \"./node_modules/moment/locale/en-nz.js\",\n\t\"./en-nz.js\": \"./node_modules/moment/locale/en-nz.js\",\n\t\"./en-sg\": \"./node_modules/moment/locale/en-sg.js\",\n\t\"./en-sg.js\": \"./node_modules/moment/locale/en-sg.js\",\n\t\"./eo\": \"./node_modules/moment/locale/eo.js\",\n\t\"./eo.js\": \"./node_modules/moment/locale/eo.js\",\n\t\"./es\": \"./node_modules/moment/locale/es.js\",\n\t\"./es-do\": \"./node_modules/moment/locale/es-do.js\",\n\t\"./es-do.js\": \"./node_modules/moment/locale/es-do.js\",\n\t\"./es-mx\": \"./node_modules/moment/locale/es-mx.js\",\n\t\"./es-mx.js\": \"./node_modules/moment/locale/es-mx.js\",\n\t\"./es-us\": \"./node_modules/moment/locale/es-us.js\",\n\t\"./es-us.js\": \"./node_modules/moment/locale/es-us.js\",\n\t\"./es.js\": \"./node_modules/moment/locale/es.js\",\n\t\"./et\": \"./node_modules/moment/locale/et.js\",\n\t\"./et.js\": \"./node_modules/moment/locale/et.js\",\n\t\"./eu\": \"./node_modules/moment/locale/eu.js\",\n\t\"./eu.js\": \"./node_modules/moment/locale/eu.js\",\n\t\"./fa\": \"./node_modules/moment/locale/fa.js\",\n\t\"./fa.js\": \"./node_modules/moment/locale/fa.js\",\n\t\"./fi\": \"./node_modules/moment/locale/fi.js\",\n\t\"./fi.js\": \"./node_modules/moment/locale/fi.js\",\n\t\"./fil\": \"./node_modules/moment/locale/fil.js\",\n\t\"./fil.js\": \"./node_modules/moment/locale/fil.js\",\n\t\"./fo\": \"./node_modules/moment/locale/fo.js\",\n\t\"./fo.js\": \"./node_modules/moment/locale/fo.js\",\n\t\"./fr\": \"./node_modules/moment/locale/fr.js\",\n\t\"./fr-ca\": \"./node_modules/moment/locale/fr-ca.js\",\n\t\"./fr-ca.js\": \"./node_modules/moment/locale/fr-ca.js\",\n\t\"./fr-ch\": \"./node_modules/moment/locale/fr-ch.js\",\n\t\"./fr-ch.js\": \"./node_modules/moment/locale/fr-ch.js\",\n\t\"./fr.js\": \"./node_modules/moment/locale/fr.js\",\n\t\"./fy\": \"./node_modules/moment/locale/fy.js\",\n\t\"./fy.js\": \"./node_modules/moment/locale/fy.js\",\n\t\"./ga\": \"./node_modules/moment/locale/ga.js\",\n\t\"./ga.js\": \"./node_modules/moment/locale/ga.js\",\n\t\"./gd\": \"./node_modules/moment/locale/gd.js\",\n\t\"./gd.js\": \"./node_modules/moment/locale/gd.js\",\n\t\"./gl\": \"./node_modules/moment/locale/gl.js\",\n\t\"./gl.js\": \"./node_modules/moment/locale/gl.js\",\n\t\"./gom-deva\": \"./node_modules/moment/locale/gom-deva.js\",\n\t\"./gom-deva.js\": \"./node_modules/moment/locale/gom-deva.js\",\n\t\"./gom-latn\": \"./node_modules/moment/locale/gom-latn.js\",\n\t\"./gom-latn.js\": \"./node_modules/moment/locale/gom-latn.js\",\n\t\"./gu\": \"./node_modules/moment/locale/gu.js\",\n\t\"./gu.js\": \"./node_modules/moment/locale/gu.js\",\n\t\"./he\": \"./node_modules/moment/locale/he.js\",\n\t\"./he.js\": \"./node_modules/moment/locale/he.js\",\n\t\"./hi\": \"./node_modules/moment/locale/hi.js\",\n\t\"./hi.js\": \"./node_modules/moment/locale/hi.js\",\n\t\"./hr\": \"./node_modules/moment/locale/hr.js\",\n\t\"./hr.js\": \"./node_modules/moment/locale/hr.js\",\n\t\"./hu\": \"./node_modules/moment/locale/hu.js\",\n\t\"./hu.js\": \"./node_modules/moment/locale/hu.js\",\n\t\"./hy-am\": \"./node_modules/moment/locale/hy-am.js\",\n\t\"./hy-am.js\": \"./node_modules/moment/locale/hy-am.js\",\n\t\"./id\": \"./node_modules/moment/locale/id.js\",\n\t\"./id.js\": \"./node_modules/moment/locale/id.js\",\n\t\"./is\": \"./node_modules/moment/locale/is.js\",\n\t\"./is.js\": \"./node_modules/moment/locale/is.js\",\n\t\"./it\": \"./node_modules/moment/locale/it.js\",\n\t\"./it-ch\": \"./node_modules/moment/locale/it-ch.js\",\n\t\"./it-ch.js\": \"./node_modules/moment/locale/it-ch.js\",\n\t\"./it.js\": \"./node_modules/moment/locale/it.js\",\n\t\"./ja\": \"./node_modules/moment/locale/ja.js\",\n\t\"./ja.js\": \"./node_modules/moment/locale/ja.js\",\n\t\"./jv\": \"./node_modules/moment/locale/jv.js\",\n\t\"./jv.js\": \"./node_modules/moment/locale/jv.js\",\n\t\"./ka\": \"./node_modules/moment/locale/ka.js\",\n\t\"./ka.js\": \"./node_modules/moment/locale/ka.js\",\n\t\"./kk\": \"./node_modules/moment/locale/kk.js\",\n\t\"./kk.js\": \"./node_modules/moment/locale/kk.js\",\n\t\"./km\": \"./node_modules/moment/locale/km.js\",\n\t\"./km.js\": \"./node_modules/moment/locale/km.js\",\n\t\"./kn\": \"./node_modules/moment/locale/kn.js\",\n\t\"./kn.js\": \"./node_modules/moment/locale/kn.js\",\n\t\"./ko\": \"./node_modules/moment/locale/ko.js\",\n\t\"./ko.js\": \"./node_modules/moment/locale/ko.js\",\n\t\"./ku\": \"./node_modules/moment/locale/ku.js\",\n\t\"./ku.js\": \"./node_modules/moment/locale/ku.js\",\n\t\"./ky\": \"./node_modules/moment/locale/ky.js\",\n\t\"./ky.js\": \"./node_modules/moment/locale/ky.js\",\n\t\"./lb\": \"./node_modules/moment/locale/lb.js\",\n\t\"./lb.js\": \"./node_modules/moment/locale/lb.js\",\n\t\"./lo\": \"./node_modules/moment/locale/lo.js\",\n\t\"./lo.js\": \"./node_modules/moment/locale/lo.js\",\n\t\"./lt\": \"./node_modules/moment/locale/lt.js\",\n\t\"./lt.js\": \"./node_modules/moment/locale/lt.js\",\n\t\"./lv\": \"./node_modules/moment/locale/lv.js\",\n\t\"./lv.js\": \"./node_modules/moment/locale/lv.js\",\n\t\"./me\": \"./node_modules/moment/locale/me.js\",\n\t\"./me.js\": \"./node_modules/moment/locale/me.js\",\n\t\"./mi\": \"./node_modules/moment/locale/mi.js\",\n\t\"./mi.js\": \"./node_modules/moment/locale/mi.js\",\n\t\"./mk\": \"./node_modules/moment/locale/mk.js\",\n\t\"./mk.js\": \"./node_modules/moment/locale/mk.js\",\n\t\"./ml\": \"./node_modules/moment/locale/ml.js\",\n\t\"./ml.js\": \"./node_modules/moment/locale/ml.js\",\n\t\"./mn\": \"./node_modules/moment/locale/mn.js\",\n\t\"./mn.js\": \"./node_modules/moment/locale/mn.js\",\n\t\"./mr\": \"./node_modules/moment/locale/mr.js\",\n\t\"./mr.js\": \"./node_modules/moment/locale/mr.js\",\n\t\"./ms\": \"./node_modules/moment/locale/ms.js\",\n\t\"./ms-my\": \"./node_modules/moment/locale/ms-my.js\",\n\t\"./ms-my.js\": \"./node_modules/moment/locale/ms-my.js\",\n\t\"./ms.js\": \"./node_modules/moment/locale/ms.js\",\n\t\"./mt\": \"./node_modules/moment/locale/mt.js\",\n\t\"./mt.js\": \"./node_modules/moment/locale/mt.js\",\n\t\"./my\": \"./node_modules/moment/locale/my.js\",\n\t\"./my.js\": \"./node_modules/moment/locale/my.js\",\n\t\"./nb\": \"./node_modules/moment/locale/nb.js\",\n\t\"./nb.js\": \"./node_modules/moment/locale/nb.js\",\n\t\"./ne\": \"./node_modules/moment/locale/ne.js\",\n\t\"./ne.js\": \"./node_modules/moment/locale/ne.js\",\n\t\"./nl\": \"./node_modules/moment/locale/nl.js\",\n\t\"./nl-be\": \"./node_modules/moment/locale/nl-be.js\",\n\t\"./nl-be.js\": \"./node_modules/moment/locale/nl-be.js\",\n\t\"./nl.js\": \"./node_modules/moment/locale/nl.js\",\n\t\"./nn\": \"./node_modules/moment/locale/nn.js\",\n\t\"./nn.js\": \"./node_modules/moment/locale/nn.js\",\n\t\"./oc-lnc\": \"./node_modules/moment/locale/oc-lnc.js\",\n\t\"./oc-lnc.js\": \"./node_modules/moment/locale/oc-lnc.js\",\n\t\"./pa-in\": \"./node_modules/moment/locale/pa-in.js\",\n\t\"./pa-in.js\": \"./node_modules/moment/locale/pa-in.js\",\n\t\"./pl\": \"./node_modules/moment/locale/pl.js\",\n\t\"./pl.js\": \"./node_modules/moment/locale/pl.js\",\n\t\"./pt\": \"./node_modules/moment/locale/pt.js\",\n\t\"./pt-br\": \"./node_modules/moment/locale/pt-br.js\",\n\t\"./pt-br.js\": \"./node_modules/moment/locale/pt-br.js\",\n\t\"./pt.js\": \"./node_modules/moment/locale/pt.js\",\n\t\"./ro\": \"./node_modules/moment/locale/ro.js\",\n\t\"./ro.js\": \"./node_modules/moment/locale/ro.js\",\n\t\"./ru\": \"./node_modules/moment/locale/ru.js\",\n\t\"./ru.js\": \"./node_modules/moment/locale/ru.js\",\n\t\"./sd\": \"./node_modules/moment/locale/sd.js\",\n\t\"./sd.js\": \"./node_modules/moment/locale/sd.js\",\n\t\"./se\": \"./node_modules/moment/locale/se.js\",\n\t\"./se.js\": \"./node_modules/moment/locale/se.js\",\n\t\"./si\": \"./node_modules/moment/locale/si.js\",\n\t\"./si.js\": \"./node_modules/moment/locale/si.js\",\n\t\"./sk\": \"./node_modules/moment/locale/sk.js\",\n\t\"./sk.js\": \"./node_modules/moment/locale/sk.js\",\n\t\"./sl\": \"./node_modules/moment/locale/sl.js\",\n\t\"./sl.js\": \"./node_modules/moment/locale/sl.js\",\n\t\"./sq\": \"./node_modules/moment/locale/sq.js\",\n\t\"./sq.js\": \"./node_modules/moment/locale/sq.js\",\n\t\"./sr\": \"./node_modules/moment/locale/sr.js\",\n\t\"./sr-cyrl\": \"./node_modules/moment/locale/sr-cyrl.js\",\n\t\"./sr-cyrl.js\": \"./node_modules/moment/locale/sr-cyrl.js\",\n\t\"./sr.js\": \"./node_modules/moment/locale/sr.js\",\n\t\"./ss\": \"./node_modules/moment/locale/ss.js\",\n\t\"./ss.js\": \"./node_modules/moment/locale/ss.js\",\n\t\"./sv\": \"./node_modules/moment/locale/sv.js\",\n\t\"./sv.js\": \"./node_modules/moment/locale/sv.js\",\n\t\"./sw\": \"./node_modules/moment/locale/sw.js\",\n\t\"./sw.js\": \"./node_modules/moment/locale/sw.js\",\n\t\"./ta\": \"./node_modules/moment/locale/ta.js\",\n\t\"./ta.js\": \"./node_modules/moment/locale/ta.js\",\n\t\"./te\": \"./node_modules/moment/locale/te.js\",\n\t\"./te.js\": \"./node_modules/moment/locale/te.js\",\n\t\"./tet\": \"./node_modules/moment/locale/tet.js\",\n\t\"./tet.js\": \"./node_modules/moment/locale/tet.js\",\n\t\"./tg\": \"./node_modules/moment/locale/tg.js\",\n\t\"./tg.js\": \"./node_modules/moment/locale/tg.js\",\n\t\"./th\": \"./node_modules/moment/locale/th.js\",\n\t\"./th.js\": \"./node_modules/moment/locale/th.js\",\n\t\"./tk\": \"./node_modules/moment/locale/tk.js\",\n\t\"./tk.js\": \"./node_modules/moment/locale/tk.js\",\n\t\"./tl-ph\": \"./node_modules/moment/locale/tl-ph.js\",\n\t\"./tl-ph.js\": \"./node_modules/moment/locale/tl-ph.js\",\n\t\"./tlh\": \"./node_modules/moment/locale/tlh.js\",\n\t\"./tlh.js\": \"./node_modules/moment/locale/tlh.js\",\n\t\"./tr\": \"./node_modules/moment/locale/tr.js\",\n\t\"./tr.js\": \"./node_modules/moment/locale/tr.js\",\n\t\"./tzl\": \"./node_modules/moment/locale/tzl.js\",\n\t\"./tzl.js\": \"./node_modules/moment/locale/tzl.js\",\n\t\"./tzm\": \"./node_modules/moment/locale/tzm.js\",\n\t\"./tzm-latn\": \"./node_modules/moment/locale/tzm-latn.js\",\n\t\"./tzm-latn.js\": \"./node_modules/moment/locale/tzm-latn.js\",\n\t\"./tzm.js\": \"./node_modules/moment/locale/tzm.js\",\n\t\"./ug-cn\": \"./node_modules/moment/locale/ug-cn.js\",\n\t\"./ug-cn.js\": \"./node_modules/moment/locale/ug-cn.js\",\n\t\"./uk\": \"./node_modules/moment/locale/uk.js\",\n\t\"./uk.js\": \"./node_modules/moment/locale/uk.js\",\n\t\"./ur\": \"./node_modules/moment/locale/ur.js\",\n\t\"./ur.js\": \"./node_modules/moment/locale/ur.js\",\n\t\"./uz\": \"./node_modules/moment/locale/uz.js\",\n\t\"./uz-latn\": \"./node_modules/moment/locale/uz-latn.js\",\n\t\"./uz-latn.js\": \"./node_modules/moment/locale/uz-latn.js\",\n\t\"./uz.js\": \"./node_modules/moment/locale/uz.js\",\n\t\"./vi\": \"./node_modules/moment/locale/vi.js\",\n\t\"./vi.js\": \"./node_modules/moment/locale/vi.js\",\n\t\"./x-pseudo\": \"./node_modules/moment/locale/x-pseudo.js\",\n\t\"./x-pseudo.js\": \"./node_modules/moment/locale/x-pseudo.js\",\n\t\"./yo\": \"./node_modules/moment/locale/yo.js\",\n\t\"./yo.js\": \"./node_modules/moment/locale/yo.js\",\n\t\"./zh-cn\": \"./node_modules/moment/locale/zh-cn.js\",\n\t\"./zh-cn.js\": \"./node_modules/moment/locale/zh-cn.js\",\n\t\"./zh-hk\": \"./node_modules/moment/locale/zh-hk.js\",\n\t\"./zh-hk.js\": \"./node_modules/moment/locale/zh-hk.js\",\n\t\"./zh-mo\": \"./node_modules/moment/locale/zh-mo.js\",\n\t\"./zh-mo.js\": \"./node_modules/moment/locale/zh-mo.js\",\n\t\"./zh-tw\": \"./node_modules/moment/locale/zh-tw.js\",\n\t\"./zh-tw.js\": \"./node_modules/moment/locale/zh-tw.js\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./node_modules/moment/locale sync recursive ^\\\\.\\\\/.*$\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\n\nconst routes: Routes = [];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { AfterViewInit, ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AppService } from './app.service';\nimport { AppConstants } from './common/application.constant';\nimport { Position, Order, Instrument, PositionTypeForPayOff } from './common/models';\nimport { MapService } from './common/map.service';\nimport { WebsocketService } from './common/websocket.service';\nimport { ChartService } from './chart/chart.service';\nimport { AngelService } from './common/angel.service';\nimport { AngelWebsocketService } from './common/angelwebsocket.service';\nimport { HoldingsService } from './common/holdings.service';\n\n/*\nabMastersContract map is maintained for each \"code\"\nto send subscription over websocket, code for the symbol is required, that is found from masters. symbol is searched in masters based on expiry, instrument, strike, type.\ndata from websocket is received for this code whose information is then fetched from masters\n\nreceived from fyers:\nNSE:NIFTY209115555CE\nNSE:NIFTY20SEP5555CE\nNSE:NIFTY20N015555CE\n\nsymbol:\nUSDINR 19 JUN20 77.0 CE\nNIFTY 13 AUG20 9000.0 PE\nNIFTY JUN FUT\nNIFTY JUN 9000 PE\n\nMaps:\nNIFTY2061810000CE NIFTY20JUN10000CE NIFTY20N1810000CE\n\nFuture Position will not get realtime data. Will have to update findStrikeInMasters when sending subscription. And also update updateMaps.\nFor usdinr future, update its month in constants\n*/\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss'],\n})\nexport class AppComponent implements OnInit, AfterViewInit  {\n  title = 'Trades';\n  access_token = null;\n  user_id = null;\n  auth_code = null;\n  lastRequestStatus = null;\n  positions: Position[] = [];\n  orders: Order[] = [];\n  hide_positions = true;\n  hide_orders = true;\n  disable_order_buttons = true;\n  lastPositionsUpdateTime: any = '';\n  lastOrdersUpdateTime: any = '';\n  positionsPnL = 0;\n  stranglePositions = [];\n  debitSpreadPositions = [];\n  newexpiry = 'NIFTY20618';\n  newstrike = 10000;\n  newoption = 'CE';\n  newqty = 50;\n  newblock = 0;\n  newlimit = 0;\n  newstop = 0;\n  newProductType = 'INTRADAY';\n  newOrderType = 2;\n  nifty_oc_check = true;\n  usdinr_oc_check = false;\n  oc_instru = 'NIFTY';\n  oc_year = 2021;\n  oc_month = 6;\n  oc_date = 3;\n  is_monthly_expiry = false;\n  checked_instrument = 'USDINR';\n  oc_range_higher = 16000; // 24200\n  oc_range_lower = 14000; // 21000\n  oc_range_multiple = 50;\n  oc_strikes = [];\n  oc_product_type = 'MARGIN';\n  ws_vendor = 'aliceblue';\n  totalBalance;\n  availableBalance;\n  utilizedBalance;\n  mean = 0;\n  variance = 1;\n  ws_access_token = 'A8E8eGyqMug7VOXnvx2dPjf9pWbf8KKgfn9RQy9EVyA.KqVXmuGCRCQ2wEf95iFEtVjQxs0_LoL9FyZ86bPJlFg';\n  ocSpotStrike;\n  strategyPnL = 0;\n  strategyPointsProfit = 0;\n  suggestions = [];\n  adjust_sugg = [];\n  portfolio_return = 0;\n  holdings = [];\n  total_inv = 0;\n  current_val = 0;\n  combined_SL = 0;\n  combined_premium = 0;\n  qty_default = 175;\n\n  historical_append = 'WK';\n  zerodha_auth = 'enctoken Sr2gbgdlEM7yRuGdXWtOu9YrTyyuMHHqBJ+F4N1UXSDmSpEH8UrrAkE9Ii7DCbAb3CkRMtRVhbcnC9Qv+rY7LcLVgyz2lGZg4VqnFFnl19PrXXPH7qxXuA==';\n  zerodha_marketwatch = '{\"status\":\"success\",\"data\":[{\"id\":108696388,\"name\":\"1\",\"items\":[{\"id\":673211353,\"weight\":1,\"tradingsymbol\":\"INDIA VIX\",\"instrument_token\":264969,\"segment\":\"INDICES\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":816421144,\"weight\":2,\"tradingsymbol\":\"NIFTY 50\",\"instrument_token\":256265,\"segment\":\"INDICES\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":903805357,\"weight\":6,\"tradingsymbol\":\"NIFTYBEES\",\"instrument_token\":2707457,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":915508605,\"weight\":7,\"tradingsymbol\":\"ICICINIFTY\",\"instrument_token\":7565569,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":915630019,\"weight\":8,\"tradingsymbol\":\"KOTAKBKETF\",\"instrument_token\":1497857,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":915630692,\"weight\":9,\"tradingsymbol\":\"KOTAKNIFTY\",\"instrument_token\":4634113,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":916079116,\"weight\":10,\"tradingsymbol\":\"SETFNIF50\",\"instrument_token\":2605057,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":2963445776,\"weight\":11,\"tradingsymbol\":\"LIQUIDBEES\",\"instrument_token\":2817537,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3185499175,\"weight\":12,\"tradingsymbol\":\"BANKBEES\",\"instrument_token\":2928385,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3325591374,\"weight\":13,\"tradingsymbol\":\"NIFTY BANK\",\"instrument_token\":260105,\"segment\":\"INDICES\",\"exchange\":\"NSE\",\"expiry\":\"\"}]},{\"id\":108696392,\"name\":\"Watchlist 2\",\"items\":[{\"id\":2542203093,\"weight\":19,\"tradingsymbol\":\"INDIA VIX\",\"instrument_token\":264969,\"segment\":\"INDICES\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3380116369,\"weight\":20,\"tradingsymbol\":\"BANKNIFTY2211340400CE\",\"instrument_token\":11244546,\"segment\":\"NFO-OPT\",\"exchange\":\"NFO\",\"expiry\":\"2022-01-13\"},{\"id\":3384256979,\"weight\":21,\"tradingsymbol\":\"BANKNIFTY2211340500CE\",\"instrument_token\":11245570,\"segment\":\"NFO-OPT\",\"exchange\":\"NFO\",\"expiry\":\"2022-01-13\"},{\"id\":3384259326,\"weight\":22,\"tradingsymbol\":\"BANKNIFTY2211340600CE\",\"instrument_token\":11246082,\"segment\":\"NFO-OPT\",\"exchange\":\"NFO\",\"expiry\":\"2022-01-13\"},{\"id\":3384262349,\"weight\":23,\"tradingsymbol\":\"BANKNIFTY2211340700CE\",\"instrument_token\":11246594,\"segment\":\"NFO-OPT\",\"exchange\":\"NFO\",\"expiry\":\"2022-01-13\"},{\"id\":3384265324,\"weight\":24,\"tradingsymbol\":\"BANKNIFTY2211340800CE\",\"instrument_token\":11247106,\"segment\":\"NFO-OPT\",\"exchange\":\"NFO\",\"expiry\":\"2022-01-13\"},{\"id\":3384267715,\"weight\":25,\"tradingsymbol\":\"BANKNIFTY2211340900CE\",\"instrument_token\":11249922,\"segment\":\"NFO-OPT\",\"exchange\":\"NFO\",\"expiry\":\"2022-01-13\"},{\"id\":3384270013,\"weight\":26,\"tradingsymbol\":\"BANKNIFTY2211341000CE\",\"instrument_token\":11250434,\"segment\":\"NFO-OPT\",\"exchange\":\"NFO\",\"expiry\":\"2022-01-13\"}]},{\"id\":108696391,\"name\":\"3\",\"items\":[]},{\"id\":108696390,\"name\":\"4\",\"items\":[{\"id\":3350520016,\"weight\":3,\"tradingsymbol\":\"USDINR22107FUT\",\"instrument_token\":1838339,\"segment\":\"CDS-FUT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3352324563,\"weight\":4,\"tradingsymbol\":\"USDINR2210774.75CE\",\"instrument_token\":2084099,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3352325735,\"weight\":5,\"tradingsymbol\":\"USDINR22JAN74.75CE\",\"instrument_token\":2331907,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-27\"},{\"id\":3357694089,\"weight\":6,\"tradingsymbol\":\"USDINR2210774PE\",\"instrument_token\":2082819,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3352326484,\"weight\":6,\"tradingsymbol\":\"USDINR2211474.75CE\",\"instrument_token\":2277379,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-14\"},{\"id\":3352327889,\"weight\":7,\"tradingsymbol\":\"USDINR22JAN74.5CE\",\"instrument_token\":2331395,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-27\"},{\"id\":3352328068,\"weight\":8,\"tradingsymbol\":\"USDINR2210774.5CE\",\"instrument_token\":2083587,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3352328218,\"weight\":9,\"tradingsymbol\":\"USDINR2211474.5CE\",\"instrument_token\":2274563,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-14\"},{\"id\":3352330098,\"weight\":10,\"tradingsymbol\":\"USDINR22JAN74.25PE\",\"instrument_token\":2331139,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-27\"},{\"id\":3352330606,\"weight\":11,\"tradingsymbol\":\"USDINR2210774.25PE\",\"instrument_token\":2083331,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3352330853,\"weight\":12,\"tradingsymbol\":\"USDINR2211474.25PE\",\"instrument_token\":2228483,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-14\"},{\"id\":3352331692,\"weight\":13,\"tradingsymbol\":\"USDINR22JAN74.5PE\",\"instrument_token\":2331651,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-27\"},{\"id\":3352331872,\"weight\":14,\"tradingsymbol\":\"USDINR2210774.5PE\",\"instrument_token\":2083843,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3352332088,\"weight\":15,\"tradingsymbol\":\"USDINR2211474.5PE\",\"instrument_token\":2275843,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-14\"}]},{\"id\":108696389,\"name\":\"5\",\"items\":[{\"id\":3348892336,\"weight\":0,\"tradingsymbol\":\"USDINR2210775.5CE\",\"instrument_token\":2085635,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348944443,\"weight\":1,\"tradingsymbol\":\"USDINR2210775CE\",\"instrument_token\":2084611,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348963455,\"weight\":2,\"tradingsymbol\":\"USDINR2210776.5CE\",\"instrument_token\":2087683,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348963507,\"weight\":3,\"tradingsymbol\":\"USDINR2210776.25CE\",\"instrument_token\":2087171,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348963586,\"weight\":4,\"tradingsymbol\":\"USDINR2210776CE\",\"instrument_token\":2086659,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348963744,\"weight\":5,\"tradingsymbol\":\"USDINR2210775.75CE\",\"instrument_token\":2086147,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348963890,\"weight\":6,\"tradingsymbol\":\"USDINR2210775.25CE\",\"instrument_token\":2085123,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964092,\"weight\":7,\"tradingsymbol\":\"USDINR2210774.25CE\",\"instrument_token\":2083075,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964200,\"weight\":8,\"tradingsymbol\":\"USDINR2210774.75CE\",\"instrument_token\":2084099,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964250,\"weight\":9,\"tradingsymbol\":\"USDINR2210774.5CE\",\"instrument_token\":2083587,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964298,\"weight\":10,\"tradingsymbol\":\"USDINR2210774CE\",\"instrument_token\":2082563,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964379,\"weight\":11,\"tradingsymbol\":\"USDINR2210773.75CE\",\"instrument_token\":2082051,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964434,\"weight\":12,\"tradingsymbol\":\"USDINR2210773.5CE\",\"instrument_token\":2081539,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964547,\"weight\":13,\"tradingsymbol\":\"USDINR2210773.25CE\",\"instrument_token\":2081027,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964591,\"weight\":14,\"tradingsymbol\":\"USDINR2210773CE\",\"instrument_token\":2080515,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964657,\"weight\":15,\"tradingsymbol\":\"USDINR2210772.75CE\",\"instrument_token\":2080003,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964687,\"weight\":16,\"tradingsymbol\":\"USDINR2210772.5CE\",\"instrument_token\":2079491,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964729,\"weight\":17,\"tradingsymbol\":\"USDINR2210772.25CE\",\"instrument_token\":2078979,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348967699,\"weight\":18,\"tradingsymbol\":\"USDINR2210776.25PE\",\"instrument_token\":2087427,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348965608,\"weight\":18,\"tradingsymbol\":\"USDINR2210776PE\",\"instrument_token\":2086915,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348964780,\"weight\":18,\"tradingsymbol\":\"USDINR2210772CE\",\"instrument_token\":2078467,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348965675,\"weight\":19,\"tradingsymbol\":\"USDINR2210775.75PE\",\"instrument_token\":2086403,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348967763,\"weight\":19,\"tradingsymbol\":\"USDINR2210776.5PE\",\"instrument_token\":2087939,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348965724,\"weight\":20,\"tradingsymbol\":\"USDINR2210775.5PE\",\"instrument_token\":2085891,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348965816,\"weight\":21,\"tradingsymbol\":\"USDINR2210775.25PE\",\"instrument_token\":2085379,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348965993,\"weight\":22,\"tradingsymbol\":\"USDINR2210775PE\",\"instrument_token\":2084867,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966094,\"weight\":23,\"tradingsymbol\":\"USDINR2210774.75PE\",\"instrument_token\":2084355,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966143,\"weight\":24,\"tradingsymbol\":\"USDINR2210774.5PE\",\"instrument_token\":2083843,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966207,\"weight\":25,\"tradingsymbol\":\"USDINR2210774.25PE\",\"instrument_token\":2083331,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966278,\"weight\":26,\"tradingsymbol\":\"USDINR2210774PE\",\"instrument_token\":2082819,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966366,\"weight\":27,\"tradingsymbol\":\"USDINR2210773.75PE\",\"instrument_token\":2082307,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966427,\"weight\":28,\"tradingsymbol\":\"USDINR2210773.5PE\",\"instrument_token\":2081795,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966465,\"weight\":29,\"tradingsymbol\":\"USDINR2210773.25PE\",\"instrument_token\":2081283,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966553,\"weight\":30,\"tradingsymbol\":\"USDINR2210773PE\",\"instrument_token\":2080771,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966621,\"weight\":31,\"tradingsymbol\":\"USDINR2210772.75PE\",\"instrument_token\":2080259,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966683,\"weight\":32,\"tradingsymbol\":\"USDINR2210772.5PE\",\"instrument_token\":2079747,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966740,\"weight\":33,\"tradingsymbol\":\"USDINR2210772.25PE\",\"instrument_token\":2079235,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3348966840,\"weight\":34,\"tradingsymbol\":\"USDINR2210772PE\",\"instrument_token\":2078723,\"segment\":\"CDS-OPT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"},{\"id\":3349002726,\"weight\":35,\"tradingsymbol\":\"USDINR22107FUT\",\"instrument_token\":1838339,\"segment\":\"CDS-FUT\",\"exchange\":\"CDS\",\"expiry\":\"2022-01-07\"}]},{\"id\":1432148480,\"name\":\"MW 6\",\"items\":[{\"id\":3153225189,\"weight\":4,\"tradingsymbol\":\"INDIA VIX\",\"instrument_token\":264969,\"segment\":\"INDICES\",\"exchange\":\"NSE\",\"expiry\":\"\"}]},{\"id\":1439682075,\"name\":\"MW 7\",\"items\":[{\"id\":3160458234,\"weight\":1,\"tradingsymbol\":\"INDIA VIX\",\"instrument_token\":264969,\"segment\":\"INDICES\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186435109,\"weight\":2,\"tradingsymbol\":\"NIFTYBEES\",\"instrument_token\":2707457,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186401941,\"weight\":3,\"tradingsymbol\":\"CIPLA\",\"instrument_token\":177665,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186406251,\"weight\":4,\"tradingsymbol\":\"DIVISLAB\",\"instrument_token\":2800641,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186408123,\"weight\":5,\"tradingsymbol\":\"TCS\",\"instrument_token\":2953217,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186408254,\"weight\":6,\"tradingsymbol\":\"INFY\",\"instrument_token\":408065,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186414542,\"weight\":7,\"tradingsymbol\":\"TECHM\",\"instrument_token\":3465729,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186425692,\"weight\":8,\"tradingsymbol\":\"RELIANCE\",\"instrument_token\":738561,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186409602,\"weight\":9,\"tradingsymbol\":\"ASIANPAINT\",\"instrument_token\":60417,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186428516,\"weight\":10,\"tradingsymbol\":\"BHARTIARTL\",\"instrument_token\":2714625,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186410885,\"weight\":11,\"tradingsymbol\":\"POWERGRID\",\"instrument_token\":3834113,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186411996,\"weight\":12,\"tradingsymbol\":\"NESTLEIND\",\"instrument_token\":4598529,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186427537,\"weight\":13,\"tradingsymbol\":\"KOTAKBANK\",\"instrument_token\":492033,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3186565769,\"weight\":14,\"tradingsymbol\":\"BAJAJFINSV\",\"instrument_token\":4268801,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3261642640,\"weight\":15,\"tradingsymbol\":\"SBILIFE\",\"instrument_token\":5582849,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3261648555,\"weight\":16,\"tradingsymbol\":\"LT\",\"instrument_token\":2939649,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3261672641,\"weight\":17,\"tradingsymbol\":\"GRASIM\",\"instrument_token\":315393,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3261674006,\"weight\":18,\"tradingsymbol\":\"TITAN\",\"instrument_token\":897537,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3261755095,\"weight\":19,\"tradingsymbol\":\"BANKBEES\",\"instrument_token\":2928385,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3262029921,\"weight\":20,\"tradingsymbol\":\"VBL\",\"instrument_token\":4843777,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3262031465,\"weight\":21,\"tradingsymbol\":\"RADICO\",\"instrument_token\":2813441,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3380025273,\"weight\":22,\"tradingsymbol\":\"PIDILITIND\",\"instrument_token\":681985,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3380026008,\"weight\":23,\"tradingsymbol\":\"SUNPHARMA\",\"instrument_token\":857857,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"},{\"id\":3380027033,\"weight\":24,\"tradingsymbol\":\"DMART\",\"instrument_token\":5097729,\"segment\":\"NSE\",\"exchange\":\"NSE\",\"expiry\":\"\"}]}]}'\n  zerodha_from_date = '2021-12-08';\n  zerodha_to_date = '2022-01-07';\n  zerodha_expiry_date = 'Jan-07-2021';\n\n  /* monthsMapping = {\n    'JAN' : '1',\n    'FEB' : '2',\n    'MAR' : '3',\n    'APR' : '4',\n    'MAY' : '5',\n    'JUN' : '6',\n    'JUL' : '7',\n    'AUG' : '8',\n    'SEP' : '9',\n    'OCT' : '10',\n    'NOV' : '11',\n    'DEC' : '12'\n  }; */\n\n  constructor(\n    private route: ActivatedRoute,\n    private appService: AppService,\n    private mapService: MapService,\n    private websocketService: WebsocketService,\n    private chartService: ChartService,\n    private angelService: AngelService,\n    private angelWS: AngelWebsocketService,\n    private holdingsService: HoldingsService\n    /* private cdr: ChangeDetectorRef */) {\n    this.route.queryParams.subscribe(params => {\n      console.log('params', params);\n      if (params && params.access_token) {\n        this.access_token = params.access_token;\n        // console.log('access_token', this.access_token);\n        \n       /*  this.getFunds();\n        this.getPositions();\n        this.getOrders(); */\n\n        // this.getPayoff();\n        \n        // this.appService.getMastersContract();\n\n        // this.angelLogin();\n      }\n      if (params && params.user_id) {\n        this.user_id = params.user_id;\n      }\n    });\n\n    this.appService.requestStatusEvent$.subscribe(res => {\n      console.log('app requestStatusEvent: ', res);\n      this.lastRequestStatus = res;\n    });\n\n    this.websocketService.websocketEvent$.subscribe(res => {\n      console.log('app websocketEvent: ', res);\n      if (res === 'connected') {\n        this.subscribePositionsFeed();\n      }\n    });\n\n  }\n\n  ngOnInit() {\n\n    // Setting dummy values for indices for Payoff to work even if websocket is not working\n    this.mapService.setLtp('NIFTY50', 18000);\n    this.mapService.setLtp('BANKNIFTY', 40000);\n\n    if (window.location.href.includes('localhost')) {\n      AppConstants.isProduction = false;\n    }\n    console.log(window.location.href, AppConstants.isProduction);\n\n    let refresh_interval = setInterval(() => {\n      this.updateSpotStrike();\n    }, 5000);\n\n    let autoSuggest_interval = setInterval(() => {\n      // this.autoSuggest();\n    }, 2000);\n    this.chartService.strategyPnLEvent$.subscribe(res => {\n      // console.log('received:', res);\n      this.strategyPnL = res[0];\n      this.strategyPointsProfit = res[1];\n    });\n\n    this.chartService.optionChainEvent$.subscribe(res => {\n      console.log('received oc:', res);\n      let instru = res[0];\n      let expiryDate = res[1];\n      this.processOCRequest(instru, expiryDate);\n    });\n    \n  }\n\n  ngAfterViewInit() {\n    setTimeout(() => {\n      \n    });\n    /* this.cdr.detectChanges(); */\n\n  }\n\n  fetchHistorical() {\n    this.holdingsService.fetchCandles(this.historical_append, this.zerodha_auth, this.zerodha_marketwatch, this.zerodha_from_date, this.zerodha_to_date, this.zerodha_expiry_date);\n  }\n\n  exportHistorical() {\n    this.holdingsService.exportToCSV();\n  }\n\n  processOCRequest(instru, expiryDate) {\n\n    this.oc_instru = instru;\n\n    let expiry = new Date(expiryDate);\n    this.oc_year = expiry.getFullYear();\n    this.oc_month = expiry.getMonth() + 1;\n    this.oc_date = expiry.getDate();\n\n    if (this.oc_instru === 'NIFTY') {\n      this.oc_range_multiple = 50;\n      let spot = this.getLtp('NIFTY50');\n      let spotStrike = (Math.round(spot / this.oc_range_multiple) * this.oc_range_multiple);\n      this.oc_range_higher = spotStrike + 400;\n      this.oc_range_lower = spotStrike - 400;\n    } else if (this.oc_instru === 'BANKNIFTY') {\n      this.oc_range_multiple = 100;\n      let spot = this.getLtp('BANKNIFTY');\n      let spotStrike = (Math.round(spot / this.oc_range_multiple) * this.oc_range_multiple);\n      this.oc_range_higher = spotStrike + 1200;\n      this.oc_range_lower = spotStrike - 1200;\n    } else if (this.oc_instru === 'USDINR') {\n      this.oc_range_multiple = 0.25;\n      let spot = this.getLtp('USDINR_FUT');\n      let spotStrike = (Math.round(spot / this.oc_range_multiple) * this.oc_range_multiple);\n      this.oc_range_higher = spotStrike + 2;\n      this.oc_range_lower = spotStrike - 2;\n    }\n\n    this.updateOCRange();\n  }\n\n  getStrategyPnL() {\n    return this.strategyPnL;\n  }\n\n  getIV(symbol, strike, type) {\n    let date_expiry = new Date(this.oc_year, this.oc_month - 1, this.oc_date);\n    if (this.oc_instru === 'USDINR') {\n      date_expiry.setHours(12, 30, 0);\n    } else {\n      date_expiry.setHours(15, 30, 0);\n    }\n\n    let underlying = 'NIFTY50';\n    if (this.oc_instru === 'BANKNIFTY') {\n      underlying = 'BANKNIFTY';\n    } else if (this.oc_instru === 'USDINR') {\n      underlying = 'USDINR_FUT';\n    }\n    let spot = this.getLtp(underlying);\n\n    let mkt_price = this.getLtp(symbol + type);\n\n    let typet0 = null;\n    if (type === 'CE') {\n      typet0 = PositionTypeForPayOff.CE;\n    }\n    if (type === 'PE') {\n      typet0 = PositionTypeForPayOff.PE;\n    }\n\n    let iv = this.appService.calculateIV(this.oc_instru, spot, strike, AppConstants.INTEREST_RATE, date_expiry, typet0, mkt_price);\n\n    return iv;\n  }\n\n  getDelta(symbol, strike, type) {\n\n    let ltp = this.getLtp(symbol + type);\n    let expiry = new Date(this.oc_year, this.oc_month - 1, this.oc_date);\n    let delta = this.appService.getDelta(this.oc_instru, strike, type, expiry, ltp);\n    return delta;\n  }\n\n  getUSDINRMonth() {\n    return AppConstants.USDINR_FUT_MONTH;\n  }\n\n  checkNifty() {\n    if (this.nifty_oc_check) {\n      this.usdinr_oc_check = false;\n      this.checked_instrument = 'NIFTY';\n    } else {\n      this.usdinr_oc_check = true;\n      this.checked_instrument = 'USDINR';\n    }\n  }\n\n  checkUSDINR() {\n    if (this.usdinr_oc_check) {\n      this.nifty_oc_check = false;\n      this.checked_instrument = 'USDINR';\n    } else {\n      this.nifty_oc_check = true;\n      this.checked_instrument = 'NIFTY';\n    }\n  }\n\n  login() {\n    this.auth();\n  }\n\n  auth() {\n    this.appService.auth().subscribe((res: any) => {\n      console.log('app auth', res);\n      if (res) {\n        this.appService.requestStatusEvent$.next(res);\n        if (res.authorization_code) {\n          this.auth_code = res.authorization_code;\n          this.generateAccessToken();\n        }\n      }\n    },\n    error => {\n      console.log('app auth error', error);\n      this.appService.requestStatusEvent$.next(error.error.message +  ', ' + error.message);\n    });\n  }\n\n  generateAccessToken() {\n    if (this.auth_code) {\n      let tokenUrl = this.appService.getTokenUrl(this.auth_code, AppConstants.fyersAppId);\n      console.log('tokenUrl', tokenUrl);\n      // window.location.href = tokenUrl;\n      let wnd = window.open(tokenUrl/* , '_self' */);\n    }\n  }\n\n  getFunds() {\n    console.log('app getting Funds');\n    this.appService.getFunds(this.access_token).subscribe((res: any) => {\n      console.log('app getFunds', res);\n      if (res) {\n        this.totalBalance = res.fund_limit[8].equityAmount.toLocaleString();\n        this.availableBalance = res.fund_limit[9].equityAmount.toLocaleString();\n        this.utilizedBalance = res.fund_limit[6].equityAmount.toLocaleString();\n      }\n    },\n    error => {\n      console.log('app getPositions error', error);\n      this.appService.requestStatusEvent$.next(error.error.message +  ', ' + error.message);\n    });\n  }\n\n  getPositions() {\n    console.log('app getting Positions');\n    this.appService.getPositions(this.access_token).subscribe((res: any) => {\n      console.log('app getPositions', res);\n      if (res) {\n        this.lastPositionsUpdateTime = new Date().toLocaleTimeString();\n        this.appService.requestStatusEvent$.next(res);\n        this.mapPositions(res);\n      }\n    },\n    error => {\n      console.log('app getPositions error', error);\n      this.appService.requestStatusEvent$.next(error.error.message +  ', ' + error.message);\n    });\n  }\n\n  includePosPnLInSum1(pos: Position) {\n    pos.includeInSum1 = !pos.includeInSum1;\n  }\n  includePosPnLInSum2(pos: Position) {\n    pos.includeInSum2 = !pos.includeInSum2;\n  }\n  includePosPnLInSum3(pos: Position) {\n    pos.includeInSum3 = !pos.includeInSum3;\n  }\n  includePosPnLInSum4(pos: Position) {\n    pos.includeInSum4 = !pos.includeInSum4;\n  }\n\n  getPositionsPnLSum(num: number) {\n    let sum = 0;\n    if (this.positions) {\n      this.positions.forEach(pos => {\n        if (num === 1 && pos.includeInSum1) {\n          sum += pos.pnl;\n        }\n        if (num === 2 && pos.includeInSum2) {\n          sum += pos.pnl;\n        }\n        if (num === 3 && pos.includeInSum3) {\n          sum += pos.pnl;\n        }\n        if (num === 4 && pos.includeInSum4) {\n          sum += pos.pnl;\n        }\n      });\n      sum = Math.round((sum + 0.00001) * 100) / 100; // round to 2 decimal places\n      this.positionsPnL = sum;\n    }\n    return sum;\n  }\n\n  mapPositions(res) {\n    this.positions = [];\n    if (AppConstants.RestMode === 'fyers') {\n      if (res.netPositions instanceof Array) {\n        res.netPositions.forEach(pos => {\n          let p = new Position();\n          p.id = pos.id;\n          p.scrip = pos.symbol;\n          p.netQty = pos.netQty;\n          p.buyAvg = pos.buyAvg;\n          p.sellAvg = pos.sellAvg;\n          p.type = pos.productType;\n          p.realizedProfit = pos.realizedProfit;\n          p.pnl = pos.pl;\n          this.positions.push(p);\n        });\n        this.subscribePositionsFeed();\n      }\n    }\n  }\n\n  subscribePositionsFeed() {\n    let sub = [];\n    this.positions.forEach(pos => {\n      let symbol = pos.scrip;\n      symbol = symbol.replace('NSE:', '');\n      let instru = '';\n      if (symbol.startsWith('NIFTY')) {\n        instru = 'NIFTY';\n        symbol = symbol.replace('NIFTY', '');\n      }\n      if (symbol.startsWith('BANKNIFTY')) {\n        instru = 'BANKNIFTY';\n        symbol = symbol.replace('BANKNIFTY', '');\n      }\n      if (symbol.startsWith('USDINR')) {\n        instru = 'USDINR';\n        symbol = symbol.replace('USDINR', '');\n      }\n      let type = '';\n      if (symbol.includes('CE')) {\n        type = 'CE';\n      }\n      if (symbol.includes('PE')) {\n        type = 'PE';\n      }\n      console.log('subscribePositionsFeed symbol: ' + symbol);\n      symbol = symbol.slice(0, -2); // remove CE PE at end\n      let strike = symbol.substring(5);\n      let expiry = symbol.substring(0, 5); // 20N08 20JUN 20911\n      // 20O0812000CE 2091012000CE\n      let expiryDate = '';\n      if (isNaN(expiry as any)) { // 20N08 20JUN\n\n        if (isNaN(parseInt(expiry[4]))) { // 20JUN // checking whether last character is number or not - 20N08 20JUN\n          if (instru === 'NIFTY' || instru === 'BANKNIFTY') {\n            expiryDate = AppConstants.monthlyExpiryDates[expiry].toDateString();\n          }\n          if (instru === 'USDINR') {\n            expiryDate = AppConstants.monthlyExpiryDatesUSDINR[expiry].toDateString();\n          }\n        } else { // 20N08\n          let year = Number(expiry.substring(0, 2)) + 2000;\n          let month = null;\n          if (expiry[2] === 'O') {\n            month = 9;\n          } else if (expiry[2] === 'N') {\n            month = 10;\n          } else if (expiry[2] === 'D') {\n            month = 11;\n          }\n          let date = Number(expiry.substring(3, 5));\n          console.log('subscribePositionsFeed oct nov dec: ', year, month, date);\n          expiryDate = new Date(year, month, date).toDateString();\n        }\n        // console.log('expiryDate', expiryDate);\n      } else { // 20618\n        let year = Number(expiry.substring(0, 2)) + 2000;\n        let month = Number(expiry.substring(2, 3)) - 1;\n        let date = Number(expiry.substring(3, 5));\n        console.log('subscribePositionsFeed: ', year, month, date);\n        expiryDate = new Date(year, month, date).toDateString();\n      }\n\n      let e1 = new Instrument();\n      e1.expiry = expiryDate;\n      e1.instru = instru;\n      e1.strike = Number(strike);\n      e1.type = type;\n      sub.push(e1);\n      /*\n      let e2 = new Instrument();\n      e2.expiry = expiryDate;\n      e2.instru = instru;\n      e2.strike = Number(strike);\n      e2.type = 'PE';\n      sub.push(e2); */\n    });\n    console.log('positions feed', sub);\n    this.appService.sendSubscriptions(sub);\n\n\n    /* let symbol = pos.scrip;\n    symbol = symbol.replace('NSE:', '');\n    let instru = '';\n    if (symbol.includes('NIFTY')) {\n      instru = 'NIFTY';\n      symbol = symbol.replace('NIFTY', '');\n    }\n    if (symbol.includes('USDINR')) {\n      instru = 'USDINR';\n      symbol = symbol.replace('USDINR', '');\n    }\n    let type = '';\n    if (symbol.includes('CE')) {\n      type = 'CE';\n    }\n    if (symbol.includes('PE')) {\n      type = 'PE';\n    }\n    symbol = symbol.slice(0, -2);\n    let strike = symbol.substring(5);\n    let expiry = symbol.substring(0, 5); */\n    // let alice_symbol = instru + expiry + symbol + type;\n  }\n\n  getMastersStatus() {\n    if (AppConstants.abMastersContract.size) {\n      return 'Masters Contract is available';\n    }\n    return 'Masters Contract not available yet';\n  }\n\n  establishWSVendor() {\n    AppConstants.SocketMode = this.ws_vendor;\n    this.appService.getMastersContract(this.ws_access_token);\n  }\n\n  isSocketConnected() {\n    return this.appService.isSocketConnected();\n  }\n\n  getOrders() {\n    console.log('app getting Orders');\n    this.appService.getOrders(this.access_token).subscribe((res: any) => {\n      console.log('app getOrders', res);\n      if (res) {\n        this.lastOrdersUpdateTime = new Date().toLocaleTimeString();\n        this.appService.requestStatusEvent$.next(res);\n        this.mapOrders(res);\n      }\n    },\n    error => {\n      console.log('app getOrders error', error);\n      this.appService.requestStatusEvent$.next(error.error.message +  ', ' + error.message);\n    });\n  }\n\n  mapOrders(res) {\n    this.orders = [];\n    if (AppConstants.RestMode === 'fyers') {\n      if (res.orderBook instanceof Array) {\n        res.orderBook.forEach(order => {\n          let o = new Order();\n          o.id = order.id;\n          o.scrip = order.symbol;\n          o.qty = order.qty;\n          o.status = order.status;\n          o.message = order.message;\n          o.type = order.type;\n          o.limit = order.limitPrice;\n          o.stop = order.stopPrice;\n          o.tradedPrice = order.tradedPrice;\n          o.side = order.side;\n          o.orderDateTime = order.orderDateTime;\n          this.orders.push(o);\n        });\n      }\n    }\n  }\n\n  getCMP() {\n    return 0.0;\n  }\n\n  getOrderStatus(status: number) {\n    if (status === 1) {\n      return 'Cancelled';\n    } else if (status === 2) {\n      return 'Filled';\n    } else if (status === 3) {\n      return 'Unknown';\n    } else if (status === 4) {\n      return 'Transit';\n    } else if (status === 5) {\n      return 'Rejected';\n    } else if (status === 6) {\n      return 'Pending';\n    }\n  }\n\n  getOrderType(type: number) {\n    if (type === 1) {\n      return 'Limit';\n    } else if (type === 2) {\n      return 'Market';\n    } else if (type === 3) {\n      return 'SL-M';\n    } else if (type === 4) {\n      return 'SL';\n    }\n  }\n\n  newOrder(side: number) {\n    let symbol = 'NSE:' + this.newexpiry + this.newstrike + this.newoption;\n    this.appService.placeOrder(this.access_token, symbol, this.newqty, this.newOrderType, side,\n                                this.newProductType, this.newlimit, this.newstop)\n      .subscribe((res: any) => {\n        console.log('app newOrder', res);\n        this.refreshAll();\n        if (res) {\n          this.appService.requestStatusEvent$.next(res);\n        }\n      },\n      error => {\n        console.log('app newOrder error', error);\n        this.appService.requestStatusEvent$.next(error.error.message +  ', ' + error.message);\n        this.refreshAll();\n      });\n  }\n\n  resetNewOrder() {\n    this.newexpiry = 'NIFTY20618';\n    this.newstrike = 10000;\n    this.newoption = 'CE';\n    this.newqty = 50;\n    this.newblock = 0;\n    this.newOrderType = 2;\n    this.newProductType = 'INTRADAY';\n    this.newlimit = 0;\n    this.newstop = 0;\n  }\n\n  exitSelected() {\n    if (this.positions) {\n      if (confirm('Exit Selected?')) {\n        this.positions.forEach(pos => {\n          if (pos.includeInSum1 || pos.includeInSum2 || pos.includeInSum3 || pos.includeInSum4) {\n            this.exitPosition(pos, true);\n          }\n        });\n      }\n    }\n  }\n\n  exitPosition(pos: Position, isExitSelected = false) {\n    let qty = Number(((document.getElementById('pos-qty-' + pos.id)) as HTMLInputElement).value);\n    /* let limit = ((document.getElementById('pos-limit-' + pos.id)) as HTMLInputElement).value; */\n\n    if (!qty) {\n      qty = Math.abs(pos.netQty);\n    }\n\n    let buysell = 0;\n    if (pos.netQty > 0) {\n      buysell = -1;\n    } else if (pos.netQty < 0) {\n      buysell = 1;\n    }\n\n    let orderType = 2; // MARKET\n    console.log('placing order: ', pos.scrip, qty, orderType, buysell, pos.type, 0);\n    let user_confirm = isExitSelected;\n\n    if (isExitSelected === false) {\n      user_confirm = confirm('Exit ' + qty + ' Qty with ' + (buysell === -1 ? 'Sell order' : 'Buy order') + ' Sure?');\n    }\n\n    if (user_confirm) {\n      this.appService.placeOrder(this.access_token, pos.scrip, qty, orderType, buysell,\n                                  pos.type, 0, 0)\n        .subscribe((res: any) => {\n          console.log('app exitPosition', res);\n          this.refreshAll();\n          if (res) {\n            this.appService.requestStatusEvent$.next(res);\n            this.appService.playAudio('success');\n          }\n        },\n        error => {\n          console.log('app exitPosition error', error);\n          this.appService.requestStatusEvent$.next(error.error.message +  ', ' + error.message);\n          this.refreshAll();\n          this.appService.playAudio('error');\n        });\n    }\n  }\n\n  refreshAll() {\n    this.getFunds();\n    this.getPositions();\n    this.getOrders();\n  }\n\n  addToStrategyBuilder(oc, type) {\n    this.appService.payOffEvent$.next( { symbol: oc.symbol + type, ltp: this.getLtp(oc.symbol + type), qty: this.qty_default } );\n  }\n\n  addToChart(oc, type) {\n    this.appService.chartEvent$.next( { symbol: oc.symbol + type, type: type } );\n  }\n\n  getQtyOfStrikeInStrategy(strike) { // 73.5CE\n    let curr_positions_trades = AppConstants.curr_positions_trades;\n    if (curr_positions_trades) {\n      for (let i = 0; i < curr_positions_trades.length; i++) {\n        let element = curr_positions_trades[i];\n        /* {\n          qty: 50,\n          scrip: '11150CE',\n          expiry: '01OCT2020',\n          entry: 50,\n          exit: 0,\n        }, */\n        let ocDate = new Date(this.oc_year, this.oc_month - 1, this.oc_date);\n        let strikeExpiry = new Date(element.expiry);\n        if (ocDate.getDate() === strikeExpiry.getDate() && element.scrip === strike && element.exit === 0) {\n          return element.qty;\n        }\n      }\n      return null;\n    }\n  }\n\n  getCostOfStrikeInStrategy(strike) { // 73.5CE\n    let curr_positions_trades = AppConstants.curr_positions_trades;\n    if (curr_positions_trades) {\n      for (let i = 0; i < curr_positions_trades.length; i++) {\n        let element = curr_positions_trades[i];\n        /* {\n          qty: 50,\n          scrip: '11150CE',\n          expiry: '01OCT2020',\n          entry: 50,\n          exit: 0,\n        }, */\n        let ocDate = new Date(this.oc_year, this.oc_month - 1, this.oc_date);\n        let strikeExpiry = new Date(element.expiry);\n        if (ocDate.getDate() === strikeExpiry.getDate() && element.scrip === strike && element.exit === 0) {\n          return element.entry;\n        }\n      }\n      return null;\n    }\n  }\n\n  isStrikeInCurrStrategy(strike) { // 73.5CE\n    let curr_positions_trades = AppConstants.curr_positions_trades;\n    if (curr_positions_trades) {\n      for (let i = 0; i < curr_positions_trades.length; i++) {\n        let element = curr_positions_trades[i];\n        /* {\n          qty: 50,\n          scrip: '11150CE',\n          expiry: '01OCT2020',\n          entry: 50,\n          exit: 0,\n        }, */\n\n        let ocDate = new Date(this.oc_year, this.oc_month - 1, this.oc_date);\n        let strikeExpiry = new Date(element.expiry);\n        if (element.exit === 0 && ocDate.getDate() === strikeExpiry.getDate() && element.scrip === strike) {\n          return true;\n        }\n      }\n      return false;\n    }\n  }\n\n  ocOrder(buysell: number, optionType: string, oc) {\n    let symbol = 'NSE:' + oc.symbol + optionType;\n    let strike = oc.strike;\n    let productType = this.oc_product_type;\n\n    let limit: any;\n    console.log('ocOrder qty: ' + 'oc-qty-' + optionType + '-' + oc.symbol);\n    let qty = Number((document.getElementById('oc-qty-' + optionType + '-' + oc.symbol) as HTMLInputElement).value);\n    limit = (document.getElementById('oc-limit-' + optionType + '-' + oc.symbol) as HTMLInputElement).value;\n    /* let block = (document.getElementById('oc-block-' + optionType + '-' + oc.symbol) as HTMLInputElement).value; */\n\n    let orderType = 2; // MARKET\n    if (limit) {\n      orderType = 1; // LIMIT\n    } else {\n      limit = 0;\n    }\n    console.log('placing order: ', symbol, qty, (orderType === 2 ? 'Market' : 'Limit'), buysell, productType, limit);\n    if (true /* confirm(qty + ' Qty, ' + limit + ' Limit, ' + (orderType === 2 ? 'Market' : 'Limit') + ' order ' + 'Sure?') */) {\n      this.appService.placeOrder(this.access_token, symbol, qty, orderType, buysell,\n                                  productType, limit, 0)\n        .subscribe((res: any) => {\n          console.log('app ocOrder', res);\n          this.refreshAll();\n          if (res) {\n            this.appService.requestStatusEvent$.next(symbol + ' ' + qty + ' ' + (orderType === 2 ? 'Market' : 'Limit') + ' ' + res); \n            // Order submitted successfully. Your Order Ref. No.220091778602\n            this.appService.playAudio('success');\n          }\n        },\n        error => {\n          console.log('app ocOrder error', error);\n          this.appService.requestStatusEvent$.next(error.error.message +  ', ' + error.message);\n          this.refreshAll();\n          this.appService.playAudio('error');\n        });\n    }\n  }\n\n  isAnyOpenPosition() {\n    let curr_positions_trades = AppConstants.curr_positions_trades;\n    if (curr_positions_trades) {\n      for (let i = 0; i < curr_positions_trades.length; i++) {\n        let element = curr_positions_trades[i];\n        /* {\n          qty: 50,\n          scrip: '11150CE',\n          expiry: '01OCT2020',\n          entry: 50,\n          exit: 0,\n        }, */\n\n        if (element.exit === 0) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  autoSuggest() {\n    this.findInitialPositions();\n    this.checkAdjustments();\n  }\n\n  findInitialPositions() {\n    this.suggestions = [];\n    if (!this.isAnyOpenPosition()) {\n      for (let index = this.oc_range_lower; index <= this.oc_range_higher; index += this.oc_range_multiple) {\n        //this.oc_strikes.push({symbol: this.oc_instru + this.getExpiry() + index, strike: index, ltp: 0, delta: 0 }); // symbol: NIFTY2061810000 NIFTY20JUN10000\n        let symbol = this.oc_instru + this.getExpiry() + index;\n        let ltp = this.getLtp(symbol + 'CE');\n        if (ltp >= 16 && ltp <= 28) {\n          let delta = this.getDelta(symbol, index, 'CE');\n          if (delta > 0 && Math.abs(delta) < 1) { // on 0DTE, delta is not calculated correctly\n  \n            //console.log(index, ltp, delta);\n            for (let index1 = this.oc_range_lower; index1 <= this.oc_range_higher; index1 += this.oc_range_multiple) {\n              let symbol1 = this.oc_instru + this.getExpiry() + index1;\n              let delta1 = this.getDelta(symbol1, index1, 'PE');\n  \n              if (Math.abs(delta + delta1) <= 0.025) {\n                let ltp1 = this.getLtp(symbol1 + 'PE');\n                if (ltp1) {\n                  this.suggestions.push({ strikeCE: index, deltaCE: delta, ltpCE: ltp, strikePE: index1, deltaPE: delta1, ltpPE: ltp1 });\n                }\n              }\n            }\n          }\n        }\n      }\n      // console.log(this.suggestions);\n    }\n  }\n\n  checkAdjustments() {\n    let curr_positions_trades = AppConstants.curr_positions_trades;\n    let ceDelta = 0;\n    let cePremium = 0;\n    let ceQty = 0;\n    let peDelta = 0;\n    let pePremium = 0;\n    let peQty = 0;\n    this.adjust_sugg = [];\n    this.combined_premium = 0;\n    if (curr_positions_trades) {\n      for (let i = 0; i < curr_positions_trades.length; i++) {\n        let element = curr_positions_trades[i];\n        /* {\n          qty: 50,\n          scrip: '11150CE',\n          expiry: '01OCT2020',\n          entry: 50,\n          exit: 0,\n        }, */\n\n        let ocDate = new Date(this.oc_year, this.oc_month - 1, this.oc_date);\n        let strikeExpiry = new Date(element.expiry);\n        if (element.exit === 0 && element.qty < 0) { // calculating delta and premiums of only sold positions\n          \n          let type = '';\n          if (element.scrip.includes('CE')) {\n            type = 'CE';\n          }\n          if (element.scrip.includes('PE')) {\n            type = 'PE';\n          }\n          let index = element.scrip.slice(0, -2);\n\n          let symbol = this.oc_instru + this.getExpiry() + index;\n          let delta = this.getDelta(symbol, index, type) * element.qty;\n          let ltp = this.getLtp(symbol + type) * element.qty;\n\n          if (type === 'CE') {\n            cePremium += ltp;\n            ceDelta += delta;\n            ceQty += element.qty;\n          } else if (type === 'PE') {\n            pePremium += ltp;\n            peDelta += delta;\n            peQty += element.qty;\n          }\n        }\n      }\n      if (cePremium !== 0 && pePremium !== 0) {\n        cePremium = cePremium / ceQty;\n        pePremium = pePremium / peQty;\n        this.combined_premium = cePremium + pePremium;\n        this.combined_premium = (Math.round((this.combined_premium + 0.00001) * 100) / 100);\n        if (this.combined_SL && this.combined_premium >= this.combined_SL) {\n          this.appService.playAudio('warn');\n        }\n      }\n      if (ceDelta !== 0 && peDelta !== 0 && cePremium && pePremium) {\n        ceDelta = ceDelta / ceQty;\n        peDelta = peDelta / peQty;\n        if (Math.abs(ceDelta + peDelta) > 0.04) {\n          // console.log('mismatch');\n          \n          this.roll('CE', peDelta);\n          this.roll('PE', ceDelta);\n\n        }\n        // console.log(ceDelta, peDelta, cePremium, pePremium);\n      }\n    }\n  }\n\n  roll(type, delta) { // type = 'PE'\n    for (let index1 = this.oc_range_lower; index1 <= this.oc_range_higher; index1 += this.oc_range_multiple) {\n      let symbol1 = this.oc_instru + this.getExpiry() + index1;\n      let delta1 = this.getDelta(symbol1, index1, type);\n\n      if (Math.abs(delta + delta1) <= 0.025) {\n        let ltp1 = this.getLtp(symbol1 + type);\n        if (ltp1) {\n          this.adjust_sugg.push({ action: 'Adjust ' + type, strike: index1 + type, ltp: ltp1 });\n        }\n      }\n    }\n  }\n\n  sortTableColumn(colName) {\n    console.log('sort');\n    this.holdings.sort((a, b) => {\n      // console.log(a['scrip'], b['scrip']);\n      if (a['scrip'] === 'NIFTY 50') {\n        return -1;\n      }\n      if (b['scrip'] === 'NIFTY 50') {\n        return 1;\n      }\n      return a[colName] > b[colName] ? -1 : a[colName] < b[colName] ? 1 : 0\n\n      // 1 means b before a\n      // -1 means a before b\n    });\n  }\n\n  fetchStocks() {\n    this.holdingsService.fetchStocksData();\n  }\n\n  loadHoldings() {\n    let r = this.holdingsService.loadHoldings();\n    this.portfolio_return = r['portfolio_return'];\n    this.holdings = r['holdings'];\n    this.total_inv = r['total_inv'];\n    this.current_val = r['current_val'];\n    console.log('stocks:', this.holdings);\n  }\n\n  backtestStocks() {\n    this.holdingsService.backtestStocks();\n  }\n\n  exportBacktest() {\n    this.holdingsService.exportBacktest();\n  }\n\n  isStockHolding(scrip) {\n    if (AppConstants.holdings[scrip].avgp) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  updateOCRange() {\n\n    this.is_monthly_expiry = false;\n    let enteredDate = new Date(this.oc_year, this.oc_month - 1, this.oc_date);\n\n    let tempmonthlyExpiryDates = AppConstants.monthlyExpiryDates;\n    if (this.oc_instru === 'USDINR') {\n      tempmonthlyExpiryDates = AppConstants.monthlyExpiryDatesUSDINR;\n    }\n    for (let key in tempmonthlyExpiryDates) {\n      if (tempmonthlyExpiryDates.hasOwnProperty(key)) {\n          // console.log(key + \" -> \" + this.tempmonthlyExpiryDates[key] + ' ' + enteredDate);\n          if (enteredDate.getTime() === tempmonthlyExpiryDates[key].getTime()) {\n            console.log('monthly expiry matched');\n            this.is_monthly_expiry = true;\n            break;\n          }\n      }\n    }\n\n    this.oc_strikes = [];\n    for (let index = this.oc_range_lower; index <= this.oc_range_higher; index += this.oc_range_multiple) {\n      this.oc_strikes.push({symbol: this.oc_instru + this.getExpiry() + index, strike: index, ltp: 0, delta: 0 }); // symbol: NIFTY2061810000 NIFTY20JUN10000\n    }\n\n    if (!AppConstants.isSimulatedStrategy) {\n      let sub = [];\n      this.oc_strikes.forEach(oc => {\n        let e1 = new Instrument();\n        e1.expiry = new Date(this.oc_year, this.oc_month - 1, this.oc_date).toDateString();\n        e1.instru = this.oc_instru;\n        e1.strike = Number(oc.strike);\n        e1.type = 'CE';\n        sub.push(e1);\n        let e2 = new Instrument();\n        e2.expiry = new Date(this.oc_year, this.oc_month - 1, this.oc_date).toDateString();\n        e2.instru = this.oc_instru;\n        e2.strike = Number(oc.strike);\n        e2.type = 'PE';\n        sub.push(e2);\n      });\n      console.log('updateOCRange Subscriptions: ' + sub);\n      this.appService.sendSubscriptions(sub);\n    }\n    \n  }\n\n  clearOC() {\n    this.oc_strikes = [];\n  }\n\n  getSpotValue() {\n    let underlying = '';\n    if (this.oc_instru === 'NIFTY') {\n      underlying = 'NIFTY50';\n    } else if (this.oc_instru === 'BANKNIFTY') {\n      underlying = 'BANKNIFTY';\n    } else if (this.oc_instru === 'USDINR') {\n      underlying = 'USDINR_FUT';\n    }\n    let e = this.getLtp(underlying);\n    return e;\n  }\n\n  updateSpotStrike() {\n    let underlying = '';\n    if (this.oc_instru === 'NIFTY') {\n      underlying = 'NIFTY50';\n    } else if (this.oc_instru === 'BANKNIFTY') {\n      underlying = 'BANKNIFTY';\n    } else if (this.oc_instru === 'USDINR') {\n      underlying = 'USDINR_FUT';\n    }\n    let e = this.getLtp(underlying);\n\n    let spotStrike = (Math.round(e / this.oc_range_multiple) * this.oc_range_multiple);\n\n    /* let symbol = this.oc_instru + this.getExpiry() + spotStrike;\n\n    let ce_premium = this.getLtp(symbol + 'CE');\n    let pe_premium = this.getLtp(symbol + 'PE');\n    let targetStrike = ce_premium - pe_premium + spotStrike;\n    targetStrike = (Math.round(targetStrike / this.oc_range_multiple) * this.oc_range_multiple); */\n\n    // targetStrike:72.75 74.25 0.0975 0.15 74.25\n    // console.log('oc targetStrike:' + symbol + ' ' + targetStrike + ' ' + ce_premium + ' ' + pe_premium + ' ' + spotStrike);\n\n    this.ocSpotStrike = spotStrike; // targetStrike;\n  }\n\n  isSpotStrike(strike) {\n    /* let underlying = '';\n    if (this.oc_instru === 'NIFTY') {\n      underlying = 'NIFTY50';\n    } else if (this.oc_instru === 'BANKNIFTY') {\n      underlying = 'BANKNIFTY';\n    } else if (this.oc_instru === 'USDINR') {\n      underlying = 'USDINR_FUT';\n    }\n    let e = this.getLtp(underlying);\n    if ((Math.round(e / this.oc_range_multiple) * this.oc_range_multiple) === strike) {\n      return true;\n    }\n    return false; */\n\n    if (strike === this.ocSpotStrike) {\n      return true;\n    } \n    return false;\n  }\n\n  getPosLTP(position: Position) {\n    let symbol = position.scrip;\n    symbol = symbol.replace('NSE:', '');\n    /* let instru = '';\n    if (symbol.includes('NIFTY')) {\n      instru = 'NIFTY';\n      symbol = symbol.replace('NIFTY', '');\n    }\n    if (symbol.includes('USDINR')) {\n      instru = 'USDINR';\n      symbol = symbol.replace('USDINR', '');\n    }\n    let type = '';\n    if (symbol.includes('CE')) {\n      type = 'CE';\n    }\n    if (symbol.includes('PE')) {\n      type = 'PE';\n    }\n    symbol = symbol.slice(0, -2);\n    // if positions contains another expiry?\n    symbol = symbol.substring(5); // remove the expiry string\n    let alice_symbol = instru + symbol + type; */\n    position.cmp = this.getLtp(symbol);\n    return position.cmp;\n  }\n\n  getPosPnL(position: Position) {\n    // return position.realizedProfit;\n    if (position.cmp) {\n      let pnl = null;\n      let realizedProfit = 0;\n      if (position.realizedProfit) {\n        realizedProfit = position.realizedProfit;\n      }\n      if (position.netQty === 0) {\n        return position.pnl;\n      }\n      if (position.netQty > 0) {\n        let p = (position.cmp - position.buyAvg) * position.netQty;\n        pnl = realizedProfit + p;\n      } else if (position.netQty < 0) {\n        let p = (position.sellAvg - position.cmp) * -position.netQty;\n        pnl = realizedProfit + p;\n      }\n      if (position.scrip.includes('USDINR')) {\n        pnl *= 1000;\n      }\n      position.pnl = (Math.round((pnl + 0.00001) * 100) / 100);\n      return position.pnl;\n    } else {\n      return position.pnl;\n    }\n  }\n\n  // strike in map is NIFTY2061810000CE or NIFTY20JUN10000CE\n\n  getExpiry() {\n    if (this.is_monthly_expiry) {\n      return '' + (this.oc_year - 2000) + AppConstants.monthsMapping[this.oc_month];\n    }\n\n    let expiryMonth = null;\n    if (this.oc_month === 10) {\n      expiryMonth = 'O';\n    } else if (this.oc_month === 11) {\n      expiryMonth = 'N';\n    } else if (this.oc_month === 12) {\n      expiryMonth = 'D';\n    } else {\n      expiryMonth = this.oc_month;\n    }\n\n    return '' + (this.oc_year - 2000) + expiryMonth + ('0' + this.oc_date).slice(-2);//this.oc_date;\n  }\n\n  getLtp(strike: string, oc_strike = null) {\n    // console.log('strike', strike);\n\n    if (strike === 'USDINR_FUT') {\n      let expiryDate: Date = AppConstants.monthlyExpiryDatesUSDINR[AppConstants.year + AppConstants.USDINR_FUT_MONTH];\n      let expiryMonth = null;\n      if (expiryDate.getMonth() + 1 === 10) {\n        expiryMonth = 'O';\n      } else if (expiryDate.getMonth() + 1 === 11) {\n        expiryMonth = 'N';\n      } else if (expiryDate.getMonth() + 1 === 12) {\n        expiryMonth = 'D';\n      } else {\n        expiryMonth = expiryDate.getMonth() + 1;\n      }\n      let expiry = '' + (expiryDate.getFullYear() - 2000) + (expiryMonth) + ('0' + expiryDate.getDate()).slice(-2);\n      strike = 'USDINR' + expiry + AppConstants.USDINR_FUT_MONTH + 'FUT';\n      // console.log('getLtp strike: ' + strike);\n    }\n\n    let ltp = this.mapService.getLtp(strike);\n    if (oc_strike) {\n      oc_strike.ltp = ltp; \n    }\n\n    return ltp;\n  }\n\n  getAtp(strike: string) {\n    return this.mapService.getAtp(strike);\n  }\n\n  getVolume(strike: string) {\n    let volume = this.mapService.getVolume(strike);\n    if (volume) {\n      return volume.toLocaleString();\n    }\n    return volume;\n  }\n\n  getOI(strike: string) {\n    this.mapService.getOI(strike);\n  }\n\n  getChgOI(strike: string) {\n    this.mapService.getChgOI(strike);\n  }\n\n  connectWS() {\n    AppConstants.SocketMode = this.ws_vendor;\n    this.appService.connectWebsocket(this.ws_access_token);\n  }\n\n  includeInStrangleFn(symbol) {\n    if (this.stranglePositions.includes(symbol)) {\n      this.stranglePositions = this.stranglePositions.filter(e => e !== symbol);\n    } else {\n      this.stranglePositions.push(symbol);\n    }\n  }\n\n  includeInDebitSpreadFn(symbol) {\n    if (this.debitSpreadPositions.includes(symbol)) {\n      this.debitSpreadPositions = this.debitSpreadPositions.filter(e => e !== symbol);\n    } else {\n      this.debitSpreadPositions.push(symbol);\n    }\n  }\n\n  getProfitForStrangle() {\n    let pnl = 0.0;\n    let lotsize = 0;\n    if (this.oc_instru === 'NIFTY') {\n      lotsize = 50;\n    } else if (this.oc_instru === 'BANKNIFTY') {\n      lotsize = 25;\n    } else if (this.oc_instru === 'USDINR') {\n      lotsize = 1000;\n    }\n\n    let credit = 0;\n\n    this.stranglePositions.forEach(symbol => {\n      let ltp = this.getLtp(symbol);\n      credit += ltp;\n      // console.log(symbol + ', ltp: ' + ltp);\n      pnl += (ltp * lotsize);\n    });\n    credit = Math.round((credit + 0.00001) * 100) / 100; // round to 2 decimal places\n    return credit + ' , ' + pnl;\n  }\n\n  getPnLForDebitSpread() {\n    let profit = 0.0;\n    let loss = 0.0;\n    let lotsize = 0;\n    let spread = 0;\n    if (this.oc_instru === 'NIFTY') {\n      lotsize = 50;\n      spread = 50;\n    } else if (this.oc_instru === 'BANKNIFTY') {\n      lotsize = 25;\n      spread = 100;\n    } else if (this.oc_instru === 'USDINR') {\n      lotsize = 1000;\n      spread = 0.25;\n    }\n    let pos = []\n    this.debitSpreadPositions.forEach(symbol => {\n      let ltp = this.getLtp(symbol);\n      // console.log(symbol + ', ltp: ' + ltp);\n      pos.push(ltp);\n    });\n    if (pos.length === 2) {\n      let s1 = pos[0];\n      let s2 = pos[1];\n      let debit = Math.abs(s1 - s2);\n      loss = debit * lotsize;\n      profit = (spread - debit) * lotsize;\n      /*\n      Net Debit = Premium Paid for lower strike  Premium Received for higher strike\n      Bull Call Spread Max loss = Net Debit of the Strategy\n      Bull Call Spread Max Profit = Spread  Net Debit\n      */\n    }\n\n    return [profit, loss];\n  }\n\n\n}\n","<div class=\"main-content\">\n\n    <!-- <iframe height=\"480\" width=\"1050\" src=\"https://in.investing.com/indices/s-p-cnx-nifty-chart\"></iframe> -->\n    <!-- <iframe height=\"480\" width=\"1050\" src=\"https://in.investing.com/indices/s-p-cnx-nifty-chart\"></iframe> -->\n    <!-- <button (click)=\"playAudio('success')\">play</button>\n    <button (click)=\"playAudio('error')\">error</button> -->\n    <div class=\"top-content d-flex\">\n        <div class=\"mr-auto\">\n\n            <div class=\"confirmation-check form-check-inline mt-0\">\n                <input class=\"form-check-input\" [(ngModel)]=\"ws_vendor\" type=\"radio\" value=\"aliceblue\" id=\"aliceblue_ws\">\n                <label class=\"form-check-label\" for=\"aliceblue_ws\">Aliceblue</label>\n            </div>\n            <!-- <div class=\"confirmation-check form-check-inline mt-0\">\n                <input class=\"form-check-input\" [(ngModel)]=\"ws_vendor\" type=\"radio\" value=\"angel\" id=\"angel_ws\">\n                <label class=\"form-check-label\" for=\"angel_ws\">Angel</label>\n            </div> -->\n\n            <!-- <button type=\"button\" class=\"btn btn-secondary btn-sm refresh-btn\" (click)=\"refreshWebsocketVendor()\">Refresh WS Vendor</button> -->\n\n            <button type=\"button\" class=\"btn btn-link\" (click)=\"establishWSVendor()\">Connect WS</button>\n\n            <div>\n                <span>{{ getMastersStatus() }}</span>\n                <button *ngIf=\"!access_token\" type=\"button\" class=\"btn btn-link\" (click)=\"login()\">Login</button>\n            </div>\n\n            <div>\n                <span *ngIf=\"isSocketConnected()\">Websocket is connected</span>\n                <span *ngIf=\"!isSocketConnected()\">Websocket is not connected</span>\n                <!-- <button *ngIf=\"!isSocketConnected()\" type=\"button\" class=\"btn btn-link mt-0\" (click)=\"connectWS()\">Connect WS</button> -->\n            </div>\n            <!-- <div class=\"lastRequestStatus\">Last Request Status: {{ lastRequestStatus }}</div> -->\n        </div>\n\n        <div class=\"mr-4 mt-2\">\n            Funds: Total: {{ totalBalance }}, Available: {{ availableBalance }}, Utilized: {{ utilizedBalance }}\n        </div>\n        <div class=\"\">\n            <table class=\"table table-sm table-bordered mb-0\" style=\"width: 200px;\">\n                <tbody>\n                    <tr>\n                        <td style=\"width: 50%\">Nifty</td>\n                        <td>{{ getLtp('NIFTY50') }}</td>\n                    </tr>\n            </table>\n        </div>\n\n        <div class=\"ml-1\">\n            <table class=\"table table-sm table-bordered mb-0\" style=\"width: 200px;\">\n                <tbody>\n                    <tr>\n                        <td style=\"width: 50%\">BNF</td>\n                        <td>{{ getLtp('BANKNIFTY') }}</td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n\n        <div class=\"ml-1\">\n            <table class=\"table table-sm table-bordered mb-0\" style=\"width: 220px;\">\n                <tbody>\n                    <tr>\n                        <td style=\"width: 50%\">USDINR {{ getUSDINRMonth() }} FUT</td>\n                        <td>{{ getLtp('USDINR_FUT') }}</td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n\n        <!-- <div class=\"ml-1\">\n            <table class=\"table table-sm table-bordered mb-0\" style=\"width: 200px;\">\n                <tbody>\n                    <tr>\n                        <td>USDINR Spot</td>\n                        <td>{{ getLtp('USDINR') }}</td>\n                    </tr>\n                    <tr>\n                        <td>USDINR {{ getUSDINRMonth() }} FUT</td>\n                        <td>{{ getLtp('USDINR_FUT') }}</td>\n                    </tr>\n                </tbody>\n            </table>\n        </div> -->\n    </div>\n\n    <!-- Nifty Jun Fut: {{ getLtp('NIFTYJUNFUT') }}\n    BNF Jun Fut: {{ getLtp('BANKNIFTYJUNFUT') }} -->\n    \n    <hr style=\"margin-top: 0.5rem;\" />\n\n    <button type=\"button\" class=\"btn btn-secondary btn-sm refresh-btn\" (click)=\"refreshAll()\">Refresh All</button>\n    <span>Positions last update: {{ lastPositionsUpdateTime }} | Orders last update: {{ lastOrdersUpdateTime }}</span>\n\n    <div class=\"flex-container\">\n        <div class=\"positions_div\">\n            <div class=\"table-title\">\n                <span class=\"font-weight-bold\">Positions</span>\n                <span class=\"pl-4 pr-4\">|</span>\n                <span class=\"positions-sum font-weight-bold\">\n                    P&L1: \n                    <span [ngClass]=\"{\n                        'text-danger': getPositionsPnLSum(1) < 0,\n                        'text-success': getPositionsPnLSum(1) > 0\n                      }\">\n                      {{ getPositionsPnLSum(1) }}\n                    </span>\n                </span>\n                <span class=\"pl-2 pr-2\">|</span>\n                <span class=\"positions-sum font-weight-bold\">\n                    P&L2: \n                    <span [ngClass]=\"{\n                        'text-danger': getPositionsPnLSum(2) < 0,\n                        'text-success': getPositionsPnLSum(2) > 0\n                      }\">\n                      {{ getPositionsPnLSum(2) }}\n                    </span>\n                </span>\n                <span class=\"pl-2 pr-2\">|</span>\n                <span class=\"positions-sum font-weight-bold\">\n                    P&L3: \n                    <span [ngClass]=\"{\n                        'text-danger': getPositionsPnLSum(3) < 0,\n                        'text-success': getPositionsPnLSum(3) > 0\n                      }\">\n                      {{ getPositionsPnLSum(3) }}\n                    </span>\n                </span>\n                <span class=\"pl-2 pr-2\">|</span>\n                <span class=\"positions-sum font-weight-bold\">\n                    P&L4: \n                    <span [ngClass]=\"{\n                        'text-danger': getPositionsPnLSum(4) < 0,\n                        'text-success': getPositionsPnLSum(4) > 0\n                      }\">\n                      {{ getPositionsPnLSum(4) }}\n                    </span>\n                </span>\n                <div class=\"ml-auto float-right\">\n                    <div class=\"form-check-inline\">\n                        <label class=\"form-check-label mr-1\" for=\"hide-positions\">Hide</label>\n                        <input class=\"form-check-input mr-2\" [(ngModel)]=\"hide_positions\" type=\"checkbox\" value=\"\" id=\"hide-positions\">                        \n                    </div>\n                    <button [disabled]=\"disable_order_buttons\" type=\"button\" class=\"btn btn-secondary btn-sm refresh-btn\" (click)=\"exitSelected()\">Exit selected</button>\n                </div>\n                \n            </div>\n            <table class=\"table table-sm table-bordered shadow text-center\"><!-- table-responsive -->\n                <thead class=\"thead-light\">\n                    <tr>\n                        <!-- <th scope=\"col\">#</th> -->\n                        <th></th>\n                        <th scope=\"col\">Symbol</th>\n                        <th scope=\"col\">Type</th>\n                        <th scope=\"col\">NetQty</th>\n                        <th scope=\"col\">BuyAvg</th>\n                        <th scope=\"col\">SellAvg</th>\n                        <th scope=\"col\">CMP</th>\n                        <th scope=\"col\">PnL</th>\n                        <th scope=\"col\"></th>\n                    </tr>\n                </thead>\n                <tbody *ngIf=\"!hide_positions\">\n                    <tr *ngFor=\"let pos of positions; index as i\">\n                        <!-- <th scope=\"row\">{{ i + 1 }}</th> -->\n                        <td>\n                            <div class=\"form-check-inline posCheckbox\">\n                                <input class=\"form-check-input\" (change)=\"includePosPnLInSum1(pos)\" type=\"checkbox\" value=\"\">\n                            </div>\n                            <div class=\"form-check-inline posCheckbox\">\n                                <input class=\"form-check-input\" (change)=\"includePosPnLInSum2(pos)\" type=\"checkbox\" value=\"\">\n                            </div>\n                            <div class=\"form-check-inline posCheckbox\">\n                                <input class=\"form-check-input\" (change)=\"includePosPnLInSum3(pos)\" type=\"checkbox\" value=\"\">\n                            </div>\n                            <div class=\"form-check-inline posCheckbox\">\n                                <input class=\"form-check-input\" (change)=\"includePosPnLInSum4(pos)\" type=\"checkbox\" value=\"\">\n                            </div>\n                        </td>\n                        <td class=\"font-weight-bold\">{{ pos.scrip }}</td>\n                        <td>{{ pos.type}}</td>\n                        <td>{{ pos.netQty}}</td>\n                        <td>{{ pos.buyAvg}}</td>\n                        <td>{{ pos.sellAvg}}</td>\n                        <td>{{ getPosLTP(pos) }}</td>\n                        <td class=\"font-weight-bold\" [ngClass]=\"{\n                            'text-danger': pos.pnl < 0,\n                            'text-success': pos.pnl > 0\n                          }\">{{ getPosPnL(pos) }}</td>\n                        <td>\n                            <div class=\"positions-row-actions\">\n                                <input type=\"number\" placeholder=\"Qty\" id=\"pos-qty-{{pos.id}}\" class=\"pos-input form-control form-control-sm\"/>\n                                <!-- <input type=\"number\" placeholder=\"Limit\" id=\"pos-limit-{{pos.id}}\" class=\"pos-input form-control form-control-sm\"/> -->\n                                <!-- <input type=\"number\" placeholder=\"Block\" id=\"pos-block-{{pos.id}}\" class=\"pos-input form-control form-control-sm\"/> -->\n                                <button [disabled]=\"disable_order_buttons\" type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"exitPosition(pos)\">Exit</button>\n                            </div>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n\n            <!-- <div class=\"new-order-div shadow\">\n                <div class=\"font-weight-bold\">New Order</div>\n                <div>\n                    <div class=\"input-group input-group-sm new-input-prepend\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Expiry</div>\n                        </div>\n                        <input [(ngModel)]=\"newexpiry\" \n                            (ngModelChange)=\"newexpiry = $event.toUpperCase()\"\n                            type=\"text\" class=\"form-control\"/>\n                    </div>\n                    <div class=\"input-group input-group-sm new-input-prepend\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Strike</div>\n                        </div>\n                        <input [(ngModel)]=\"newstrike\" \n                            (ngModelChange)=\"newstrike = $event.toUpperCase()\"\n                            type=\"number\" class=\"form-control\" min=\"0\" step=\"50\"/>\n                    </div>\n                    <select class=\"new-input form-control form-control-sm\" [(ngModel)]=\"newoption\">\n                        <option value=\"CE\">CE</option>\n                        <option value=\"PE\">PE</option>\n                    </select>\n                    <select class=\"new-input form-control form-control-sm\" [(ngModel)]=\"newProductType\">\n                        <option value=\"INTRADAY\">INTRADAY</option>\n                        <option value=\"MARGIN\">MARGIN</option>\n                    </select>\n                    <select class=\"new-input form-control form-control-sm\" [(ngModel)]=\"newOrderType\">\n                        <option value=2>MARKET</option>\n                        <option value=1>LIMIT</option>\n                        <option value=3>SL-M</option>\n                        <option value=4>SL-L</option>\n                    </select>\n                </div>\n                <div>\n                    <div class=\"input-group input-group-sm new-input-prepend\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Qty</div>\n                        </div>\n                        <input [(ngModel)]=\"newqty\" type=\"number\" class=\"form-control\" min=\"0\" step=\"50\" />\n                    </div>\n                    <div class=\"input-group input-group-sm new-input-prepend\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Block</div>\n                        </div>\n                        <input [(ngModel)]=\"newblock\" type=\"number\" class=\"form-control\"/>\n                    </div>\n                    <div class=\"input-group input-group-sm new-input-prepend\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Limit</div>\n                        </div>\n                        <input [(ngModel)]=\"newlimit\" type=\"number\" class=\"form-control\"/>\n                    </div>\n                    <div class=\"input-group input-group-sm new-input-prepend\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Stop</div>\n                        </div>\n                        <input [(ngModel)]=\"newstop\" type=\"number\" class=\"form-control\"/>\n                    </div>\n                </div>\n                <div>\n                    CMP: {{ getCMP() }}\n                </div>\n                <button type=\"button\" class=\"btn btn-primary btn-sm new-input-btn\" (click)=\"newOrder(1)\">Buy</button>\n                <button type=\"button\" class=\"btn btn-danger btn-sm new-input-btn\" (click)=\"newOrder(-1)\">Sell</button>\n                <button type=\"button\" class=\"btn btn-secondary btn-sm new-input-btn\" (click)=\"resetNewOrder()\">Reset</button>\n                <div class=\"confirmation-check form-check\">\n                    <input class=\"form-check-input\" type=\"checkbox\" value=\"\" id=\"conf-check\">\n                    <label class=\"form-check-label\" for=\"conf-check\">\n                        Show confirmation dialog before sending order\n                    </label>\n                </div>\n            </div> -->\n        </div>\n\n        <div class=\"orderbook_div\">\n            <div class=\"table-title\">\n                <div class=\"d-flex\">\n                    <span class=\"font-weight-bold\">Orders</span>\n                    <div class=\"form-check-inline ml-auto\">\n                        <label class=\"form-check-label mr-1\" for=\"hide-orders\">Hide</label>\n                        <input class=\"form-check-input\" [(ngModel)]=\"hide_orders\" type=\"checkbox\" value=\"\" id=\"hide-orders\">                        \n                    </div>\n                </div>                \n            </div>\n            <table class=\"table table-sm table-bordered shadow text-center\">\n                <thead class=\"thead-light\">\n                    <tr>\n                        <th scope=\"col\">Symbol</th>\n                        <th scope=\"col\">Status</th>\n                        <th scope=\"col\">B/S</th>\n                        <th scope=\"col\">Qty</th>\n                        <th scope=\"col\">Type</th>\n                        <th scope=\"col\">Limit</th>\n                        <th scope=\"col\">Stop</th>\n                        <th scope=\"col\">Price</th>\n                        <th scope=\"col\">Time</th>\n                        <th scope=\"col\">Message</th>\n                    </tr>\n                </thead>\n                <tbody *ngIf=\"!hide_orders\">\n                    <tr *ngFor=\"let ord of orders; index as i\">\n                        <td>{{ ord.scrip }}</td>\n                        <td>{{ getOrderStatus(ord.status) }}</td>\n                        <td>{{ ord.side === 1 ? 'B':'S' }}</td>\n                        <td>{{ ord.qty }}</td>\n                        <td>{{ getOrderType(ord.type) }}</td>\n                        <td>{{ ord.limit }}</td>\n                        <td>{{ ord.stop }}</td>\n                        <td>{{ ord.tradedPrice }}</td>\n                        <td>{{ ord.orderDateTime }}</td>\n                        <td>{{ ord.message }}</td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n    </div>\n\n    <hr/>\n\n    <div class=\"form-check text-center\" style=\"font-size: 18px;\">\n        <input class=\"form-check-input\" [(ngModel)]=\"disable_order_buttons\" type=\"checkbox\" value=\"\" id=\"disable-order-buttons\"> \n        <label class=\"form-check-label\" for=\"disable-order-buttons\">Disable order buttons</label>                      \n    </div>\n    \n    <hr/>\n\n    <div class=\"accordion mb-2\" id=\"accordionHistorical\">\n        <div class=\"card\">\n            \n            <button class=\"btn btn-light font-weight-bold\" type=\"button\" data-toggle=\"collapse\" data-target=\"#historicalSection\" aria-expanded=\"false\" aria-controls=\"holdingsSection\">\n                Historical\n            </button>\n    \n            <div id=\"historicalSection\" class=\"collapse hide p-2\" aria-labelledby=\"headingOne\" data-parent=\"#accordionHistorical\">\n\n                <div class=\"historical_input mb-2\">\n                    <label class=\"historical_label\" for=\"historical_append\">Append</label>\n                    <input name=\"historical_append\" placeholder=\"historical_append\" [(ngModel)]=\"historical_append\" class=\"mr-2 form-control form-control-sm\"/>\n                </div>\n\n                <div class=\"historical_input mb-2\">\n                    <label class=\"historical_label\" for=\"zerodha_auth\">Authorization</label>\n                    <input name=\"zerodha_auth\" placeholder=\"zerodha_auth\" [(ngModel)]=\"zerodha_auth\" class=\"mr-2 form-control form-control-sm\"/>\n                </div>\n\n                <div class=\"historical_input mb-2\">\n                    <label class=\"historical_label\" for=\"zerodha_marketwatch\">Marketwatch</label>\n                    <textarea name=\"zerodha_marketwatch\" [(ngModel)]=\"zerodha_marketwatch\" rows=\"5\" style=\"width: 100%\"></textarea>\n                </div>\n\n                <div class=\"historical_input mb-2\">\n                    <label class=\"historical_label\" for=\"zerodha_from_date\">From Date</label>\n                    <input name=\"zerodha_from_date\" placeholder=\"zerodha_from_date\" [(ngModel)]=\"zerodha_from_date\" class=\"mr-2 form-control form-control-sm\"/>\n                </div>\n\n                <div class=\"historical_input mb-2\">\n                    <label class=\"historical_label\" for=\"zerodha_to_date\">To Date</label>\n                    <input name=\"zerodha_to_date\" placeholder=\"zerodha_to_date\" [(ngModel)]=\"zerodha_to_date\" class=\"mr-2 form-control form-control-sm\"/>\n                </div>\n\n                <div class=\"historical_input mb-2\">\n                    <label class=\"historical_label\" for=\"zerodha_expiry_date\">Expiry Date</label>\n                    <input name=\"zerodha_expiry_date\" placeholder=\"zerodha_expiry_date\" [(ngModel)]=\"zerodha_expiry_date\" class=\"mr-2 form-control form-control-sm\"/>\n                </div>\n\n                <button type=\"button\" class=\"btn btn-link\" (click)=\"fetchHistorical()\">Fetch Historical</button>\n                <button type=\"button\" class=\"btn btn-link\" (click)=\"exportHistorical()\">Export</button>\n                \n            </div>\n    \n        </div>\n    </div>\n\n    <div class=\"accordion mb-2\" id=\"accordionHoldings\">\n        <div class=\"card\">\n            \n            <button class=\"btn btn-light font-weight-bold\" type=\"button\" data-toggle=\"collapse\" data-target=\"#holdingsSection\" aria-expanded=\"true\" aria-controls=\"holdingsSection\">\n                Stocks\n            </button>\n    \n            <div id=\"holdingsSection\" class=\"collapse show p-2\" aria-labelledby=\"headingOne\" data-parent=\"#accordionHoldings\">\n\n                <div>Portfolio return: {{ portfolio_return }}% Total inv.: {{ total_inv }} Current val.: {{ current_val }}</div>\n                <table class=\"table table-sm table-bordered shadow mb-0 text-center\">\n                    <thead class=\"thead-light\">\n                        <tr>\n                            <th class=\"oc-col\" scope=\"col\">Scrip</th>\n                            <th class=\"oc-col\" scope=\"col\">LTP</th>\n                            <!-- <th (click)=\"sortTableColumn('volume')\" class=\"oc-col\" scope=\"col\">Volume</th> -->\n                            <th (click)=\"sortTableColumn('oned')\" class=\"oc-col\" scope=\"col\">1D%</th>\n                            <th (click)=\"sortTableColumn('onew')\" class=\"oc-col\" scope=\"col\">1W%</th>\n                            <th (click)=\"sortTableColumn('onem')\" class=\"oc-col\" scope=\"col\">1M%</th>\n                            <th (click)=\"sortTableColumn('threem')\" class=\"oc-col\" scope=\"col\">3M%</th>\n                            <th (click)=\"sortTableColumn('fiftytwow')\" class=\"oc-col\" scope=\"col\">52W H%</th>\n                            <th (click)=\"sortTableColumn('avgp')\" class=\"oc-col\" scope=\"col\">Avg%</th>\n                            <th (click)=\"sortTableColumn('support')\" class=\"oc-col\" scope=\"col\">Support</th>\n                            <th (click)=\"sortTableColumn('resistance')\" class=\"oc-col\" scope=\"col\">Resistance</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr *ngFor=\"let h of holdings; index as i\">\n                            <td [ngClass]=\"{ 'stockHolding': isStockHolding(h.scrip) }\">{{ h.scrip }}</td>\n                            <td>{{ h.ltp }}</td>\n                            <!-- <td>{{ h.volume }}</td> -->\n                            <td [ngClass]=\"{ 'green': h.oned > 0, 'red': h.oned < 0, 'bold-higher': h.oned > 2 || h.oned < -2 }\">{{ h.oned }}</td>\n                            <td [ngClass]=\"{ 'green': h.onew > 0, 'red': h.onew < 0, 'bold-higher': h.onew > 5 || h.onew < -5 }\">{{ h.onew }}</td>\n                            <td [ngClass]=\"{ 'green': h.onem > 0, 'red': h.onem < 0, 'bold-higher': h.onem > 7 || h.onem < -7 }\">{{ h.onem }}</td>\n                            <td [ngClass]=\"{ 'green': h.threem > 0, 'red': h.threem < 0, 'bold-higher': h.threem > 10 || h.threem < -10 }\">{{ h.threem }}</td>\n                            <td [ngClass]=\"{ 'green': h.fiftytwow > 0, 'red': h.fiftytwow < 0, 'bold-higher': h.fiftytwow > 10 || h.fiftytwow < -10 }\">{{ h.fiftytwow }}</td>\n                            <td [ngClass]=\"{ 'green': h.avgp > 0, 'red': h.avgp < 0, 'bold-higher': h.avgp > 5 || h.avgp < -5 }\">{{ h.avgp }}</td>\n                            <td [ngClass]=\"{ 'green': h.support > 0, 'red': h.support < 0, 'bold-higher': h.support > 5 || h.support < -5 }\">{{ h.support }}</td>\n                            <td [ngClass]=\"{ 'green': h.resistance > 0, 'red': h.resistance < 0, 'bold-higher': h.resistance > 5 || h.resistance < -5 }\">{{ h.resistance }}</td>\n                        </tr>\n                    </tbody>\n                </table>\n\n                <button type=\"button\" class=\"btn btn-link\" (click)=\"fetchStocks()\">Fetch Stocks data</button>\n                <button type=\"button\" class=\"btn btn-link\" (click)=\"loadHoldings()\">Load</button>\n                <button type=\"button\" class=\"btn btn-link\" (click)=\"backtestStocks()\">Backtest</button>\n                <button type=\"button\" class=\"btn btn-link\" (click)=\"exportBacktest()\">Export Backtest</button>\n                \n            </div>\n    \n        </div>\n    </div>\n\n    <div class=\"algo-suggestions-main shadow-sm p-3 mb-5 bg-white\" *ngIf=\"false\">\n        <span class=\"mr-2\">\n            Strategy PnL: <span class=\"font-weight-bold\" [ngClass]=\"{ 'text-danger': getStrategyPnL() < 0, 'text-success': getStrategyPnL() > 0 }\"> {{ getStrategyPnL() }} , {{ strategyPointsProfit }}</span>\n        </span>\n        <!-- <span class=\"suggest-positions\">\n            14750CE 25 , 14400PE 28\n        </span> -->\n        <span class=\"suggest-positions\" *ngFor=\"let sug of suggestions; index as i\">\n            {{ sug.strikeCE }}CE {{ sug.ltpCE }} , {{ sug.strikePE }}PE {{ sug.ltpPE }}\n        </span>\n\n        <span class=\"suggest-positions\" *ngFor=\"let sug of adjust_sugg; index as i\">\n            {{ sug.action }}: {{ sug.strike }} {{ sug.ltp }}\n        </span>\n\n        <span class=\"ml-4 mr-3\">Current Premium: {{ combined_premium }}</span> \n\n        <span>\n            Combined SL:\n            <input style=\"width: 70px; display: inline;\" type=\"number\" placeholder=\"Combined SL\" [(ngModel)]=\"combined_SL\" class=\"ml-2 form-control form-control-sm\"/>\n        </span>\n\n    </div>\n\n    <app-chart></app-chart>\n\n    <hr/>\n\n    <div class=\"option-chain\">\n        <!-- <div class=\"confirmation-check form-check-inline\">\n            <input class=\"form-check-input\" [(ngModel)]=\"nifty_oc_check\" (change)=\"checkNifty()\" type=\"checkbox\" value=\"\" id=\"nifty-oc-check\">\n            <label class=\"form-check-label\" for=\"nifty-oc-check\">Nifty</label>\n        </div>\n        <div class=\"confirmation-check form-check-inline\">\n            <input class=\"form-check-input\" [(ngModel)]=\"usdinr_oc_check\" (change)=\"checkUSDINR()\" type=\"checkbox\" value=\"\" id=\"usdinr-oc-check\">\n            <label class=\"form-check-label\" for=\"usdinr-oc-check\">USDINR</label>\n        </div> -->\n        <select class=\"new-input form-control form-control-sm\" [(ngModel)]=\"oc_instru\">\n            <option value='NIFTY'>NIFTY</option>\n            <option value='BANKNIFTY'>BANKNIFTY</option>\n            <option value='USDINR'>USDINR</option>\n        </select>\n        <input id=\"strategy-qty\" style=\"display: inline; width: 70px;\" type=\"number\" placeholder=\"Qty Default\" [(ngModel)]=\"qty_default\" class=\"ml-2 form-control form-control-sm\"/>\n\n        <div style=\"display: inline-block; margin-left: 20px; margin-right: 10px;\">Expiry: </div>\n        <div class=\"input-group input-group-sm new-input-prepend-expiry\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Year</div>\n            </div>\n            <input [(ngModel)]=\"oc_year\" type=\"number\" class=\"form-control\"/>\n        </div>\n        <div class=\"input-group input-group-sm new-input-prepend-expiry\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Month</div>\n            </div>\n            <input [(ngModel)]=\"oc_month\" type=\"number\" class=\"form-control\"/>\n        </div>\n        <div class=\"input-group input-group-sm new-input-prepend-expiry\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Date</div>\n            </div>\n            <input [(ngModel)]=\"oc_date\" type=\"number\" class=\"form-control\"/>\n        </div>\n        <div class=\"confirmation-check form-check-inline\">\n            <input class=\"form-check-input\" [(ngModel)]=\"is_monthly_expiry\" type=\"checkbox\" value=\"\" id=\"is-monthly-expiry\" [disabled]=\"true\">\n            <label class=\"form-check-label\" for=\"is-monthly-expiry\">Is Monthly</label>\n        </div>\n        <div style=\"display: inline-block; margin-left: 20px; margin-right: 10px; margin-bottom: 20px;\">Strike range: </div>\n        <div class=\"input-group input-group-sm new-input-prepend-oc\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Higher</div>\n            </div>\n            <input [(ngModel)]=\"oc_range_higher\" type=\"number\" class=\"form-control\" min=\"0\" step=\"50\"/>\n        </div>\n        <div class=\"input-group input-group-sm new-input-prepend-oc\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Lower</div>\n            </div>\n            <input [(ngModel)]=\"oc_range_lower\" type=\"number\" class=\"form-control\" min=\"0\" step=\"50\"/>\n        </div>\n        <div class=\"input-group input-group-sm new-input-prepend-oc\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Multiple</div>\n            </div>\n            <input [(ngModel)]=\"oc_range_multiple\" type=\"number\" class=\"form-control\" min=\"50\" step=\"50\" />\n        </div>\n        <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"updateOCRange()\">Update</button>\n        <button type=\"button\" class=\"btn btn-secondary btn-sm ml-1\" (click)=\"clearOC()\">Clear</button>\n\n        <table class=\"table table-sm table-bordered shadow mb-0 text-center\">\n            <thead class=\"thead-light\">\n                <tr class=\"text-center\">\n                    <th colspan=\"4\" scope=\"col\">Calls</th>\n                    <th scope=\"col\"></th>\n                    <th colspan=\"4\" scope=\"col\">Puts</th>\n                </tr>\n                <tr>\n                    <th class=\"oc-col-actions\" scope=\"col\"></th>\n                    <!-- <th class=\"oc-col\" scope=\"col\">Chg OI</th>\n                    <th class=\"oc-col\" scope=\"col\">OI</th> -->\n                    <th class=\"oc-col\" scope=\"col\">Volume</th>\n                    <!-- <th class=\"oc-col\" scope=\"col\">ATP</th> -->\n                    <th class=\"oc-col\" scope=\"col\">Delta</th>\n                    <th class=\"oc-col\" scope=\"col\">LTP</th>\n                    <th class=\"text-center\" scope=\"col\">Strike</th>\n                    <th class=\"oc-col\" scope=\"col\">LTP</th>\n                    <th class=\"oc-col\" scope=\"col\">Delta</th>\n                    <!-- <th class=\"oc-col\" scope=\"col\">ATP</th> -->\n                    <th class=\"oc-col\" scope=\"col\">Volume</th>\n                    <!-- <th class=\"oc-col\" scope=\"col\">OI</th>\n                    <th class=\"oc-col\" scope=\"col\">Chg OI</th> -->\n                    <th class=\"oc-col-actions\" scope=\"col\"></th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr *ngFor=\"let oc of oc_strikes; index as i\">\n                    <td [ngClass]=\"{ 'ocStrikeStrategyCE': isStrikeInCurrStrategy(oc.strike + 'CE') }\">\n                        <div class=\"positions-row-actions\">\n                            <div class=\"form-check-inline posCheckbox\">\n                                <input class=\"form-check-input\" (change)=\"includeInStrangleFn(oc.symbol + 'CE')\" type=\"checkbox\" value=\"\">\n                            </div>\n                            <div class=\"form-check-inline posCheckbox\">\n                                <input class=\"form-check-input\" (change)=\"includeInDebitSpreadFn(oc.symbol + 'CE')\" type=\"checkbox\" value=\"\">\n                            </div>\n                            <!-- <input type=\"number\" placeholder=\"Qty\" id=\"oc-qty-CE-{{oc.symbol}}\" class=\"pos-input form-control form-control-sm\"/>\n                            <input type=\"number\" placeholder=\"Limit\" id=\"oc-limit-CE-{{oc.symbol}}\" class=\"pos-input form-control form-control-sm\"/> -->\n                            <!-- <input type=\"number\" placeholder=\"Block\" id=\"oc-block-CE-{{oc.symbol}}\" class=\"pos-input form-control form-control-sm\"/> -->\n                            <!-- <button [disabled]=\"disable_order_buttons\" type=\"button\" class=\"btn btn-primary btn-sm mr-1\" (click)=\"ocOrder(1, 'CE', oc)\">Buy</button>\n                            <button [disabled]=\"disable_order_buttons\" type=\"button\" class=\"btn btn-danger btn-sm mr-1\" (click)=\"ocOrder(-1, 'CE', oc)\">Sell</button> -->\n                            <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"addToStrategyBuilder(oc, 'CE')\">SB</button>\n                            <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"addToChart(oc, 'CE')\">C</button>\n                            <!-- <button type=\"button\" class=\"btn btn-default\">\n                                <span class=\"glyphicon glyphicon-align-left\" aria-hidden=\"true\"></span>\n                            </button> -->\n                        </div>\n                    </td>\n                    <!-- <td>{{ getChgOI(oc.symbol + 'CE') }}</td>\n                    <td>{{ getOI(oc.symbol + 'CE') }}</td> -->\n                    <td [ngClass]=\"{ 'ocStrikeStrategyCE': isStrikeInCurrStrategy(oc.strike + 'CE') }\">{{ getVolume(oc.symbol + 'CE') }}</td>\n                    <!-- <td [ngClass]=\"{ 'ocStrikeStrategyCE': isStrikeInCurrStrategy(oc.strike + 'CE') }\">{{ getAtp(oc.symbol + 'CE') }}</td> -->\n                    <td [ngClass]=\"{ 'ocStrikeStrategyCE': isStrikeInCurrStrategy(oc.strike + 'CE') }\">{{ getDelta(oc.symbol, oc.strike, 'CE') }}</td>\n                    <td [ngClass]=\"{ 'ocStrikeStrategyCE': isStrikeInCurrStrategy(oc.strike + 'CE') }\" class=\"text-info font-weight-bold\">\n                        {{ getLtp(oc.symbol + 'CE') }}\n                        <div class=\"ocStrategyStrikeQty\" *ngIf=\"isStrikeInCurrStrategy(oc.strike + 'CE')\">\n                            {{ getQtyOfStrikeInStrategy(oc.strike + 'CE') }} ({{ getCostOfStrikeInStrategy(oc.strike + 'CE') }})\n                        </div>\n                    </td>\n                    <td [ngClass]=\"{ 'table-warning': isSpotStrike(oc.strike), 'oc-strike': !isSpotStrike(oc.strike) }\"class=\"font-weight-bold text-center\">\n                        {{ oc.strike }}\n                        <div class=\"ocStrategyStrikeQty oc-strike-spot\" *ngIf=\"isSpotStrike(oc.strike)\">\n                            {{ getSpotValue() }}\n                        </div>\n                    </td>\n                    <td [ngClass]=\"{ 'ocStrikeStrategyPE': isStrikeInCurrStrategy(oc.strike + 'PE') }\" class=\"text-info font-weight-bold\">\n                        {{ getLtp(oc.symbol + 'PE') }}\n                        <div class=\"ocStrategyStrikeQty\" *ngIf=\"isStrikeInCurrStrategy(oc.strike + 'PE')\">\n                            {{ getQtyOfStrikeInStrategy(oc.strike + 'PE') }} ({{ getCostOfStrikeInStrategy(oc.strike + 'PE') }})\n                        </div>\n                    </td>\n                    <td [ngClass]=\"{ 'ocStrikeStrategyPE': isStrikeInCurrStrategy(oc.strike + 'PE') }\">{{ getDelta(oc.symbol, oc.strike, 'PE') }}</td>\n                    <!-- <td [ngClass]=\"{ 'ocStrikeStrategyPE': isStrikeInCurrStrategy(oc.strike + 'PE') }\">{{ getAtp(oc.symbol + 'PE') }}</td> -->\n                    <td [ngClass]=\"{ 'ocStrikeStrategyPE': isStrikeInCurrStrategy(oc.strike + 'PE') }\">{{ getVolume(oc.symbol + 'PE') }}</td>\n                    <!-- <td>{{ getOI(oc.symbol + 'PE') }}</td>\n                    <td>{{ getChgOI(oc.symbol + 'PE') }}</td> -->\n                    <td [ngClass]=\"{ 'ocStrikeStrategyPE': isStrikeInCurrStrategy(oc.strike + 'PE') }\">\n                        <div class=\"positions-row-actions\">\n                            <div class=\"form-check-inline posCheckbox\">\n                                <input class=\"form-check-input\" (change)=\"includeInStrangleFn(oc.symbol + 'PE')\" type=\"checkbox\" value=\"\">\n                            </div>\n                            <div class=\"form-check-inline posCheckbox\">\n                                <input class=\"form-check-input\" (change)=\"includeInDebitSpreadFn(oc.symbol + 'PE')\" type=\"checkbox\" value=\"\">\n                            </div>\n                            <!-- <input type=\"number\" placeholder=\"Qty\" id=\"oc-qty-PE-{{oc.symbol}}\" class=\"pos-input form-control form-control-sm\"/>\n                            <input type=\"number\" placeholder=\"Limit\" id=\"oc-limit-PE-{{oc.symbol}}\" class=\"pos-input form-control form-control-sm\"/> -->\n                            <!-- <input type=\"number\" placeholder=\"Block\" id=\"oc-block-PE-{{oc.symbol}}\" class=\"pos-input form-control form-control-sm\"/> -->\n                            <!-- <button [disabled]=\"disable_order_buttons\" type=\"button\" class=\"btn btn-primary btn-sm mr-1\" (click)=\"ocOrder(1, 'PE', oc)\">Buy</button>\n                            <button [disabled]=\"disable_order_buttons\" type=\"button\" class=\"btn btn-danger btn-sm mr-1\" (click)=\"ocOrder(-1, 'PE', oc)\">Sell</button> -->\n                            <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"addToStrategyBuilder(oc, 'PE')\">SB</button>\n                            <button type=\"button\" class=\"btn btn-secondary btn-sm\" (click)=\"addToChart(oc, 'PE')\">C</button>\n                        </div>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n\n        <div class=\"confirmation-check form-check-inline\">\n            <input class=\"form-check-input\" [(ngModel)]=\"oc_product_type\" type=\"radio\" value=\"INTRADAY\" id=\"oc-order-type-intraday\">\n            <label class=\"form-check-label\" for=\"oc-order-type-intraday\">Intraday</label>\n        </div>\n        <div class=\"confirmation-check form-check-inline\">\n            <input class=\"form-check-input\" [(ngModel)]=\"oc_product_type\" type=\"radio\" value=\"MARGIN\" id=\"oc-order-type-margin\">\n            <label class=\"form-check-label\" for=\"oc-order-type-margin\">Margin</label>\n        </div>\n\n        <div>\n            <span>Strangle max profit per lot: {{ getProfitForStrangle() }}</span>\n        </div>\n\n        <div>\n            <span>Debit spread per lot Profit: {{ getPnLForDebitSpread()[0] }}, Loss: {{ getPnLForDebitSpread()[1] }}</span>\n        </div>\n    </div>\n</div>\n\n<router-outlet></router-outlet>","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { AppService } from './app.service';\nimport { FyersService } from './common/fyers.service';\nimport { HttpClientModule } from '@angular/common/http';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { ChartComponent } from './chart/chart.component';\nimport { ChartsModule } from 'ng2-charts';\nimport { ChartModule } from './chart/chart.module';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n  ],\n  imports: [\n    CommonModule,\n    BrowserModule,\n    AppRoutingModule,\n    HttpClientModule,\n    FormsModule,\n    ReactiveFormsModule,\n    ChartModule\n  ],\n  /* exports: [\n    ChartsModule\n  ], */\n  providers: [AppService, FyersService],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport { FyersService } from './common/fyers.service';\nimport { AppConstants } from './common/application.constant';\nimport { AliceblueService } from './common/aliceblue.service';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { AngelService } from './common/angel.service';\nimport { AngelWebsocketService } from './common/angelwebsocket.service';\nimport { WebsocketService } from './common/websocket.service';\nimport { PositionTypeForPayOff } from './common/models';\nimport { MapService } from './common/map.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AppService {\n\n  public requestStatusEvent$: Subject<any> = new Subject();\n  public payOffEvent$: Subject<any> = new Subject();\n  public chartEvent$: Subject<any> = new Subject();\n  mean = 0;\n  variance = 1;\n\n  constructor(\n    private http: HttpClient,\n    private fyersService: FyersService,\n    private aliceblueService: AliceblueService,\n    private angelService: AngelService,\n    private angelWS: AngelWebsocketService,\n    private websocketService: WebsocketService,\n    private mapService: MapService\n  ) { }\n\n  getMastersContract(access_token?) {\n    if (AppConstants.SocketMode === 'aliceblue') {\n      this.aliceblueService.getMastersContract(access_token);\n    } else if (AppConstants.SocketMode === 'angel') {\n      return this.angelService.getMastersContract();\n    }\n  }\n\n  getDelta(instru, strike, type, expiry, ltp, simulate_strategy = false, simulateCurrDateObj = null) {\n\n    //let expiry_date = new Date(this.oc_year, this.oc_month - 1, this.oc_date).toDateString();\n    // let date_expiry = new Date(this.oc_year, this.oc_month - 1, this.oc_date);\n    let date_expiry = new Date(expiry);\n    if (instru === 'USDINR') {\n      date_expiry.setHours(12, 30, 0);\n    } else {\n      date_expiry.setHours(15, 30, 0);\n    }\n\n    let date_now = new Date();\n    if (simulate_strategy) {\n      date_now = simulateCurrDateObj;\n    }\n    // date_now.setDate(date_now.getDate() + 0);\n\n    let seconds = Math.floor((date_expiry.getTime() - date_now.getTime()) / 1000);\n    let\tminutes = Math.floor(seconds / 60);\n    let\thours = Math.floor(minutes / 60);\n    let\tdelta_t = (Math.floor(hours / 24)) / 365.0; // time\n\n    let underlying = 'NIFTY50';\n    if (instru === 'BANKNIFTY') {\n      underlying = 'BANKNIFTY';\n    } else if (instru === 'USDINR') {\n      underlying = 'USDINR_FUT';\n    }\n    let spot = this.getLtp(underlying);\n\n    // let mkt_price = this.getLtp(symbol + type);\n    let mkt_price = ltp;\n\n    let typet0 = null;\n    if (type === 'CE') {\n      typet0 = PositionTypeForPayOff.CE;\n    }\n    if (type === 'PE') {\n      typet0 = PositionTypeForPayOff.PE;\n    }\n\n    let iv = this.calculateIV(instru, spot, strike, AppConstants.INTEREST_RATE, date_expiry, typet0, mkt_price);\n    let volt = iv / 100;\n    let int_rate = AppConstants.INTEREST_RATE / 100;\n\n    // console.log(spot, date_expiry, mkt_price, iv);\n\n    let d1 = (Math.log(spot / strike) + (int_rate + (Math.pow(volt, 2) / 2)) * delta_t) / (volt * Math.sqrt(delta_t));\n    let delta = 0;\n    if (type === 'CE') {\n      delta = this.getCDF(d1);\n    } else if (type === 'PE') {\n      delta = this.getCDF(d1) - 1;\n    }\n    delta = Math.round((delta + 0.00001) * 100) / 100;\n    return delta;\n  }\n\n  getLtp(strike: string, oc_strike = null) {\n    // console.log('strike', strike);\n\n    if (strike === 'USDINR_FUT') {\n      let expiryDate: Date = AppConstants.monthlyExpiryDatesUSDINR[AppConstants.year + AppConstants.USDINR_FUT_MONTH];\n      let expiryMonth = null;\n      if (expiryDate.getMonth() + 1 === 10) {\n        expiryMonth = 'O';\n      } else if (expiryDate.getMonth() + 1 === 11) {\n        expiryMonth = 'N';\n      } else if (expiryDate.getMonth() + 1 === 12) {\n        expiryMonth = 'D';\n      } else {\n        expiryMonth = expiryDate.getMonth() + 1;\n      }\n      let expiry = '' + (expiryDate.getFullYear() - 2000) + (expiryMonth) + ('0' + expiryDate.getDate()).slice(-2);\n      strike = 'USDINR' + expiry + AppConstants.USDINR_FUT_MONTH + 'FUT';\n      // console.log('getLtp strike: ' + strike);\n    }\n\n    let ltp = this.mapService.getLtp(strike);\n    if (oc_strike) {\n      oc_strike.ltp = ltp; \n    }\n\n    return ltp;\n  }\n\n  // params - smaller date, bigger date\n  calcWorkingDays(dDate1, dDate2) { // input given as Date objects\n\n    // return (dDate2.getTime() - dDate1.getTime()) / (1000 * 3600 * 24);\n\n    // https://stackoverflow.com/questions/37069186/calculate-working-days-between-two-dates-in-javascript-excepts-holidays\n    let count = 0;\n    let curDate = new Date(dDate1.getTime());\n    while (curDate <= dDate2) {\n        let dayOfWeek = curDate.getDay();\n        if(dayOfWeek !== 0 && dayOfWeek !== 6) {\n          count++;\n        }\n        curDate.setDate(curDate.getDate() + 1);\n    }\n    return count - 1;\n\n    /* var iWeeks, iDateDiff, iAdjust = 0;\n    if (dDate2 < dDate1) return -1; // error code if dates transposed\n    var iWeekday1 = dDate1.getDay(); // day of week\n    var iWeekday2 = dDate2.getDay();\n    iWeekday1 = (iWeekday1 == 0) ? 7 : iWeekday1; // change Sunday from 0 to 7\n    iWeekday2 = (iWeekday2 == 0) ? 7 : iWeekday2;\n    if ((iWeekday1 > 5) && (iWeekday2 > 5)) iAdjust = 1; // adjustment if both days on weekend\n    iWeekday1 = (iWeekday1 > 5) ? 5 : iWeekday1; // only count weekdays\n    iWeekday2 = (iWeekday2 > 5) ? 5 : iWeekday2;\n  \n    // calculate differnece in weeks (1000mS * 60sec * 60min * 24hrs * 7 days = 604800000)\n    iWeeks = Math.floor((dDate2.getTime() - dDate1.getTime()) / 604800000)\n  \n    if (iWeekday1 < iWeekday2) { //Equal to makes it reduce 5 days\n      iDateDiff = (iWeeks * 5) + (iWeekday2 - iWeekday1)\n    } else {\n      iDateDiff = ((iWeeks + 1) * 5) - (iWeekday1 - iWeekday2)\n    }\n  \n    iDateDiff -= iAdjust // take into account both days on weekend\n  \n    let date_diff = iDateDiff; // (iDateDiff + 1); // add 1 because dates are inclusive\n    return date_diff; */\n  }\n  \n\n  calculateIV(instru, spot, strike, int_rate, expiry_date, type, mkt_price) {\n    let high = 80;\n    let low = 0;\n    let iv = 0;\n\n    /* let date_expiry = new Date(expiry_date);\n    let date_now = new Date(); */\n\n    /* let days_diff = this.calcWorkingDays(date_now, date_expiry);\n    let seconds = days_diff * 86400;\n\n    //let seconds = Math.floor((date_expiry.getTime() - date_now.getTime()) / 1000);\n    let\tminutes = Math.floor(seconds / 60);\n    let\thours = Math.floor(minutes / 60);\n    let\tdelta_t = (Math.floor(hours / 24)) / 365.0;\n\n    if (hours < 24) {\n      return 0;\n    } */\n\n    while ((high - low) > 0.0001) {\n      if (this.calculateT0AtPoint(instru, spot, strike, int_rate, expiry_date, (high + low) / 2, type) > mkt_price) {\n        high = (high + low) / 2;\n      } else {\n        low = (high + low) / 2;\n      }\n    }\n    iv = (high + low) / 2;\n    return iv;\n  }\n\n  calculateT0AtPoint(instru, spot, strike, int_rate, expiry_date, volatility, type, add_days?) {\n    let t0 = 0;\n    let date_expiry = new Date(expiry_date);\n    if (instru === 'USDINR') {\n      date_expiry.setHours(12, 30, 0);\n    } else {\n      date_expiry.setHours(15, 30, 0);\n    }\n\n    if (!add_days) {\n      add_days = 0;\n    }\n\n    let date_now = new Date();\n    date_now.setDate(date_now.getDate() + add_days);\n\n    let days_diff = this.calcWorkingDays(date_now, date_expiry);\n    let seconds = days_diff * 86400;\n\n    // let seconds = Math.floor((date_expiry.getTime() - date_now.getTime()) / 1000);\n    let\tminutes = Math.floor(seconds / 60);\n    let\thours = Math.floor(minutes / 60);\n    let\tdelta_t = (Math.floor(hours / 24)) / 365.0; // time\n\n    if (hours < 12) {\n      return 0;\n    }\n    else {\n      let volt = volatility / 100;\n      int_rate = int_rate / 100;\n\n      let d1 = (Math.log(spot / strike) + (int_rate + (Math.pow(volt, 2) / 2)) * delta_t) / (volt * Math.sqrt(delta_t));\n      // let d2 = (Math.log(spot / strike) + (int_rate - (Math.pow(volt, 2) / 2)) * delta_t) / (volt * Math.sqrt(delta_t));\n      let d2 = d1 - (volt * Math.sqrt(delta_t));\n\n      let fv_strike = (strike) * Math.exp(-1 * int_rate * delta_t);\n\n      if (type === PositionTypeForPayOff.CE) {\n        t0 = spot * this.getCDF(d1) - fv_strike * this.getCDF(d2);\n      }\n\n      if (type === PositionTypeForPayOff.PE) {\n        t0 = fv_strike * this.getCDF(-1 * d2) - spot * this.getCDF(-1 * d1);\n      }\n    }\n    return t0;\n  }\n\n  getCDF(x) {\n    let standardDeviation = Math.sqrt(this.variance);\n    return 0.5 * this.erfc(-(x - this.mean) / (standardDeviation * Math.sqrt(2)));\n  }\n\n  // Complementary error function\n  // From Numerical Recipes in C 2e p221\n  erfc(x) {\n    let z = Math.abs(x);\n    let t = 1 / (1 + z / 2);\n    let r = t * Math.exp(-z * z - 1.26551223 + t * (1.00002368 +\n            t * (0.37409196 + t * (0.09678418 + t * (-0.18628806 +\n            t * (0.27886807 + t * (-1.13520398 + t * (1.48851587 +\n            t * (-0.82215223 + t * 0.17087277)))))))));\n    return x >= 0 ? r : 2 - r;\n  }\n\n  playAudio(type){\n    let relativePath = '';\n    if (AppConstants.isProduction === false) {\n      relativePath = '../';\n    }\n    let audio = new Audio();\n    if (type === 'success') {\n      audio.src = relativePath + \"assets/audio/beep-25-success.mp3\";\n    } else if (type === 'error') {\n      audio.src = relativePath + \"assets/audio/beep-02.mp3\";\n    } else if (type === 'warn') {\n      audio.src = relativePath + \"assets/audio/beep-05.mp3\";\n    }\n    audio.load();\n    audio.play();\n  }\n\n  get(urlToFetch) {\n    let httpOptions = {};\n\n    let url = urlToFetch;\n    return this.http.get(url, httpOptions);\n  }\n\n  getZerodhaMargin(instru: any, month, curr_positions_trades, exchange?) {\n    let formData: any = new FormData();\n    formData.append('action', 'calculate');\n    /*\n    formData.append('exchange[]', 'CDS');\n    formData.append('product[]', 'OPT');\n    formData.append('scrip[]', 'USDINR20OCT');\n    formData.append('option_type[]', 'CE');\n    formData.append('strike_price[]', '73.5');\n    formData.append('qty[]', '30');\n    formData.append('trade[]', 'sell'); */\n\n    // console.log('getMargin curr_positions_trades: ', curr_positions_trades);\n\n    for (let i = 0; i < curr_positions_trades.length; i++) {\n      let element = curr_positions_trades[i];\n      /* {\n        qty: 50,\n        scrip: '11150CE',\n        expiry: '01OCT2020',\n        entry: 50,\n        exit: 0,\n      }, */\n      // -375x10950PEx01OCT2020x19.2x0x0&\n      // console.log('getMargin inside loop: ', element);\n\n      if (element.exit !== null && element.exit === 0) {\n        let pos_strike = element.scrip.slice(0, -2); // remove CE PE at end\n        let type = '';\n        if (element.scrip.includes('CE')) {\n          type = 'CE';\n        }\n        if (element.scrip.includes('PE')) {\n          type = 'PE';\n        }\n        let trade = 'sell';\n        if (element.qty > 0) {\n          trade = 'buy';\n        }\n\n        let exch = 'CDS';\n        if (exchange.includes('NIFTY')) {\n          exch = 'NFO';\n        }\n\n        let qtyMultiple = 1000;\n        if (exchange === 'NIFTY') {\n          qtyMultiple = 1;\n        } else if (exchange === 'BANKNIFTY') {\n          qtyMultiple = 1;\n        }\n\n        let scrip = instru + AppConstants.year + month;\n\n        formData.append('exchange[]', exch);\n        formData.append('product[]', 'OPT');\n        formData.append('scrip[]', scrip);\n        formData.append('option_type[]', type);\n        formData.append('strike_price[]', pos_strike);\n        formData.append('qty[]', Math.abs(element.qty) / qtyMultiple);\n        formData.append('trade[]', trade);\n      }\n\n    }\n\n    /* for (let pair of formData.entries()) {\n      console.log('getMargin pair: ', pair[0], pair[1]);\n    } */\n    // console.log('getMargin formdata: ', formData);\n\n    return this.http.post('https://zerodha.com/margin-calculator/SPAN', formData);/* .subscribe(\n      (response) => console.log('ZERODHA MARGIN: ', response),\n      (error) => console.log('ZERODHA MARGIN ERROR: ', error)\n    ); */\n  }\n\n  sendSubscriptions(strikes) {\n    if (AppConstants.SocketMode === 'aliceblue') {\n      this.aliceblueService.sendSubscriptions(strikes);\n    } else if (AppConstants.SocketMode === 'angel') {\n      this.angelService.sendSubscriptions(strikes);\n    }\n  }\n\n  connectWebsocket(access_token?) {\n    if (AppConstants.SocketMode === 'aliceblue') {\n      this.aliceblueService.connectWebsocket(access_token);\n    } else if (AppConstants.SocketMode === 'angel') {\n      this.angelService.angelLogin();\n    }\n  }\n\n  isSocketConnected() {\n    if (AppConstants.SocketMode === 'aliceblue') {\n      return this.websocketService.isSocketConnected();\n    } else if (AppConstants.SocketMode === 'angel') {\n      return this.angelWS.isSocketConnected();\n    }\n  }\n\n  auth() {\n    if (AppConstants.RestMode === 'fyers') {\n      return this.fyersService.auth();\n    }\n  }\n\n  getTokenUrl(auth_code, appId) {\n    if (AppConstants.RestMode === 'fyers') {\n      return this.fyersService.getTokenUrl(auth_code, appId);\n    }\n  }\n\n  getFunds(access_token) {\n    if (AppConstants.RestMode === 'fyers') {\n      return this.fyersService.getFunds(access_token);\n    }\n  }\n\n  getPositions(access_token) {\n    if (AppConstants.RestMode === 'fyers') {\n      return this.fyersService.getPositions(access_token);\n    }\n  }\n\n  getOrders(access_token) {\n    if (AppConstants.RestMode === 'fyers') {\n      return this.fyersService.getOrders(access_token);\n    }\n  }\n\n  placeOrder(access_token, symbol: string, qty: number, orderType: number, side: number,\n    productType: string, limitPrice: number, stopPrice: number) {\n    if (AppConstants.RestMode === 'fyers') {\n      let order = {\n        'symbol': symbol,\n        'qty': qty,\n        'type': orderType,\n        'side': side,\n        'productType': productType,\n        'limitPrice': limitPrice,\n        'stopPrice': stopPrice,\n        'disclosedQty': 0,\n        'validity': 'DAY',\n        'offlineOrder': 'False',\n        'stopLoss': 0,\n        'takeProfit': 0\n      };\n      console.log('Order: ' + order);\n      return this.fyersService.place_order(access_token, order);\n    }\n  }\n}\n","import { Component, Input, OnInit, SimpleChanges, ViewChild } from '@angular/core';\nimport { ChartDataSets, ChartOptions } from 'chart.js';\nimport { BaseChartDirective, Color, Label } from 'ng2-charts';\nimport { AppService } from '../app.service';\nimport * as pluginAnnotations from 'chartjs-plugin-annotation';\nimport { MapService } from '../common/map.service';\nimport { prependOnceListener } from 'process';\nimport { AppConstants } from '../common/application.constant';\nimport { Instrument, OrderPasted, PositionTypeForPayOff } from '../common/models';\nimport { WebsocketService } from '../common/websocket.service';\nimport { ChartService } from './chart.service';\nimport { THIS_EXPR } from '@angular/compiler/src/output/output_ast';\nimport { AngelWebsocketService } from '../common/angelwebsocket.service';\n\n@Component({\n  selector: 'app-chart',\n  templateUrl: './chart.component.html',\n  styleUrls: ['./chart.component.scss']\n})\nexport class ChartComponent implements OnInit {\n\n  s1Trades = null;\n  s2Trades = null;\n  s3Trades = null;\n  s4Trades = null;\n  s5Trades = null;\n  currLoadNum = null;\n  payOffData = null;\n  curr_positions_trades = null;\n  expiryDate = null;\n  margin = null;\n  breakevens = null;\n  cePremium = 0;\n  pePremium = 0;\n  ceWeight = 0;\n  peWeight = 0;\n  ceLots = 0;\n  peLots = 0;\n  urlToFetch = ''; // 'https://opstra.definedge.com/api/free/strategybuilder/payoff/NIFTY$-375x11600CEx01OCT2020x10.27x5.1x0&-375x10600PEx01OCT2020x11.8x0x0&+150x10700PEx01OCT2020x52.05x0x0&-150x10650PEx01OCT2020x37.3x0x0&+225x10550PEx01OCT2020x31.87x13.4x0&-225x11200CEx01OCT2020x22.65x36.55x0&-150x11250CEx01OCT2020x17.65x30.75x0&+150x10550PEx01OCT2020x31.87x28.2x0&+150x10550PEx01OCT2020x32.7x13.4x0&-375x11350CEx01OCT2020x11.4x0x0$2020-10-01$0$0$0';\n  spot = null;\n  rest_res = null;\n  labels = [];\n  pnl = [];\n  zeroline = [];\n  instru = 'NIFTY';\n  stepValue = 25;\n  mean = 0;\n  variance = 1;\n  simulate_instru = 'BANKNIFTY';\n  simulate_strategy = false;\n  simulateExpiryDate = '2022-01-07';\n  simulateStartDate = '2021-12-31';\n  simulateCurrDateObj = new Date();\n  simulateTimeAdv = 'add';\n  simulateTimeMins = 5;\n  simulateCurrHour = 9;\n  simulateCurrMins = 15;\n  simulateCurrDateTimeString = '';\n  payoff_overlay = false;\n  hide_payoff = false;\n  use_hypo_future = false;\n  hypo_future_strike = 74.5;\n  payoff_range = 1000;\n  alerts = [];\n  ordersTextarea = '';\n  orders_parsed = [];\n  orders_broker = 'upstox';\n  ce_side_overlay = false;\n  pe_side_overlay = false;\n  num_overlays = 1;\n  overlay_strike;\n  public lineChartData: ChartDataSets[] = [\n    /* { data: [-65, -59, 80, 81, 56, -55, -40], label: 'Series A' },\n    { data: [0, 0, 0, 0, 0, 0, 0], label: 'Zero line' }, */\n    /* { data: [-65, -59, 80, 81, 56, -55, -40], label: 'PnL' },\n    { data: [0, 0, 0, 0, 0, 0, 0], label: 'Zero line' }, */\n  ];\n  public finLineChartData1: ChartDataSets[] = [];\n  public finLineChartData2: ChartDataSets[] = [];\n  public finLineChartDataInstru: ChartDataSets[] = [];\n  public lineChartLabels: Label[] = [/* 'January', 'February', 'March', 'April', 'May', 'June', 'July' */];\n  public finLineChartLabels1: Label[] = [];\n  public finLineChartLabels2: Label[] = [];\n  public finLineChartLabelsInstru: Label[] = [];\n  /* public lineChartOptions: (ChartOptions & { annotation: any }) = {\n    responsive: true,\n  }; */\n  public lineChartOptions = {\n    /* responsive: true,\n    scales: {\n      xAxes: [{}],\n    },\n    animation: {\n      duration: 0\n    },\n    annotation: {\n      annotations: [\n        {\n          drawTime: 'afterDatasetsDraw',\n          type: 'line',\n          mode: 'vertical',\n          scaleID: 'x-axis-0',\n          value: this.spot,\n          borderColor: 'orange',\n          borderWidth: 1,\n          label: {\n            enabled: false,\n            fontColor: 'orange',\n            content: 'Nifty'\n          }\n        },\n      ],\n    } */\n  };\n  public finLineChartOptions = {};\n  public lineChartColors: Color[] = [\n    /* {\n      borderColor: 'black',\n      backgroundColor: 'rgba(255,0,0,0.3)',\n    }, */\n    {\n      borderColor: '#35A4EB',\n      borderWidth: 2,\n      pointRadius: 0\n    },\n    {\n      borderColor: 'black',\n      borderWidth: 1,\n      pointRadius: 0\n    },\n    {\n      borderColor: '#205f87',\n      borderWidth: 1,\n      pointRadius: 0\n    },\n    {\n      borderColor: '#6fb9e8',\n      borderWidth: 1,\n      pointRadius: 0\n    },\n    {\n      borderColor: '#35A4EB',\n      borderWidth: 2,\n      pointRadius: 0,\n      borderDash: [10, 5]\n    },\n    {\n      borderColor: 'black',\n      borderWidth: 1,\n      pointRadius: 0,\n      borderDash: [10, 5]\n    },\n    {\n      borderColor: '#35A4EB',\n      borderWidth: 2,\n      pointRadius: 0,\n      borderDash: [10, 5]\n    },\n    {\n      borderColor: '#35A4EB',\n      borderWidth: 2,\n      pointRadius: 0,\n      borderDash: [10, 5]\n    },\n  ];\n  public finLineChartColors: Color[] = [\n    {\n      borderColor: '#35A4EB',\n      borderWidth: 2,\n      pointRadius: 0\n    },\n  ];\n  public lineChartLegend = false; // true\n  public lineChartType = 'line';\n  public lineChartPlugins = [pluginAnnotations];\n\n  straddle1instru = 'USDINR';\n  straddle1expiryDate = null;\n  straddle1scrip = null;\n  straddle2instru = 'USDINR';\n  straddle2expiryDate = null;\n  straddle2scrip = null;\n  straddle3instru = 'USDINR';\n  straddle3expiryDate = null;\n  straddle3scrip = null;\n  public i1ChartData: ChartDataSets[] = [];\n  public i1ChartLabels: Label[] = [];\n  public i1ChartOptions = {\n    responsive: true,\n    scales: {\n      xAxes: [{}],\n      yAxes: [\n        {\n          id: 'y-axis-0',\n          position: 'left',\n          /* ticks: {\n            max: 1,\n          } */\n        },\n        {\n          id: 'y-axis-1',\n          position: 'right',\n          /* gridLines: {\n            color: 'rgba(255,0,0,0.3)',\n          },\n          ticks: {\n            fontColor: 'red',\n          } */\n          /* ticks: {\n            min: 71,\n            max: 77,\n          } */\n        }\n      ]\n    },\n    tooltips: {\n      mode: 'index',\n      intersect: false,\n    },\n    animation: {\n      duration: 0\n    },\n    elements: {\n      line: {\n        fill: false\n      }\n    }\n  };\n  public i1ChartColors: Color[] = [ { borderColor: '#35A4EB', borderWidth: 2, pointRadius: 0 }, { borderColor: 'black', borderWidth: 1, pointRadius: 0 }, ];\n  public i1ChartLegend = false; // true\n  public i1ChartType = 'line';\n  public i1ChartPlugins = [pluginAnnotations];\n\n  intradayWatch = [\n    { scrip: 'FUT', instru: 'USDINR', expiry: AppConstants.USDINR_FUT_MONTH, },\n    { scrip: '74CE', instru: 'USDINR', expiry: '2020-11-13', },\n    { scrip: '74PE', instru: 'USDINR', expiry: '2020-11-13', },\n    { scrip: '74.5CE', instru: 'USDINR', expiry: '2020-11-13', },\n    { scrip: '74.5PE', instru: 'USDINR', expiry: '2020-11-13', },\n    /* { scrip: '73.25CE', instru: 'USDINR', expiry: '2020-10-23', },\n    { scrip: '73.25PE', instru: 'USDINR', expiry: '2020-10-23', },\n    { scrip: '73.5CE', instru: 'USDINR', expiry: '2020-10-23', },\n    { scrip: '73.5PE', instru: 'USDINR', expiry: '2020-10-23', }, */\n  ];\n\n  @ViewChild(BaseChartDirective, { static: true }) chart: BaseChartDirective;\n\n  constructor(\n    private appService: AppService,\n    private mapService: MapService,\n    private websocketService: WebsocketService,\n    private angelWS: AngelWebsocketService,\n    private chartService: ChartService,\n  ) {\n    this.appService.payOffEvent$.subscribe(res => {\n      console.log('payOffEvent subcribe: ', res);\n      // this.rest_res = res;\n\n      let scrip = this.parseSymbol(res.symbol);\n      console.log('Adding scrip to strategy: ' + scrip);\n      /* let qty = -450;\n      if (this.instru === 'BANKNIFTY') {\n        qty = 25;\n      }\n      if (this.instru === 'USDINR') {\n        qty = 1000;\n      } */\n      this.addPosition(res.qty, scrip, res.ltp); // TODO: check instru for lot size\n    });\n\n    this.appService.chartEvent$.subscribe(res => {\n      console.log('chartEvent subcribe: ', res);\n      // this.rest_res = res;\n\n      let scrip = this.parseSymbol(res.symbol);\n      console.log('Adding scrip to chart: ' + scrip);\n\n      this.addScripToChart(scrip, res.type);\n    });\n\n    this.websocketService.websocketEvent$.subscribe(res => {\n      console.log('chart websocketEvent: ', res);\n      if (res === 'connected') {\n        this.doStrategiesSubscriptions();\n      }\n    });\n\n    this.angelWS.websocketEvent$.subscribe(res => {\n      console.log('chart websocketEvent: ', res);\n      if (res === 'connected') {\n        this.doStrategiesSubscriptions();\n      }\n    });\n\n    /* window.addEventListener('storage', () => {\n      // When local storage changes, dump the list to\n      // the console.\n      console.log('*** changed1');\n      console.log(JSON.parse(window.localStorage.getItem('addScripToStrategy')));\n    });\n\n    window.onstorage = function(e) {\n      console.log('received storage event', JSON.parse(e.newValue));\n      //if (e.key === 'userportal_s') {\n      //  let token = e.newValue;\n      //  that.chatService.setAccessToken(token);\n      //  localStorage.removeItem('userportal_s');\n      //}\n    }; */\n  }\n\n  parseSymbol(symbol) {\n    symbol = symbol.replace('NSE:', '');\n    let instru = '';\n    if (symbol.startsWith('NIFTY')) {\n      instru = 'NIFTY';\n      symbol = symbol.replace('NIFTY', '');\n    }\n    if (symbol.startsWith('BANKNIFTY')) {\n      instru = 'BANKNIFTY';\n      symbol = symbol.replace('BANKNIFTY', '');\n    }\n    if (symbol.startsWith('USDINR')) {\n      instru = 'USDINR';\n      symbol = symbol.replace('USDINR', '');\n    }\n    let type = '';\n    if (symbol.includes('CE')) {\n      type = 'CE';\n    }\n    if (symbol.includes('PE')) {\n      type = 'PE';\n    }\n    symbol = symbol.slice(0, -2); // remove CE PE at end\n\n    let strike = symbol.substring(5);\n    let expiry = symbol.substring(0, 5); // 20N08 20JUN 20911\n\n    return strike + type;\n  }\n\n  ngOnInit(): void {\n\n    /* let positions = {\n      instru: 'NIFTY',\n      expiry: '2020-10-01',\n      trades:\n      [\n        {\n          qty: -375,\n          scrip: '10950PE',\n          expiry: '01OCT2020',\n          entry: 19.2,\n          exit: 0,\n        },\n        {\n          qty: 150,\n          scrip: '11050PE',\n          expiry: '01OCT2020',\n          entry: 32.7,\n          exit: 0,\n        },\n        {\n          qty: -375,\n          scrip: '11450CE',\n          expiry: '01OCT2020',\n          entry: 10,\n          exit: 0,\n        },\n        {\n          qty: 225,\n          scrip: '11500CE',\n          expiry: '01OCT2020',\n          entry: 6.35,\n          exit: 0,\n        },\n        {\n          qty: -75,\n          scrip: '11200CE',\n          expiry: '01OCT2020',\n          entry: 95.95,\n          exit: 0,\n        },\n        {\n          qty: -75,\n          scrip: '11200PE',\n          expiry: '01OCT2020',\n          entry: 66.2,\n          exit: 0,\n        },\n        {\n          qty: 75,\n          scrip: '11250CE',\n          expiry: '01OCT2020',\n          entry: 67.25,\n          exit: 0,\n        },\n        {\n          qty: 75,\n          scrip: '11150PE',\n          expiry: '01OCT2020',\n          entry: 50,\n          exit: 0,\n        },\n      ]\n    };\n    localStorage.setItem(\n      'curr_positions1',\n      JSON.stringify(positions)\n    ); */\n\n    // localStorage.removeItem('curr_positions1');\n\n    // this.loadPayoffData();\n    // this.getPayoff();\n    // this.getMargin();\n\n    // this.doStrategiesSubscriptions();\n\n    /***** LOCAL STORAGE RETRIEVE SAVE ************************************* */\n    //this.chartService.loadIntradayData(this.intradayWatch);\n    //this.chartService.initFetchIntraday(this.intradayWatch);\n    //this.chartService.saveIntradayData();\n\n    /****************************************** */\n\n    this.alerts = [];\n    for (let index = 0; index < AppConstants.numAlerts; index += 1) {\n      this.alerts.push({selected: false, scrip1: '40000CE', scrip2: '', instru: 'BANKNIFTY', expiry: '2022-01-07', compare: '>', price: 20, status: '' });\n    }\n\n    let alert_interval = setInterval(() => {\n      if (this.alerts) {\n        this.alerts.forEach((alert)=> {\n          alert.status = '';\n          if (alert.selected) {\n\n            let ltp = null;\n            if (alert.scrip1) {\n\n              let ltp1 = this.getLTP_strike({ scrip : alert.scrip1 }, alert.instru, alert.expiry);\n              ltp = ltp1;\n              if (alert.scrip2) {\n                let ltp2 = this.getLTP_strike({ scrip : alert.scrip2 }, alert.instru, alert.expiry);\n                ltp += ltp2;\n              }\n            \n            } else { // index\n              ltp = this.mapService.getLtp(alert.instru);\n            }\n\n            if (alert.compare === '>') {\n              if (ltp > alert.price) {\n                alert.status = 'Alert';\n                this.appService.playAudio('success');\n              } else {\n                alert.status = '';\n              }\n            }\n            if (alert.compare === '<') {\n              if (ltp < alert.price) {\n                alert.status = 'Alert';\n                this.appService.playAudio('success');\n              } else {\n                alert.status = '';\n              }\n            }\n          }\n\n        });\n      }\n    }, 1000);\n\n    let refresh_interval = setInterval(() => {\n      if (!this.hide_payoff) {\n        this.updateChartData(this.payOffData);\n      }\n      this.getCEPEWeightage();\n    }, 5000);\n\n    let refresh_intervalP = setInterval(() => {\n      if (!this.hide_payoff) {\n        this.getPayoff();\n      }\n    }, 60000);\n\n    let refresh_intervalI = setInterval(() => {\n      //this.updateIntradayChartData();\n    }, 2000);\n\n    for (let num = 1; num <= 5; num++) {\n      let curr_positions = JSON.parse(localStorage.getItem('curr_positions' + num));\n\n      if (curr_positions && curr_positions.trades) {\n        if (num === 1) {\n          this.s1Trades = curr_positions;\n        }\n        if (num === 2) {\n          this.s2Trades = curr_positions;\n        }\n        if (num === 3) {\n          this.s3Trades = curr_positions;\n        }\n        if (num === 4) {\n          this.s4Trades = curr_positions;\n        }\n        if (num === 5) {\n          this.s5Trades = curr_positions;\n        }\n      }\n    }\n  }\n\n\n  ordersTextareaUpdated(event) {\n    // console.log(this.ordersTextarea);\n    if (this.orders_broker === 'upstox') {\n      this.parseUpstoxOrders();\n    } else if (this.orders_broker === 'zerodha') {\n      this.parseZerodhaOrders();\n    }\n  }\n\n  parseZerodhaOrders() {\n/*\n14:59:52\tBUY\tBANKNIFTY 2nd w DEC 38000 CE NFO\tNRML\t125 / 125\t7.20\tCOMPLETE\n11:36:58\tSELL\tBANKNIFTY 2nd w DEC 35000 PE NFO\nNRML\t75 / 75\t140.85\tCOMPLETE\n11:36:58\tSELL\tBANKNIFTY 2nd w DEC 35700 PE NFO\nNRML\t175 / 175\t303.71\tCOMPLETE\n11:36:58\tBUY\tBANKNIFTY 2nd w DEC 36300 CE NFO\nNRML\t175 / 175\t162.56\tCOMPLETE\n\n14:59:52\tBUY\tBANKNIFTY 2nd w DEC 38000 CE NFO\nNRML\t125 / 125\t7.20\tCOMPLETE\n11:36:58\tSELL\tBANKNIFTY 2nd w DEC 35000 PE NFO\nNRML\t75 / 75\t140.85\tCOMPLETE\n11:36:58\tSELL\tBANKNIFTY 2nd w DEC 35700 PE NFO\tNRML\t175 / 175\t303.71\tCOMPLETE\n11:36:58\tBUY\tBANKNIFTY 2nd w DEC 36300 CE NFO\tNRML\t175 / 175\t162.56\tCOMPLETE\n*/\n\n    this.orders_parsed = [];\n    let split = this.ordersTextarea.split('COMPLETE\\n');\n    console.log(split);\n\n    if (split) {\n      for (let i = 0; i < split.length; i++) {\n        let line = split[i];\n        line = line.replace('\\n', '\\t');\n        let details = line.split('\\t');\n\n        let o = new OrderPasted();\n        o.instru = details[2].split(' ')[0];\n        o.scrip = details[2].split(' ')[4] + details[2].split(' ')[5];\n        \n        o.qty = Number(details[4].split(' ')[0]);\n        if (details[1] === 'SELL') {\n          o.qty = -o.qty;\n        }\n        o.price = Number(details[5]);\n\n        o.strategy = this.currLoadNum;\n        this.orders_parsed.push(o);\n      }\n    }\n    console.log(this.orders_parsed);\n  }\n\n  parseUpstoxOrders() {\n\n    /*\nBANKNIFTY 36400CE\nNFO 02DEC21\nComplete\n03:26 PM\tDelivery\tSell\t175/175\t54.00\t0\t0\t54.51\t\n\t\nBANKNIFTY 36300CE\nNFO 02DEC21\nComplete\n03:26 PM\tDelivery\tBuy\t175/175\t70.00\t0\t0\t69.40\n*/\n\n    this.orders_parsed = [];\n    let split = this.ordersTextarea.split('\\n\\t\\n');\n    // console.log(split);\n    if (split) {\n      for (let i = 0; i < split.length; i++) {\n        let line = split[i];\n        let order = line.split('\\n');\n        console.log(order);\n\n        let o = new OrderPasted();\n        o.instru = order[0].split(' ')[0];\n        o.expiry = order[1].split(' ')[1];\n        o.scrip = order[0].split(' ')[1];\n\n        o.symbol = this.getMapKeyString(o.instru, o.expiry, o.scrip);\n        \n        let details = order[3].split('\\t');\n        o.qty = Number(details[3].split('/')[0]);\n        if (details[2] === 'Sell') {\n          o.qty = -o.qty;\n        }\n        o.price = Number(details[7]);\n\n        o.strategy = this.currLoadNum;\n        this.orders_parsed.push(o);\n      }\n    }\n    console.log(this.orders_parsed);\n  }\n\n  addOrdersToStrategy() {\n    for (let i = 0; i < this.orders_parsed.length; i++) {\n      this.addPosition(this.orders_parsed[i].qty, this.orders_parsed[i].scrip, this.orders_parsed[i].price);\n    }\n  }\n\n  exportToCSV(num): void {\n    let export_file_name = 'Strategy_' + num + '_' + this.getDateInFormat() + '.csv';\n    console.log('exporting: ', export_file_name);\n    let curr_positions = JSON.parse(localStorage.getItem('curr_positions' + num));\n    if (curr_positions && curr_positions.trades) {\n      let instru = curr_positions.instru;\n      let expiryDate = curr_positions.expiry;\n      let curr_positions_trades = curr_positions.trades;\n      console.log('exporting:', instru, expiryDate, curr_positions_trades);\n\n      let str = '';\n      str += instru + ',' + expiryDate + '\\r\\n';\n      curr_positions_trades.forEach(pos => {\n        let row = '';\n        row += pos.qty + ',' + pos.scrip + ',' + pos.expiry + ',' + pos.entry + ',' + pos.exit;\n        str += row + '\\r\\n';\n      });\n\n      const downloadFile = new Blob([str], {\n        type: 'application/x-msdownload',\n      });\n  \n      if (window.navigator && window.navigator.msSaveOrOpenBlob) {\n        // for IE\n        window.navigator.msSaveOrOpenBlob(downloadFile, export_file_name);\n      } else {\n        const fileURL = URL.createObjectURL(downloadFile);\n        const link = document.createElement('a');\n        link.href = fileURL;\n        link.target = '_blank';\n        document.body.appendChild(link);\n        link.download = export_file_name;\n        link.click();\n        link.parentNode.removeChild(link);\n      }\n    }\n  }\n\n  getDateInFormat() {\n    let date = new Date();\n    let d = date.getDate();\n    let m = date.getMonth() + 1; //Month from 0 to 11\n    let y = date.getFullYear();\n    let h = date.getHours();\n    let mins = date.getMinutes();\n    let s = date.getSeconds();\n    let format = '' + (d <= 9 ? '0' + d : d) + (m <= 9 ? '0' + m : m) + y + '_' + (h <= 9 ? '0' + h : h) + (mins <= 9 ? '0' + mins : mins) + (s <= 9 ? '0' + s : s);\n    return format;\n  }\n\n  uploadExpiryFile(fileInput) {\n    let fileReaded = fileInput.target.files[0];\n\n    let reader: FileReader = new FileReader();\n    reader.readAsText(fileReaded);\n\n    reader.onload = e => {\n      let csv: string = String(reader.result);\n      // console.log('csv:', csv);\n      this.loadExpiryFile(csv);\n    };\n  }\n\n  loadExpiryFile(importData) {\n    let allTextLines_all_data = importData.split(/\\r|\\n|\\r/);\n\n    let allTextLines = allTextLines_all_data.filter(function(elem) {\n      return elem !== '';\n    });\n\n    // console.log('allTextLines: ', allTextLines);\n\n    let firstLine = allTextLines[0].split(','); // ignore first line header\n    \n    MapService.simulateData = {};\n    for (let index = 1; index < allTextLines.length; index++) {\n\n      // Ticker\tDate/Time\tOpen\tHigh\tLow\tClose\tVolume\tOpen Interest\n      // BANKNIFTY, 30/07/21 9:15, 34698.8, 34698.8, 34445.4, 34607.7, 0, 0\n\n      let split = allTextLines[index].split(',');\n\n      let instru_name = split[0];\n      /* if (instru_name === 'USDINR') {\n        instru_name = 'USDINR_FUT';\n      } */\n\n      let timeDict = {};\n      timeDict = MapService.simulateData[instru_name]; // split[0] is the instrument name\n      if (!timeDict) {\n        timeDict = {}\n      }\n\n      timeDict[split[1]] = Number(split[5]) // closing price\n      MapService.simulateData[instru_name] = timeDict\n    }\n\n    console.log('simulateData', MapService.simulateData);\n\n    if (MapService.simulateData) {\n      AppConstants.isSimulatedStrategy = true;\n    }\n\n    this.simulateCurrDateObj = new Date(this.simulateStartDate);\n    this.simulateCurrDateObj.setHours(this.simulateCurrHour);\n    this.simulateCurrDateObj.setMinutes(this.simulateCurrMins);\n\n    let curr_date_string = '' + ('0' + this.simulateCurrDateObj.getDate()).slice(-2) + '-' + ('0' + (this.simulateCurrDateObj.getMonth() + 1)).slice(-2) + '-' + this.simulateCurrDateObj.getFullYear();\n    this.simulateCurrDateTimeString = curr_date_string + ' ' + ('0' + this.simulateCurrDateObj.getHours()).slice(-2) + ':' + ('0' + this.simulateCurrDateObj.getMinutes()).slice(-2) + ':00'; // '21-10-2021 09:15:00'\n\n    this.loadSimulatedOCForTime(this.simulate_instru, this.simulateCurrDateTimeString, this.simulateExpiryDate);\n\n    this.loadOptionChain(this.simulate_instru, this.simulateExpiryDate);\n  }\n\n  loadSimulatedNextMins(mins = null) {\n\n    if (this.simulateTimeAdv === 'add' || (mins && mins > 0)) {\n      if (mins) {\n        this.simulateCurrDateObj.setMinutes(this.simulateCurrDateObj.getMinutes() + mins);\n      } else {\n        this.simulateCurrDateObj.setMinutes(this.simulateCurrDateObj.getMinutes() + Number(this.simulateTimeMins));\n      }\n\n      if ((this.simulateCurrDateObj.getHours() === 15 && this.simulateCurrDateObj.getMinutes() > 30) || this.simulateCurrDateObj.getHours() > 15) {\n        let eod = new Date(this.simulateCurrDateObj);\n        eod.setHours(15);\n        eod.setMinutes(30);\n\n        let diff = this.simulateCurrDateObj.getTime() - eod.getTime(); // difference in milliseconds\n\n        let newday = new Date(this.simulateCurrDateObj);\n        newday.setDate(newday.getDate() + 1);\n        newday.setHours(9);\n        newday.setMinutes(15);\n        newday.setMilliseconds(newday.getMilliseconds() + diff);\n\n        this.simulateCurrDateObj = new Date(newday);\n\n        //console.log(eod, diff, newday);\n      }\n    }\n\n    if (this.simulateTimeAdv === 'subtract' || (mins && mins < 0)) {\n      if (mins) {\n        this.simulateCurrDateObj.setMinutes(this.simulateCurrDateObj.getMinutes() + mins);\n      } else {\n        this.simulateCurrDateObj.setMinutes(this.simulateCurrDateObj.getMinutes() - Number(this.simulateTimeMins));\n      }\n    \n      if ((this.simulateCurrDateObj.getHours() === 9 && this.simulateCurrDateObj.getMinutes() < 15) || this.simulateCurrDateObj.getHours() < 9) {\n        let sod = new Date(this.simulateCurrDateObj);\n        sod.setHours(9);\n        sod.setMinutes(15);\n\n        let diff = sod.getTime() - this.simulateCurrDateObj.getTime(); // difference in milliseconds\n\n        let newday = new Date(this.simulateCurrDateObj);\n        newday.setDate(newday.getDate() - 1);\n        newday.setHours(15);\n        newday.setMinutes(30);\n        newday.setMilliseconds(newday.getMilliseconds() - diff);\n\n        this.simulateCurrDateObj = new Date(newday);\n\n        //console.log(sod, diff, newday);\n      }\n    }\n    \n    let curr_date_string = '' + ('0' + this.simulateCurrDateObj.getDate()).slice(-2) + '-' + ('0' + (this.simulateCurrDateObj.getMonth() + 1)).slice(-2) + '-' + this.simulateCurrDateObj.getFullYear();\n    this.simulateCurrDateTimeString = curr_date_string + ' ' + ('0' + this.simulateCurrDateObj.getHours()).slice(-2) + ':' + ('0' + this.simulateCurrDateObj.getMinutes()).slice(-2) + ':00'; // '21-10-2021 09:15:00'\n\n    this.loadSimulatedOCForTime(this.simulate_instru, this.simulateCurrDateTimeString, this.simulateExpiryDate);\n  }\n\n  loadSimulatedOCForTime(instru, dateTimeString, expiry_date) {\n\n    let curr_date_time = dateTimeString;\n\n    console.log('loadSimulatedOCForTime', curr_date_time);\n\n    for (let [key, value] of Object.entries(MapService.simulateData)) {\n      // console.log(`${key}: ${value}`);\n\n      if (key === instru || (key.startsWith(instru) && (key.endsWith('CE') || key.endsWith('PE')))) {\n\n        if (key === instru) {\n          let symbol = instru;\n          if (instru === 'NIFTY') {\n            symbol = 'NIFTY50';\n          }\n          if (instru === 'USDINR') {\n            let expiryDate: Date = AppConstants.monthlyExpiryDatesUSDINR[AppConstants.year + AppConstants.USDINR_FUT_MONTH];\n            let expiryMonth = null;\n            if (expiryDate.getMonth() + 1 === 10) {\n              expiryMonth = 'O';\n            } else if (expiryDate.getMonth() + 1 === 11) {\n              expiryMonth = 'N';\n            } else if (expiryDate.getMonth() + 1 === 12) {\n              expiryMonth = 'D';\n            } else {\n              expiryMonth = expiryDate.getMonth() + 1;\n            }\n            let expiry = '' + (expiryDate.getFullYear() - 2000) + (expiryMonth) + ('0' + expiryDate.getDate()).slice(-2);\n            symbol = 'USDINR' + expiry + AppConstants.USDINR_FUT_MONTH + 'FUT';\n          }\n          this.mapService.setLtp(symbol, value[curr_date_time]);\n        } else {\n          let scrip = key;\n          scrip = scrip.replace(instru, '');\n          scrip = scrip.replace('WK', '');\n    \n          let symbol = this.getMapKeyString(instru, expiry_date, scrip);\n    \n          let ltp = value[curr_date_time];\n    \n          this.mapService.setLtp(symbol, ltp);\n        }\n      }\n    }\n\n    this.addScripToChart(this.simulate_instru, null);\n    this.getPayoff();\n    \n    console.log('ltpMap', this.mapService.ltpMap);\n  }\n\n  getMapKeyString(instru, expiry_date, scrip) {\n    let is_monthly_expiry = false;\n    let expiryDate = new Date(expiry_date);\n    expiryDate.setHours(0, 0, 0, 0);\n\n    let tempmonthlyExpiryDates = AppConstants.monthlyExpiryDates;\n    if (instru === 'USDINR') {\n      tempmonthlyExpiryDates = AppConstants.monthlyExpiryDatesUSDINR;\n    }\n    for (let key in tempmonthlyExpiryDates) {\n      if (tempmonthlyExpiryDates.hasOwnProperty(key)) {\n          // console.log(key + \" -> \" + tempmonthlyExpiryDates[key] + ' ' + expiryDate);\n          if (expiryDate.getTime() === tempmonthlyExpiryDates[key].getTime()) {\n            // console.log('monthly expiry matched');\n            is_monthly_expiry = true;\n            break;\n          }\n      }\n    }\n\n    let expiry = null;\n    if (is_monthly_expiry) {\n      expiry = '' + (expiryDate.getFullYear() - 2000) + AppConstants.monthsMapping[expiryDate.getMonth() + 1];\n    } else {\n      let expiryMonth = null;\n      if (expiryDate.getMonth() + 1 === 10) {\n        expiryMonth = 'O';\n      } else if (expiryDate.getMonth() + 1 === 11) {\n        expiryMonth = 'N';\n      } else if (expiryDate.getMonth() + 1 === 12) {\n        expiryMonth = 'D';\n      } else {\n        expiryMonth = expiryDate.getMonth() + 1;\n      }\n      expiry = '' + (expiryDate.getFullYear() - 2000) + (expiryMonth) + ('0' + expiryDate.getDate()).slice(-2);\n    }\n\n    let str = instru + expiry + scrip;\n\n    return str;\n  }\n\n\n  importCSV(fileInput, num) {\n    let fileReaded = fileInput.target.files[0];\n\n    let reader: FileReader = new FileReader();\n    reader.readAsText(fileReaded);\n\n    reader.onload = e => {\n      let csv: string = String(reader.result);\n      console.log('csv:', csv);\n      this.loadPayoffData(num, true, csv);\n    };\n  }\n\n  loadImportedPositions(importData) {\n    let allTextLines_all_data = importData.split(/\\r|\\n|\\r/);\n\n    let allTextLines = allTextLines_all_data.filter(function(elem) {\n      return elem !== '';\n    });\n\n    console.log('allTextLines: ', allTextLines);\n\n    let firstLine = allTextLines[0].split(',');\n    let instru = firstLine[0];\n    let expiryDate = firstLine[1];\n    let trades = [];\n    for (let index = 1; index < allTextLines.length; index++) {\n      let line = allTextLines[index].split(',');\n      trades.push({ qty: Number(line[0]), scrip: line[1], expiry: line[2], entry: Number(line[3]), exit: Number(line[4]) });\n    }\n\n    let curr_positions = { instru: '', expiry: '', trades: {} };\n    curr_positions.instru = instru;\n    curr_positions.expiry = expiryDate;\n    curr_positions.trades = trades;\n\n    return curr_positions;\n  }\n\n  loadOptionChain(instru = null, expiryDate = null) {\n    if (instru && expiryDate) {\n      this.chartService.optionChainEvent$.next([instru, expiryDate]);\n    } else if (this.instru && this.expiryDate) {\n      this.chartService.optionChainEvent$.next([this.instru, this.expiryDate]);\n    } else {\n      console.log('No data to load');\n    }\n  }\n\n  doSingleStrategySubscription(alert?) {\n    if (this.instru && this.expiryDate && this.curr_positions_trades) {\n      this.subscribeStrategiesPositionsFeed(this.instru, this.expiryDate, this.curr_positions_trades);\n    } else {\n      console.log('Nothing to subscribe');\n    }\n  }\n\n  doStrategiesSubscriptions() {\n    for (let num = 1; num <= 5; num++) {\n      let curr_positions = JSON.parse(localStorage.getItem('curr_positions' + num));\n\n      if (curr_positions && curr_positions.trades) {\n        if (num === 1) {\n          this.s1Trades = curr_positions;\n        }\n        if (num === 2) {\n          this.s2Trades = curr_positions;\n        }\n        if (num === 3) {\n          this.s3Trades = curr_positions;\n        }\n        if (num === 4) {\n          this.s4Trades = curr_positions;\n        }\n        if (num === 5) {\n          this.s5Trades = curr_positions;\n        }\n        let instru = curr_positions.instru;\n        let expiryDate = curr_positions.expiry;\n        let trades = curr_positions.trades;\n        this.subscribeStrategiesPositionsFeed(instru, expiryDate, trades);\n      }\n    }\n\n    this.subscribeAlerts();\n\n    /* this.intradayWatch.forEach(element => {\n      if (element.scrip !== 'FUT' && element.scrip !== 'SPOT') {\n        this.subscribeIntradayWatchFeed(element.instru, element.expiry, element.scrip);\n      }\n    }); */\n  }\n\n  subscribeAlerts() {\n    let sub = [];\n    if (this.alerts) {\n      this.alerts.forEach((pos) => {\n        if (pos.selected) {\n\n          if (pos.scrip1) {\n            let e1 = this.getSubscriptionObject(pos.scrip1, pos.instru, pos.expiry);\n            sub.push(e1);\n          }\n          \n          if (pos.scrip2) {\n            let e2 = this.getSubscriptionObject(pos.scrip2, pos.instru, pos.expiry);\n            sub.push(e2);\n          }\n        }\n      });\n    }\n    console.log('alerts feed', sub);\n    this.appService.sendSubscriptions(sub);\n  }\n\n  getSubscriptionObject(scrip, instru, expiry) {\n    let symbol = scrip;\n    let type = '';\n    if (symbol.includes('CE')) {\n      type = 'CE';\n    }\n    if (symbol.includes('PE')) {\n      type = 'PE';\n    }\n    console.log('getSubscriptionObject symbol: ' + symbol);\n    symbol = symbol.slice(0, -2); // remove CE PE at end\n\n    let expiryDate = new Date(expiry).toDateString(); // expiry_date\n\n    let e1 = new Instrument();\n    e1.expiry = expiryDate;\n    e1.instru = instru;\n    e1.strike = Number(symbol);\n    e1.type = type;\n\n    return e1;\n  }\n\n  subscribeStrategiesPositionsFeed(instru, expiry_date, trades) {\n    let sub = [];\n\n    trades.forEach(pos => {\n      let e1 = this.getSubscriptionObject(pos.scrip, instru, pos.expiry);\n      sub.push(e1);\n    });\n\n    let expiryDate = new Date(expiry_date).toDateString();\n\n    let e1 = new Instrument();\n    e1.expiry = expiryDate;\n    e1.instru = instru;\n    e1.strike = Number(this.hypo_future_strike);\n    e1.type = 'CE';\n    sub.push(e1);\n\n    let e2 = new Instrument();\n    e2.expiry = expiryDate;\n    e2.instru = instru;\n    e2.strike = Number(this.hypo_future_strike);\n    e2.type = 'PE';\n    sub.push(e2);\n\n    /* let ltp = 14000; // TODO: HOW TO DECIDE LTP OF INSTRUMENT AT TIME OF INITIAL SUBSCRIPTIONS !?\n    let range = 1000;\n    let range_multiple = 50;\n    let increment = 50;\n    if (this.instru === 'BANKNIFTY') {\n      ltp = 32000;\n      range = 3000;\n      range_multiple = 100;\n      increment = 100;\n    }\n    if (this.instru === 'USDINR') {\n      ltp = this.hypo_future_strike;\n      range = 2;\n      range_multiple = 0.25;\n      increment = 0.25;\n    }\n\n    let round_ltp = (Math.round(ltp / range_multiple) * range_multiple);\n    let lower_range = round_ltp - range; // TODO: range depends on instru\n    let upper_range = round_ltp + range;\n\n    for (let point = lower_range; point <= upper_range; point += increment) {\n\n      let expiryDate = new Date(expiry_date).toDateString();\n\n      let e1 = new Instrument();\n      e1.expiry = expiryDate;\n      e1.instru = instru;\n      e1.strike = Number(point);\n      e1.type = 'CE';\n      sub.push(e1);\n\n      let e2 = new Instrument();\n      e2.expiry = expiryDate;\n      e2.instru = instru;\n      e2.strike = Number(point);\n      e2.type = 'PE';\n      sub.push(e2);\n    } */\n\n    console.log('strategies positions feed', sub);\n    this.appService.sendSubscriptions(sub);\n  }\n\n  subscribeIntradayWatchFeed(instru, expiry_date, scrip) {\n    let sub = [];\n\n    let symbol = scrip;\n    let type = '';\n    if (symbol.includes('CE')) {\n      type = 'CE';\n    }\n    if (symbol.includes('PE')) {\n      type = 'PE';\n    }\n    console.log('subscribeIntradayWatchFeed symbol: ' + symbol);\n    symbol = symbol.slice(0, -2); // remove CE PE at end\n\n    let expiryDate = new Date(expiry_date).toDateString();\n\n    let e1 = new Instrument();\n    e1.expiry = expiryDate;\n    e1.instru = instru;\n    e1.strike = Number(symbol);\n    e1.type = type;\n    sub.push(e1);\n\n    console.log('intraday watch feed', sub);\n    this.appService.sendSubscriptions(sub);\n  }\n\n\n  loadPayoffData(num, isImported = false, importData = null) {\n    let curr_positions = null;\n    if (!isImported) {\n      curr_positions = JSON.parse(localStorage.getItem('curr_positions' + num));\n    } else {\n      curr_positions = this.loadImportedPositions(importData);\n    }\n    this.currLoadNum = num;\n    console.log('curr_positions: ', curr_positions);\n\n    this.curr_positions_trades = null;\n    if (curr_positions && curr_positions.trades) {\n      this.instru = curr_positions.instru;\n      this.expiryDate = curr_positions.expiry;\n      this.curr_positions_trades = curr_positions.trades;\n\n      this.curr_positions_trades.forEach(e => {\n        e.selected = true;\n        e.selectedActual = true;\n      })\n\n      if (this.instru === 'NIFTY') {\n        this.stepValue = 50;\n      } else if (this.instru === 'BANKNIFTY') {\n        this.stepValue = 25;\n      } else {\n        this.stepValue = 1000;\n      }\n\n      this.curr_positions_trades.sort((a, b) => {\n\n        // -1 means a should come before b\n        // 1 means a should come after b\n\n        /* \n        exit and exit\n        exit and no exit\n        no exit and exit\n        same strike no exit and no exit\n        no exit and no exit\n        */\n\n        // console.log(a.exit, b.exit);\n\n        if (a.exit !== 0 && b.exit !== 0) {\n          //return b.scrip.localeCompare(a.scrip);\n          return this.compareForSorting(a.scrip, b.scrip);\n        }\n        if (a.exit !== 0 && b.exit === 0) {\n          return -1;\n        }\n        if (a.exit === 0 && b.exit !== 0) {\n          return 1;\n        }\n        let a_symbol = a.scrip.slice(0, -2);\n        let b_symbol = b.scrip.slice(0, -2);\n        if (a_symbol === b_symbol && a.scrip.includes('CE') && b.scrip.includes('PE')) { // same strike CE PE, CE should occur first\n          return -1;\n        }\n        if (a_symbol === b_symbol && a.scrip.includes('PE') && b.scrip.includes('CE')) { // same strike CE PE, CE should occur first\n          return 1;\n        }\n        //return b.scrip.localeCompare(a.scrip); // negative if a is before b\n        return this.compareForSorting(a.scrip, b.scrip);\n\n      });\n    }\n    AppConstants.curr_positions_trades = this.curr_positions_trades;\n    this.constructUrlToFetch();\n    this.getCEPEWeightage();\n  }\n\n  compareForSorting(ascrip, bscrip) {\n    \n    // All CE strikes to be before PE\n    if (ascrip.includes('CE') && bscrip.includes('PE')) { // CE should occur first\n      return -1;\n    }\n    if (ascrip.includes('PE') && bscrip.includes('CE')) { // CE should occur first\n      return 1;\n    }\n\n    // same type of options\n    let a_symbol = ascrip.slice(0, -2);\n    let b_symbol = bscrip.slice(0, -2);\n    if (a_symbol > b_symbol) {\n      return -1;\n    }\n    return 1;\n    \n  }\n\n  constructUrlToFetch() {\n    /* if (this.curr_positions_trades) {\n      let url = 'https://opstra.definedge.com/api/free/strategybuilder/payoff/NIFTY$';\n      this.curr_positions_trades.forEach(element => {\n        // -375x10950PEx01OCT2020x19.2x0x0&\n        let pos = '' + (element.qty <= 0 ? element.qty : '+' + element.qty) + 'x' + element.scrip + 'x' + element.expiry + 'x' + element.entry + 'x' + element.exit + 'x0&';\n        url += pos;\n      });\n      url = url.replace(/&\\s*$/, ''); // remove last &\n      url += '$' + this.expiryDate;\n      url += '$0$0$0';\n      // $2020-10-01$0$0$0\n      console.log('urlToFetch: ' + url);\n      this.urlToFetch = url;\n    } */\n  }\n\n  addPosition(qty = null, scrip = null, entry = null) {\n    if (this.curr_positions_trades === null) {\n      this.curr_positions_trades = [];\n    }\n    let d = new Date(this.expiryDate);\n    let monthNames = [ 'JAN', 'FEB', 'MAR', 'APR',\n                      'MAY', 'JUN', 'JUL', 'AUG',\n                      'SEP', 'OCT', 'NOV', 'DEC' ];\n    let day = ('0' + d.getDate()).slice(-2);\n    let monthIndex = d.getMonth();\n    let monthName = monthNames[monthIndex];\n    let year = d.getFullYear();\n    let dateString = day + monthName + year;\n    // console.log('***: ', day + monthName + year);\n    this.curr_positions_trades.push({ qty: qty, scrip: scrip, expiry: dateString, entry: entry, exit: 0, selected: true, selectedActual: false });\n  }\n\n  addPositionCustom(arr, qty = null, scrip = null, entry = null) {\n    let d = new Date(this.expiryDate);\n    let monthNames = [ 'JAN', 'FEB', 'MAR', 'APR',\n                      'MAY', 'JUN', 'JUL', 'AUG',\n                      'SEP', 'OCT', 'NOV', 'DEC' ];\n    let day = ('0' + d.getDate()).slice(-2);\n    let monthIndex = d.getMonth();\n    let monthName = monthNames[monthIndex];\n    let year = d.getFullYear();\n    let dateString = day + monthName + year;\n    // console.log('***: ', day + monthName + year);\n    arr.push({ qty: qty, scrip: scrip, expiry: dateString, entry: entry, exit: 0, selected: true, selectedActual: false });\n  }\n\n  splitPosition(pos) {\n    this.curr_positions_trades.push({ qty: 0, scrip: pos.scrip, expiry: pos.expiry, entry: pos.entry, exit: pos.exit, selected: true, selectedActual: false });\n  }\n\n  deletePosition(pos) {\n\n    let found_index = -100;\n    for (let index = 0; index < this.curr_positions_trades.length; index++) {\n      let element = this.curr_positions_trades[index];\n      if (element.qty === pos.qty && element.scrip === pos.scrip && element.expiry === pos.expiry && element.entry === pos.entry &&\n          element.exit === pos.exit) {\n        found_index = index;\n        break;\n      }\n    }\n    if (found_index !== -100) {\n      this.curr_positions_trades.splice(found_index, 1);\n    }\n  }\n\n  calculatePayoff() {\n    this.constructUrlToFetch();\n    this.getPayoff();\n    this.getMargin();\n  }\n\n  reloadPayoffData(num) {\n    this.loadPayoffData(num);\n    this.getPayoff();\n    this.getMargin();\n  }\n\n  savePositions(num) {\n\n    // To combine positions of same scrip\n    // other way is iterating through the array and use Map with scrip as key and rest of params as value\n    const combinedItems = (arr = []) => {\n      const res = arr.reduce((acc, obj) => {\n        \n        //console.log(obj);\n        \n        if (obj.exit !== 0) {\n          acc.push(obj);\n          return acc;\n        }\n\n        if (obj.notconsider === true) {\n          return acc;\n        }\n        \n        //this.curr_positions_trades.push({ qty: qty, scrip: scrip, expiry: dateString, entry: entry, exit: 0 });\n\n        let found = false;\n\n        for (let i = 0; i < acc.length; i++) {\n\n          if (acc[i].notconsider === true) {\n            continue;\n          }\n          \n          if (acc[i].exit === 0 && acc[i].scrip === obj.scrip && acc[i].expiry === obj.expiry) {\n            found = true;\n\n            if ((acc[i].qty > 0 && obj.qty > 0) || (acc[i].qty < 0 && obj.qty < 0)) {\n              acc[i].entry = ((acc[i].entry * acc[i].qty) + (obj.entry * obj.qty)) / (acc[i].qty + obj.qty);\n              acc[i].entry = (Math.round((acc[i].entry + 0.00001) * 10000) / 10000); // round to four decimals\n              acc[i].qty += obj.qty;\n            } else {\n              let qtydiff = acc[i].qty + obj.qty;\n              \n              if (qtydiff !== 0) { // if quantity mismatch, add another entry\n\n                if (Math.abs(acc[i].qty) > Math.abs(obj.qty)) {\n                  \n                  let copy = Object.assign({}, acc[i]);\n                  copy.qty = qtydiff;\n                  copy.entry = acc[i].entry;\n                  copy.notconsider = true;\n                  acc.push(copy);\n\n                  acc[i].qty = -obj.qty;\n                  acc[i].exit = obj.entry;\n\n                  // console.log('qtydiff', qtydiff, copy);\n                } else {\n                  \n                  let copy = Object.assign({}, acc[i]);\n                  copy.qty = qtydiff;\n                  copy.entry = obj.entry;\n                  copy.notconsider = true;\n                  acc.push(copy);\n\n                  acc[i].exit = obj.entry;\n                }\n\n              } else {\n                acc[i].exit = obj.entry;\n              }\n            }\n          }\n        }\n        if (found === false) {\n          acc.push(obj);\n        }\n        return acc;\n      }, []);\n      return res;\n    }\n    this.curr_positions_trades = combinedItems(this.curr_positions_trades);\n    //console.log(ne);\n    console.log(this.curr_positions_trades);\n\n    if (confirm('Sure save ' + num + '?')) {\n      let curr_positions = { instru: '', expiry: '', trades: {} };\n\n      curr_positions.instru = this.instru;\n      curr_positions.expiry = this.expiryDate;\n\n      this.curr_positions_trades.forEach(element => {\n        delete element.selected;\n        delete element.selectedActual;\n        delete element.pnl;\n      });\n\n      curr_positions.trades = this.curr_positions_trades;\n\n      console.log('Saving positions: ', curr_positions);\n      console.log('Saving positions json: ', JSON.stringify(curr_positions));\n      localStorage.setItem(\n        'curr_positions' + num,\n        JSON.stringify(curr_positions)\n      );\n      this.reloadPayoffData(num);\n      // this.doStrategiesSubscriptions();\n\n      for (let num = 1; num <= 5; num++) {\n        let curr_positions = JSON.parse(localStorage.getItem('curr_positions' + num));\n  \n        if (curr_positions && curr_positions.trades) {\n          if (num === 1) {\n            this.s1Trades = curr_positions;\n          }\n          if (num === 2) {\n            this.s2Trades = curr_positions;\n          }\n          if (num === 3) {\n            this.s3Trades = curr_positions;\n          }\n          if (num === 4) {\n            this.s4Trades = curr_positions;\n          }\n          if (num === 5) {\n            this.s5Trades = curr_positions;\n          }\n        }\n      }\n    }\n  }\n\n  getCEPEWeightage() {\n    /* this.cePremium = 0;\n    this.pePremium = 0;\n    this.ceWeight = 0;\n    this.peWeight = 0;\n    this.ceLots = 0;\n    this.peLots = 0;\n    if (this.curr_positions_trades) {\n      this.curr_positions_trades.forEach(element => {\n\n        if (element.exit === null || element.exit === 0) {\n          if (element.scrip.includes('CE') && element.qty < 0) {\n            let mkt_price = this.getLTP_strike({ scrip : element.scrip }, this.instru, element.expiry);\n            let currPremium = element.qty * mkt_price;\n            this.cePremium += currPremium;\n            this.ceLots += element.qty / 1000;\n          }\n          if (element.scrip.includes('PE') && element.qty < 0) {\n            let mkt_price = this.getLTP_strike({ scrip : element.scrip }, this.instru, element.expiry);\n            let currPremium = element.qty * mkt_price;\n            this.pePremium += currPremium;\n            this.peLots += element.qty / 1000;\n          }\n        }\n\n        let totalCEPE = this.cePremium + this.pePremium;\n        this.ceWeight = (this.cePremium / totalCEPE) * 100;\n        this.peWeight = (this.pePremium / totalCEPE) * 100;\n\n        this.cePremium = Math.round(this.cePremium);\n        this.pePremium = Math.round(this.pePremium);\n        this.ceWeight = Math.round(this.ceWeight);\n        this.peWeight = Math.round(this.peWeight);\n      });\n    } */\n  }\n\n  unselectStraddlePositions() {\n\n    let strikes = [];\n    let straddle_strike;\n    let qty;\n    if (this.curr_positions_trades) {\n      this.curr_positions_trades.forEach(element => {\n        if (element.exit === 0) {\n          let pos_strike = element.scrip.slice(0, -2); // remove CE PE at end\n          if (strikes.includes(pos_strike)) {\n            straddle_strike = pos_strike;\n            qty = Math.abs(element.qty);\n          } else {\n            strikes.push(pos_strike);\n          }\n        }\n      });\n\n      console.log('straddle strike:', straddle_strike);\n      if (straddle_strike) {\n        this.curr_positions_trades.forEach(element => {\n          if (element.exit === 0) {\n            let pos_strike = element.scrip.slice(0, -2); // remove CE PE at end\n            if (pos_strike === straddle_strike) {\n              element.selected = false;\n            }\n          }\n        });\n      }\n\n      console.log('selected:', this.curr_positions_trades);\n    }\n    return [straddle_strike, qty];\n  }\n\n  whatIsStraddleHedge(straddle_strike, qty, type) {\n\n    let strike;\n    if (this.curr_positions_trades) {\n      this.curr_positions_trades.forEach(element => {\n        if (element.exit === 0) {\n\n          if (element.selected) {\n            if (element.scrip.includes(type) && element.qty === qty) {\n              strike = element.scrip.slice(0, -2); // remove CE PE at end\n            }\n          }\n        }\n      });\n    }\n    console.log('hedge strike:', strike);\n    return strike;\n  }\n\n  payoffCheckboxChange(event) {\n    if (event.currentTarget.checked) {\n      if (this.overlay_strike) {\n        let new_strike1 = this.overlay_strike;\n        let straddle_strike = this.unselectStraddlePositions();\n        let new_premium1_ce = this.getLTP_strike({ scrip : new_strike1 + 'CE' }, this.instru, this.expiryDate);\n        this.addPosition(-straddle_strike[1], new_strike1 + 'CE', new_premium1_ce);\n        let new_premium1_pe = this.getLTP_strike({ scrip : new_strike1 + 'PE' }, this.instru, this.expiryDate);\n        this.addPosition(-straddle_strike[1], new_strike1 + 'PE', new_premium1_pe);\n        this.calculatePayoff();\n      }\n    } else {\n      this.reloadPayoffData(this.currLoadNum);\n    }\n  }\n\n  getPayoff() {\n\n    let myPayoff = { chart: [] };\n    let ltp = 0;\n    if (this.instru === 'USDINR') {\n      if (this.use_hypo_future) {\n        let ce_premium = this.getLTP_strike({ scrip : this.hypo_future_strike + 'CE' }, this.instru, this.expiryDate);\n        let pe_premium = this.getLTP_strike({ scrip : this.hypo_future_strike + 'PE' }, this.instru, this.expiryDate);\n        ltp = ce_premium - pe_premium + this.hypo_future_strike; // Find future price from Put Call Parity\n        ltp = (Math.round((ltp + 0.00001) * 100) / 100);\n        // console.log('hypo fut:' + ltp);\n      } else {\n        ltp = parseFloat(this.getInstruLTP());\n        ltp = (Math.round((ltp + 0.00001) * 100) / 100); // TODO: ltp rounding for usdinr to two decimal\n      }\n    } else {\n      ltp = parseInt(this.getInstruLTP());\n    }\n    console.log('ltp is: ', ltp);\n    let range = 1000;\n    let increment = 1;\n    let multiple = 50;\n    if (this.instru === 'BANKNIFTY') {\n      range = 3000;\n      multiple = 100;\n    }\n    if (this.instru === 'USDINR') {\n      range = 2;\n      increment = 0.01;\n      multiple = 0.25;\n    }\n\n    if (this.payoff_range && this.instru !== 'USDINR') {\n      range = this.payoff_range;\n    }\n    \n    let lower_range = ltp - range;\n    let upper_range = ltp + range;\n    let pnlForBreakeven = [];\n\n    let pnlExitedPos = 0;\n\n    let actualPos = [];\n\n    let overlayPos1 = [];\n    let overlayPos2 = [];\n    let overlayPos3 = [];\n\n    if (this.curr_positions_trades) {\n\n      if (this.ce_side_overlay || this.pe_side_overlay) {\n        let straddle_strike = this.unselectStraddlePositions();\n        this.curr_positions_trades.forEach(element => {\n          overlayPos1.push(element);\n          overlayPos2.push(element);\n          overlayPos3.push(element);\n        });\n\n        let type = 'CE';\n        if (this.pe_side_overlay) {\n          type = 'PE';\n          multiple = -100;\n        }\n\n        let hedge_strike = this.whatIsStraddleHedge(straddle_strike[0], straddle_strike[1], type);\n        \n        let new_strike1 = hedge_strike - multiple;\n        let new_premium1_ce = this.getLTP_strike({ scrip : new_strike1 + 'CE' }, this.instru, this.expiryDate);\n        this.addPositionCustom(overlayPos1, -straddle_strike[1], new_strike1 + 'CE', new_premium1_ce);\n        let new_premium1_pe = this.getLTP_strike({ scrip : new_strike1 + 'PE' }, this.instru, this.expiryDate);\n        this.addPositionCustom(overlayPos1, -straddle_strike[1], new_strike1 + 'PE', new_premium1_pe);\n        console.log('overlayPos1:', overlayPos1);\n\n        let new_strike2 = hedge_strike - 2*multiple;\n        let new_premium2_ce = this.getLTP_strike({ scrip : new_strike2 + 'CE' }, this.instru, this.expiryDate);\n        this.addPositionCustom(overlayPos2, -straddle_strike[1], new_strike2 + 'CE', new_premium2_ce);\n        let new_premium2_pe = this.getLTP_strike({ scrip : new_strike2 + 'PE' }, this.instru, this.expiryDate);\n        this.addPositionCustom(overlayPos2, -straddle_strike[1], new_strike2 + 'PE', new_premium2_pe);\n        console.log('overlayPos2:', overlayPos2);\n\n        let new_strike3 = hedge_strike - 3*multiple;\n        let new_premium3_ce = this.getLTP_strike({ scrip : new_strike3 + 'CE' }, this.instru, this.expiryDate);\n        this.addPositionCustom(overlayPos3, -straddle_strike[1], new_strike3 + 'CE', new_premium3_ce);\n        let new_premium3_pe = this.getLTP_strike({ scrip : new_strike3 + 'PE' }, this.instru, this.expiryDate);\n        this.addPositionCustom(overlayPos3, -straddle_strike[1], new_strike3 + 'PE', new_premium3_pe);\n        console.log('overlayPos3:', overlayPos3);\n      }\n\n      this.curr_positions_trades.forEach(element => {\n        if (element.exit && element.exit > 0) {\n          let pospnl = this.getPnL(element);\n          pnlExitedPos += pospnl;\n        }\n\n        if (this.payoff_overlay && element.selectedActual === true) {\n          actualPos.push(element);\n        }\n      });\n\n      for (let point = lower_range; point <= upper_range; point += increment) {\n        let pnl = 0;\n        let t0 = 0;\n        let t1 = 0;\n        let t2 = 0;\n        let overlayPnL = 0;\n        let overlayT0 = 0;\n        let overlayPnL2 = 0;\n        let overlayPnL3 = 0;\n        let arr = [];\n\n        point = (Math.round((point + 0.00001) * 100) / 100); // for USDINR two decimal places\n\n        if (this.payoff_overlay) {\n          arr = this.calculatePnLAtPoint(this.curr_positions_trades, point, ltp, true);\n          overlayPnL += arr[0];\n          overlayPnL += pnlExitedPos;\n          overlayPnL = (Math.round((overlayPnL + 0.00001) * 100) / 100);\n\n          overlayT0 += arr[1];\n          overlayT0 += pnlExitedPos;\n          overlayT0 = (Math.round((overlayT0 + 0.00001) * 100) / 100);\n\n          arr = this.calculatePnLAtPoint(actualPos, point, ltp, false);\n\n        } else if (this.ce_side_overlay || this.pe_side_overlay) {\n          arr = this.calculatePnLAtPoint(overlayPos1, point, ltp, true);\n          overlayPnL += arr[0];\n          overlayPnL += pnlExitedPos;\n          overlayPnL = (Math.round((overlayPnL + 0.00001) * 100) / 100);\n\n          arr = this.calculatePnLAtPoint(overlayPos2, point, ltp, true);\n          overlayPnL2 += arr[0];\n          overlayPnL2 += pnlExitedPos;\n          overlayPnL2 = (Math.round((overlayPnL2 + 0.00001) * 100) / 100);\n\n          arr = this.calculatePnLAtPoint(overlayPos3, point, ltp, true);\n          overlayPnL3 += arr[0];\n          overlayPnL3 += pnlExitedPos;\n          overlayPnL3 = (Math.round((overlayPnL3 + 0.00001) * 100) / 100);\n\n          arr = this.calculatePnLAtPoint(this.curr_positions_trades, point, ltp, false);\n\n        } else {\n          arr = this.calculatePnLAtPoint(this.curr_positions_trades, point, ltp, false);\n        }\n\n        pnl += arr[0];\n        pnl += pnlExitedPos;\n        pnl = (Math.round((pnl + 0.00001) * 100) / 100);\n\n        t0 += arr[1];\n        t0 += pnlExitedPos;\n        t0 = (Math.round((t0 + 0.00001) * 100) / 100);\n\n        t1 += arr[2];\n        t1 += pnlExitedPos;\n        t1 = (Math.round((t1 + 0.00001) * 100) / 100);\n\n        t2 += arr[3];\n        t2 += pnlExitedPos;\n        t2 = (Math.round((t2 + 0.00001) * 100) / 100);\n\n        pnlForBreakeven.push(pnl);\n        myPayoff.chart.push({ Final: pnl, StockPrice: point, Today: t0, T1: t1, T2: t2, Overlay: overlayPnL, OverlayT0: overlayT0, Overlay2: overlayPnL2, Overlay3: overlayPnL3 });\n      }\n\n      console.log('myPayoff:', myPayoff);\n\n      this.payOffData = myPayoff;\n      this.updateChartData(myPayoff);\n\n      this.breakevens = '';\n      for (let i = 1; i < myPayoff.chart.length; i++) {\n        let element = myPayoff.chart[i];\n        let prev_element = myPayoff.chart[i - 1];\n        if ((element.Final > 0 && prev_element.Final <= 0) || (element.Final < 0 && prev_element.Final >= 0)) {\n          this.breakevens = this.breakevens + prev_element.StockPrice + ' ';\n        }\n      }\n    }\n\n    /* this.appService.get(this.urlToFetch).subscribe(res => {\n      console.log('getPayoff: ', res);\n\n      // this.payOffData = res;\n\n      if ((res as any).breakevens !== null) {\n        this.breakevens = (res as any).breakevens;\n      }\n\n      // this.updateChartData(res);\n\n      // this.appService.payOffEvent$.next(res);\n    },\n    error => {\n      console.log('getPayoff error', error);\n    }); */\n  }\n\n  calculatePnLAtPoint(positions, point, ltp, overlay) {\n    let pnl = 0;\n    let t0 = 0;\n    let t1 = 0;\n    let t2 = 0;\n    positions.forEach(element => {\n      /*  {\n        qty: 75,\n        scrip: '11150CE',\n        expiry: '01OCT2020',\n        entry: 50,\n        exit: 0,\n      }, */\n\n      if (element.exit === null || element.exit === 0) {\n        let type = null;\n        let typet0 = null;\n        if (element.scrip.includes('CE') && element.qty < 0) {\n          type = PositionTypeForPayOff.CEsell;\n          typet0 = PositionTypeForPayOff.CE;\n        }\n        if (element.scrip.includes('PE') && element.qty < 0) {\n          type = PositionTypeForPayOff.PEsell;\n          typet0 = PositionTypeForPayOff.PE;\n        }\n        if (element.scrip.includes('CE') && element.qty > 0) {\n          type = PositionTypeForPayOff.CEbuy;\n          typet0 = PositionTypeForPayOff.CE;\n        }\n        if (element.scrip.includes('PE') && element.qty > 0) {\n          type = PositionTypeForPayOff.PEbuy;\n          typet0 = PositionTypeForPayOff.PE;\n        }\n        let pos_strike = element.scrip.slice(0, -2); // remove CE PE at end\n\n        let expiry = element.expiry; // this.expiryDate;\n\n        let d1 = new Date(expiry); // position expiry\n        let d2 = new Date(this.expiryDate);\n        if (d1.getFullYear() === d2.getFullYear() && d1.getMonth() === d2.getMonth() && d1.getDate() === d2.getDate()) {\n          if (overlay && !element.selected) {\n            pnl += this.getPnL(element);\n          } else {\n            pnl += this.calculatePnLAtPointForStrike(point, pos_strike, element.qty, element.entry, type);\n          }\n        } else { // for Calendar position - position expiry not same as strategy expiry date\n\n          let d3 = new Date(); // today\n          let days_diff = this.appService.calcWorkingDays(d3, d2);\n          let add_days = days_diff;\n          // let add_days = Math.round((d2.getTime() - d3.getTime()) / (1000 * 3600 * 24));\n          // console.log('add_days: ', add_days);\n\n          let mkt_price = this.getLTP_strike({ scrip : element.scrip }, this.instru, expiry);\n          let iv = this.calculateIV(ltp, pos_strike, AppConstants.INTEREST_RATE, expiry, typet0, mkt_price);\n          // console.log('*** ', pos_strike, typet0, expiry, iv);\n\n          let t0_ = this.calculateT0AtPointForStrike(point, pos_strike, AppConstants.INTEREST_RATE, expiry, iv, typet0, add_days);\n          t0_ = t0_ - element.entry;\n          t0_ = t0_ * element.qty;\n          pnl += t0_;\n        }\n\n        // T+0 calculation:\n\n        if (overlay && !element.selected) {\n          t0 += this.getPnL(element);\n        } else {\n          let mkt_price = this.getLTP_strike({ scrip : element.scrip }, this.instru, expiry);\n\n          let iv = this.calculateIV(ltp, pos_strike, AppConstants.INTEREST_RATE, expiry, typet0, mkt_price);\n\n          let t0_ = this.calculateT0AtPointForStrike(point, pos_strike, AppConstants.INTEREST_RATE, expiry, iv, typet0);\n          // console.log('*** ', pos_strike, typet0, expiry, mkt_price, iv, t0_);\n          t0_ = t0_ - element.entry;\n          t0_ = t0_ * element.qty;\n          t0 += t0_;\n\n          let t1_ = this.calculateT0AtPointForStrike(point, pos_strike, AppConstants.INTEREST_RATE, expiry, iv, typet0, 1);\n          t1_ = t1_ - element.entry;\n          t1_ = t1_ * element.qty;\n          t1 += t1_;\n\n          let t2_ = this.calculateT0AtPointForStrike(point, pos_strike, AppConstants.INTEREST_RATE, expiry, iv, typet0, 2);\n          t2_ = t2_ - element.entry;\n          t2_ = t2_ * element.qty;\n          t2 += t2_;\n        }\n        \n      }\n    });\n\n    //console.log('t0', t0);\n    return [pnl, t0, t1, t2];\n  }\n\n  calculateIV(spot, strike, int_rate, expiry_date, type, mkt_price, add_days?) {\n    let high = 80;\n    let low = 0;\n    let iv = 0;\n\n    /* let date_expiry = new Date(expiry_date);\n\n    let date_now = new Date();\n    if (this.simulate_strategy) {\n      date_now = this.simulateCurrDateObj;\n    } */\n\n    /* let days_diff = this.appService.calcWorkingDays(date_now, date_expiry);\n    let seconds = days_diff * 86400;\n    \n    // let seconds = Math.floor((date_expiry.getTime() - date_now.getTime()) / 1000);\n    let\tminutes = Math.floor(seconds / 60);\n    let\thours = Math.floor(minutes / 60);\n    let\tdelta_t = (Math.floor(hours / 24)) / 365.0; */\n\n    /* if (hours < 24) {\n      return 0;\n    } */\n\n    while ((high - low) > 0.0001) {\n      if (this.calculateT0AtPointForStrike(spot, strike, int_rate, expiry_date, (high + low) / 2, type, add_days) > mkt_price) {\n        high = (high + low) / 2;\n      } else {\n        low = (high + low) / 2;\n      }\n    }\n    iv = (high + low) / 2;\n    return iv;\n  }\n\n  calculateT0AtPointForStrike(spot, strike, int_rate, expiry_date, volatility, type, add_days?) {\n    let t0 = 0;\n    let date_expiry = new Date(expiry_date);\n    if (this.instru === 'USDINR') {\n      date_expiry.setHours(12, 30, 0);\n    } else {\n      date_expiry.setHours(15, 30, 0);\n    }\n\n    if (!add_days) {\n      add_days = 0;\n    }\n\n    let date_now = new Date();\n    if (this.simulate_strategy) {\n      date_now = this.simulateCurrDateObj;\n    }\n    \n    date_now.setDate(date_now.getDate() + add_days);\n\n    let days_diff = this.appService.calcWorkingDays(date_now, date_expiry);\n    let seconds = days_diff * 86400;\n\n    //let seconds = Math.floor((date_expiry.getTime() - date_now.getTime()) / 1000);\n    let\tminutes = Math.floor(seconds / 60);\n    let\thours = Math.floor(minutes / 60);\n    let\tdelta_t = (Math.floor(hours / 24)) / 365.0; // time\n\n    /* if (hours < 12) {\n      return 0;\n    }\n    else { */\n      let volt = volatility / 100;\n      int_rate = int_rate / 100;\n\n      let d1 = (Math.log(spot / strike) + (int_rate + (Math.pow(volt, 2) / 2)) * delta_t) / (volt * Math.sqrt(delta_t));\n      // let d2 = (Math.log(spot / strike) + (int_rate - (Math.pow(volt, 2) / 2)) * delta_t) / (volt * Math.sqrt(delta_t));\n      let d2 = d1 - (volt * Math.sqrt(delta_t));\n\n      let fv_strike = (strike) * Math.exp(-1 * int_rate * delta_t);\n\n      if (type === PositionTypeForPayOff.CE) {\n        t0 = spot * this.getCDF(d1) - fv_strike * this.getCDF(d2);\n      }\n\n      if (type === PositionTypeForPayOff.PE) {\n        t0 = fv_strike * this.getCDF(-1 * d2) - spot * this.getCDF(-1 * d1);\n      }\n    /* } */\n    return t0;\n  }\n\n  getCDF(x) {\n    let standardDeviation = Math.sqrt(this.variance);\n    return 0.5 * this.erfc(-(x - this.mean) / (standardDeviation * Math.sqrt(2)));\n  }\n\n  // Complementary error function\n  // From Numerical Recipes in C 2e p221\n  erfc(x) {\n    let z = Math.abs(x);\n    let t = 1 / (1 + z / 2);\n    let r = t * Math.exp(-z * z - 1.26551223 + t * (1.00002368 +\n            t * (0.37409196 + t * (0.09678418 + t * (-0.18628806 +\n            t * (0.27886807 + t * (-1.13520398 + t * (1.48851587 +\n            t * (-0.82215223 + t * 0.17087277)))))))));\n    return x >= 0 ? r : 2 - r;\n  }\n\n  calculatePnLAtPointForStrike(point, pos_strike, qty, entry, type) {\n    let pnl = 0;\n    if (type === PositionTypeForPayOff.CEsell) {\n      if (point > pos_strike) {\n        pnl = (pos_strike - point + entry) * Math.abs(qty);\n      } else {\n        pnl = entry * Math.abs(qty);\n      }\n    }\n    if (type === PositionTypeForPayOff.PEsell) {\n      if (point < pos_strike) {\n        pnl = (-pos_strike + point + entry) * Math.abs(qty);\n      } else {\n        pnl = entry * Math.abs(qty);\n      }\n    }\n    if (type === PositionTypeForPayOff.CEbuy) {\n      if (point > pos_strike) {\n        pnl = (-pos_strike + point - entry) * Math.abs(qty);\n      } else {\n        pnl = entry * -Math.abs(qty);\n      }\n    }\n    if (type === PositionTypeForPayOff.PEbuy) {\n      if (point < pos_strike) {\n        pnl = (pos_strike - point - entry) * Math.abs(qty);\n      } else {\n        pnl = entry * -Math.abs(qty);\n      }\n    }\n\n    // pnl = pnl * lotsize;\n\n    if (pnl !== 0) {\n      pnl = (Math.round((pnl + 0.00001) * 100) / 100);\n    }\n    return pnl;\n  }\n\n  getMargin() {\n    /* let url = this.urlToFetch.replace('payoff', 'margin');\n    this.appService.get(url).subscribe(res => {\n      console.log('getMargin: ', res);\n      this.margin = (res as any).margin.toLocaleString();\n    },\n    error => {\n      console.log('getMargin error', error);\n    }); */\n\n    let d = new Date(this.expiryDate);\n    // let month = d.toLocaleString('default', { month: 'short' }).toUpperCase();\n    let month = AppConstants.monthsMapping[d.getMonth() + 1];\n\n    console.log('getMargin: ', this.curr_positions_trades);\n    this.appService.getZerodhaMargin(this.instru, month, this.curr_positions_trades, this.instru).subscribe((res: any) => {\n      console.log('getMargin: ', res);\n      if (res.total) {\n        this.margin = Math.round(res.total.total).toLocaleString();\n      }\n    },\n    error => {\n      console.log('getMargin error', error);\n    });\n  }\n\n  getROI() {\n    // console.log('roi: ', this.getStrategyPnL(), parseFloat(this.margin.replace(/,/g, '')));\n    if (this.margin) {\n      let roi = (this.getStrategyPnL() / parseFloat(this.margin.replace(/,/g, ''))) * 100;\n      roi = (Math.round((roi + 0.00001) * 100) / 100);\n      return roi;\n    }\n  }\n\n  getPnL(pos, instru?, expiry_date?) { // TODO: read instru\n    let pnl = null;\n    let exit = null;\n    if (pos.exit !== null && pos.exit !== 0) {\n      exit = pos.exit;\n    } else {\n      exit = this.getLTP_strike(pos, instru, expiry_date);\n    }\n\n    if (pos.qty > 0) {\n      let p = (exit - pos.entry) * pos.qty;\n      pnl = p;\n    } else if (pos.qty < 0) {\n      let p = (pos.entry - exit) * -pos.qty;\n      pnl = p;\n    }\n    /* if (position.scrip.includes('USDINR')) {\n      pnl *= 1000;\n    } */\n    pnl = (Math.round((pnl + 0.00001) * 100) / 100);\n    pos.pnl = pnl;\n    return pnl;\n  }\n\n  getStrategyDelta() {\n    let delta = 0;\n    let trades = this.curr_positions_trades;\n    if (trades) {\n      trades.forEach(pos => {\n        if (pos.exit === null || pos.exit === 0) {\n\n          if (this.payoff_overlay && !pos.selected) {\n            return;\n          }\n\n          let type = '';\n          let s = pos.scrip;\n          if (s.includes('CE')) {\n            type = 'CE';\n          }\n          if (s.includes('PE')) {\n            type = 'PE';\n          }\n          let strike = s.slice(0, -2); // remove CE PE at end\n          let ltp = this.getLTP_strike(pos);\n\n          delta += (this.appService.getDelta(this.instru, strike, type, pos.expiry, ltp, this.simulate_strategy, this.simulateCurrDateObj) * pos.qty);\n        }\n      });\n    }\n\n    delta = Math.round((delta + 0.00001) * 100) / 100;\n\n    let suggest_string = ' ( 50: ' + (Math.round(((-delta/50) + 0.00001) * 100) / 100) + \n                          ' , 100: ' + (Math.round(((-delta/100) + 0.00001) * 100) / 100) + \n                          ' , 150: ' + (Math.round(((-delta/150) + 0.00001) * 100) / 100) + \n                          ' , 200: ' + (Math.round(((-delta/200) + 0.00001) * 100) / 100) + ' )'; \n    return delta + suggest_string;\n  }\n\n  getStrategyPnLAfterCharges() {\n    let pnl = this.getStrategyPnL();\n\n    let charges = 0;\n    let trades = this.curr_positions_trades;\n    if (trades) {\n      trades.forEach(pos => {\n        if (pos.exit !== null && pos.exit !== 0) {\n          charges += 70;\n        } else {\n          charges += 35;\n        }\n      });\n    }\n\n    return (pnl - charges);\n  }\n\n  getStrategyPnL(num = null) {\n    let pnl = 0;\n    let pointsProfit = 0;\n    let trades = null;\n    let instru = null;\n    let expiry = null;\n    if (num === null) {\n      trades = this.curr_positions_trades;\n    }\n    if (num === 1 && this.s1Trades) {\n      trades = this.s1Trades.trades;\n      instru = this.s1Trades.instru;\n      expiry = this.s1Trades.expiry;\n    }\n    if (num === 2 && this.s2Trades) {\n      trades = this.s2Trades.trades;\n      instru = this.s2Trades.instru;\n      expiry = this.s2Trades.expiry;\n    }\n    if (num === 3 && this.s3Trades) {\n      trades = this.s3Trades.trades;\n      instru = this.s3Trades.instru;\n      expiry = this.s3Trades.expiry;\n    }\n    if (num === 4 && this.s4Trades) {\n      trades = this.s4Trades.trades;\n      instru = this.s4Trades.instru;\n      expiry = this.s4Trades.expiry;\n    }\n    if (num === 5 && this.s5Trades) {\n      trades = this.s5Trades.trades;\n      instru = this.s5Trades.instru;\n      expiry = this.s5Trades.expiry;\n    }\n    if (trades) {\n      trades.forEach(pos => {\n        if (num) {\n          let posPnl = this.getPnL(pos, instru, pos.expiry);\n          pnl += posPnl;\n          pointsProfit += posPnl / Math.abs(pos.qty);\n          // console.log('points:', pointsProfit);\n        } else {\n          let posPnl = this.getPnL(pos); // pos.pnl;\n          pnl += posPnl;\n          pointsProfit += posPnl / Math.abs(pos.qty);\n        }\n      });\n    }\n    pnl = (Math.round((pnl + 0.00001) * 100) / 100);\n    pointsProfit = (Math.round((pointsProfit + 0.00001) * 100) / 100);\n    // console.log('pointsProfit:', pointsProfit);\n\n    this.chartService.strategyPnLEvent$.next([pnl, pointsProfit]);\n    return pnl;\n  }\n\n  getAlertLtp(alert) {\n    if (alert.selected) {\n      if (alert.scrip1) {\n        let ltp1 =  this.getLTP_strike({ scrip : alert.scrip1 }, alert.instru, alert.expiry);\n        let ltp = ltp1;\n        if (alert.scrip2) {\n          let ltp2 =  this.getLTP_strike({ scrip : alert.scrip2 }, alert.instru, alert.expiry);\n          ltp += ltp2;\n        }\n        return ltp;\n      } else { // index\n        return this.mapService.getLtp(alert.instru);\n      }\n    }\n  }\n\n/*   getLTP(scrip, instru?, expiry_date?) { // scrip: 18000CE\n    return this.getLTP_strike({ scrip : scrip }, instru, expiry_date);\n  } */\n\n  getLTP_strike(pos, instru?, expiry_date?) { // TODO: read instru\n\n    if (!instru) {\n      instru = this.instru;\n    }\n    if (!expiry_date) {\n      expiry_date = pos.expiry; // this.expiryDate;\n    }\n\n    let is_monthly_expiry = false;\n    let expiryDate = new Date(expiry_date);\n    expiryDate.setHours(0, 0, 0, 0);\n\n    let tempmonthlyExpiryDates = AppConstants.monthlyExpiryDates;\n    if (instru === 'USDINR') {\n      tempmonthlyExpiryDates = AppConstants.monthlyExpiryDatesUSDINR;\n    }\n    for (let key in tempmonthlyExpiryDates) {\n      if (tempmonthlyExpiryDates.hasOwnProperty(key)) {\n          // console.log(key + \" -> \" + tempmonthlyExpiryDates[key] + ' ' + expiryDate);\n          if (expiryDate.getTime() === tempmonthlyExpiryDates[key].getTime()) {\n            // console.log('monthly expiry matched');\n            is_monthly_expiry = true;\n            break;\n          }\n      }\n    }\n\n    let expiry = null;\n    if (is_monthly_expiry) {\n      expiry = '' + (expiryDate.getFullYear() - 2000) + AppConstants.monthsMapping[expiryDate.getMonth() + 1];\n    } else {\n      let expiryMonth = null;\n      if (expiryDate.getMonth() + 1 === 10) {\n        expiryMonth = 'O';\n      } else if (expiryDate.getMonth() + 1 === 11) {\n        expiryMonth = 'N';\n      } else if (expiryDate.getMonth() + 1 === 12) {\n        expiryMonth = 'D';\n      } else {\n        expiryMonth = expiryDate.getMonth() + 1;\n      }\n      expiry = '' + (expiryDate.getFullYear() - 2000) + (expiryMonth) + ('0' + expiryDate.getDate()).slice(-2);\n    }\n\n    let str = instru + expiry + pos.scrip;\n    // console.log('str: ' + str);\n    return this.mapService.getLtp(str);\n  }\n\n  getInstruLTP(instru?) { // TODO: read instru\n\n    if (!instru) {\n      instru = this.instru;\n    }\n\n    let scrip = 'NIFTY50';\n    if (instru === 'BANKNIFTY') {\n      scrip = 'BANKNIFTY';\n    }\n    if (instru === 'USDINR') {\n      let expiryDate: Date = AppConstants.monthlyExpiryDatesUSDINR[AppConstants.year + AppConstants.USDINR_FUT_MONTH];\n      let expiryMonth = null;\n      if (expiryDate.getMonth() + 1 === 10) {\n        expiryMonth = 'O';\n      } else if (expiryDate.getMonth() + 1 === 11) {\n        expiryMonth = 'N';\n      } else if (expiryDate.getMonth() + 1 === 12) {\n        expiryMonth = 'D';\n      } else {\n        expiryMonth = expiryDate.getMonth() + 1;\n      }\n      let expiry = '' + (expiryDate.getFullYear() - 2000) + (expiryMonth) + ('0' + expiryDate.getDate()).slice(-2);\n      // scrip = 'USDINR' + expiry + AppConstants.USDINR_FUT_MONTH + AppConstants.year + 'FUT';\n      scrip = 'USDINR' + expiry + AppConstants.USDINR_FUT_MONTH + 'FUT';\n\n      // console.log('getLtp strike: ' + scrip);\n    }\n\n    this.spot = this.mapService.getLtp(scrip);\n\n    return this.spot;\n  }\n\n  addScripToChart(scrip, type) {\n    \n    for (let [key, value] of Object.entries(MapService.simulateData)) {\n\n      if (key === scrip || (key.startsWith(this.simulate_instru) && key.endsWith(scrip))) {\n\n        let chartData = { chart: [] };\n\n        let curr_date = this.simulateCurrDateTimeString.split(' ')[0];\n\n        for (let [k, v] of Object.entries(value)) {\n          if (k.startsWith(curr_date)) {\n            chartData.chart.push({ label: k, close: v });\n          }\n        }\n        \n        console.log('value', curr_date, chartData, value);\n        this.updateFinChartData(chartData, type);\n      }\n    }\n  }\n\n  updateFinChartData(res, type) {\n    if (res) {\n      let labels = [];\n      let close = [];\n\n      if (res.chart && Array.isArray(res.chart)) {\n        res.chart.forEach(element => {\n          \n          labels.push(element.label);\n          close.push(element.close);\n        });\n      }\n\n      if (!type) {\n        this.finLineChartLabelsInstru = labels;\n        this.finLineChartDataInstru = [\n          { data: close, label: 'close' },\n        ];\n      } else if (type === 'CE') {\n        this.finLineChartLabels1 = labels;\n        this.finLineChartData1 = [\n          { data: close, label: 'close' },\n        ];\n      } else if (type === 'PE') {\n        this.finLineChartLabels2 = labels;\n        this.finLineChartData2 = [\n          { data: close, label: 'close' },\n        ];\n      }\n\n      this.finLineChartOptions = {\n        responsive: true,\n        scales: {\n          xAxes: [{}],\n        },\n        tooltips: {\n          mode: 'index',\n          intersect: false,\n        },\n        animation: {\n          duration: 0\n        },\n        /* annotation: {\n          events: ['click'],\n          annotations: this.getChartAnnotations(ltp),\n        } */\n      };\n    }\n  }\n\n  updateChartData(res) {\n    if (res) {\n      this.labels = [];\n      this.pnl = [];\n      let overlay = [];\n      let overlayT0 = [];\n      let overlay2 = [];\n      let overlay3 = [];\n      let t0 = [];\n      let t1 = [];\n      let t2 = [];\n      this.zeroline = [];\n      let count = 0;\n      if (res.chart && Array.isArray(res.chart)) {\n        res.chart.forEach(element => {\n          // Change: -8.1, Final: -102518, StockPrice: 10318, Today: -115484.48, bes: 0\n          count++;\n          if (count < 100) {\n            /* this.labels.push(element.StockPrice);\n            this.pnl.push(element.Final);\n            this.zeroline.push(0); */\n          }\n          this.labels.push(element.StockPrice);\n          this.pnl.push(element.Final);\n          t0.push(element.Today);\n          t1.push(element.T1);\n          t2.push(element.T2);\n          this.zeroline.push(0);\n\n          if (this.payoff_overlay) {\n            overlay.push(element.Overlay);\n            overlayT0.push(element.OverlayT0);\n          }\n\n          if (this.ce_side_overlay || this.pe_side_overlay) {\n            overlay.push(element.Overlay);\n            overlay2.push(element.Overlay2);\n            overlay3.push(element.Overlay3);\n          }\n\n          /* overlay.push(10000); */\n        });\n      }\n      // console.log('payOffEvent labels: ', this.labels);\n      // console.log('payOffEvent pnl: ', this.pnl);\n      this.lineChartLabels = this.labels;\n      this.lineChartData = [\n        { data: this.pnl, label: 'PnL' },\n        { data: t0, label: 'T+0', fill: false, },\n        { data: t1, label: 'T+1', fill: false, },\n        { data: t2, label: 'T+2', fill: false, },\n        { data: overlay, label: 'Overlay', fill: false, },\n        { data: overlayT0, label: 'OverlayT0', fill: false, },\n        { data: overlay2, label: 'Overlay2', fill: false, },\n        { data: overlay3, label: 'Overlay3', fill: false, },\n        /* { data: this.zeroline, label: 'Zero line' }, */\n      ];\n\n      let ltp = 0;\n      if (this.instru === 'USDINR') {\n\n        if (this.use_hypo_future) {\n          let ce_premium = this.getLTP_strike({ scrip : this.hypo_future_strike + 'CE' }, this.instru, this.expiryDate);\n          let pe_premium = this.getLTP_strike({ scrip : this.hypo_future_strike + 'PE' }, this.instru, this.expiryDate);\n          ltp = ce_premium - pe_premium + this.hypo_future_strike; // Find future price from Put Call Parity\n          ltp = (Math.round((ltp + 0.00001) * 100) / 100);\n          console.log('hypo fut:' + ltp);\n        } else {\n          ltp = parseFloat(this.getInstruLTP());\n          ltp = (Math.round((ltp + 0.00001) * 100) / 100); // TODO: ltp rounding for usdinr to two decimal\n        }\n      } else {\n        ltp = parseInt(this.getInstruLTP());\n      }\n\n      this.lineChartOptions = {\n        responsive: true,\n        scales: {\n          xAxes: [{}],\n        },\n        tooltips: {\n          mode: 'index',\n          intersect: false,\n        },\n        animation: {\n          duration: 0\n        },\n        annotation: {\n          events: ['click'],\n          annotations: this.getChartAnnotations(ltp),\n        }\n      };\n    }\n  }\n\n  getChartAnnotations(ltp) {\n    let annotations = [];\n\n    /* let range = 1000;\n    let range_multiple = 50;\n    let increment = 50;\n    if (this.instru === 'BANKNIFTY') {\n      range = 3000;\n      range_multiple = 100;\n      increment = 100;\n    }\n    if (this.instru === 'USDINR') {\n      range = 2;\n      range_multiple = 0.25;\n      increment = 0.25;\n    }\n\n    let round_ltp = (Math.round(ltp / range_multiple) * range_multiple);\n    let lower_range = round_ltp - range; // TODO: range depends on instru\n    let upper_range = round_ltp + range; */\n\n    /* for (let point = lower_range; point <= upper_range; point += increment) {\n      let symbol = point;\n      let ce_premium = this.getLTP_strike({ scrip : symbol + 'CE' }, this.instru, this.expiryDate);\n      let pe_premium = this.getLTP_strike({ scrip : symbol + 'PE' }, this.instru, this.expiryDate);\n\n      annotations.push({\n        drawTime: 'afterDatasetsDraw',\n        type: 'line',\n        mode: 'vertical',\n        scaleID: 'x-axis-0',\n        value: symbol,\n        borderColor: 'white',\n        borderWidth: 0,\n        label: {\n          yAdjust: 180,\n          enabled: true,\n          fontColor: 'white',\n          content: ce_premium\n        },\n        onClick: function(this, e) {\n          let scrip = point + 'CE';\n          console.log('Adding scrip from payoff to strategy: ' + scrip);\n          let qty = 75;\n          if (this.instru === 'BANKNIFTY') {\n            qty = 25;\n          }\n          if (this.instru === 'USDINR') {\n            qty = 1000;\n          }\n          console.log(e);\n          localStorage.setItem('addScripToStrategy', JSON.stringify({qty: qty, scrip: scrip, premium: ce_premium}));\n        }\n      });\n      annotations.push({\n        drawTime: 'afterDatasetsDraw',\n        type: 'line',\n        mode: 'vertical',\n        scaleID: 'x-axis-0',\n        value: symbol,\n        borderColor: 'white',\n        borderWidth: 0,\n        label: {\n          yAdjust: 200,\n          enabled: true,\n          fontColor: 'white',\n          content: pe_premium\n        },\n        onClick: function(e) {\n          let scrip = point + 'PE';\n          console.log('Adding scrip from payoff to strategy: ' + scrip);\n          let qty = 75;\n          if (this.instru === 'BANKNIFTY') {\n            qty = 25;\n          }\n          if (this.instru === 'USDINR') {\n            qty = 1000;\n          }\n          this.addPosition(qty, scrip, pe_premium); // TODO: check instru for lot size\n        }\n      });\n    } */\n/* \n    this.curr_positions_trades.forEach(element => { */\n      /* {\n        qty: 75,\n        scrip: '11150CE',\n        expiry: '01OCT2020',\n        entry: 50,\n        exit: 0,\n      }, */\n      // -375x10950PEx01OCT2020x19.2x0x0&\n/*       if (element.exit === 0) {\n        let symbol = element.scrip.slice(0, -2);\n        symbol = parseFloat(symbol);\n        symbol = (Math.round((symbol + 0.00001) * 100) / 100); // ltp rounding for usdinr to two decimal\n\n        let labelcolor = 'white'; //'lightgreen';\n        let linecolor = 'darkgrey' //'limegreen';\n        let yAdjustBase = 0;\n\n        if (element.scrip.includes('PE')) {\n          //labelcolor = 'salmon';\n          //linecolor = 'salmon';\n          yAdjustBase = 60;\n        } */\n\n        /* if (this.doAnnotationsContainSymbol(annotations, symbol)) {\n          //yAdjustBase = 80;\n          //linecolor = 'darkturquoise';\n        } */\n\n        /* if (element.qty >= 0) {\n          labelcolor = 'white';\n        } */\n        //let pos = '' + (element.qty <= 0 ? element.qty : '+' + element.qty) + 'x' + element.scrip + 'x' + element.expiry + 'x' + element.entry + 'x' + element.exit + 'x0&';\n        /* annotations.push({\n          drawTime: 'afterDatasetsDraw',\n          type: 'line',\n          mode: 'vertical',\n          scaleID: 'x-axis-0',\n          value: symbol,\n          borderColor: linecolor,\n          borderWidth: 1,\n          label: {\n            yAdjust: 0,\n            enabled: true,\n            fontColor: labelcolor,\n            content: symbol\n          }\n        });\n\n        annotations.push({\n          drawTime: 'afterDatasetsDraw',\n          type: 'line',\n          mode: 'vertical',\n          scaleID: 'x-axis-0',\n          value: symbol,\n          borderColor: linecolor,\n          borderWidth: 1,\n          label: {\n            yAdjust: yAdjustBase + 40,\n            enabled: true,\n            fontColor: labelcolor,\n            content: element.qty / 1000\n          }\n        });\n\n        let pnlcolor = 'lightgreen';\n        if (element.pnl < 0) {\n          pnlcolor = 'salmon';\n        } \n        annotations.push({\n          drawTime: 'afterDatasetsDraw',\n          type: 'line',\n          mode: 'vertical',\n          scaleID: 'x-axis-0',\n          value: symbol,\n          borderColor: linecolor,\n          borderWidth: 1,\n          label: {\n            yAdjust: yAdjustBase + 60,\n            enabled: true,\n            fontColor: pnlcolor,\n            content: element.pnl\n          }\n        });\n      }\n    }); */\n\n    annotations.push({\n      drawTime: 'afterDatasetsDraw',\n      type: 'line',\n      mode: 'vertical',\n      scaleID: 'x-axis-0',\n      value: ltp,\n      borderColor: 'orange',\n      borderWidth: 1,\n      label: {\n        yAdjust: -40,\n        enabled: true,\n        fontColor: 'orange',\n        content: ltp\n      }\n    });\n    \n    // console.log(annotations);\n    return annotations;\n  }\n\n  doAnnotationsContainSymbol(annotations, symbol) {\n    for(let i = 0; i < annotations.length; i++) {\n      if (symbol === annotations[i].value) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  updateIntradayChartData() {\n    let labels = [];\n    let prices = [];\n    let spot = [];\n    let ce_intraday = this.chartService.getIntradayData('74CE', 'USDINR', '2020-11-13');\n    let pe_intraday = this.chartService.getIntradayData('74PE', 'USDINR', '2020-11-13');\n    let spot_intraday = this.chartService.getIntradayData('FUT', 'USDINR', AppConstants.USDINR_FUT_MONTH);\n    if (ce_intraday) {\n      ce_intraday.forEach(ce_elem => {\n        let ce_time = ce_elem.time;\n        pe_intraday.forEach(pe_elem => {\n          if (ce_time === pe_elem.time) {\n            let p = ce_elem.price + pe_elem.price;\n            p = Math.round((p + 0.00001) * 100) / 100; // round to 2 decimal places\n            labels.push(ce_time);\n            prices.push(p);\n            return;\n          }\n        });\n        if (spot_intraday) {\n          spot_intraday.forEach(elem => {\n            if (ce_time === elem.time) {\n              spot.push(elem.price);\n              return;\n            }\n          });\n        }        \n      });\n    }\n    \n    // console.log('updateIntradayChartData: ', labels, prices);\n    this.i1ChartLabels = labels;\n    this.i1ChartData = [\n      { data: prices, label: 'Price' },\n      { data: spot, label: 'Underlying', yAxisID: 'y-axis-1' },\n    ];\n  }\n}\n","<!-- {{ getLTP() }} --> \n\n<div class=\"accordion mb-2\" id=\"accordionAlerts\">\n    <div class=\"card\">\n        \n        <button class=\"btn btn-light font-weight-bold\" type=\"button\" data-toggle=\"collapse\" data-target=\"#alertsSection\" aria-expanded=\"false\" aria-controls=\"alertsSection\">\n            Alerts\n        </button>\n\n        <div id=\"alertsSection\" class=\"collapse show p-2\" aria-labelledby=\"headingOne\" data-parent=\"#accordionAlerts\">\n            <div class=\"alerts-flex-container\" *ngFor=\"let alert of alerts; index as i\">\n\n                <div class=\"form-check-inline\">\n                    <input class=\"form-check-input\" [(ngModel)]=\"alert.selected\" type=\"checkbox\" value=\"\" />\n                </div>\n                <select class=\"alert_field form-control form-control-sm mr-2\" [(ngModel)]=\"alert.instru\">\n                    <option value='NIFTY50'>NIFTY</option>\n                    <option value='BANKNIFTY'>BANKNIFTY</option>\n                    <option value='USDINR'>USDINR</option>\n                </select>\n                <input placeholder=\"Scrip1\" [(ngModel)]=\"alert.scrip1\" class=\"mr-2 mb-1 form-control form-control-sm alert_field\"/>\n                <input placeholder=\"Scrip2\" [(ngModel)]=\"alert.scrip2\" class=\"mr-2 mb-1 form-control form-control-sm alert_field\"/>\n                <input placeholder=\"Expiry YYYY-MM-DD\" [(ngModel)]=\"alert.expiry\" class=\"mr-2 mb-1 form-control form-control-sm alert_field\" />\n                <select class=\"alert_field form-control form-control-sm mr-2\" [(ngModel)]=\"alert.compare\">\n                    <option value='>'>></option>\n                    <option value='<'><</option>\n                </select>\n                <input placeholder=\"Price\" type=\"number\" [(ngModel)]=\"alert.price\" class=\"mr-2 mb-1 form-control form-control-sm alert_field\"/>\n                <span>{{ getAlertLtp(alert) }}</span>\n                <span class=\"text-danger ml-2\">{{ alert.status }}</span>\n                    \n            </div>\n\n            <button type=\"button\" class=\"btn btn-link\" (click)=\"subscribeAlerts()\">Refresh LTPs</button>\n        </div>\n\n    </div>\n</div>\n\n<div class=\"accordion mb-2\" id=\"accordionOrders\">\n    <div class=\"card\">\n        \n        <button class=\"btn btn-light font-weight-bold\" type=\"button\" data-toggle=\"collapse\" data-target=\"#ordersSection\" aria-expanded=\"true\" aria-controls=\"ordersSection\">\n            Orders\n        </button>\n\n        <div id=\"ordersSection\" class=\"collapse show p-2\" aria-labelledby=\"headingOne\" data-parent=\"#accordionOrders\">\n            <textarea [(ngModel)]=\"ordersTextarea\" (ngModelChange)=\"ordersTextareaUpdated($event)\" rows=\"5\" style=\"width: 100%\"></textarea>\n            <table class=\"table table-sm table-bordered shadow text-center\">\n                <tbody>\n                    <tr *ngFor=\"let o of orders_parsed; index as i\">              \n                        <td>\n                            {{ o.instru }}\n                        </td>\n                        <td>\n                            {{ o.scrip }}\n                        </td>\n                        <td>\n                            {{ o.qty }}\n                        </td>\n                        <td>\n                            {{ o.price }}\n                        </td>\n                        <!-- <td>\n                            <select class=\"form-control form-control-sm\" [(ngModel)]=\"o.strategy\">\n                                <option value='1'>Strategy 1</option>\n                                <option value='2'>Strategy 2</option>\n                                <option value='3'>Strategy 3</option>\n                                <option value='4'>Strategy 4</option>\n                            </select>\n                        </td> -->\n                    </tr>\n                </tbody>\n            </table>\n\n            <div class=\"confirmation-check form-check-inline mt-0\">\n                <input class=\"form-check-input\" [(ngModel)]=\"orders_broker\" type=\"radio\" value=\"upstox\" id=\"upstox_orders\">\n                <label class=\"form-check-label\" for=\"upstox_orders\">Upstox</label>\n            </div>\n            <div class=\"confirmation-check form-check-inline mt-0\">\n                <input class=\"form-check-input\" [(ngModel)]=\"orders_broker\" type=\"radio\" value=\"zerodha\" id=\"zerodha_orders\">\n                <label class=\"form-check-label\" for=\"zerodha_orders\">Zerodha</label>\n            </div>\n\n            <button type=\"button\" class=\"btn btn-secondary btn-sm\" style=\"margin-top: -7px;\" (click)=\"addOrdersToStrategy()\">Add</button>\n        </div>\n    </div>\n</div>\n\n<div class=\"accordion mb-2\" id=\"accordionPayoff\">\n    <div class=\"card\">\n        \n        <button class=\"btn btn-light font-weight-bold\" type=\"button\" data-toggle=\"collapse\" data-target=\"#payOffSection\" aria-expanded=\"true\" aria-controls=\"payOffSection\">\n            Strategy Payoff\n        </button>\n\n        <div id=\"payOffSection\" class=\"collapse show p-2\" aria-labelledby=\"headingOne\" data-parent=\"#accordionPayoff\">\n\n            <div class=\"chart-all-strategies-pnl text-center\">\n                <span>Strategy 1: <span [ngClass]=\"{\n                    'text-danger': getStrategyPnL(1) < 0,\n                    'text-success': getStrategyPnL(1) > 0\n                  }\" class=\"font-weight-bold\">{{ getStrategyPnL(1) }}</span></span>\n                <span class=\"pl-4 pr-4\">|</span>\n                <span>Strategy 2: <span [ngClass]=\"{\n                    'text-danger': getStrategyPnL(2) < 0,\n                    'text-success': getStrategyPnL(2) > 0\n                  }\" class=\"font-weight-bold\">{{ getStrategyPnL(2) }}</span></span>\n                <span class=\"pl-4 pr-4\">|</span>\n                <span>Strategy 3: <span [ngClass]=\"{\n                    'text-danger': getStrategyPnL(3) < 0,\n                    'text-success': getStrategyPnL(3) > 0\n                  }\" class=\"font-weight-bold\">{{ getStrategyPnL(3) }}</span></span>\n                <span class=\"pl-4 pr-4\">|</span>\n                <span>Strategy 4: <span [ngClass]=\"{\n                    'text-danger': getStrategyPnL(4) < 0,\n                    'text-success': getStrategyPnL(4) > 0\n                  }\" class=\"font-weight-bold\">{{ getStrategyPnL(4) }}</span></span>\n                <span class=\"pl-4 pr-4\">|</span>\n                <span>Strategy 5: <span [ngClass]=\"{\n                    'text-danger': getStrategyPnL(5) < 0,\n                    'text-success': getStrategyPnL(5) > 0\n                  }\" class=\"font-weight-bold\">{{ getStrategyPnL(5) }}</span></span>\n            </div>\n            <hr/>\n            <div class=\"chart-flex-container\">\n\n                <div class=\"chart-chart\" *ngIf=\"!hide_payoff\">\n                    <canvas baseChart width=\"2\" height=\"1\"\n                        [datasets]=\"lineChartData\"\n                        [labels]=\"lineChartLabels\"\n                        [options]=\"lineChartOptions\"\n                        [colors]=\"lineChartColors\"\n                        [legend]=\"lineChartLegend\"\n                        [chartType]=\"lineChartType\"\n                        [plugins]=\"lineChartPlugins\">\n                    </canvas>\n                </div>\n\n                <div class=\"chart-positions\">\n\n                    <div class=\"form-check-inline use-hypo-future-class\">\n                        <label class=\"form-check-label\" for=\"use-range\">Range</label>\n                        <input id=\"use-range\" style=\"width: 100px;\" type=\"number\" placeholder=\"Payoff Range\" [(ngModel)]=\"payoff_range\" class=\"ml-2 form-control form-control-sm\"/>\n                    </div>\n\n                    <div class=\"form-check-inline use-hypo-future-class\">\n                        <input class=\"form-check-input\" [(ngModel)]=\"use_hypo_future\" type=\"checkbox\" value=\"\" id=\"use-hypo-future\">\n                        <label class=\"form-check-label\" for=\"use-hypo-future\">Use Hypothetical Future</label>\n                        <input style=\"width: 100px;\" type=\"number\" placeholder=\"Closest Strike\" [(ngModel)]=\"hypo_future_strike\" class=\"ml-2 form-control form-control-sm\"/>\n                    </div>\n\n                    <div class=\"form-check-inline use-hypo-future-class\">\n                        <input class=\"form-check-input\" [(ngModel)]=\"hide_payoff\" type=\"checkbox\" value=\"\" id=\"hide-payoff\">\n                        <label class=\"form-check-label\" for=\"hide-payoff\">Hide Payoff</label>\n                    </div>\n\n                    <div class=\"form-check-inline use-hypo-future-class\">\n                        <input class=\"form-check-input\" [(ngModel)]=\"simulate_strategy\" type=\"checkbox\" value=\"\" id=\"simulate_strategy\">\n                        <label class=\"form-check-label\" for=\"simulate_strategy\">Simulate Strategy</label>\n                    </div>\n\n                    <div>\n                        <div class=\"form-check-inline use-hypo-future-class\">\n                            <input class=\"form-check-input\" [(ngModel)]=\"ce_side_overlay\" type=\"checkbox\" value=\"\" id=\"ce_side_overlay\">\n                            <label class=\"form-check-label\" for=\"ce_side_overlay\">CE side</label>\n                        </div>\n\n                        <div class=\"form-check-inline use-hypo-future-class\">\n                            <input class=\"form-check-input\" [(ngModel)]=\"pe_side_overlay\" type=\"checkbox\" value=\"\" id=\"pe_side_overlay\">\n                            <label class=\"form-check-label\" for=\"pe_side_overlay\">PE side</label>\n                            <!-- <input style=\"width: 100px;\" type=\"number\" placeholder=\"Num overlays\" [(ngModel)]=\"num_overlays\" class=\"ml-2 form-control form-control-sm\"/> -->\n                        </div>\n\n                        <div class=\"form-check-inline use-hypo-future-class\">\n                            <input class=\"form-check-input\" [(ngModel)]=\"payoff_overlay\" (change)=\"payoffCheckboxChange($event)\" type=\"checkbox\" value=\"\" id=\"payoff_overlay\">\n                            <label class=\"form-check-label\" for=\"payoff_overlay\">Payoff Overlay</label>\n                            <input style=\"width: 100px;\" type=\"number\" placeholder=\"Overlay strike\" [(ngModel)]=\"overlay_strike\" class=\"ml-2 form-control form-control-sm\"/>\n                        </div>\n                    </div>\n\n                    <div class=\"mb-2\" *ngIf=\"simulate_strategy === true\">\n                        <select class=\"strategy_instru form-control form-control-sm mr-2\" [(ngModel)]=\"simulate_instru\">\n                            <option value='NIFTY'>NIFTY</option>\n                            <option value='BANKNIFTY'>BANKNIFTY</option>\n                            <option value='USDINR'>USDINR</option>\n                        </select>\n                        <input placeholder=\"Expiry YYYY-MM-DD\" [(ngModel)]=\"simulateExpiryDate\" class=\"simulateDate mb-1 mr-3 form-control form-control-sm\"/>\n                        <input placeholder=\"Start YYYY-MM-DD\" [(ngModel)]=\"simulateStartDate\" class=\"simulateDate mb-1 mr-3 form-control form-control-sm\"/>\n                        <select class=\"simulateTimeAdv form-control form-control-sm mr-2\" [(ngModel)]=\"simulateTimeAdv\">\n                            <option value='add'>+</option>\n                            <option value='subtract'>-</option>\n                        </select>\n                        <input placeholder=\"mins\" id=\"simulateTimeMins\" [(ngModel)]=\"simulateTimeMins\" class=\"simulateTimeMins mb-1 mr-2 form-control form-control-sm\"/>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"loadSimulatedNextMins()\">Step</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"fileImportInputExpiry.click()\">Import</button>\n                        <button type=\"button\" class=\"btn btn-light btn-sm mr-1\" (click)=\"loadSimulatedNextMins(-120)\">-120</button>\n                        <button type=\"button\" class=\"btn btn-light btn-sm mr-1\" (click)=\"loadSimulatedNextMins(120)\">+120</button>\n                        <button type=\"button\" class=\"btn btn-light btn-sm mr-1\" (click)=\"loadSimulatedNextMins(-15)\">-15</button>\n                        <button type=\"button\" class=\"btn btn-light btn-sm mr-1\" (click)=\"loadSimulatedNextMins(15)\">+15</button>\n                        <button type=\"button\" class=\"btn btn-light btn-sm mr-1\" (click)=\"loadSimulatedNextMins(-5)\">-5</button>\n                        <button type=\"button\" class=\"btn btn-light btn-sm mr-1\" (click)=\"loadSimulatedNextMins(5)\">+5</button>\n                        <button type=\"button\" class=\"btn btn-light btn-sm mr-1\" (click)=\"loadSimulatedNextMins(-1)\">-1</button>\n                        <button type=\"button\" class=\"btn btn-light btn-sm mr-1\" (click)=\"loadSimulatedNextMins(1)\">+1</button>\n                        <input #fileImportInputExpiry style=\"display:none\" type=\"file\" name=\"File Upload Expiry\" (change)=\"uploadExpiryFile($event)\" accept=\".csv\" />\n                        <div>Date Time: {{ simulateCurrDateTimeString }}</div>\n                    </div>\n\n                    <div class=\"mb-2\">Loaded Strategy {{ currLoadNum }}</div>\n                    <select class=\"strategy_instru form-control form-control-sm mr-2\" [(ngModel)]=\"instru\">\n                        <option value='NIFTY'>NIFTY</option>\n                        <option value='BANKNIFTY'>BANKNIFTY</option>\n                        <option value='USDINR'>USDINR</option>\n                    </select>\n                    <input placeholder=\"Expiry YYYY-MM-DD\" id=\"payOffExpiry\" [(ngModel)]=\"expiryDate\" class=\"mb-1 mr-3 form-control form-control-sm\"/>\n                    <button type=\"button\" class=\"btn btn-secondary btn-sm mb-1 mr-2\" (click)=\"doSingleStrategySubscription()\">Refresh LTPs</button>\n                    <button type=\"button\" class=\"btn btn-secondary btn-sm mb-1\" (click)=\"loadOptionChain()\">Load Option Chain</button>\n\n                    <table class=\"table table-sm table-bordered shadow text-center\"><!-- table-responsive -->\n                        <!-- <thead class=\"thead-light\">\n                            <tr>\n                                <th></th>\n                                <th scope=\"col\">Symbol</th>\n                                <th scope=\"col\">Type</th>\n                                <th scope=\"col\">NetQty</th>\n                                <th scope=\"col\">BuyAvg</th>\n                                <th scope=\"col\">SellAvg</th>\n                                <th scope=\"col\">CMP</th>\n                                <th scope=\"col\">PnL</th>\n                                <th scope=\"col\"></th>\n                            </tr>\n                        </thead> -->\n                        <tbody>\n                            <tr *ngFor=\"let pos of curr_positions_trades; index as i\" [ngClass]=\"{ 'positionExited': pos.exit !== 0 }\">  \n                                <td *ngIf=\"payoff_overlay\">\n                                    <div class=\"form-check-inline posCheckbox\">\n                                        <input class=\"form-check-input\" [(ngModel)]=\"pos.selected\" type=\"checkbox\" value=\"\" [disabled]=\"pos.exit !== 0\">\n                                        <input class=\"form-check-input\" [(ngModel)]=\"pos.selectedActual\" type=\"checkbox\" value=\"\" [disabled]=\"pos.exit !== 0\">\n                                    </div>\n                                </td>\n                                <!-- <td>\n                                    <input type=\"checkbox\" [(ngModel)]=\"pos.selected\" class=\"form-control form-control-sm \" />\n                                </td>  -->              \n                                <td>\n                                    <input type=\"number\" placeholder=\"Qty\" [step]=\"stepValue\" [(ngModel)]=\"pos.qty\" class=\"form-control form-control-sm\"/>\n                                </td>\n                                <td>\n                                    <input placeholder=\"Scrip 11500CE\" [(ngModel)]=\"pos.scrip\" class=\"form-control form-control-sm\"/>                        \n                                </td>\n                                <td>\n                                    <input placeholder=\"Expiry 01OCT2020\" [(ngModel)]=\"pos.expiry\" class=\"form-control form-control-sm\"/>                        \n                                </td>\n                                <td>\n                                    <input type=\"number\" placeholder=\"Entry\" [(ngModel)]=\"pos.entry\" class=\"form-control form-control-sm\"/>\n                                </td>\n                                <td>\n                                    <input type=\"number\" placeholder=\"Exit\" [(ngModel)]=\"pos.exit\" class=\"form-control form-control-sm\"/>                        \n                                </td>\n                                <td>\n                                    {{ getLTP_strike(pos) }}\n                                </td>\n                                <td class=\"font-weight-bold\">\n                                    <span [ngClass]=\"{\n                                        'text-danger': pos.pnl < 0,\n                                        'text-success': pos.pnl > 0\n                                      }\">\n                                      {{ getPnL(pos) }}\n                                    </span>\n                                </td>       \n                                <td>\n                                    <button type=\"button\" class=\"btn btn-light btn-sm\" (click)=\"splitPosition(pos)\">+</button>\n                                </td>\n                                <td>\n                                    <button type=\"button\" class=\"btn btn-light btn-sm\" (click)=\"deletePosition(pos)\">X</button>                        \n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n            \n                    <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"addPosition()\">Add</button>\n                    <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"calculatePayoff()\">Preview</button>\n                    <div class=\"mt-2\">\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"savePositions(1)\">Save 1</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"savePositions(2)\">Save 2</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"savePositions(3)\">Save 3</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"savePositions(4)\">Save 4</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"savePositions(5)\">Save 5</button>\n                    </div>\n                    <div class=\"mt-2\">\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"reloadPayoffData(1)\">Load 1</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"reloadPayoffData(2)\">Load 2</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"reloadPayoffData(3)\">Load 3</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"reloadPayoffData(4)\">Load 4</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"reloadPayoffData(5)\">Load 5</button>\n                    </div>\n                    <div class=\"mt-2\">\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"exportToCSV(1)\">Export 1</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"exportToCSV(2)\">Export 2</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"exportToCSV(3)\">Export 3</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"exportToCSV(4)\">Export 4</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"exportToCSV(5)\">Export 5</button>\n                    </div>\n                    <div class=\"mt-2\">\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"fileImportInput1.click()\">Import</button>\n                        <input\n                        #fileImportInput1\n                        style=\"display:none\"\n                        type=\"file\"\n                        name=\"File Upload 1\"\n                        (change)=\"importCSV($event, 1)\"\n                        accept=\".csv\"\n                      />                        \n                        <!-- <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"fileImportInput1.click()\">Import 2</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"fileImportInput1.click()\">Import 3</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"fileImportInput1.click()\">Import 4</button>\n                        <button type=\"button\" class=\"btn btn-secondary btn-sm mr-1\" (click)=\"fileImportInput1.click()\">Import 5</button> -->\n                    </div>\n\n                    <div class=\"mt-2 font-weight-bold\">\n                        Total PnL:\n                        <span [ngClass]=\"{\n                            'text-danger': getStrategyPnL() < 0,\n                            'text-success': getStrategyPnL() > 0\n                          }\">\n                          {{ getStrategyPnL() }}\n                        </span>\n                        <span style=\"font-weight: normal;\">\n                            ({{ getStrategyPnLAfterCharges() }})\n                        </span>\n                    </div>\n                    <div class=\"mt-1\">Delta: {{ getStrategyDelta() }}</div>\n                    <div class=\"mt-1\">Margin: {{ margin }}</div>\n                    <div class=\"mt-1\">ROI: {{ getROI() }} %</div>\n                    <div class=\"mt-1\">Breakevens: {{ breakevens }}</div>\n                    <div class=\"mt-1\">CE: {{ cePremium }} ( {{ ceWeight }}% ) , {{ ceLots }}</div>\n                    <div class=\"mt-1\">PE: {{ pePremium }} ( {{ peWeight }}% ) , {{ peLots }}</div>\n                </div>\n                \n            </div>\n            <!-- <div>Place SLs and entries based on SPOT POSITION. Watch Payoff, Breakevens, Loss at Rs 1.5. Maintain 1:1 RR. Don't enter entire position on same day, divide in days</div>\n            <div>Better to exit a position and re-enter another strike above/below. Place SL based on SPOT, and re-enter another strike on SL hit.</div>\n -->\n\n            <div *ngIf=\"simulate_strategy === true\">\n                <div class=\"chart-flex-container\">\n                    <div class=\"chart-finchart\">\n                        <canvas baseChart width=\"2\" height=\"1\"\n                            [datasets]=\"finLineChartDataInstru\"\n                            [labels]=\"finLineChartLabelsInstru\"\n                            [options]=\"finLineChartOptions\"\n                            [colors]=\"finLineChartColors\"\n                            [legend]=\"lineChartLegend\"\n                            [chartType]=\"lineChartType\"\n                            [plugins]=\"lineChartPlugins\">\n                        </canvas>\n                    </div>\n                </div>\n\n                <div class=\"chart-flex-container\">\n                    <div class=\"chart-finchart\">\n                        <canvas baseChart width=\"2\" height=\"1\"\n                            [datasets]=\"finLineChartData1\"\n                            [labels]=\"finLineChartLabels1\"\n                            [options]=\"finLineChartOptions\"\n                            [colors]=\"finLineChartColors\"\n                            [legend]=\"lineChartLegend\"\n                            [chartType]=\"lineChartType\"\n                            [plugins]=\"lineChartPlugins\">\n                        </canvas>\n                    </div>\n                    <div class=\"chart-finchart\">\n                        <canvas baseChart width=\"2\" height=\"1\"\n                            [datasets]=\"finLineChartData2\"\n                            [labels]=\"finLineChartLabels2\"\n                            [options]=\"finLineChartOptions\"\n                            [colors]=\"finLineChartColors\"\n                            [legend]=\"lineChartLegend\"\n                            [chartType]=\"lineChartType\"\n                            [plugins]=\"lineChartPlugins\">\n                        </canvas>\n                    </div>\n                </div>\n            </div>\n\n            <div>\n                <b>Update 27 Nov:</b>\n                Maintain T+0\n                Monitor extra buying options and buy and exit whenever required.\n                Shift straddle if spot breaching breakeven.\n                Move other side hedge whenever required.\n                End result for the Fly is the straddle one strike near to a side's hedge on the Expiry day.\n                Exit the Fly if getting 3% on deployed capital in the week and move to next week.\n                \n                During the day, maintain your T+0 slope. Do that using extra buying and maintaining appropriate distance of hedge from straddle.\n                If spot is nearing breakeven, make sure that side hedge distance is less than straddle combined premium.\n                At end of the day, if required, then adjust straddle and hedges to achieve the payoff structure and T0 you want.\n                T0 gives your pnl of the day irrespective of whether you are shifting your straddle or not. \n                So maintaining T0 slope is important.\n                If you are shifting straddle constantly, you might capture extra theta decay during the day, but will not be much as compared to original straddle.\n                You will anyways be shifting the straddle at end of day. Not required to shift straddle constantly.\n                Shift straddle has to be shifted when breakeven is breached, because loss rate increases after that at end of day. Also review payoff structure at end of day.\n                Add another lower quantity closer hedged fly if required.\n                <br/>\n\n                <b>Straddle Adjustments:</b>\n                Move straddle legs as per the trend. \n                Not early (to avoid random moves) and Not Late (ITM loss and lower premium)\n                Moving frequently leads to getting lower premium over time.\n                <br/>\n                <b>Hedge Adjustments:</b>\n                Hedges should not be too far and not too close.\n                Too far increases overnight risk. Too close results in late profit realization.\n                Manage intraday moves with extra buy.\n                Maintaining T0 is important.\n                Move untested side hedge inside if cheap.\n\n                Add extra small quantity of buy to manage T0 line according to trend.\n                Monitor option chart for this.\n\n                Look for EMA confirmation, S/R breach for adjustment of straddle and buys.\n                Max loss on a side should be 100 points. In terms of Rs., do 100 * num. lots.\n                Hedge should eventually be at the distance less than straddle premium.\n                <br/>\n                <b>Loss less:</b>\n                A side becomes loss less if NET CREDIT is GREATER than HEDGE DISTANCE on that side.\n                Normally you would have atleast 400 credit in straddle and pay upto 200 on hedges. So net credit is 200. \n                So straddle around 200 points away from hedge can make that side loss less. \n                <br/>\n                <b>Strangle:</b>\n                Sell naked far OTM CE or strangle. Exit the naked option if SL hit. Keep moving untested side naked sell inside.\n                <br/>\n                <b>NEW FLY:</b>\n                If BNF near of crossing breakeven, make CLOSE-HEDGED fly with lower qty at that point. Exit this new fly if BNF moving out of its breakevens.\n                \n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"accordion mb-2\" id=\"accordionStraddle\" *ngIf=\"false\">\n    <div class=\"card\">\n        <button class=\"btn btn-light font-weight-bold\" type=\"button\" data-toggle=\"collapse\" data-target=\"#straddleSection\" aria-expanded=\"true\" aria-controls=\"straddleSection\">\n            Straddle Charts\n        </button>\n        <div id=\"straddleSection\" class=\"collapse show p-2\" aria-labelledby=\"headingOne\" data-parent=\"#accordionStraddle\">\n            <div class=\"chart-flex-container\">\n                <div class=\"chart-positions\">\n                    <select class=\"strategy_instru form-control form-control-sm mr-2\" [(ngModel)]=\"straddle1instru\">\n                        <option value='NIFTY'>NIFTY</option>\n                        <option value='BANKNIFTY'>BANKNIFTY</option>\n                        <option value='USDINR'>USDINR</option>\n                    </select>\n                    <input placeholder=\"Expiry YYYY-MM-DD\" id=\"payOffExpiry\" [(ngModel)]=\"straddle1expiryDate\" class=\"mr-2 mb-1 form-control form-control-sm\"/>\n                    <input placeholder=\"Scrip\" id=\"payOffExpiry\" [(ngModel)]=\"straddle1scrip\" class=\"mb-1 form-control form-control-sm\"/>\n                    \n                    <select class=\"strategy_instru form-control form-control-sm mr-2\" [(ngModel)]=\"straddle2instru\">\n                        <option value='NIFTY'>NIFTY</option>\n                        <option value='BANKNIFTY'>BANKNIFTY</option>\n                        <option value='USDINR'>USDINR</option>\n                    </select>\n                    <input placeholder=\"Expiry YYYY-MM-DD\" id=\"payOffExpiry\" [(ngModel)]=\"straddle2expiryDate\" class=\"mr-2 mb-1 form-control form-control-sm\"/>\n                    <input placeholder=\"Scrip\" id=\"payOffExpiry\" [(ngModel)]=\"straddle2scrip\" class=\"mb-1 form-control form-control-sm\"/>\n                \n                    <select class=\"strategy_instru form-control form-control-sm mr-2\" [(ngModel)]=\"straddle3instru\">\n                        <option value='NIFTY'>NIFTY</option>\n                        <option value='BANKNIFTY'>BANKNIFTY</option>\n                        <option value='USDINR'>USDINR</option>\n                    </select>\n                    <input placeholder=\"Expiry YYYY-MM-DD\" id=\"payOffExpiry\" [(ngModel)]=\"straddle3expiryDate\" class=\"mr-2 mb-1 form-control form-control-sm\"/>\n                    <input placeholder=\"Scrip\" id=\"payOffExpiry\" [(ngModel)]=\"straddle3scrip\" class=\"mb-1 form-control form-control-sm\"/>\n                \n                </div>\n                <div class=\"chart-chart\">\n                    <canvas baseChart width=\"2\" height=\"1\"\n                        [datasets]=\"i1ChartData\"\n                        [labels]=\"i1ChartLabels\"\n                        [options]=\"i1ChartOptions\"\n                        [colors]=\"i1ChartColors\"\n                        [legend]=\"i1ChartLegend\"\n                        [chartType]=\"i1ChartType\"\n                        [plugins]=\"i1ChartPlugins\">\n                    </canvas>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"accordion\" id=\"accordionCharts\" *ngIf=\"false\">\n    <div class=\"card\">\n        \n        <button class=\"btn btn-light font-weight-bold\" type=\"button\" data-toggle=\"collapse\" data-target=\"#chartsSection\" aria-expanded=\"true\" aria-controls=\"chartsSection\">\n            Charts\n        </button>\n\n        <div id=\"chartsSection\" class=\"collapse show p-2\" aria-labelledby=\"headingOne\" data-parent=\"#accordionCharts\">\n\n            <div class=\"chart-flex-container\">\n                <iframe height=\"600\" width=\"760\" src=\"https://ssltvc.forexprostools.com/?pair_ID=8985&height=600&width=760&interval=300&plotStyle=candles&domain_ID=56&lang_ID=56&timezone_ID=20\"></iframe>\n\n                <iframe height=\"600\" width=\"760\" src=\"https://ssltvc.forexprostools.com/?pair_ID=160&height=600&width=760&interval=300&plotStyle=candles&domain_ID=56&lang_ID=56&timezone_ID=20\"></iframe>\n                \n\n            </div>\n\n        </div>\n    </div>\n</div>\n\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { ChartsModule } from 'ng2-charts';\nimport { AppRoutingModule } from '../app-routing.module';\nimport { ChartComponent } from './chart.component';\nimport { ChartService } from './chart.service';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    BrowserModule,\n    AppRoutingModule,\n    HttpClientModule,\n    FormsModule,\n    ReactiveFormsModule,\n    ChartsModule\n  ],\n  exports: [ChartComponent],\n  declarations: [ChartComponent],\n  providers: [ChartService]\n})\nexport class ChartModule { }\n","import { Injectable } from '@angular/core';\nimport { interval, Subject } from 'rxjs';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { FyersService } from '../common/fyers.service';\nimport { AliceblueService } from '../common/aliceblue.service';\nimport { AppConstants } from '../common/application.constant';\nimport { MapService } from '../common/map.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChartService {\n\n  public requestStatusEvent$: Subject<any> = new Subject();\n  public optionChainEvent$: Subject<any> = new Subject();\n  public strategyPnLEvent$: Subject<any> = new Subject();\n  intradayData = new Map<any, any>();\n\n  constructor(\n    private http: HttpClient,\n    private mapService: MapService,\n    private fyersService: FyersService,\n    private aliceblueService: AliceblueService\n  ) { }\n\n  getIntradayData(scrip, instru, expiry) {\n    return this.intradayData.get(instru + ' ' + expiry + ' ' + scrip);\n  }\n\n  loadIntradayData(intradayWatch) {\n    console.log('Loading intraday data');\n    intradayWatch.forEach(element => {\n      let prices = JSON.parse(localStorage.getItem(element.instru + ' ' + element.expiry + ' ' + element.scrip));\n      this.intradayData.set(element.instru + ' ' + element.expiry + ' ' + element.scrip, prices);\n    });\n    console.log('Loaded intraday data: ', this.intradayData);\n  }\n\n  initFetchIntraday(intradayWatch) {\n\n    interval(500).subscribe((sec) => {\n      // console.log('Fetching intraday data');\n      let cutOffTime = new Date();\n      cutOffTime.setHours(17, 5, 0, 0);\n      let openTime = new Date();\n      openTime.setHours(8, 55, 0, 0);\n\n      let currTime = new Date().getTime();\n      if (currTime > cutOffTime.getTime()) {\n        return;\n      }\n      if (currTime < openTime.getTime()) {\n        return;\n      }\n      if (new Date().getDay() === 6 || new Date().getDay() === 0) {\n        return;\n      }\n\n      intradayWatch.forEach(element => {\n\n        let scrip = element.scrip;\n        let instru = element.instru;\n        let expiry = element.expiry;\n        let ltp = null;\n        if (scrip === 'FUT' || scrip === 'SPOT') {\n          ltp = this.getInstruLTP(instru);\n        } else {\n          ltp = this.getLTP_strike(scrip, instru, expiry);\n        }\n\n        if (ltp) {\n          let arr = this.intradayData.get(instru + ' ' + expiry + ' ' + scrip);\n          if (!arr) {\n            arr = [];\n          }\n\n          let d = new Date();\n          // \"2020-10-15 8:24\"\n          let dformat = [d.getFullYear(), d.getMonth() + 1, d.getDate()].join('-')\n                        + ' ' +\n                        [d.getHours(), d.getMinutes()].join(':');\n          // let prev_ltp = arr[dformat];\n\n          let found = null;\n          for (let i = 0; i < arr.length; i++) {\n            if (arr[i].time && arr[i].time === dformat) {\n              found = i;\n              break;\n            }\n          }\n          if (found !== null) {\n            arr[found] = { time: dformat, price: ltp };\n          } else {\n            arr.push({ time: dformat, price: ltp });\n          }\n\n          // arr[dformat] = ltp;\n          this.intradayData.set(instru + ' ' + expiry + ' ' + scrip, arr);\n          // console.log('intradayData: ', this.intradayData);\n        }\n      });\n    });\n  }\n\n  getLTP_strike(scrip, instru, expiry_date) {\n\n    let is_monthly_expiry = false;\n    let expiryDate = new Date(expiry_date);\n    expiryDate.setHours(0, 0, 0, 0);\n\n    let tempmonthlyExpiryDates = AppConstants.monthlyExpiryDates;\n    if (instru === 'USDINR') {\n      tempmonthlyExpiryDates = AppConstants.monthlyExpiryDatesUSDINR;\n    }\n    for (let key in tempmonthlyExpiryDates) {\n      if (tempmonthlyExpiryDates.hasOwnProperty(key)) {\n          // console.log(key + \" -> \" + tempmonthlyExpiryDates[key] + ' ' + expiryDate);\n          if (expiryDate.getTime() === tempmonthlyExpiryDates[key].getTime()) {\n            // console.log('monthly expiry matched');\n            is_monthly_expiry = true;\n            break;\n          }\n      }\n    }\n\n    let expiry = null;\n    if (is_monthly_expiry) {\n      expiry = '' + (expiryDate.getFullYear() - 2000) + AppConstants.monthsMapping[expiryDate.getMonth() + 1];\n    } else {\n      let expiryMonth = null;\n      if (expiryDate.getMonth() + 1 === 10) {\n        expiryMonth = 'O';\n      } else if (expiryDate.getMonth() + 1 === 11) {\n        expiryMonth = 'N';\n      } else if (expiryDate.getMonth() + 1 === 12) {\n        expiryMonth = 'D';\n      } else {\n        expiryMonth = expiryDate.getMonth() + 1;\n      }\n      expiry = '' + (expiryDate.getFullYear() - 2000) + (expiryMonth) + ('0' + expiryDate.getDate()).slice(-2);\n    }\n\n    let str = instru + expiry + scrip;\n    // console.log('str: ' + str);\n    return this.mapService.getLtp(str);\n  }\n\n  getInstruLTP(instru) {\n\n    let scrip = 'NIFTY50';\n    if (instru === 'BANKNIFTY') {\n      scrip = 'BANKNIFTY';\n    }\n    if (instru === 'USDINR') {\n      let expiryDate: Date = AppConstants.monthlyExpiryDatesUSDINR[AppConstants.year + AppConstants.USDINR_FUT_MONTH];\n      let expiryMonth = null;\n      if (expiryDate.getMonth() + 1 === 10) {\n        expiryMonth = 'O';\n      } else if (expiryDate.getMonth() + 1 === 11) {\n        expiryMonth = 'N';\n      } else if (expiryDate.getMonth() + 1 === 12) {\n        expiryMonth = 'D';\n      } else {\n        expiryMonth = expiryDate.getMonth() + 1;\n      }\n      let expiry = '' + (expiryDate.getFullYear() - 2000) + (expiryMonth) + ('0' + expiryDate.getDate()).slice(-2);\n      scrip = 'USDINR' + expiry + AppConstants.USDINR_FUT_MONTH + 'FUT';\n      // console.log('getLtp strike: ' + scrip);\n    }\n\n    let spot = this.mapService.getLtp(scrip);\n\n    return spot;\n  }\n\n  saveIntradayData() {\n    // console.log('Saving intraday data: ');\n    interval(1000).subscribe((sec) => {\n\n      for (let [key, value] of this.intradayData) {\n\n        let val = value;\n        // console.log('Saving intraday data: ', val);\n        // console.log('Saving intraday data json: ', JSON.stringify(val));\n        localStorage.setItem(\n          key,\n          JSON.stringify(val)\n        );\n      }\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AppConstants } from './application.constant';\nimport { AppService } from '../app.service';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { AliceBlueWsFrameMode, AliceblueInstrument, AliceBlueLiveFeedType, Instrument, AliceMarketData } from './models';\nimport { WebsocketService } from './websocket.service';\nimport { MapService } from './map.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AliceblueParserService {\n\n  constructor(\n    private http: HttpClient,\n    private mapService: MapService\n  ) { }\n\n  handleSocketMessage(binaryData) {\n    // console.log('AliceblueService message', binaryData);\n    this.parseSocketMessage(binaryData);\n  }\n\n  parseSocketMessage(binaryData) {\n    const dataByteArry = new Uint8Array(binaryData);\n    if (dataByteArry instanceof Uint8Array) {\n      let mode = dataByteArry[0];\n      // let payload = dataByteArry.subarray(1);\n      // console.log('mode', mode);\n      if (mode === AliceBlueWsFrameMode.MARKETDATA) {\n        this.parseMarketData(dataByteArry);\n      } else if (mode === AliceBlueWsFrameMode.COMPACT_MARKETDATA) {\n\n      } else if (mode === AliceBlueWsFrameMode.SNAPQUOTE) {\n\n      } else if (mode === AliceBlueWsFrameMode.FULL_SNAPQUOTE) {\n\n      } else if (mode === AliceBlueWsFrameMode.DPR) {\n\n      } else if (mode === AliceBlueWsFrameMode.OI) {\n        console.log('***** RECEIVED OI');\n      } else if (mode === AliceBlueWsFrameMode.MARKET_STATUS) {\n\n      } else if (mode === AliceBlueWsFrameMode.EXCHANGE_MESSAGES) {\n\n      }\n    } else {\n      console.error('Error while converting binary data to byte array');\n    }\n  }\n\n  parseMarketData(payload: Uint8Array) {\n    // console.log(payload.byteLength);\n    /* for (let i = 0; i < payload.byteLength; i++) {\n      // do something with each byte in the array\n    } */\n    let p = new AliceMarketData();\n    p.exchange_code = payload[1];\n\n    let multiplier = 100;\n    if (p.exchange_code === 3) {\n      multiplier = 10000000;\n    }\n\n    // console.log(p.exchange_code);\n    // console.log(enc.decode(payload.subarray(0, 2)));\n    // console.log(this.byteArrayToNumber(payload.subarray(6, 10), 24));\n    p.token = this.byteArrayToNumber(payload.subarray(2, 6), 24);\n    p.ltp = this.byteArrayToNumber(payload.subarray(6, 10), 24) / multiplier;\n    p.ltt_unix = this.byteArrayToNumber(payload.subarray(10, 14), 24);\n    p.last_traded_qty = this.byteArrayToNumber(payload.subarray(14, 18), 24);\n    p.volume = this.byteArrayToNumber(payload.subarray(18, 22), 24);\n    p.best_bid = this.byteArrayToNumber(payload.subarray(22, 26), 24) / multiplier;\n    p.best_bid_qty = this.byteArrayToNumber(payload.subarray(26, 30), 24);\n    p.best_ask = this.byteArrayToNumber(payload.subarray(30, 34), 24) / multiplier;\n    p.best_ask_qty = this.byteArrayToNumber(payload.subarray(34, 38), 24);\n    p.total_buy_qty = this.byteArrayToNumber(payload.subarray(38, 46), 56);\n    p.total_sell_qty = this.byteArrayToNumber(payload.subarray(46, 54), 56);\n    p.atp = this.byteArrayToNumber(payload.subarray(54, 58), 24) / multiplier;\n    p.exchange_timestamp = this.byteArrayToNumber(payload.subarray(58, 62), 24);\n    p.open = this.byteArrayToNumber(payload.subarray(62, 66), 24) / multiplier;\n    p.high = this.byteArrayToNumber(payload.subarray(66, 70), 24) / multiplier;\n    p.low = this.byteArrayToNumber(payload.subarray(70, 74), 24) / multiplier;\n    p.close = this.byteArrayToNumber(payload.subarray(74, 78), 24) / multiplier;\n    p.year_high = this.byteArrayToNumber(payload.subarray(78, 82), 24) / multiplier;\n    p.year_low = this.byteArrayToNumber(payload.subarray(82, 86), 24) / multiplier;\n    // console.log('parseMarketData:', p);\n    // console.log('parseMarketData:', new Date(p.ltt_unix * 1000), new Date(p.ltt_unix * 1000).getHours(), new Date(p.ltt_unix * 1000).getMinutes(), new Date(p.ltt_unix * 1000).getSeconds());\n    /* if (seconds === 0) {\n      update current min\n    } else {\n      update current min+1\n    } */\n    this.updateMaps(p);\n  }\n\n  private convertPayloadToString(payload: Uint8Array): string {\n    let payloadstr = String.fromCharCode.apply(null, payload);\n    return payloadstr;\n  }\n\n  byteArrayToNumber(bufferedArray: Uint8Array, shiftMax: number): number {\n    let accum = 0;\n    let shiftBy = 0;\n    let startIndex = 0;\n\n    for (shiftBy = shiftMax; shiftBy >= 0; shiftBy -= 8) {\n      accum |= (bufferedArray[startIndex] & 0xff) << shiftBy;\n      startIndex++;\n      // console.log(accum, shiftBy, startIndex);\n    }\n\n    return accum;\n  }\n\n  updateMaps(p: AliceMarketData) {\n    let instru_masters = AppConstants.abMastersContract.get(p.token);\n\n    if (instru_masters) {\n      // console.log('instru_masters.symbol', instru_masters.symbol);\n      let split = instru_masters.symbol.split(' ');\n      let instru = split[0];\n      let strike = isNaN(split[split.length - 2] as any) ? split[split.length - 2] : Number(split[split.length - 2]);\n      let type = split[split.length - 1];\n\n      let expiry = '';\n      if (split.length === 4) {// NIFTY JUN 9000 PE\n        expiry = AppConstants.year + split[1]; // TODO: make year 21 when 2021 year starts\n        // console.log(expiry);\n      } else { // USDINR 19 JUN20 77.0 CE, NIFTY JUN FUT, NIFTY 13 AUG20 9000.0 PE\n        let expiryDate = new Date(instru_masters.expiry);\n        // console.log((expiryDate.getFullYear() - 2000), (expiryDate.getMonth() + 1), expiryDate.getDate());\n        let expiryMonth = null;\n        if (expiryDate.getMonth() + 1 === 10) {\n          expiryMonth = 'O';\n        } else if (expiryDate.getMonth() + 1 === 11) {\n          expiryMonth = 'N';\n        } else if (expiryDate.getMonth() + 1 === 12) {\n          expiryMonth = 'D';\n        } else {\n          expiryMonth = expiryDate.getMonth() + 1;\n        }\n        expiry = '' + (expiryDate.getFullYear() - 2000) + (expiryMonth) + ('0' + expiryDate.getDate()).slice(-2); // expiryDate.getDate();\n      }\n\n      let symbol = instru + expiry + strike + type; // NIFTY2061810000CE NIFTY20JUN10000CE NIFTY20N1810000CE\n\n      // console.log('updateMaps strike is', symbol);\n      this.mapService.setLtp(symbol, p.ltp);\n      this.mapService.setAtp(symbol, p.atp);\n      this.mapService.setVolume(symbol, p.volume);\n      // this.mapService.setOI(instru_masters.symbol, p.oi);\n      // this.mapService.setChgOI(instru_masterss.symbol, p.chgoi);\n    } else { // symbol is in nse masters or cds masters, not nfo masters\n      let symbol = '';\n      if (p.token === 26000) {\n        symbol = 'NIFTY50';\n      } else if (p.token === 26009) {\n        symbol = 'BANKNIFTY';\n      } else if (p.token === 1) {\n        symbol = 'USDINR';\n      } else {\n        console.error(p.token, 'not found in masters');\n      }\n      this.mapService.setLtp(symbol, p.ltp);\n      this.mapService.setAtp(symbol, p.atp);\n      this.mapService.setVolume(symbol, p.volume);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AppConstants } from './application.constant';\nimport { AppService } from '../app.service';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { AliceBlueWsFrameMode, AliceblueInstrument, AliceBlueLiveFeedType, Instrument } from './models';\nimport { WebsocketService } from './websocket.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AliceblueService {\n\n  baseUrl = 'https://ant.aliceblueonline.com';\n  // abMastersContract: AliceblueInstrument[] = [];\n\n  constructor(\n    private http: HttpClient,\n    private webSocketService: WebsocketService\n  ) { }\n\n  getMastersContract(access_token?) {\n    let httpOptions = {\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + '/api/v2/contracts.json?exchanges=NFO';\n    this.http.get(url, httpOptions).subscribe((res: any) => {\n      console.log('AliceblueService getMastersContract', res);\n      if (res) {\n        AppConstants.abMastersContract.clear();\n        for (let o in res) {\n          if (res[o] instanceof Array) {\n            res[o].forEach(i => {\n              let p = new AliceblueInstrument();\n              p.symbol = i.symbol; // USDINR 19 JUN20 77.0 CE, NIFTY JUN FUT, NIFTY JUN 9000 PE, NIFTY 13 AUG20 9000.0 PE\n              p.lotSize = Number(i.lotSize);\n              p.expiry = new Date(i.expiry * 1000).toDateString();\n              p.exchange_code = i.exchange_code;\n              p.exchange = i.exchange;\n              p.company = i.company;\n              p.code = Number(i.code);\n              // let split = i.symbol.split(' ');\n              // let key = split[0] + split[split.length - 2] + split[split.length - 1]; // NIFTY10000CE\n              /* if (i.code === 95734 || i.code === '95734') {\n                console.log('**** FOUND', i.code);\n              } */\n              if (p.code === 95734) {\n                // console.log('**** FOUND', i.code);\n              }\n              AppConstants.abMastersContract.set(p.code, p);\n            });\n          }\n        }\n\n        this.connectWebsocket(access_token);\n\n      }\n      console.log('AliceblueService getMastersContract abMastersContract', AppConstants.abMastersContract);\n    },\n    error => {\n      console.log('AliceblueService getMastersContract error', error);\n    });\n  }\n\n  connectWebsocket(access_token) {\n    this.webSocketService.connect(access_token);\n  }\n\n  sendSubscriptions(instruments: Instrument[]) {\n    /* for _instrument in instrument:\n                if not isinstance(_instrument, Instrument):\n                    raise TypeError(\"Required parameter instrument not of type Instrument\")\n                exchange = self.__exchange_codes[_instrument.exchange] \n                arr.append([exchange, int(_instrument.token)])\n                self.__subscribers[_instrument] = live_feed_type\n    arr.append([exchange, int(_instrument.token)])\n    data = json.dumps({'a' : 'subscribe', 'v' : arr, 'm' : AliceBlueLiveFeedType.MARKET_DATA}) */\n\n    let arr = [];\n    instruments.forEach(instrument => {\n      let instru = this.findStrikeInMasters(instrument);\n      if (instru) {\n        arr.push([instru.exchange_code, instru.code]);\n      }\n    });\n    let message = JSON.stringify({'a' : 'subscribe', 'v' : arr, 'm' : AliceBlueLiveFeedType.MARKET_DATA});\n\n    console.log('sendSubscriptions: ' + message);\n    this.webSocketService.sendMessage(message);\n  }\n\n  findStrikeInMasters(instrument: Instrument): AliceblueInstrument {\n/*\n    symbol in masters:\n    USDINR 19 JUN20 77.0 CE\n    NIFTY 13 AUG20 9000.0 PE\n    NIFTY JUN FUT\n    NIFTY JUN 9000 PE\n */\n    let return_instru = null;\n    AppConstants.abMastersContract.forEach(element => {\n    // for (let i = 0; i < this.abMastersContract.length; i++) {\n      // let element = this.abMastersContract[i];\n      let split = element.symbol.split(' ');\n      let instru = split[0];\n      let strike = split[split.length - 2];\n      let type = split[split.length - 1];\n      // console.log(instru, strike, type, element.expiry, instrument.instru, instrument.strike, instrument.type, instrument.expiry);\n      if (instrument.expiry === element.expiry &&\n           instrument.instru === instru &&\n           instrument.strike === Number(strike) &&\n           instrument.type === type) {\n        return_instru = element;\n        return;\n      }\n    });\n    return return_instru;\n\n    /*\n    for contract in master_contract:\n            if symbol == master_contract[contract].symbol.split(' ')[0]:\n                matches.append(master_contract[contract])\n    matches = []\n    for i in res:\n        if(i.expiry == expiry_date):\n            matches.append(i)\n    for i in matches:\n        if(is_fut == True):\n            if('FUT' in i.symbol):\n                return i\n        else:\n            sp = i.symbol.split(' ')\n            if((sp[-1] == 'CE') or (sp[-1] == 'PE')):\n                if(float(sp[-2]) == float(strike)):\n                    if(is_CE == True):\n                        if(sp[-1] == 'CE'):\n                            return i\n                    else:\n                        if(sp[-1] == 'PE'):\n                            return i */\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AppConstants } from './application.constant';\nimport { AppService } from '../app.service';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { from } from 'rxjs';\nimport * as xml2js from 'xml2js';\nimport { AliceblueInstrument, AliceBlueLiveFeedType, Instrument } from './models';\nimport { AngelWebsocketService } from './angelwebsocket.service';\n// const fyers = require('fyers-api');\n// import * as fyers from 'fyers-api';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AngelService {\n\n  baseUrl = 'https://apiconnect.angelbroking.com';\n\n  constructor(\n    private http: HttpClient,\n    private angelWS: AngelWebsocketService\n  ) { }\n\n  getAngelHeaders() {\n    \n  }\n\n  angelLogin() {\n\n    this.auth().subscribe((res: any) => {\n      console.log('angel auth', res);\n      if (res && res.data) {\n        AppConstants.angelFeedToken = res.data.feedToken;\n        AppConstants.angelJWTToken = res.data.jwtToken;\n        AppConstants.angelRefreshToken = res.data.refreshToken;\n\n        this.angelWS.connect();\n      }\n    },\n    error => {\n      console.log('angel auth error', error);\n    });\n  }\n\n  getMastersContract() {\n    let httpOptions = {\n      responseType: 'json' as 'json'\n    };\n\n    let url = 'https://margincalculator.angelbroking.com/OpenAPI_File/files/OpenAPIScripMaster.json';\n    this.http.get(url, httpOptions).subscribe((res: any) => {\n      console.log('AngelService getMastersContract', res);\n      if (res) {\n        AppConstants.abMastersContract.clear();\n        res.forEach(i => {\n\n          // {\"token\":\"37616\",\"symbol\":\"BANKNIFTY28OCT2139100CE\",\"name\":\"BANKNIFTY\",\"expiry\":\"28OCT2021\",\"strike\":\"3910000.000000\",\"lotsize\":\"25\",\"instrumenttype\":\"OPTIDX\",\"exch_seg\":\"NFO\",\"tick_size\":\"5.000000\"},\n\n          let p = new AliceblueInstrument();\n\n          let multiplier = 100;\n          if (i.exch_seg === 'CDS') {\n            multiplier = 10000000;\n          }\n\n          p.instru = i.name;\n          p.strike = Number(i.strike) / multiplier;\n          if (i.symbol.endsWith('CE')) {\n            p.optionType = 'CE';\n          }\n          if (i.symbol.endsWith('PE')) {\n            p.optionType = 'PE';\n          }\n          if (i.symbol.endsWith('FUT')) {\n            p.optionType = 'FUT';\n          } \n\n          p.symbol = i.symbol; // BANKNIFTY28OCT2139100CE NIFTY28OCT21FUT USDINR21O1475.25CE\n          p.lotSize = Number(i.lotsize);\n          p.expiry = new Date(i.expiry).toDateString();\n          // p.exchange_code = i.exchange_code;\n          p.exchange = i.exch_seg;\n          // p.company = i.company;\n          p.code = Number(i.token);\n          // let split = i.symbol.split(' ');\n          // let key = split[0] + split[split.length - 2] + split[split.length - 1]; // NIFTY10000CE\n          /* if (i.code === 95734 || i.code === '95734') {\n            console.log('**** FOUND', i.code);\n          } */\n          if (p.code === 95734) {\n            // console.log('**** FOUND', i.code);\n          }\n          AppConstants.abMastersContract.set(p.code, p);\n\n        });\n\n        this.angelLogin();\n      }\n      console.log('AngelService getMastersContract abMastersContract', AppConstants.abMastersContract);\n    },\n    error => {\n      console.log('AngelService getMastersContract error', error);\n    });\n  }\n\n  sendSubscriptions(instruments: Instrument[]) {\n    /* for _instrument in instrument:\n                if not isinstance(_instrument, Instrument):\n                    raise TypeError(\"Required parameter instrument not of type Instrument\")\n                exchange = self.__exchange_codes[_instrument.exchange] \n                arr.append([exchange, int(_instrument.token)])\n                self.__subscribers[_instrument] = live_feed_type\n    arr.append([exchange, int(_instrument.token)])\n    data = json.dumps({'a' : 'subscribe', 'v' : arr, 'm' : AliceBlueLiveFeedType.MARKET_DATA}) */\n\n    let arr = [];\n    instruments.forEach(instrument => {\n      let instru = this.findStrikeInMasters(instrument);\n      \n    });\n    // let message = JSON.stringify({'a' : 'subscribe', 'v' : arr, 'm' : AliceBlueLiveFeedType.MARKET_DATA});\n\n    let strwatchlistscrips = 'nse_fo|43315&nse_fo|38692'\n    let subs = '{\"task\":\"mw\",\"channel\":\"' + strwatchlistscrips + '\",\"token\":\"' + AppConstants.angelFeedToken + '\",\"user\": \"' + AppConstants.angelUserId + '\",\"acctid\":\"' + AppConstants.angelUserId + '\"}';\n      \n    \n    console.log('angel sendSubscriptions: ' + subs);\n    this.angelWS.sendMessage(subs);\n  }\n\n  findStrikeInMasters(instrument: Instrument): AliceblueInstrument {\n/*\n    symbol in masters:\n    BANKNIFTY28OCT2139100CE \n    NIFTY28OCT21FUT \n    USDINR21O1475.25CE\n */\n    let return_instru = null;\n    AppConstants.abMastersContract.forEach(element => {\n\n      // console.log(instru, strike, type, element.expiry, instrument.instru, instrument.strike, instrument.type, instrument.expiry);\n      if (instrument.expiry === element.expiry &&\n           instrument.instru === element.instru &&\n           instrument.strike === element.strike &&\n           instrument.type === element.optionType) {\n        return_instru = element;\n        return;\n      }\n    });\n    return return_instru;\n  }\n\n\n  auth() {\n    /* let reqBody = { 'app_id': AppConstants.fyersAppId, 'secret_key':  AppConstants.fyersSecretId };\n    return fyers.auth(reqBody); */\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'X-UserType': 'USER',\n        'X-SourceID': 'WEB',\n        'X-ClientLocalIP': '192.168.0.2',\n        'X-ClientPublicIP': '101.190.74.150',\n        'X-MACAddress': '37:ab:f8:95:27:ff',\n        'X-PrivateKey': AppConstants.angelAPIKey,        \n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + '/rest/auth/angelbroking/user/v1/loginByPassword';\n\n    let body = {'clientcode':AppConstants.angelUserId,'password':AppConstants.angelPassword};\n\n    return this.http.post(url, body, httpOptions);\n\n    /* {\n      \"status\": true,\n      \"message\": \"SUCCESS\",\n      \"errorcode\": \"\",\n      \"data\": {\n          \"jwtToken\": \"eyJhbGciOiJIUzUxMiJ9.eyJ1c2VybmFtZSI6IkExNjUzMDciLCJyb2xlcyI6MCwidXNlcnR5cGUiOiJVU0VSIiwiaWF0IjoxNjA4NTY0MDU4LCJleHAiOjE2MDg1NzMwNTh9.VTx5ZmHagVRoPiS982j1LnIyNvpK7QIknwctRgO_QBlntYSAuWCuhEPzjC-rKJjqul2imxOvPLYZ6JVIuqVcPw\",\n          \"refreshToken\": \"eyJhbGciOiJIUzUxMiJ9.eyJ0b2tlbiI6IlJFRlJFU0gtVE9LRU4iLCJpYXQiOjE2MDg1NjQwNTh9.JWbUh1b1XcqLQUJzWr270DrFSsIjrZe4X4d6iDdgpjmy6p_AYt38qJukRuuNekztfvrwyOPVw3j8ni5H8xvOBQ\",\n          \"feedToken\": \"1168502830\"\n      }\n    } */\n  }\n\n  getFunds(access_token) {\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        Authorization: 'Bearer ' + access_token,\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'X-UserType': 'USER',\n        'X-SourceID': 'WEB',\n        'X-ClientLocalIP': '192.168.0.2',\n        'X-ClientPublicIP': '101.190.74.150',\n        'X-MACAddress': '37:ab:f8:95:27:ff',\n        'X-PrivateKey': AppConstants.angelAPIKey,        \n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + '/rest/secure/angelbroking/user/v1/getRMS';\n    return this.http.get(url, httpOptions);\n\n    /* {\n      \"status\": true,\n      \"message\": \"SUCCESS\",\n      \"errorcode\": \"\",\n      \"data\": {\n          \"net\": \"80152.68437499999709\",\n          \"availablecash\": \"80152.68437499999709\",\n          \"availableintradaypayin\": \"100000\",\n          \"availablelimitmargin\": \"0\",\n          \"collateral\": \"0\",\n          \"m2munrealized\": \"0\",\n          \"m2mrealized\": \"0\",\n          \"utiliseddebits\": \"19847.315624999999272\",\n          \"utilisedspan\": \"0\",\n          \"utilisedoptionpremium\": \"0\",\n          \"utilisedholdingsales\": \"0\",\n          \"utilisedexposure\": \"0\",\n          \"utilisedturnover\": \"0\",\n          \"utilisedpayout\": \"0\"\n      }\n    } */\n  }\n\n  getPositions(access_token) {\n\n    /* return from(\n      [this.convertToJson(AppConstants.dummyResPos.replace('\\ufeff', ''))]\n    ); */\n\n    /* return from(\n      [JSON.parse(AppConstants.dummyResPos)]\n    ); */\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        Authorization: 'Bearer ' + access_token,\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'X-UserType': 'USER',\n        'X-SourceID': 'WEB',\n        'X-ClientLocalIP': '192.168.0.2',\n        'X-ClientPublicIP': '101.190.74.150',\n        'X-MACAddress': '37:ab:f8:95:27:ff',\n        'X-PrivateKey': AppConstants.angelAPIKey,        \n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + '/rest/secure/angelbroking/order/v1/getPosition';\n    return this.http.get(url, httpOptions);\n\n    /* {\n      \"status\": true,\n      \"message\": \"SUCCESS\",\n      \"errorcode\": \"\",\n      \"data\": [\n          {\n              \"symboltoken\": \"44068\",\n              \"symbolname\": \"NIFTY\",\n              \"instrumenttype\": \"OPTIDX\",\n              \"priceden\": \"1\",\n              \"pricenum\": \"1\",\n              \"genden\": \"1\",\n              \"gennum\": \"1\",\n              \"precision\": \"2\",\n              \"multiplier\": \"-1\",\n              \"boardlotsize\": \"1\",\n              \"exchange\": \"NFO\",\n              \"producttype\": \"INTRADAY\",\n              \"tradingsymbol\": \"NIFTY24DEC2015000CE\",\n              \"symbolgroup\": \"XX\",\n              \"strikeprice\": \"1500000\",\n              \"optiontype\": \"CE\",\n              \"expirydate\": \"24DEC2020\",\n              \"lotsize\": \"75\",\n              \"cfbuyqty\": \"0\",\n              \"cfsellqty\": \"0\",\n              \"cfbuyamount\": \"0\",\n              \"cfsellamount\": \"0\",\n              \"buyavgprice\": \"0\",\n              \"sellavgprice\": \"165\",\n              \"avgnetprice\": \"165\",\n              \"netvalue\": \"12375\",\n              \"netqty\": \"-75\",\n              \"totalbuyvalue\": \"0\",\n              \"totalsellvalue\": \"12375\",\n              \"cfbuyavgprice\": \"0\",\n              \"cfsellavgprice\": \"0\",\n              \"totalbuyavgprice\": \"0\",\n              \"totalsellavgprice\": \"165\",\n              \"netprice\": \"165\",\n              \"buyqty\": \"0\",\n              \"sellqty\": \"75\",\n              \"buyamount\": \"0\",\n              \"sellamount\": \"12375\"\n          }\n      ]\n    } */\n  }\n\n  getOrders(access_token) {\n\n    /* return from(\n      [JSON.parse(AppConstants.dummyResOrd)]\n    ); */\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        Authorization: 'Bearer ' + access_token,\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'X-UserType': 'USER',\n        'X-SourceID': 'WEB',\n        'X-ClientLocalIP': '192.168.0.2',\n        'X-ClientPublicIP': '101.190.74.150',\n        'X-MACAddress': '37:ab:f8:95:27:ff',\n        'X-PrivateKey': AppConstants.angelAPIKey,        \n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + '/rest/secure/angelbroking/order/v1/getOrderBook';\n    return this.http.get(url, httpOptions);\n  }\n\n  place_order(access_token, body) {\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        Authorization: access_token,\n        'Content-Type': 'application/json'\n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + 'orders';\n\n    return this.http.post(url, body, httpOptions);\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { AppConstants } from './application.constant';\nimport { AliceBlueLiveFeedType, Instrument } from './models';\nimport { AliceblueParserService } from './aliceblue-parser.service';\nimport { Subject } from 'rxjs';\nimport { resourceUsage } from 'process';\n//import * as smartapi from 'smartapi-javascript';\nimport * as pako from 'pako';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AngelWebsocketService {\n\n  public websocketEvent$: Subject<any> = new Subject();\n  heartbeatInterval;\n  websocket: WebSocket;\n  socket_endpoint = 'wss://omnefeeds.angelbroking.com/NestHtml5Mobile/socket/stream?';\n  url2 = \"wss://wsfeeds.angelbroking.com/NestHtml5Mobile/socket/stream\";\n\n\n  constructor(\n    private aliceblueParserService: AliceblueParserService\n  ) { }\n\n   isSocketConnected() {\n    if (this.websocket && this.websocket.OPEN === 1) {\n      return true;\n    }\n    return false;\n  }\n\n  connect(): void {\n\n    this.websocket = new WebSocket(\n      this.socket_endpoint\n    );\n    this.websocket.binaryType = 'arraybuffer';\n    this.websocket.onopen = () => {\n      this.handleOnOpen(event);\n    };\n    this.websocket.onmessage = messageEvent => {\n      this.handleOnMessage(messageEvent);\n    };\n    this.websocket.onerror = event => {\n      this.handleOnError(event);\n    };\n    this.websocket.onclose = event => {\n      this.handleOnClose(event);\n    };\n  }\n\n  handleOnOpen(event: Event): void {\n    console.log('Opened Web Socket connection');\n    /* if (AppConstants.SocketMode === 'aliceblue') {\n      this.sendHeartbeat();\n      this.sendInitialSubscription();\n      this.websocketEvent$.next('connected');\n    } */\n\n    let _req = '{\"task\":\"cn\",\"channel\":\"\",\"token\":\"' + AppConstants.angelFeedToken + '\",\"user\": \"' + AppConstants.angelUserId + '\",\"acctid\":\"' + AppConstants.angelUserId + '\"}';\n    this.sendMessage(_req);\n\n    this.sendHeartbeat();\n  }\n\n  sendHeartbeat() {\n    this.heartbeatInterval = setInterval(() => {\n      // console.log('sending heartbeat');\n      let message = '{\"task\":\"hb\",\"channel\":\"\",\"token\":\"' + AppConstants.angelFeedToken + '\",\"user\": \"' + AppConstants.angelUserId + '\",\"acctid\":\"' + AppConstants.angelUserId + '\"}';\n      this.sendMessage(message);\n    }, 59000);\n  }\n\n  sendInitialSubscription() {\n    console.log('sending initial subscription');\n    let usdinr_fut_code = AppConstants.USDINRFUTCodes[AppConstants.USDINR_FUT_MONTH];\n    let message = JSON.stringify({\n      'a' : 'subscribe',\n      'v' : [[1, 26000], [1, 26009], [3, 1], [3, usdinr_fut_code]/* , [2, 95734], [2, 95733] */],\n      'm' : AliceBlueLiveFeedType.MARKET_DATA});\n\n    // 26000 26009 for nf and bnf spot\n    // 1 is usdinr spot\n\n    console.log('usdinr_fut_code', usdinr_fut_code);\n\n    this.sendMessage(message);\n  }\n\n  handleOnMessage(messageEvent: MessageEvent) {\n    console.log('handleOnMessage', messageEvent, messageEvent.data);\n    // console.log('handleOnMessage parse', JSON.parse(messageEvent.data));\n    /* if (AppConstants.SocketMode === 'aliceblue') {\n      this.aliceblueParserService.handleSocketMessage(messageEvent.data);\n    } */\n\n    let strData = atob(messageEvent.data);\n\n    // Convert binary string to character-number array\n    var charData = strData.split('').map(function (x) { return x.charCodeAt(0); });\n\n    // Turn number array into byte-array\n    var binData = new Uint8Array(charData);\n\n    // Pako magic\n    var result = this._atos(pako.inflate(binData));\n\n    console.log('parsed', result);\n\n    let json = JSON.parse(result)[0];\n    if (json && json.msg === 'connected') {\n      console.log('ANGEL WS CONNECTED');\n\n      // USDINR: cde_fo|1\n      // NIFTY50: cde_fo|2 - not working\n      /* let strwatchlistscrips = 'nse_fo|43315&nse_fo|38692'\n      //let strwatchlistscrips = 'cde_fo|2'\n      let subs = '{\"task\":\"mw\",\"channel\":\"' + strwatchlistscrips + '\",\"token\":\"' + AppConstants.angelFeedToken + '\",\"user\": \"' + AppConstants.angelUserId + '\",\"acctid\":\"' + AppConstants.angelUserId + '\"}';\n      this.sendMessage(subs); */\n\n      this.websocketEvent$.next('connected');\n\n      /* strwatchlistscrips = 'nse_fo|38692'\n      subs = '{\"task\":\"mw\",\"channel\":\"' + strwatchlistscrips + '\",\"token\":\"' + AppConstants.angelFeedToken + '\",\"user\": \"' + AppConstants.angelUserId + '\",\"acctid\":\"' + AppConstants.angelUserId + '\"}';\n      this.sendMessage(subs); */\n\n      // [{\"tvalue\":\"12\\/10\\/2021 13:19:20\",\"name\":\"tm\"},{\"to\":\"3484040944.50\",\"lo\":\"38.65\",\"e\":\"nse_fo\",\"sp\":\"54.15\",\"c\":\"78.30\",\"ltp\":\"54.00\",\"ltq\":\"50\",\"tk\":\"43315\",\"bs\":\"450\",\"ltt\":\"12\\/10\\/2021 13:19:19\",\"tsq\":\"1385600\",\"v\":\"61349550\",\"bp\":\"54.00\",\"cng\":\"-24.30\",\"bq\":\"150\",\"ap\":\"56.79\",\"nc\":\"-31.0345\",\"name\":\"sf\",\"tbq\":\"749350\"}]\n    \n      // [{\"e\":\"nse_fo\",\"name\":\"sf\",\"ltp\":\"54.00\",\"ltq\":\"50\",\"tk\":\"43315\",\"ltt\":\"NA\"}]\n\n      // [{\"to\":\"23800815.00\",\"lo\":\"01.75\",\"e\":\"nse_fo\",\"sp\":\"02.00\",\"c\":\"02.60\",\"ltp\":\"01.95\",\"ltq\":\"50\",\"tk\":\"38692\",\"bs\":\"21500\",\"ltt\":\"12\\/10\\/2021 13:19:13\",\"tsq\":\"361500\",\"v\":\"9958500\",\"bp\":\"01.95\",\"cng\":\"-00.65\",\"bq\":\"108350\",\"ap\":\"02.39\",\"nc\":\"-25.00\",\"name\":\"sf\",\"tbq\":\"1945850\"},{\"to\":\"3484075018.50\",\"lo\":\"38.65\",\"e\":\"nse_fo\",\"sp\":\"54.05\",\"c\":\"78.30\",\"ltp\":\"53.95\",\"ltq\":\"100\",\"tk\":\"43315\",\"bs\":\"1800\",\"ltt\":\"12\\/10\\/2021 13:19:20\",\"tsq\":\"1390250\",\"v\":\"61350150\",\"bp\":\"53.90\",\"cng\":\"-24.35\",\"bq\":\"700\",\"ap\":\"56.79\",\"nc\":\"-31.0983\",\"name\":\"sf\",\"tbq\":\"747150\"}]\n    \n    }\n  }\n\n\n  _atos(array) {\n    var newarray = [];\n    try {\n         for (var i = 0; i < array.length; i++) {\n              newarray.push(String.fromCharCode(array[i]));\n         }\n    } catch (e) { }\n\n    return newarray.join('');\n  }\n\n  handleOnError(event: Event): void {\n    console.log('Error in WS connection', event);\n  }\n\n  handleOnClose(event: CloseEvent): void {\n    console.log('Closed WS connection', event);\n    clearInterval(this.heartbeatInterval);\n    this.websocket = null;\n    setTimeout(() => {\n      if (this.websocket && this.websocket.OPEN === 1) {\n        // ws connected\n      } else {\n        console.log('Reconnecting websocket');\n        this.connect();\n      }\n      \n    }, 2000);\n  }\n\n  sendMessage(message): any {\n    if (this.websocket && this.websocket.OPEN === 1) {\n      console.log('Sending message over websocket: ' + message);\n      this.websocket.send(message);\n    } else {\n      console.log(\n        'Cannot send the message. Socket is not yet opened or it has been closed - ',\n        message\n      );\n    }\n  }\n}\n","import { LowerCasePipe } from '@angular/common';\r\nimport { AliceblueInstrument } from './models';\r\n\r\nexport class AppConstants {\r\n  static SocketMode = 'aliceblue'; // angel\r\n  static RestMode = 'fyers';\r\n  static fyersAppId = 'FUU5Z8ICUH';\r\n  static fyersSecretId = 'IYF3LPXJ0X';\r\n  static angelUserId = 'A165307';\r\n  static angelPassword = 'scjFNB5iYLI';\r\n  static angelAPIKey = 'I5nI74Nm';\r\n  static angelFeedToken = '';\r\n  static angelJWTToken = '';\r\n  static angelRefreshToken = '';\r\n  static year = '22'; // TODO: make year 22 when 2022 year starts\r\n  static INTEREST_RATE = 6; // https://in.investing.com/rates-bonds/india-10-year-bond-yield-historical-data\r\n  static curr_positions_trades = [];\r\n  static isSimulatedStrategy = false;\r\n  static isProduction = true;\r\n  static numAlerts = 4;\r\n  \r\n  /* static USDINRFUTCodes = {\r\n    'SEP': 1985,\r\n    'OCT': 2698,\r\n    'NOV': 3050,\r\n    'DEC': 1487,\r\n  }; */\r\n  static USDINRFUTCodes = {\r\n    'JAN': 1131,\r\n    'FEB': 10201,\r\n    'MAR': 1779,\r\n    'APR': 1170,\r\n    'MAY': 1381,\r\n    'JUN': 1237,\r\n    'JUL': 1503,\r\n    'AUG': 1091,\r\n    'SEP': 1136,\r\n    'OCT': 1176,\r\n    'NOV': 5940,\r\n    'DEC': 1182,\r\n  };\r\n\r\n  static USDINR_FUT_MONTH = new Date().toLocaleString('default', { month: 'short' }).toUpperCase().substring(0,3); // 'JUL';\r\n\r\n  static abMastersContract = new Map<number, AliceblueInstrument>();\r\n\r\n  static monthsMapping = {\r\n    1 : 'JAN',\r\n    2 : 'FEB',\r\n    3 : 'MAR',\r\n    4 : 'APR',\r\n    5 : 'MAY',\r\n    6 : 'JUN',\r\n    7 : 'JUL',\r\n    8 : 'AUG',\r\n    9 : 'SEP',\r\n    10 : 'OCT',\r\n    11 : 'NOV',\r\n    12 : 'DEC'\r\n  };\r\n\r\n/*   static monthlyExpiryDates = {\r\n    '20JUN': new Date(2020, 5, 25),\r\n    '20JUL': new Date(2020, 6, 30),\r\n    '20AUG': new Date(2020, 7, 27),\r\n    '20SEP': new Date(2020, 8, 24),\r\n    '20OCT': new Date(2020, 9, 29),\r\n    '20NOV': new Date(2020, 10, 26),\r\n    '20DEC': new Date(2020, 11, 31),\r\n  };\r\n\r\n  static monthlyExpiryDatesUSDINR = {\r\n    '20JUN': new Date(2020, 5, 26),\r\n    '20JUL': new Date(2020, 6, 29),\r\n    '20AUG': new Date(2020, 7, 27),\r\n    '20SEP': new Date(2020, 8, 28),\r\n    '20OCT': new Date(2020, 9, 27),\r\n    '20NOV': new Date(2020, 10, 25),\r\n    '20DEC': new Date(2020, 11, 29),\r\n  }; */\r\n\r\n  static monthlyExpiryDates = {\r\n    '21JAN': new Date(2021, 0, 27),\r\n    '21FEB': new Date(2021, 1, 24),\r\n    '21MAR': new Date(2021, 2, 26),\r\n    '21APR': new Date(2021, 3, 29),\r\n    '21MAY': new Date(2021, 4, 27),\r\n    '21JUN': new Date(2021, 5, 24),\r\n    '21JUL': new Date(2021, 6, 29),\r\n    '21AUG': new Date(2021, 7, 26),\r\n    '21SEP': new Date(2021, 8, 30),\r\n    '21OCT': new Date(2021, 9, 28),\r\n    '21NOV': new Date(2021, 10, 25),\r\n    '21DEC': new Date(2021, 11, 30),\r\n    '22JAN': new Date(2022, 0, 27),\r\n    '22FEB': new Date(2022, 1, 24),\r\n    '22MAR': new Date(2022, 2, 31),\r\n    '22APR': new Date(2022, 2, 29),\r\n    '22MAY': new Date(2022, 2, 29),\r\n    '22JUN': new Date(2022, 2, 29),\r\n    '22JUL': new Date(2022, 2, 29),\r\n    '22AUG': new Date(2022, 2, 29),\r\n    '22SEP': new Date(2022, 2, 29),\r\n    '22OCT': new Date(2022, 2, 29),\r\n    '22NOV': new Date(2022, 2, 29),\r\n    '22DEC': new Date(2022, 2, 29),\r\n  };\r\n\r\n  static monthlyExpiryDatesUSDINR = {\r\n    '21JAN': new Date(2021, 0, 27),\r\n    '21FEB': new Date(2021, 1, 24),\r\n    '21MAR': new Date(2021, 2, 26),\r\n    '21APR': new Date(2021, 3, 28),\r\n    '21MAY': new Date(2021, 4, 27),\r\n    '21JUN': new Date(2021, 5, 25),\r\n    '21JUL': new Date(2021, 6, 28),\r\n    '21AUG': new Date(2021, 7, 27),\r\n    '21SEP': new Date(2021, 8, 28),\r\n    '21OCT': new Date(2021, 9, 27),\r\n    '21NOV': new Date(2021, 10, 26),\r\n    '21DEC': new Date(2021, 11, 29),\r\n    '22JAN': new Date(2022, 0, 27),\r\n    '22FEB': new Date(2022, 1, 24),\r\n    '22MAR': new Date(2022, 2, 29),\r\n    '22APR': new Date(2022, 2, 29),\r\n    '22MAY': new Date(2022, 2, 29),\r\n    '22JUN': new Date(2022, 2, 29),\r\n    '22JUL': new Date(2022, 2, 29),\r\n    '22AUG': new Date(2022, 2, 29),\r\n    '22SEP': new Date(2022, 2, 29),\r\n    '22OCT': new Date(2022, 2, 29),\r\n    '22NOV': new Date(2022, 2, 29),\r\n    '22DEC': new Date(2022, 2, 29),\r\n  };\r\n\r\n\r\n  /* Enter Supports from high to low, Enter Resistances from Low to High */\r\n  static holdings = {\r\n    'NIFTY 50': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 17131, 'qty': 109, 'support': [], 'resistance': [] }, /* 185.4 * 92.4 */\r\n    'NIFTY BANK': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 36938, 'qty': 27, 'support': [], 'resistance': [] }, /* 369.38 * 100 */\r\n    'ADANIPORTS': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [650], 'resistance': [900] },\r\n    'ASIANPAINT': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 3098.95, 'qty': 3, 'support': [3000, 2860], 'resistance': [3600] },\r\n    'AXISBANK': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [650], 'resistance': [770, 850] },\r\n    'BAJAJ-AUTO': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [3300], 'resistance': [4000, 4300] },\r\n    'BAJAJFINSV': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 17013.7, 'qty': 1, 'support': [15500], 'resistance': [19200] },\r\n    'BAJFINANCE': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'BHARTIARTL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'BPCL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'BRITANNIA': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'CIPLA': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'COALINDIA': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'DIVISLAB': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'DRREDDY': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'EICHERMOT': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'GRASIM': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 1733.95, 'qty': 6, 'support': [], 'resistance': [] },\r\n    'HCLTECH': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'HDFC': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'HDFCBANK': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'HDFCLIFE': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'HEROMOTOCO': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'HINDALCO': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'HINDUNILVR': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'ICICIBANK': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'INDUSINDBK': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'INFY': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 1718.17, 'qty': 12, 'support': [], 'resistance': [] },\r\n    'IOC': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'ITC': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'JSWSTEEL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'KOTAKBANK': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'LT': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'M&M': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'MARUTI': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'NESTLEIND': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 18927.05, 'qty': 1, 'support': [], 'resistance': [] },\r\n    'NTPC': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'ONGC': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'POWERGRID': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 202.1, 'qty': 45, 'support': [], 'resistance': [] },\r\n    'RELIANCE': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 2481, 'qty': 4, 'support': [], 'resistance': [] },\r\n    'SBILIFE': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 1183.8, 'qty': 8, 'support': [], 'resistance': [] },\r\n    'SBIN': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'SHREECEM': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'SUNPHARMA': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 829.8, 'qty': 12, 'support': [], 'resistance': [] },\r\n    'TATACONSUM': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'TATAMOTORS': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'TATASTEEL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'TCS': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 3544.32, 'qty': 6, 'support': [], 'resistance': [] },\r\n    'TECHM': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 1577.74, 'qty': 13, 'support': [], 'resistance': [] },\r\n    'TITAN': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 2330.5, 'qty': 4, 'support': [], 'resistance': [] },\r\n    'ULTRACEMCO': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'UPL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'WIPRO': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'RADICO': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 1068.1, 'qty': 9, 'support': [], 'resistance': [] },\r\n    'VBL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 901.7, 'qty': 11, 'support': [], 'resistance': [] },\r\n    'ACC': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [2100], 'resistance': [2600] },\r\n    'ADANIENT': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [1750, 1350], 'resistance': [1800, 1900] },\r\n    'ADANIGREEN': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [1500, 875], 'resistance': [1500, 1900]},\r\n    'ADANITRANS': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [1650], 'resistance': [2040] },\r\n    'AMBUJACEM': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [350], 'resistance': [440] },\r\n    'APOLLOHOSP': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [4000], 'resistance': [5930] },\r\n    'AUROPHARMA': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [620], 'resistance': [770, 1060] },\r\n    'BAJAJHLDNG': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [5000], 'resistance': [5650] },\r\n    'BANDHANBNK': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'BERGEPAINT': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'BIOCON': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'BOSCHLTD': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'CADILAHC': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'CHOLAFIN': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'COLPAL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'DABUR': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'DLF': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'DMART': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 4704.85, 'qty': 2, 'support': [], 'resistance': [] },\r\n    'GAIL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'GLAND': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'GODREJCP': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'HAVELLS': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'HDFCAMC': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'HINDPETRO': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'ICICIPRULI': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'IGL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'INDIGO': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'INDUSTOWER': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'JINDALSTEL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'JUBLFOOD': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'LTI': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'LUPIN': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'MARICO': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'MCDOWELL-N': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'MUTHOOTFIN': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'NAUKRI': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'NMDC': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'PEL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'PGHH': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'PIDILITIND': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': 2648.45, 'qty': 4, 'support': [], 'resistance': [] },\r\n    'PIIND': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'PNB': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'SAIL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'SBICARD': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'SIEMENS': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'TORNTPHARM': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'VEDL': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n    'YESBANK': { 'ltp': null, 'volume': null, 'oned': null, 'onew': null, 'onem': null, 'threem': null, 'fiftytwow': null, 'avgp': null, 'qty': null, 'support': [], 'resistance': [] },\r\n  }\r\n\r\n  static dummyResPos = '{\"s\":\"ok\",\"netPositions\":[{\"crossCurrency\":\"N\",\"qty\":16,\"realized_profit\":0,\"id\":\"NSE:JPASSOCIAT-EQ-CNC\",\"unrealized_profit\":0.32,\"buyQty\":16,\"sellAvg\":0,\"sellQty\":0,\"buyAvg\":4.78,\"symbol\":\"NSE:JPASSOCIAT-EQ\",\"fyToken\":\"101000000011460\",\"slNo\":0,\"avgPrice\":4.78,\"segment\":\"E\",\"dummy\":\" \",\"rbiRefRate\":1,\"side\":1,\"netQty\":16,\"pl\":0.32,\"productType\":\"CNC\",\"netAvg\":4.78,\"qtyMulti_com\":1},{\"crossCurrency\":\"N\",\"qty\":16,\"realized_profit\":0,\"id\":\"NSE:JPASSOCIAT-EQ-CNC\",\"unrealized_profit\":0.32,\"buyQty\":16,\"sellAvg\":0,\"sellQty\":0,\"buyAvg\":4.78,\"symbol\":\"NSE:JPASSOCIAT-EQ\",\"fyToken\":\"101000000011460\",\"slNo\":0,\"avgPrice\":4.78,\"segment\":\"E\",\"dummy\":\" \",\"rbiRefRate\":1,\"side\":1,\"netQty\":16,\"pl\":0.32,\"productType\":\"CNC\",\"netAvg\":4.78,\"qtyMulti_com\":1}],\"message\":\"\"}';\r\n  static dummyResOrd = '{\"s\":\"ok\",\"message\":\"\",\"orderBook\":[{\"status\":5,\"symbol\":\"NSE:TCSEQ\",\"qty\":1,\"orderNumStatus\":\"119050790482:5\",\"dqQtyRem\":5,\"orderDateTime\":\"07-May-2019 15:18:04\",\"orderValidity\":\"IOC\",\"fyToken\":\"101000000011536\",\"slNo\":1,\"message\":\"RMS:119050790482:Not allowed to trade in NSE EQ\",\"segment\":\"E\",\"id\":\"119050790482\",\"stopPrice\":0,\"exchOrdId\":0,\"remainingQuantity\":1,\"filledQty\":0,\"limitPrice\":2155,\"offlineOrder\":\"false\",\"instrument\":\"EQUITY\",\"productType\":\"CNC\",\"type\":1,\"side\":1,\"discloseQty\":5,\"tradedPrice\":0}]}';\r\n}\r\n","import { Injectable } from '@angular/core';\nimport { AppConstants } from './application.constant';\nimport { AppService } from '../app.service';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { from } from 'rxjs';\nimport * as xml2js from 'xml2js';\n// const fyers = require('fyers-api');\n// import * as fyers from 'fyers-api';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FyersService {\n\n  baseUrl = 'https://api.fyers.in/api/v1/';\n  dataUrl = 'https://data.fyers.in/data-api/v1/';\n  testUrl = 'https://jsonplaceholder.typicode.com/posts';\n\n  constructor(\n    private http: HttpClient\n  ) { }\n\n  auth() {\n    /* let reqBody = { 'app_id': AppConstants.fyersAppId, 'secret_key':  AppConstants.fyersSecretId };\n    return fyers.auth(reqBody); */\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        /* Authorization: auth, */\n        'Content-Type': 'application/json'\n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + 'auth';\n    let body = { 'app_id': AppConstants.fyersAppId, 'secret_key':  AppConstants.fyersSecretId };\n\n    return this.http.post(url, body, httpOptions);\n  }\n\n  getTokenUrl(auth_code, appId) {\n    /* return fyers.generateToken(); */\n    return this.baseUrl + 'genrateToken' + '?authorization_code=' + auth_code + '&appId=' + appId;\n  }\n\n  getFunds(access_token) {\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        Authorization: access_token,\n        'Content-Type': 'application/json'\n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + 'funds';\n    return this.http.get(url, httpOptions);\n  }\n\n  getPositions(access_token) {\n\n    /* return from(\n      [this.convertToJson(AppConstants.dummyResPos.replace('\\ufeff', ''))]\n    ); */\n\n    /* return from(\n      [JSON.parse(AppConstants.dummyResPos)]\n    ); */\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        Authorization: access_token,\n        'Content-Type': 'application/json'\n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + 'positions';\n    return this.http.get(url, httpOptions);\n  }\n\n  getOrders(access_token) {\n\n    /* return from(\n      [JSON.parse(AppConstants.dummyResOrd)]\n    ); */\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        Authorization: access_token,\n        'Content-Type': 'application/json'\n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + 'orders';\n    return this.http.get(url, httpOptions);\n  }\n\n  place_order(access_token, body) {\n\n    let httpOptions = {\n      headers: new HttpHeaders({\n        Authorization: access_token,\n        'Content-Type': 'application/json'\n      }),\n      responseType: 'json' as 'json'\n    };\n\n    let url = this.baseUrl + 'orders';\n\n    return this.http.post(url, body, httpOptions);\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { AppConstants } from './application.constant';\nimport { AppService } from '../app.service';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { AliceBlueWsFrameMode, AliceblueInstrument, AliceBlueLiveFeedType, Instrument } from './models';\nimport { WebsocketService } from './websocket.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class HoldingsService {\n\n      /*\n    go to https://www.nseindia.com/\n    in the search bar, search for instrument like TCS\n    on instrument's page, scroll down and select Historical Data tab\n    select 3M and click Filter\n    get the url from Network tab in dev console\n    example: https://www.nseindia.com/api/historical/cm/equity?symbol=TCS&series=[%22EQ%22]&from=21-09-2021&to=21-12-2021\n\n    for nf, bnf:\n    gives 1 year by default:\n    https://query1.finance.yahoo.com/v8/finance/chart/%5ENSEI\n    https://query1.finance.yahoo.com/v8/finance/chart/%5ENSEBANK\n    also for stocks, but does not give 52W high:\n    https://query1.finance.yahoo.com/v8/finance/chart/TCS.NS\n    for providing range:\n    https://query1.finance.yahoo.com/v8/finance/chart/%5ENSEI?formatted=true&lang=en-US&region=US&includeAdjustedClose=true&interval=1d&period1=1632182400&period2=1640044800\n    https://query1.finance.yahoo.com/v8/finance/chart/%5ENSEBANK?formatted=true&lang=en-US&region=US&includeAdjustedClose=true&interval=1d&period1=1632182400&period2=1640044800\n    or get the data from https://www1.nseindia.com/products/content/equities/indices/historical_index_data.htm\n    */\n\n    /* \n    let u1 = 'https://www.nseindia.com/api/historical/cm/equity?symbol=TCS&series=[%22EQ%22]&from=21-09-2021&to=21-12-2021';\n    this.http.get(u1, httpOptions).subscribe((res: any) => {\n      console.log('nse', res);\n    });\n    let u2 = 'https://www.nseindia.com/api/historical/cm/equity?symbol=INFY&series=[%22EQ%22]&from=21-09-2021&to=21-12-2021';\n    this.http.get(u2, httpOptions).subscribe((res: any) => {\n      console.log('nse2', res);\n    });\n    let u3 = 'https://www.nseindia.com/api/historical/cm/equity?symbol=GRASIM&series=[%22EQ%22]&from=21-09-2021&to=21-12-2021';\n    this.http.get(u3, httpOptions).subscribe((res: any) => {\n      console.log('nse3', res);\n    }); \n    */\n  \n  holdingsMap = {\n    'ADANIPORTS.NS': { 'holding': false, 'average': null },\n    'ASIANPAINT.NS': { 'holding': true, 'average': 3098.95 },\n  };\n\n  backtestMap = {};\n\n  shortlistedStocks = [];\n\n  // *** add scrips from only ONE expiry to wathclist 5\n  // update append value - for weekly add WK and keep empty for monthly\n  // get authorization header from minute request\n  // get response of marketwatch request\n  // get date range from minute url\n\n  append = '';\n  auth = '';\n  marketwatch = '';\n  from_date = '';\n  to_date = '';\n  expiry_date = '';\n\n  delay = 2000;\n\n  data = {}\n  niftyReturn = {};\n\n  constructor(\n    private http: HttpClient,\n  ) { }\n\n  fetchCandles(append, auth, marketwatch, from_date, to_date, expiry_date) {\n\n    this.append = append;\n    this.auth = auth;\n    this.marketwatch = marketwatch;\n    this.from_date = from_date;\n    this.to_date = to_date;\n    this.expiry_date = expiry_date;\n\n    let json = JSON.parse(this.marketwatch);\n    let items = json.data[4].items;\n\n    console.log('marketwatch watchlist 5: ', json.data[4].items.length, json.data[4]);\n\n    for (let i = 0; i < items.length; i++) {\n      setTimeout(() => {\n        let item = items[i];\n        console.log('item', i, item);\n        this.getItem(item);\n      }, i * this.delay);\n    }\n  }\n\n  getItem(item) {\n\n    const headers = new HttpHeaders({\n      'authorization': this.auth,\n    });\n    let httpOptions = {\n      responseType: 'json' as 'json',\n      headers: headers\n    };\n\n    let symbol = item.tradingsymbol; // let symbol = 'USDINR2210775.5CE' 'USDINR22FEB74PE' 'USDINR22107FUT';\n    let token = item.instrument_token;\n    console.log(symbol, token);\n  \n    let strike = symbol.substring(11);\n    let scrip = 'USDINR' + this.append + strike;\n    if (strike.includes('FUT')) {\n      scrip = 'USDINR';\n    }\n\n    // let url = 'https://www.nseindia.com/api/chart-databyindex?index=OPTCURUSDINR31-12-2021CE74.5000';\n    // url = 'https://kite.zerodha.com/api/marketwatch';\n    // let url = 'https://kite.zerodha.com/oms/instruments/historical/2085635/minute?user_id=FW6041&oi=1&from=2021-12-02&to=2022-01-01';\n\n    let url = 'https://kite.zerodha.com/oms/instruments/historical/' + token + '/minute?user_id=FW6041&oi=1&from=' + this.from_date + '&to=' + this.to_date;\n\n    this.http.get(url, httpOptions).subscribe((res: any) => {\n      console.log('scrip data:', scrip, res);\n      if (res.data.candles) {\n        let arr = res.data.candles;\n        if (arr.length === 0) {\n          console.log('ZERO CANDLES FOR ', scrip);\n        }\n        for (let j = 0; j < arr.length; j++) {\n          let element = arr[j];\n            \n          let obj = this.data[scrip]; // getting all data for scrip\n          if (!obj) {\n            obj = {};\n          }\n          let d = this.getDateInFormat(element[0]);\n          obj[d] = [ element[1], element[2], element[3], element[4], element[5], element[6] ];\n\n          this.data[scrip] = obj;\n        }\n      }\n\n      console.log('candles:', Object.keys(this.data).length, this.data);\n    });\n  }\n\n  exportToCSV(): void {\n    let expiry_string = 'Monthly';\n    if (this.append === 'WK') {\n      expiry_string = 'Weekly';\n    }\n    let export_file_name = this.expiry_date + ' ' + expiry_string + '.csv';\n    console.log('exporting: ', export_file_name);\n    if (this.data) {\n      \n      let str = '';\n      str += 'Ticker,Date/Time,Open,High,Low,Close,Volume,Open Interest\\r\\n';\n\n      for (let key in this.data) { // for each scrip\n        for (let key1 in this.data[key]) { // for each time in scrip\n          let row = '';\n          let arr = this.data[key][key1];\n          row += key + ',' + key1 + ',' + arr[0] + ',' + arr[1] + ',' + arr[2] + ',' + arr[3] + ',' + arr[4] + ',' + arr[5];\n          str += row + '\\r\\n';\n        }\n      }\n\n      const downloadFile = new Blob([str], {\n        type: 'application/x-msdownload',\n      });\n  \n      if (window.navigator && window.navigator.msSaveOrOpenBlob) { // for IE\n        window.navigator.msSaveOrOpenBlob(downloadFile, export_file_name);\n      } else {\n        const fileURL = URL.createObjectURL(downloadFile);\n        const link = document.createElement('a');\n        link.href = fileURL;\n        link.target = '_blank';\n        document.body.appendChild(link);\n        link.download = export_file_name;\n        link.click();\n        link.parentNode.removeChild(link);\n      }\n    }\n  }\n\n  getDateInFormat(str = null) {\n    if (!str) {\n      str = new Date();\n    }\n    let date = new Date(str);\n    let d = date.getDate();\n    let m = date.getMonth() + 1; //Month from 0 to 11\n    let y = date.getFullYear();\n    let h = date.getHours();\n    let mins = date.getMinutes();\n    let s = date.getSeconds();\n    // dd-mm-yyyy hh:mm:ss\n    let format = '' + (d <= 9 ? '0' + d : d) + '-' + (m <= 9 ? '0' + m : m) + '-' + y + ' ' + (h <= 9 ? '0' + h : h) + ':' + (mins <= 9 ? '0' + mins : mins) + ':' + (s <= 9 ? '0' + s : s);\n    return format;\n  }\n  \n  loadHoldings() {\n  \n    let portfolio_return = 0;\n    let holdings = [];\n\n    let total_investment = 0;\n    let current_value = 0;\n\n    // console.log(AppConstants.holdings);\n    for (let key in AppConstants.holdings) {\n      if (AppConstants.holdings.hasOwnProperty(key)) {\n\n        // doing here and not in fetchStockHistoricalData to avoid overwriting of average price in appconstants\n        let avgp = null;\n        let supp_str = '';\n        let res_str = '';\n\n        if (AppConstants.holdings[key]['avgp']) {\n          avgp = (AppConstants.holdings[key]['ltp'] - AppConstants.holdings[key]['avgp']) * 100 / AppConstants.holdings[key]['avgp'];\n          avgp = Math.round((avgp + 0.00001) * 100) / 100;\n\n          let avgp_adj = AppConstants.holdings[key]['avgp'];\n          let ltp_adj = AppConstants.holdings[key]['ltp'];\n          if (key === 'NIFTY 50') {\n            avgp_adj = avgp_adj / 92.4;\n            ltp_adj = ltp_adj / 92.4;\n          }\n          if (key === 'NIFTY BANK') {\n            avgp_adj = avgp_adj / 100;\n            ltp_adj = ltp_adj / 100;\n          }\n\n          total_investment += (avgp_adj * AppConstants.holdings[key]['qty']); \n          current_value += (ltp_adj * AppConstants.holdings[key]['qty']);\n\n          let supp_perc = -999;\n          let supp = null;\n          for (let i = 0; i < AppConstants.holdings[key]['support'].length; i++) {\n            let element = AppConstants.holdings[key]['support'][i];\n\n            let supp_perc_t = (AppConstants.holdings[key]['ltp'] - element) * 100 / element;\n            if (supp_perc_t < 0 && supp_perc_t > supp_perc) {\n              supp_perc = supp_perc_t;\n              supp = element;\n            }\n          }\n          if (supp !== null) {\n            supp_perc = Math.round((supp_perc + 0.00001) * 100) / 100;\n            supp_str = supp_perc + ' (' + supp + ')'\n          }\n\n          let res_perc = 999;\n          let res = null;\n          for (let i = 0; i < AppConstants.holdings[key]['resistance'].length; i++) {\n            let element = AppConstants.holdings[key]['resistance'][i];\n\n            let res_perc_t = (AppConstants.holdings[key]['ltp'] - element) * 100 / element;\n            if (res_perc_t > 0 && res_perc_t < res_perc) {\n              res_perc = res_perc_t;\n              res = element;\n            }\n          }\n          if (res !== null) {\n            res_perc = Math.round((res_perc + 0.00001) * 100) / 100;\n            res_str = res_perc + ' (' + res + ')'\n          }\n        }\n\n        holdings.push({ scrip: key, volume: AppConstants.holdings[key]['volume'], ltp: AppConstants.holdings[key]['ltp'], oned: AppConstants.holdings[key]['oned'], \n                        onew: AppConstants.holdings[key]['onew'], onem: AppConstants.holdings[key]['onem'], threem: AppConstants.holdings[key]['threem'], \n                        fiftytwow: AppConstants.holdings[key]['fiftytwow'], avgp: avgp, support: supp_str, resistance: res_str });\n      }\n    }\n\n    portfolio_return = (current_value - total_investment) * 100 / total_investment;\n    portfolio_return = Math.round((portfolio_return + 0.00001) * 100) / 100;\n\n    total_investment = Math.round(total_investment);\n    current_value = Math.round(current_value);\n    // console.log(total_investment, current_value);\n\n    return { 'portfolio_return': portfolio_return, 'holdings': holdings, 'total_inv': total_investment, 'current_val': current_value };\n  }\n\n  fetchStocksData() {\n    let httpOptions = {\n      responseType: 'json' as 'json'\n    };\n\n    let nifty50stocksURL = 'https://www.nseindia.com/api/equity-stockIndices?index=NIFTY%2050';\n\n    /* this.http.get(indicesURL, httpOptions).subscribe((res: any) => {\n      console.log('ind', res);\n    }); */\n\n    this.http.get(nifty50stocksURL, httpOptions).subscribe((res: any) => {\n      console.log('now stocks data: ', res);\n      let resArr = res.data;\n      resArr.forEach(element => {\n        if (AppConstants.holdings.hasOwnProperty(element.symbol)) {\n          AppConstants.holdings[element.symbol]['ltp'] = Math.round((element.lastPrice + 0.00001) * 100) / 100;\n          AppConstants.holdings[element.symbol]['volume'] = Math.round((element.totalTradedVolume + 0.00001) * 100) / 100;\n          AppConstants.holdings[element.symbol]['oned'] = Math.round((element.pChange + 0.00001) * 100) / 100;\n          // AppConstants.holdings[element.symbol]['onew'] = Math.round((element.nearWKH + 0.00001) * 100) / 100;\n          AppConstants.holdings[element.symbol]['onem'] = Math.round((element.perChange30d + 0.00001) * 100) / 100;\n          let fiftytwow = (element.lastPrice - element.yearHigh) * 100 / element.yearHigh;\n          AppConstants.holdings[element.symbol]['fiftytwow'] = Math.round((fiftytwow + 0.00001) * 100) / 100;\n        }\n      });\n    });\n\n    setTimeout(() => { this.fetchIndicesData(); }, 2000);\n\n    setTimeout(() => { this.fetchHistoricalData(); }, 4000);\n\n    // console.log(AppConstants.holdings);\n  }\n\n  fetchIndicesData() {\n    let httpOptions = {\n      responseType: 'json' as 'json'\n    };\n\n    let indicesURL = 'https://www.nseindia.com/api/allIndices';\n\n    this.http.get(indicesURL, httpOptions).subscribe((res: any) => {\n      console.log('indices data: ', res);\n      let resArr = res.data;\n      resArr.forEach(element => {\n        if (AppConstants.holdings.hasOwnProperty(element.index)) {\n          AppConstants.holdings[element.index]['ltp'] = Math.round((element.last + 0.00001) * 100) / 100;\n          AppConstants.holdings[element.index]['oned'] = Math.round((element.percentChange + 0.00001) * 100) / 100;\n          // AppConstants.holdings[element.symbol]['onew'] = Math.round((element.nearWKH + 0.00001) * 100) / 100;\n          AppConstants.holdings[element.index]['onem'] = Math.round((element.perChange30d + 0.00001) * 100) / 100;\n          let fiftytwow = (element.last - element.yearHigh) * 100 / element.yearHigh;\n          AppConstants.holdings[element.index]['fiftytwow'] = Math.round((fiftytwow + 0.00001) * 100) / 100;\n        }\n      });\n    });\n  } \n\n  fetchHistoricalData() {\n    let httpOptions = {\n      responseType: 'json' as 'json'\n    };\n\n    let date_now = new Date();\n    let date_prev = new Date();\n    date_prev.setDate(date_prev.getDate() - 150);\n        \n    // let stockHistoricalURL = 'https://www.nseindia.com/api/historical/cm/equity?symbol=TCS&series=[%22EQ%22]&from=21-09-2021&to=21-12-2021';\n    let stockHistoricalURL = 'https://query1.finance.yahoo.com/v8/finance/chart/';\n\n    for (let key in AppConstants.holdings) {\n      if (AppConstants.holdings.hasOwnProperty(key)) {\n        // console.log(key + \" -> \" + this.tempmonthlyExpiryDates[key] + ' ' + enteredDate);\n\n\n        // https://query1.finance.yahoo.com/v7/finance/quote?symbols=RADICO.NS&fields=exchangeTimezoneName,exchangeTimezoneShortName,regularMarketTime,gmtOffSetMilliseconds&region=US&lang=en-US\n\n        // https://query1.finance.yahoo.com/v7/finance/quote?formatted=true&crumb=DVvEVKnjAxW&lang=en-US&region=US&symbols=RADICO.NS&fields=messageBoardId%2ClongName%2CshortName%2CmarketCap%2CunderlyingSymbol%2CunderlyingExchangeSymbol%2CheadSymbolAsString%2CregularMarketPrice%2CregularMarketChange%2CregularMarketChangePercent%2CregularMarketVolume%2Cuuid%2CregularMarketOpen%2CfiftyTwoWeekLow%2CfiftyTwoWeekHigh%2CtoCurrency%2CfromCurrency%2CtoExchange%2CfromExchange&corsDomain=finance.yahoo.com\n\n        let k = key + '.NS';\n        if (k === 'NIFTY 50.NS') {\n          k = '%5ENSEI';\n        }\n        if (k === 'NIFTY BANK.NS') {\n          k = '%5ENSEBANK';\n        }\n        //let stockUrl = stockHistoricalURL + k + '?formatted=true&lang=en-US&region=US&includeAdjustedClose=true&interval=1d&period1=';\n        //stockUrl += Math.floor(date_prev.getTime() / 1000) + '&period2=' + Math.floor(date_now.getTime() / 1000);\n\n        let stockUrl = stockHistoricalURL + k + '?formatted=true&lang=en-US&region=US&includeAdjustedClose=true&interval=1d&range=1y';\n\n        this.http.get(stockUrl, httpOptions).subscribe((res: any) => {\n          if (res) {\n            // console.log(res.chart.result[0].indicators.adjclose[0].adjclose[102]);\n            // console.log(res);\n            let closeArr = res.chart.result[0].indicators.adjclose[0].adjclose;\n            if (closeArr instanceof Array) {\n\n              let ltp = AppConstants.holdings[key]['ltp'];\n              if (!ltp) {\n                ltp = res.chart.result[0].meta.regularMarketPrice;\n                AppConstants.holdings[key]['ltp'] = ltp;\n\n                let currdate = res.chart.result[0].meta.regularMarketTime;\n                let index_oned = 1;\n                let timestamps = res.chart.result[0].timestamp;\n                if (new Date(currdate * 1000).getDate() === new Date(timestamps[timestamps.length - 1] * 1000).getDate()) {\n                  index_oned = 2;\n                }\n\n                let one = closeArr[closeArr.length - index_oned];\n                one = (ltp - one) * 100 / one;\n                one = Math.round((one + 0.00001) * 100) / 100;\n                AppConstants.holdings[key]['oned'] = one;\n\n                let thirty = closeArr[closeArr.length - 30];\n                thirty = (ltp - thirty) * 100 / thirty;\n                thirty = Math.round((thirty + 0.00001) * 100) / 100;\n                AppConstants.holdings[key]['onem'] = thirty;\n\n                let highArr = res.chart.result[0].indicators.quote[0].high;\n                var max_high = Math.max.apply(null, highArr);\n\n                let fiftytwow = (ltp - max_high) * 100 / max_high;\n                AppConstants.holdings[key]['fiftytwow'] = Math.round((fiftytwow + 0.00001) * 100) / 100;\n\n                // console.log(ltp, one, thirty);\n              }\n\n              let seven = closeArr[closeArr.length - 7];\n              seven = (ltp - seven) * 100 / seven;\n              seven = Math.round((seven + 0.00001) * 100) / 100;\n              let ninety = closeArr[closeArr.length - 90];\n              ninety = (ltp - ninety) * 100 / ninety;\n              ninety = Math.round((ninety + 0.00001) * 100) / 100;\n              console.log(key, seven, ninety);\n              AppConstants.holdings[key]['onew'] = seven;\n              AppConstants.holdings[key]['threem'] = ninety;\n            }\n          }\n        });\n      }\n    }\n  }\n\n  exportBacktest() {\n    console.log(this.backtestMap);\n\n    let export_file_name = 'Backtest ' + this.getDateInFormat() + '.csv';\n    console.log('exporting: ', export_file_name);\n    \n    if (this.backtestMap) {\n    \n      let str = '';\n      str += 'ExitDate,Portfolio,Nifty,S1,S2,S3,S4,S5,S6,S7,S8,S9,S10\\r\\n';\n\n      for (let key in this.backtestMap) {\n\n        this.shortlistedStocks = [];\n        \n        for (let k in this.backtestMap[key]) {\n          \n          if (this.backtestMap[key][k]['fiftytwow'] > -10) {\n            // this.shortlistedStocks[k] = this.backtestMap[key][k];\n            let copy = Object.assign({}, this.backtestMap[key][k]);\n            copy['scrip'] = k\n            this.shortlistedStocks.push(copy);\n          }\n        }\n\n        this.shortlistedStocks.sort((a, b) => {\n\n          // -1 means a should come before b\n          // 1 means a should come after b\n\n          if (a['onem'] > b['onem']) {\n            return -1;\n          } else {\n            return 1;\n          }\n        });\n\n        console.log('shortlistedStocks:', this.shortlistedStocks);\n\n        let finalStocks = this.shortlistedStocks.slice(0, 10);\n        console.log('finalStocks:', finalStocks);\n\n        let cum_percent = 0;\n        \n        let stocksRetStr = '';\n        for (let i = 0; i < finalStocks.length; i++) {\n          let ret = (finalStocks[i]['last'] - finalStocks[i]['entry']) * 100 / finalStocks[i]['entry'];\n          ret = Math.round((ret + 0.00001) * 100) / 100;\n          cum_percent += ret;\n          stocksRetStr += ',' + ret;\n        }\n\n        let avg_percent = cum_percent / finalStocks.length;\n        avg_percent = Math.round((avg_percent + 0.00001) * 100) / 100;\n        console.log(avg_percent, this.niftyReturn[key]);\n\n        let returnsStr = '' + key + ',' + avg_percent + ',' + this.niftyReturn[key] + stocksRetStr + '\\r\\n';\n        console.log(returnsStr);\n\n        str += returnsStr;\n      }\n\n      const downloadFile = new Blob([str], {\n        type: 'application/x-msdownload',\n      });\n  \n      if (window.navigator && window.navigator.msSaveOrOpenBlob) { // for IE\n        window.navigator.msSaveOrOpenBlob(downloadFile, export_file_name);\n      } else {\n        const fileURL = URL.createObjectURL(downloadFile);\n        const link = document.createElement('a');\n        link.href = fileURL;\n        link.target = '_blank';\n        document.body.appendChild(link);\n        link.download = export_file_name;\n        link.click();\n        link.parentNode.removeChild(link);\n      }\n    }\n  }\n\n  backtestStocks() {\n    this.backtest52W1M();\n  }\n\n  backtest52W1M() {\n    // find stocks under 10% from 52W high\n    // rank top 10 stocks based on 1 month returns\n\n    let httpOptions = {\n      responseType: 'json' as 'json'\n    };\n\n    let stockHistoricalURL = 'https://query1.finance.yahoo.com/v8/finance/chart/';\n\n    let monthsToTest = 12;\n    let curr_date = new Date();\n    for (let i = 13; i <= 24; i++) {\n      let test_date_end = new Date();\n      test_date_end.setDate(curr_date.getDate() - (30 * i));\n\n      let test_date_start = new Date();\n      test_date_start.setDate(curr_date.getDate() - (30 * i) - 365);\n\n      for (let key in AppConstants.holdings) {\n        if (AppConstants.holdings.hasOwnProperty(key)) {\n\n          let k = key + '.NS';\n          if (k === 'NIFTY 50.NS') {\n            k = '%5ENSEI';\n          }\n          if (k === 'NIFTY BANK.NS') {\n            k = '%5ENSEBANK';\n          }\n\n          let stockUrl = stockHistoricalURL + k + '?formatted=true&lang=en-US&region=US&includeAdjustedClose=true&interval=1d&period1=';\n          stockUrl += Math.floor(test_date_start.getTime() / 1000) + '&period2=' + Math.floor(test_date_end.getTime() / 1000);\n\n          this.http.get(stockUrl, httpOptions).subscribe((res: any) => {\n            if (res) {\n              // console.log(res.chart.result[0].indicators.adjclose[0].adjclose[102]);\n              // console.log(res);\n              let closeArr = res.chart.result[0].indicators.adjclose[0].adjclose;\n              if (closeArr instanceof Array) {\n\n                let obj = {};\n                obj['last'] = closeArr[closeArr.length - 1];\n                obj['entry'] = closeArr[closeArr.length - 22]; // considering 21 trading days in a month\n\n                if (key === 'NIFTY 50') {\n                  let ret = (obj['last'] - obj['entry']) * 100 / obj['entry'];\n                  ret = Math.round((ret + 0.00001) * 100) / 100;\n                  this.niftyReturn[test_date_end.toLocaleDateString()] = ret;\n                }\n\n                let thirty = closeArr[closeArr.length - 43]; // 22 + 21\n                thirty = (obj['entry'] - thirty) * 100 / thirty;\n                thirty = Math.round((thirty + 0.00001) * 100) / 100;\n                obj['onem'] = thirty;\n\n                let highArr = res.chart.result[0].indicators.quote[0].high;\n                highArr = highArr.slice(0, -21);\n                var max_high = Math.max.apply(null, highArr);\n\n                let fiftytwow = (obj['entry'] - max_high) * 100 / max_high;\n                obj['fiftytwow'] = Math.round((fiftytwow + 0.00001) * 100) / 100;\n\n                // console.log(ltp, one, thirty);\n\n                if (!this.backtestMap[test_date_end.toLocaleDateString()]) {\n                  this.backtestMap[test_date_end.toLocaleDateString()] = {};\n                }\n                this.backtestMap[test_date_end.toLocaleDateString()][key] = obj;\n                \n              }\n            }\n          });\n\n        }\n      }\n    }\n\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { IntradayData } from './models';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MapService {\n\n  ltpMap = new Map<string, number>();\n  atpMap = new Map<string, number>();\n  volumeMap = new Map<string, number>();\n  oiMap = new Map<string, number>();\n  chgoiMap = new Map<string, number>();\n\n  intradayData: IntradayData[] = new Array<IntradayData>();\n\n  static simulateData = {};\n\n  constructor(\n  ) { }\n\n  getLtp(strike: string) {\n    if (strike === 'BANKNIFTY') {\n      // return 37739;\n    }\n    return this.ltpMap.get(strike);\n  }\n\n  setLtp(strike: string, val: number) {\n    this.ltpMap.set(strike, val);\n  }\n\n  getAtp(strike: string) {\n    return this.atpMap.get(strike);\n  }\n\n  setAtp(strike: string, val: number) {\n    this.atpMap.set(strike, val);\n  }\n\n  getVolume(strike: string) {\n    return this.volumeMap.get(strike);\n  }\n\n  setVolume(strike: string, val: number) {\n    this.volumeMap.set(strike, val);\n  }\n\n  getOI(strike: string) {\n    return this.oiMap.get(strike);\n  }\n\n  setOI(strike: string, val: number) {\n    this.oiMap.set(strike, val);\n  }\n\n  getChgOI(strike: string) {\n    return this.chgoiMap.get(strike);\n  }\n\n  setChgOI(strike: string, val: number) {\n    this.chgoiMap.set(strike, val);\n  }\n\n  getIntradayData(period: number) {\n    return this.intradayData.slice(Math.max(this.intradayData.length - period, 0))\n  }\n\n  setIntradayData() {\n\n  }\n\n/* \n  getLtp(strike: string) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      return this.ltpMap.get(strike);\n    }\n  }\n\n  setLtp(strike: string, val: number) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      this.ltpMap.set(strike, val);\n    }\n  }\n\n  getAtp(strike: string) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      return this.atpMap.get(strike);\n    }\n  }\n\n  setAtp(strike: string, val: number) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      this.atpMap.set(strike, val);\n    }\n  }\n\n  getVolume(strike: string) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      return this.volumeMap.get(strike);\n    }\n  }\n\n  setVolume(strike: string, val: number) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      this.volumeMap.set(strike, val);\n    }\n  }\n\n  getOI(strike: string) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      return this.oiMap.get(strike);\n    }\n  }\n\n  setOI(strike: string, val: number) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      this.oiMap.set(strike, val);\n    }\n  }\n\n  getChgOI(strike: string) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      return this.chgoiMap.get(strike);\n    }\n  }\n\n  setChgOI(strike: string, val: number) {\n    if (AppConstants.isSimulatedStrategy) {\n\n    } else {\n      this.chgoiMap.set(strike, val);\n    }\n  } */\n}\n","\r\nexport class IntradayData {\r\n  time: string;\r\n  price: number;\r\n  trueRange: number;\r\n  atr: number;\r\n  ema: number;\r\n}\r\n\r\nexport class Position {\r\n  id: string;\r\n  scrip: string;\r\n  cmp: number;\r\n  netQty: number;\r\n  buyAvg: number;\r\n  sellAvg: number;\r\n  type: string;\r\n  realizedProfit: number;\r\n  pnl: number;\r\n  includeInSum1: boolean = false;\r\n  includeInSum2: boolean = false;\r\n  includeInSum3: boolean = false;\r\n  includeInSum4: boolean = false;\r\n}\r\n\r\nexport class OrderPasted {\r\n  instru: string;\r\n  expiry: string;\r\n  scrip: string;\r\n  symbol: string;\r\n  qty: number;\r\n  price: number;\r\n  strategy: string;\r\n}\r\n\r\nexport class Order {\r\n  id: string;\r\n  scrip: string;\r\n  qty: number;\r\n  status: string;\r\n  message: string;\r\n  type: string;\r\n  limit: string;\r\n  stop: string;\r\n  tradedPrice: string;\r\n  side: string;\r\n  orderDateTime: string;\r\n}\r\n\r\nexport class PlaceOrder {\r\n  symbol: string;\r\n  qty: number;\r\n  type: number;\r\n  side: number;\r\n  productType: string;\r\n  limitPrice: number;\r\n  stopPrice: number;\r\n  disclosedQty: number;\r\n  validity: string;\r\n  offlineOrder: string;\r\n  stopLoss: number;\r\n  takeProfit: number;\r\n}\r\n\r\nexport class AliceblueInstrument {\r\n  symbol: string;\r\n  lotSize: number;\r\n  expiry: string;\r\n  exchange_code: number;\r\n  exchange: string;\r\n  company: string;\r\n  code: number;\r\n\r\n  // For Angel masters\r\n  instru: string;\r\n  strike: number;\r\n  optionType: string;\r\n}\r\n\r\nexport class Instrument {\r\n  expiry: string;\r\n  instru: string;\r\n  strike: number;\r\n  type: string;\r\n}\r\n\r\nexport class AliceMarketData {\r\n  exchange_code: number;\r\n  token: number;\r\n  ltp: number;\r\n  ltt_unix: number;\r\n  last_traded_qty: number;\r\n  volume: number;\r\n  best_bid: number;\r\n  best_bid_qty: number;\r\n  best_ask: number;\r\n  best_ask_qty: number;\r\n  total_buy_qty: number;\r\n  total_sell_qty: number;\r\n  atp: number;\r\n  exchange_timestamp: number;\r\n  open: number;\r\n  high: number;\r\n  low: number;\r\n  close: number;\r\n  year_high: number;\r\n  year_low: number;\r\n}\r\n\r\nexport enum AliceBlueLiveFeedType {\r\n  MARKET_DATA = 'marketdata',\r\n  COMPACT = 'compact_marketdata',\r\n  SNAPQUOTE = 'snapquote',\r\n  FULL_SNAPQUOTE = 'full_snapquote'\r\n}\r\n\r\nexport enum AliceBlueWsFrameMode {\r\n  MARKETDATA = 1,\r\n  COMPACT_MARKETDATA = 2,\r\n  SNAPQUOTE = 3,\r\n  FULL_SNAPQUOTE = 4,\r\n  SPREADDATA = 5,\r\n  SPREAD_SNAPQUOTE = 6,\r\n  DPR = 7,\r\n  OI = 8,\r\n  MARKET_STATUS = 9,\r\n  EXCHANGE_MESSAGES = 10\r\n}\r\n\r\nexport enum PositionTypeForPayOff {\r\n  CEsell = 'cesell',\r\n  PEsell = 'pesell',\r\n  CEbuy = 'cebuy',\r\n  PEbuy = 'pebuy',\r\n  CE = 'ce',\r\n  PE = 'pe'\r\n}\r\n","import { Injectable } from '@angular/core';\nimport { AppConstants } from './application.constant';\nimport { AliceBlueLiveFeedType, Instrument } from './models';\nimport { AliceblueParserService } from './aliceblue-parser.service';\nimport { Subject } from 'rxjs';\n//import * as smartapi from 'smartapi-javascript';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WebsocketService {\n\n  public websocketEvent$: Subject<any> = new Subject();\n  heartbeatInterval;\n  websocket: WebSocket;\n  access_token;\n  baseUrl = 'https://ant.aliceblueonline.com';\n  socket_endpoint = 'wss://ant.aliceblueonline.com/hydrasocket/v2/websocket?access_token=';\n\n  constructor(\n    private aliceblueParserService: AliceblueParserService\n  ) { }\n\n  isSocketConnected() {\n    if (this.websocket && this.websocket.OPEN === 1) {\n      return true;\n    }\n    return false;\n  }\n\n  connect(access_token: string): void {\n\n    this.access_token = access_token;\n    this.websocket = new WebSocket(\n      this.socket_endpoint + access_token\n    );\n    this.websocket.binaryType = 'arraybuffer';\n    this.websocket.onopen = () => {\n      this.handleOnOpen(event);\n    };\n    this.websocket.onmessage = messageEvent => {\n      this.handleOnMessage(messageEvent);\n    };\n    this.websocket.onerror = event => {\n      this.handleOnError(event);\n    };\n    this.websocket.onclose = event => {\n      this.handleOnClose(event);\n    };\n  }\n\n  handleOnOpen(event: Event): void {\n    console.log('Opened Web Socket connection');\n    if (AppConstants.SocketMode === 'aliceblue') {\n      this.sendHeartbeat();\n      this.sendInitialSubscription();\n      this.websocketEvent$.next('connected');\n    }\n  }\n\n  sendHeartbeat() {\n    this.heartbeatInterval = setInterval(() => {\n      // console.log('sending heartbeat');\n      let message = JSON.stringify({\"a\": \"h\", \"v\": [], \"m\": \"\"});\n      this.sendMessage(message);\n    }, 5000);\n  }\n\n  sendInitialSubscription() {\n    console.log('sending initial subscription');\n    let usdinr_fut_code = AppConstants.USDINRFUTCodes[AppConstants.USDINR_FUT_MONTH];\n    let message = JSON.stringify({\n      'a' : 'subscribe',\n      'v' : [[1, 26000], [1, 26009], [3, 1], [3, usdinr_fut_code]/* , [2, 95734], [2, 95733] */],\n      'm' : AliceBlueLiveFeedType.MARKET_DATA});\n\n    // 26000 26009 for nf and bnf spot\n    // 1 is usdinr spot\n\n    console.log('usdinr_fut_code', usdinr_fut_code);\n\n    this.sendMessage(message);\n  }\n\n  handleOnMessage(messageEvent: MessageEvent) {\n    // console.log('handleOnMessage', messageEvent);\n    if (AppConstants.SocketMode === 'aliceblue') {\n      this.aliceblueParserService.handleSocketMessage(messageEvent.data);\n    }\n  }\n\n  handleOnError(event: Event): void {\n    console.log('Error in WS connection', event);\n  }\n\n  handleOnClose(event: CloseEvent): void {\n    console.log('Closed WS connection', event);\n    clearInterval(this.heartbeatInterval);\n    this.websocket = null;\n    setTimeout(() => {\n      console.log('Reconnecting websocket');\n      this.connect(this.access_token);\n    }, 2000);\n  }\n\n  sendMessage(message): any {\n    if (this.websocket && this.websocket.OPEN === 1) {\n      // console.log('Sending message over websocket: ' + message);\n      this.websocket.send(message);\n    } else {\n      console.log(\n        'Cannot send the message. Socket is not yet opened or it has been closed - ',\n        message\n      );\n    }\n  }\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"]}